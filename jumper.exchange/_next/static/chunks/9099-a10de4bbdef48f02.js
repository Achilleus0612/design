try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="77e7edd7-4136-443e-9c6c-fe41b834dc3d",e._sentryDebugIdIdentifier="sentry-dbid-77e7edd7-4136-443e-9c6c-fe41b834dc3d")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9099],{100:(e,t,n)=>{"use strict";n.d(t,{u:()=>a});var r=n(97559),i=n(7672);function a(e){let{r:t,s:n}=r.secp256k1.Signature.fromCompact(e.slice(2,130)),a=Number(`0x${e.slice(130)}`),[s,o]=(()=>{if(0===a||1===a)return[void 0,a];if(27===a)return[BigInt(a),0];if(28===a)return[BigInt(a),1];throw Error("Invalid yParityOrV value")})();return void 0!==s?{r:(0,i.cK)(t,{size:32}),s:(0,i.cK)(n,{size:32}),v:s,yParity:o}:{r:(0,i.cK)(t,{size:32}),s:(0,i.cK)(n,{size:32}),yParity:o}}},418:(e,t,n)=>{let r=n(6343),i=n(5041);function a(e){this.mode=r.KANJI,this.data=e}a.getBitsLength=function(e){return 13*e},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let n=i.toSJIS(this.data[t]);if(n>=33088&&n<=40956)n-=33088;else if(n>=57408&&n<=60351)n-=49472;else throw Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");n=(n>>>8&255)*192+(255&n),e.put(n,13)}},e.exports=a},1324:(e,t,n)=>{"use strict";n.d(t,{b:()=>g});var r=n(40440),i=n(63340),a=n(46303),s=n(80994),o=n(4377),u=n(59441),c=n(7672),l=n(508),d=n(85377),h=n(64159);function f(e={}){let t,p,g,y,m,w,I,M;return(0,r.U)(r=>({id:"metaMaskSDK",name:"MetaMask",rdns:["io.metamask","io.metamask.mobile"],type:f.type,async setup(){let e=await this.getProvider();e?.on&&(w||(w=this.onConnect.bind(this),e.on("connect",w)),y||(y=this.onAccountsChanged.bind(this),e.on("accountsChanged",y)))},async connect({chainId:n,isReconnecting:r}={}){let i=await this.getProvider();I||(I=this.onDisplayUri,i.on("display_uri",I));let a=[];r&&(a=await this.getAccounts().catch(()=>[]));try{let r,s;a?.length||(e.connectAndSign||e.connectWith?(e.connectAndSign?r=await t.connectAndSign({msg:e.connectAndSign}):e.connectWith&&(s=await t.connectWith({method:e.connectWith.method,params:e.connectWith.params})),a=await this.getAccounts()):a=(await t.connect()).map(e=>(0,o.b)(e)));let c=await this.getChainId();if(n&&c!==n){let e=await this.switchChain({chainId:n}).catch(e=>{if(e.code===u.vx.code)throw e;return{id:c}});c=e?.id??c}return I&&(i.removeListener("display_uri",I),I=void 0),r?i.emit("connectAndSign",{accounts:a,chainId:c,signResponse:r}):s&&i.emit("connectWith",{accounts:a,chainId:c,connectWithResponse:s}),w&&(i.removeListener("connect",w),w=void 0),y||(y=this.onAccountsChanged.bind(this),i.on("accountsChanged",y)),m||(m=this.onChainChanged.bind(this),i.on("chainChanged",m)),M||(M=this.onDisconnect.bind(this),i.on("disconnect",M)),{accounts:a,chainId:c}}catch(e){if(e.code===u.vx.code)throw new u.vx(e);if(e.code===u.qZ.code)throw new u.qZ(e);throw e}},async disconnect(){let e=await this.getProvider();m&&(e.removeListener("chainChanged",m),m=void 0),M&&(e.removeListener("disconnect",M),M=void 0),w||(w=this.onConnect.bind(this),e.on("connect",w)),await t.terminate()},async getAccounts(){let e=await this.getProvider();return(await e.request({method:"eth_accounts"})).map(e=>(0,o.b)(e))},async getChainId(){let e=await this.getProvider();return Number(e.getChainId()||await e?.request({method:"eth_chainId"}))},async getProvider(){async function s(){let s=await (async()=>{let{default:e}=await Promise.all([n.e(3030),n.e(3035)]).then(n.bind(n,82663));return"function"!=typeof e&&"function"==typeof e.default?e.default:e})(),o={};for(let e of r.chains)o[(0,c.cK)(e.id)]=(0,i.R)({chain:e,transports:r.transports})?.[0];t=new s({_source:"wagmi",forceDeleteProvider:!1,forceInjectProvider:!1,injectProvider:!1,...e,readonlyRPCMap:o,dappMetadata:{...e.dappMetadata,name:e.dappMetadata?.name?e.dappMetadata?.name:"wagmi",url:e.dappMetadata?.url?e.dappMetadata?.url:"undefined"!=typeof window?window.location.origin:"https://wagmi.sh"},useDeeplink:e.useDeeplink??!0});let u=await t.init(),l=u?.activeProvider?u.activeProvider:t.getProvider();if(!l)throw new a.N;return l}return p||(g||(g=s()),p=await g),p},async isAuthorized(){try{return!!(await (0,l.b)(()=>(0,d.w)(()=>this.getAccounts(),{timeout:200}),{delay:201,retryCount:3})).length}catch{return!1}},async switchChain({addEthereumChainParameter:e,chainId:t}){let n=await this.getProvider(),i=r.chains.find(e=>e.id===t);if(!i)throw new u.ch(new s.nk);try{return await n.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,c.cK)(t)}]}),await a(),await o(t),i}catch(r){if(r.code===u.vx.code)throw new u.vx(r);if(4902===r.code||r?.data?.originalError?.code===4902)try{return await n.request({method:"wallet_addEthereumChain",params:[{blockExplorerUrls:(()=>{let{default:t,...n}=i.blockExplorers??{};return e?.blockExplorerUrls?e.blockExplorerUrls:t?[t.url,...Object.values(n).map(e=>e.url)]:void 0})(),chainId:(0,c.cK)(t),chainName:e?.chainName??i.name,iconUrls:e?.iconUrls,nativeCurrency:e?.nativeCurrency??i.nativeCurrency,rpcUrls:e?.rpcUrls?.length?e.rpcUrls:[i.rpcUrls.default?.http[0]??""]}]}),await a(),await o(t),i}catch(e){if(e.code===u.vx.code)throw new u.vx(e);throw new u.ch(e)}throw new u.ch(r)}async function a(){await (0,l.b)(async()=>{let e=(0,h.ME)(await n.request({method:"eth_chainId"}));if(e!==t)throw Error("User rejected switch after adding network.");return e},{delay:50,retryCount:20})}async function o(e){await new Promise(t=>{let n=i=>{"chainId"in i&&i.chainId===e&&(r.emitter.off("change",n),t())};r.emitter.on("change",n),r.emitter.emit("change",{chainId:e})})}},async onAccountsChanged(e){if(0===e.length)if(!t.isExtensionActive())return;else this.onDisconnect();else if(r.emitter.listenerCount("connect")){let e=(await this.getChainId()).toString();this.onConnect({chainId:e})}else r.emitter.emit("change",{accounts:e.map(e=>(0,o.b)(e))})},onChainChanged(e){let t=Number(e);r.emitter.emit("change",{chainId:t})},async onConnect(e){let t=await this.getAccounts();if(0===t.length)return;let n=Number(e.chainId);r.emitter.emit("connect",{accounts:t,chainId:n});let i=await this.getProvider();w&&(i.removeListener("connect",w),w=void 0),y||(y=this.onAccountsChanged.bind(this),i.on("accountsChanged",y)),m||(m=this.onChainChanged.bind(this),i.on("chainChanged",m)),M||(M=this.onDisconnect.bind(this),i.on("disconnect",M))},async onDisconnect(e){let t=await this.getProvider();e&&1013===e.code&&t&&(await this.getAccounts()).length||(r.emitter.emit("disconnect"),m&&(t.removeListener("chainChanged",m),m=void 0),M&&(t.removeListener("disconnect",M),M=void 0),w||(w=this.onConnect.bind(this),t.on("connect",w)))},onDisplayUri(e){r.emitter.emit("message",{type:"display_uri",data:e})}}))}f.type="metaMask";var p=n(7623);let g=e=>(0,p.I)(f(e),"metaMaskSDK","MetaMask")},2479:(e,t,n)=>{"use strict";n.d(t,{Ci:()=>s,J8:()=>o,MU:()=>u});var r=n(70341),i=n(30503);let a=e=>e;class s extends i.C{constructor({body:e,cause:t,details:n,headers:i,status:s,url:o}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[s&&`Status: ${s}`,`URL: ${a(o)}`,e&&`Request body: ${(0,r.A)(e)}`].filter(Boolean),name:"HttpRequestError"}),this.body=e,this.headers=i,this.status=s,this.url=o}}i.C;class o extends i.C{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${a(n)}`,`Request body: ${(0,r.A)(e)}`],name:"RpcRequestError"}),this.code=t.code,this.data=t.data}}i.C;class u extends i.C{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${a(t)}`,`Request body: ${(0,r.A)(e)}`],name:"TimeoutError"})}}},3201:(e,t,n)=>{let r=n(23066),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],a=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case r.L:return i[(e-1)*4+0];case r.M:return i[(e-1)*4+1];case r.Q:return i[(e-1)*4+2];case r.H:return i[(e-1)*4+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case r.L:return a[(e-1)*4+0];case r.M:return a[(e-1)*4+1];case r.Q:return a[(e-1)*4+2];case r.H:return a[(e-1)*4+3];default:return}}},5041:(e,t)=>{let n,r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return r[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw Error('"toSJISFunc" is not a valid function.');n=e},t.isKanjiModeEnabled=function(){return void 0!==n},t.toSJIS=function(e){return n(e)}},6085:(e,t)=>{function n(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let n=parseInt(t.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,r=e.width&&e.width>=21?e.width:void 0,i=e.scale||4;return{width:r,scale:r?4:i,margin:t,color:{dark:n(e.color.dark||"#000000ff"),light:n(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,n){let r=t.getScale(e,n);return Math.floor((e+2*n.margin)*r)},t.qrToImageData=function(e,n,r){let i=n.modules.size,a=n.modules.data,s=t.getScale(i,r),o=Math.floor((i+2*r.margin)*s),u=r.margin*s,c=[r.color.light,r.color.dark];for(let t=0;t<o;t++)for(let n=0;n<o;n++){let l=(t*o+n)*4,d=r.color.light;t>=u&&n>=u&&t<o-u&&n<o-u&&(d=c[+!!a[Math.floor((t-u)/s)*i+Math.floor((n-u)/s)]]),e[l++]=d.r,e[l++]=d.g,e[l++]=d.b,e[l]=d.a}}},6343:(e,t,n)=>{let r=n(68205),i=n(55187);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!r.isValid(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return i.testNumeric(e)?t.NUMERIC:i.testAlphanumeric(e)?t.ALPHANUMERIC:i.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,n){if(t.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw Error("Unknown mode: "+e)}}catch(e){return n}}},6875:(e,t,n)=>{"use strict";n.d(t,{C:()=>s});var r=n(10599),i=n(95413),a=n(13426);async function s(e,t){let{account:n=e.account,domain:s,message:o,primaryType:u}=t;if(!n)throw new i.T({docsPath:"/docs/actions/wallet/signTypedData"});let c=(0,r.J)(n),l={EIP712Domain:(0,a.H4)({domain:s}),...t.types};if((0,a.$$)({domain:s,message:o,primaryType:u,types:l}),c.signTypedData)return c.signTypedData({domain:s,message:o,primaryType:u,types:l});let d=(0,a.v8)({domain:s,message:o,primaryType:u,types:l});return e.request({method:"eth_signTypedData_v4",params:[c.address,d]},{retryCount:0})}},7623:(e,t,n)=>{"use strict";n.d(t,{I:()=>r});let r=(e,t,n)=>(e.id=t,e.displayName=n,e)},8997:(e,t,n)=>{"use strict";n.d(t,{Q:()=>i});var r=n(7672);async function i(e,{address:t,blockNumber:n,blockTag:i="latest"}){let a=void 0!==n?(0,r.cK)(n):void 0,s=await e.request({method:"eth_getCode",params:[t,a||i]},{dedupe:!!a});if("0x"!==s)return s}},12135:(e,t,n)=>{"use strict";n.d(t,{S:()=>H});var r=n(22841),i=n(30503);class a extends i.C{constructor(e){let t="ProviderNotFoundError";super(`${t}: ${e||"The provider for this connector was not found"}`,{name:t})}}function s(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"app.phantom.bitcoin",name:"Phantom",type:s.type,icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTA4IiBoZWlnaHQ9IjEwOCIgdmlld0JveD0iMCAwIDEwOCAxMDgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDgiIGhlaWdodD0iMTA4IiByeD0iMjYiIGZpbGw9IiNBQjlGRjIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00Ni41MjY3IDY5LjkyMjlDNDIuMDA1NCA3Ni44NTA5IDM0LjQyOTIgODUuNjE4MiAyNC4zNDggODUuNjE4MkMxOS41ODI0IDg1LjYxODIgMTUgODMuNjU2MyAxNSA3NS4xMzQyQzE1IDUzLjQzMDUgNDQuNjMyNiAxOS44MzI3IDcyLjEyNjggMTkuODMyN0M4Ny43NjggMTkuODMyNyA5NCAzMC42ODQ2IDk0IDQzLjAwNzlDOTQgNTguODI1OCA4My43MzU1IDc2LjkxMjIgNzMuNTMyMSA3Ni45MTIyQzcwLjI5MzkgNzYuOTEyMiA2OC43MDUzIDc1LjEzNDIgNjguNzA1MyA3Mi4zMTRDNjguNzA1MyA3MS41NzgzIDY4LjgyNzUgNzAuNzgxMiA2OS4wNzE5IDY5LjkyMjlDNjUuNTg5MyA3NS44Njk5IDU4Ljg2ODUgODEuMzg3OCA1Mi41NzU0IDgxLjM4NzhDNDcuOTkzIDgxLjM4NzggNDUuNjcxMyA3OC41MDYzIDQ1LjY3MTMgNzQuNDU5OEM0NS42NzEzIDcyLjk4ODQgNDUuOTc2OCA3MS40NTU2IDQ2LjUyNjcgNjkuOTIyOVpNODMuNjc2MSA0Mi41Nzk0QzgzLjY3NjEgNDYuMTcwNCA4MS41NTc1IDQ3Ljk2NTggNzkuMTg3NSA0Ny45NjU4Qzc2Ljc4MTYgNDcuOTY1OCA3NC42OTg5IDQ2LjE3MDQgNzQuNjk4OSA0Mi41Nzk0Qzc0LjY5ODkgMzguOTg4NSA3Ni43ODE2IDM3LjE5MzEgNzkuMTg3NSAzNy4xOTMxQzgxLjU1NzUgMzcuMTkzMSA4My42NzYxIDM4Ljk4ODUgODMuNjc2MSA0Mi41Nzk0Wk03MC4yMTAzIDQyLjU3OTVDNzAuMjEwMyA0Ni4xNzA0IDY4LjA5MTYgNDcuOTY1OCA2NS43MjE2IDQ3Ljk2NThDNjMuMzE1NyA0Ny45NjU4IDYxLjIzMyA0Ni4xNzA0IDYxLjIzMyA0Mi41Nzk1QzYxLjIzMyAzOC45ODg1IDYzLjMxNTcgMzcuMTkzMSA2NS43MjE2IDM3LjE5MzFDNjguMDkxNiAzNy4xOTMxIDcwLjIxMDMgMzguOTg4NSA3MC4yMTAzIDQyLjU3OTVaIiBmaWxsPSIjRkZGREY4Ii8+Cjwvc3ZnPgo=",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"phantom"in window){let e=window,t=e.phantom?.bitcoin;if(t?.isPhantom)return t}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=new Uint8Array(e.match(/.{1,2}/g).map(e=>Number.parseInt(e,16)));return Array.from(await this.signPSBT(r,{inputsToSign:n.inputsToSign,finalize:n.finalize}),e=>e.toString(16).padStart(2,"0")).join("")}throw new r.ab(e)},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await this.getAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.on("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return(await e.requestAccounts()).filter(e=>"payment"===e.purpose).map(e=>e.address)},getChainId:async()=>n,async isAuthorized(){try{return i&&!!await e.storage?.getItem(`${this.id}.connected`)}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t.filter(e=>"payment"===e.purpose).map(e=>e.address)})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}s.type="UTXO";var o=n(74160);function u(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"XverseProviders.BitcoinProvider",name:"Xverse Wallet",type:u.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiMxNzE3MTciIGQ9Ik0wIDBoNjAwdjYwMEgweiIvPjxwYXRoIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTQ0MCA0MzUuNHYtNTFjMC0yLS44LTMuOS0yLjItNS4zTDIyMCAxNjIuMmE3LjYgNy42IDAgMCAwLTUuNC0yLjJoLTUxLjFjLTIuNSAwLTQuNiAyLTQuNiA0LjZ2NDcuM2MwIDIgLjggNCAyLjIgNS40bDc4LjIgNzcuOGE0LjYgNC42IDAgMCAxIDAgNi41bC03OSA3OC43Yy0xIC45LTEuNCAyLTEuNCAzLjJ2NTJjMCAyLjQgMiA0LjUgNC42IDQuNUgyNDljMi42IDAgNC42LTIgNC42LTQuNlY0MDVjMC0xLjIuNS0yLjQgMS40LTMuM2w0Mi40LTQyLjJhNC42IDQuNiAwIDAgMSA2LjQgMGw3OC43IDc4LjRhNy42IDcuNiAwIDAgMCA1LjQgMi4yaDQ3LjVjMi41IDAgNC42LTIgNC42LTQuNloiLz48cGF0aCBmaWxsPSIjRUU3QTMwIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0zMjUuNiAyMjcuMmg0Mi44YzIuNiAwIDQuNiAyLjEgNC42IDQuNnY0Mi42YzAgNCA1IDYuMSA4IDMuMmw1OC43LTU4LjVjLjgtLjggMS4zLTIgMS4zLTMuMnYtNTEuMmMwLTIuNi0yLTQuNi00LjYtNC42TDM4NCAxNjBjLTEuMiAwLTIuNC41LTMuMyAxLjNsLTU4LjQgNTguMWE0LjYgNC42IDAgMCAwIDMuMiA3LjhaIi8+PC9nPjwvc3ZnPg==",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"XverseProviders"in window)return window.XverseProviders.BitcoinProvider},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=(0,o.OG)(e),i=n.inputsToSign.reduce((e,t)=>(e[t.address]||(e[t.address]=[]),e[t.address].push(...t.signingIndexes),e),{}),a=await this.request("signPsbt",{psbt:r,allowedSignHash:1,signInputs:i,broadcast:n.finalize});if(a?.error)throw a?.error;return(0,o.Qf)(a?.result?.psbt)}throw new r.ab(e)},async connect({isReconnecting:n}={}){let s=await this.getInternalProvider();if(!s)throw new a;if(!n){let e=await s.request("wallet_requestPermissions");if(e.error)throw new r.vx(e.error.message)}let o=await this.getAccounts(),u=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),s.addListener("accountChange",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:o,chainId:u}},async disconnect(){let n=await this.getInternalProvider();if(!n)throw new a;t&&(n.removeListener?.("accountChange",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;let t=await e.request("getAddresses",{purposes:["payment"]});if(!t.result)throw new r.vx(t.error?.message);return t.result.addresses.map(e=>e.address)},getChainId:async()=>n,async isAuthorized(){try{return i&&!!await e.storage?.getItem(`${this.id}.connected`)}catch{return!1}},async onAccountsChanged(){let{accounts:t}=await this.connect();e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}u.type="UTXO";var c=n(33701);function l(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"unisat",name:"Unisat",type:l.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGRhdGEtbmFtZT0i5Zu+5bGCIDIiIHZpZXdCb3g9IjAgMCAxMTUuNzcgMTQ3LjciPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjMzNzkuMDMiIHgyPSIzNDE1LjQ4IiB5MT0iLTIxMDIiIHkyPSItMjE5OC4xMSIgZGF0YS1uYW1lPSLmnKrlkb3lkI3nmoTmuJDlj5ggNSIgZ3JhZGllbnRUcmFuc2Zvcm09InJvdGF0ZSgtMTM0LjczIDIxODcuNjY3IC0zNTMuNDI3KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzIwMWMxYiIvPjxzdG9wIG9mZnNldD0iLjM2IiBzdG9wLWNvbG9yPSIjNzczOTBkIi8+PHN0b3Agb2Zmc2V0PSIuNjciIHN0b3AtY29sb3I9IiNlYTgxMDEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmNGI4NTIiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjMzODQuMjMiIHgyPSIzMzMwLjY0IiB5MT0iLTIyMzEuNDIiIHkyPSItMjEzMS4yOSIgZGF0YS1uYW1lPSLmnKrlkb3lkI3nmoTmuJDlj5ggNCIgZ3JhZGllbnRUcmFuc2Zvcm09InJvdGF0ZSgtMTM0LjczIDIxODcuNjY3IC0zNTMuNDI3KSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iIzFmMWQxYyIvPjxzdG9wIG9mZnNldD0iLjM3IiBzdG9wLWNvbG9yPSIjNzczOTBkIi8+PHN0b3Agb2Zmc2V0PSIuNjciIHN0b3AtY29sb3I9IiNlYTgxMDEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmNGZiNTIiLz48L2xpbmVhckdyYWRpZW50PjxyYWRpYWxHcmFkaWVudCBpZD0iYyIgY3g9IjUzLjAxIiBjeT0iNDUuODQiIHI9IjExLjEzIiBkYXRhLW5hbWU9IuacquWRveWQjeeahOa4kOWPmCA2IiBmeD0iNTMuMDEiIGZ5PSI0NS44NCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2Y0Yjg1MiIvPjxzdG9wIG9mZnNldD0iLjMzIiBzdG9wLWNvbG9yPSIjZWE4MTAxIi8+PHN0b3Agb2Zmc2V0PSIuNjQiIHN0b3AtY29sb3I9IiM3NzM5MGQiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMyMTFjMWQiLz48L3JhZGlhbEdyYWRpZW50PjwvZGVmcz48ZyBkYXRhLW5hbWU9IuWbvuWxgiAxIj48cGF0aCBmaWxsPSJ1cmwoI2EpIiBkPSJtODEuNjYgMTMuMjkgMzAuMzEgMzAuMDJjMi41OCAyLjU1IDMuODUgNS4xMyAzLjgxIDcuNzMtLjA0IDIuNi0xLjE1IDQuOTctMy4zMiA3LjEyLTIuMjcgMi4yNS00LjcyIDMuMzktNy4zNCAzLjQ0LTIuNjIuMDQtNS4yMi0xLjIyLTcuOC0zLjc3bC0zMS0zMC43Yy0zLjUyLTMuNDktNi45Mi01Ljk2LTEwLjE5LTcuNDEtMy4yNy0xLjQ1LTYuNzEtMS42OC0xMC4zMS0uNjgtMy42MS45OS03LjQ4IDMuNTQtMTEuNjMgNy42NC01LjcyIDUuNjctOC40NSAxMC45OS04LjE3IDE1Ljk2LjI4IDQuOTcgMy4xMiAxMC4xMyA4LjUxIDE1LjQ2bDMxLjI1IDMwLjk2YzIuNjEgMi41OCAzLjg5IDUuMTYgMy44NSA3LjcyLS4wNCAyLjU3LTEuMTYgNC45NC0zLjM3IDcuMTMtMi4yIDIuMTgtNC42MyAzLjMyLTcuMjcgMy40MS0yLjY0LjA5LTUuMjctMS4xNi03Ljg3LTMuNzRMMjAuODEgNzMuNTZjLTQuOTMtNC44OC04LjQ5LTkuNS0xMC42OC0xMy44Ni0yLjE5LTQuMzYtMy4wMS05LjI5LTIuNDQtMTQuNzkuNTEtNC43MSAyLjAyLTkuMjcgNC41NC0xMy42OSAyLjUxLTQuNDIgNi4xMS04Ljk0IDEwLjc4LTEzLjU3IDUuNTYtNS41MSAxMC44Ny05LjczIDE1LjkzLTEyLjY3QzQzLjk5IDIuMDQgNDguODguNDEgNTMuNi4wN2M0LjczLS4zNCA5LjM5LjYgMTQgMi44MiA0LjYxIDIuMjIgOS4yOSA1LjY4IDE0LjA1IDEwLjRaIi8+PHBhdGggZmlsbD0idXJsKCNiKSIgZD0iTTM0LjExIDEzNC40MiAzLjgxIDEwNC40QzEuMjMgMTAxLjg0LS4wNCA5OS4yNyAwIDk2LjY3Yy4wNC0yLjYgMS4xNS00Ljk3IDMuMzItNy4xMiAyLjI3LTIuMjUgNC43Mi0zLjM5IDcuMzQtMy40NCAyLjYyLS4wNCA1LjIyIDEuMjEgNy44IDMuNzdsMzAuOTkgMzAuN2MzLjUzIDMuNDkgNi45MiA1Ljk2IDEwLjE5IDcuNDEgMy4yNyAxLjQ1IDYuNzEgMS42NyAxMC4zMi42OCAzLjYxLS45OSA3LjQ4LTMuNTQgMTEuNjMtNy42NSA1LjcyLTUuNjcgOC40NS0xMC45OSA4LjE3LTE1Ljk2LS4yOC00Ljk3LTMuMTItMTAuMTMtOC41MS0xNS40N0w2NC42IDczLjI0Yy0yLjYxLTIuNTgtMy44OS01LjE2LTMuODUtNy43Mi4wNC0yLjU3IDEuMTYtNC45NCAzLjM3LTcuMTMgMi4yLTIuMTggNC42My0zLjMyIDcuMjctMy40MSAyLjY0LS4wOSA1LjI3IDEuMTYgNy44NyAzLjc0bDE1LjcgMTUuNDFjNC45MyA0Ljg4IDguNDkgOS41IDEwLjY4IDEzLjg2IDIuMTkgNC4zNiAzLjAxIDkuMjkgMi40NCAxNC43OS0uNTEgNC43MS0yLjAyIDkuMjctNC41NCAxMy42OS0yLjUxIDQuNDItNi4xMSA4Ljk0LTEwLjc4IDEzLjU3LTUuNTYgNS41MS0xMC44NyA5LjczLTE1LjkzIDEyLjY3LTUuMDYgMi45NC05Ljk1IDQuNTgtMTQuNjggNC45Mi00LjczLjM0LTkuMzktLjYtMTQtMi44Mi00LjYxLTIuMjItOS4yOS01LjY4LTE0LjA1LTEwLjRaIi8+PGNpcmNsZSBjeD0iNTMuMDEiIGN5PSI0NS44MyIgcj0iMTEuMTMiIGZpbGw9InVybCgjYykiLz48L2c+PC9zdmc+",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"unisat"in window){let e=window;if(!(e.unisat?.isBinance||e.unisat?.isBitKeep))return e.unisat}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=n.inputsToSign.flatMap(({sigHash:e,address:t,signingIndexes:n})=>n.map(n=>({index:n,address:t,sighashTypes:void 0!==e?[e]:void 0})));return await this.signPsbt(e,{toSignInputs:r,autoFinalized:n.finalize})}throw new r.ab},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function d(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"io.xdefi.bitcoin",name:"XDEFI",type:d.type,icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8yMTkxXzQyOTApIj4KPHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIHJ4PSIxMDQiIGZpbGw9IiMzMzVERTUiLz4KPHBhdGggZD0iTTQ2My40MzggMjQxLjI0N0M0NjAuNzY1IDIwNS4xMzUgNDQ4LjU4IDE3MC4zMzggNDI4LjA4NyAxNDAuMjcxQzQwNy41OTkgMTEwLjIwOSAzNzkuNTA5IDg1LjkxODIgMzQ2LjU3OSA2OS43OTZDMzEzLjY1MyA1My42NzggMjc3LjAzMiA0Ni4yODA0IDI0MC4zMiA0OC4zMzYzQzIwMy42MDUgNTAuMzkyMSAxNjguMDY5IDYxLjgyNTUgMTM3LjIxMiA4MS41MjAxQzEwNi4zNTQgMTAxLjIxIDgxLjIzOTQgMTI4LjQ4IDY0LjMzODYgMTYwLjYzNkw2My41MzYgMTYyLjI1N0M1OC4xOTcxIDE3My4xMjYgNTQuNTg3OCAxODQuNzQ1IDUyLjg0MTEgMTk2LjY5N0M0Ny44NDU1IDIzMi4wMjEgNTUuNTkyIDI2My40NiA3NS44Mjc1IDI4Ny42NjdDOTcuOTU5OSAzMTQuMTM2IDEzMy45OTMgMzI5Ljg3OSAxNzcuMjE1IDMzMS45NDdDMjI5LjgzMiAzMzQuNTU1IDI4Mi4xNDggMzIwLjQzNCAzMTkuMjc1IDI5NC40NThMMzQxLjI4NyAzMDcuMzUzQzMyMC4yNTggMzI1LjI5MSAyNzEuNjM3IDM1Ny41OTQgMTkxLjExMiAzNjIuMDA5QzEwMC43MTkgMzY2LjkzIDYzLjA0MjUgMzM4LjAwMSA2Mi42OTA1IDMzNy43MDZMNTYuMzUxNyAzNDUuNDAzTDQ4IDM1NS4yNzNDNDkuNjAwOCAzNTYuNiA4NS43Mjg1IDM4NS4zMzUgMTcwLjU3NiAzODUuMzM1QzE3Ny41MiAzODUuMzM1IDE4NC44MTYgMzg1LjMzNSAxOTIuNDEyIDM4NC43NDZDMjg5Ljg3MyAzNzkuMzkxIDM0My40NzYgMzM3LjU3NSAzNjIuMjMxIDMxOS42MjlMMzgwLjY0MiAzMzAuNjM3QzM2OC4yNjEgMzQ2LjY1OCAzNTMuMDI1IDM2MC4zMzMgMzM1LjY3IDM3MC45ODJDMjc0LjUwNCA0MDkuODQ5IDE5Ni43MDggNDE0Ljg2NyAxNDIuMjQyIDQxMi4xNjJMMTQxLjA5NiA0MzQuODMxQzE1MC4yNDIgNDM1LjI3MyAxNTkuMDM1IDQzNS40NzEgMTY3LjU4IDQzNS40NzFDMzIxLjA0OCA0MzUuNDcxIDM4My4xMzIgMzY2LjcxOSA0MDAuNTM5IDM0Mi4wNjJMNDE0LjkyNSAzNTAuNDg3QzQwMS4xMzUgMzczLjYwMyAzODIuMzkzIDM5My41NjcgMzU5LjkzMSA0MDguOTM5QzMzMy4wMzQgNDI3LjM0NSAzMDEuNzM1IDQzOC41MzggMjY5LjExNCA0NDEuNDE1TDI3MS4xMTQgNDY0QzMwNy43MzkgNDYwLjc4NiAzNDIuODg4IDQ0OC4yMzYgMzczLjA4OSA0MjcuNTgxQzQwMy4yOSA0MDYuOTI2IDQyNy41MDggMzc4Ljg4MSA0NDMuMzQ5IDM0Ni4yMDdDNDU5LjE4NSAzMTMuNTI5IDQ2Ni4xMTYgMjc3LjM1OCA0NjMuNDM4IDI0MS4yNDdaTTM3NC44MSAyNDQuNzM5QzM2NC42MjYgMjQ0LjczOSAzNTYuMzY4IDIzNi42MTMgMzU2LjM2OCAyMjYuNTg2QzM1Ni4zNjggMjE2LjU2IDM2NC42MjEgMjA4LjQzMyAzNzQuODEgMjA4LjQzM0MzODQuOTkgMjA4LjQzMyAzOTMuMjQ3IDIxNi41NiAzOTMuMjQ3IDIyNi41ODZDMzkzLjI0NyAyMzYuNjEzIDM4NC45OTQgMjQ0LjczOSAzNzQuODEgMjQ0LjczOVoiIGZpbGw9IiNFQ0VDRUMiLz4KPC9nPgo8ZGVmcz4KPGNsaXBQYXRoIGlkPSJjbGlwMF8yMTkxXzQyOTAiPgo8cmVjdCB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgZmlsbD0id2hpdGUiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"xfi"in window){let e=window;return e.xfi?.bitcoin}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t;return await this.signPsbt(e,n.finalize)}throw new r.ab(e)},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{return i&&!!await e.storage?.getItem(`${this.id}.connected`)}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function h(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"com.okex.wallet.bitcoin",name:"OKX Wallet",type:h.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+CiAgICA8cGF0aCBmaWxsPSIjMDAwIiBkPSJNMCAwaDMydjMySDB6Ii8+CiAgICA8cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTIuNiA3SDcuNGEuNC40IDAgMCAwLS40LjR2NS4yYzAgLjIyLjE3OS40LjQuNGg1LjJhLjQuNCAwIDAgMCAuNC0uNFY3LjRhLjQuNCAwIDAgMC0uNC0uNE0xOC42MDIgMTMuMDAyaC01LjJhLjQuNCAwIDAgMC0uNC40djUuMmMwIC4yMi4xNzkuNC40LjRoNS4yYS40LjQgMCAwIDAgLjQtLjR2LTUuMmEuNC40IDAgMCAwLS40LS40TTE5LjQgN2g1LjJhLjQuNCAwIDAgMSAuNC40djUuMmEuNC40IDAgMCAxLS40LjRoLTUuMmEuNC40IDAgMCAxLS40LS40VjcuNGEuNC40IDAgMCAxIC40LS40TTEyLjYgMTlINy40YS40LjQgMCAwIDAtLjQuNHY1LjJjMCAuMjIuMTc5LjQuNC40aDUuMmEuNC40IDAgMCAwIC40LS40di01LjJhLjQuNCAwIDAgMC0uNC0uNE0xOS40IDE5aDUuMmEuNC40IDAgMCAxIC40LjR2NS4yYS40LjQgMCAwIDEtLjQuNGgtNS4yYS40LjQgMCAwIDEtLjQtLjR2LTUuMmEuNC40IDAgMCAxIC40LS40Ii8+Cjwvc3ZnPgo=",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"okxwallet"in window){let e=window,t=e.okxwallet?.bitcoin;if(t?.isOkxWallet)return t}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=n.inputsToSign.flatMap(({sigHash:e,address:t,signingIndexes:n})=>n.map(n=>({index:n,address:t,sighashTypes:void 0!==e?[e]:void 0})));return await this.signPsbt(e,{toSignInputs:r,autoFinalized:n.finalize})}throw new r.ab(e)},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function f(e={}){let{chainId:t,shimDisconnect:n=!0}=e;return e=>({id:"LeatherProvider",name:"Leather",type:f.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiBmaWxsPSJub25lIj4KICAgIDxwYXRoIGZpbGw9IiMxMjEwMEYiIGQ9Ik0wIDBoMTI4djEyOEgweiIvPgogICAgPHBhdGggZmlsbD0iI0Y1RjFFRCIgZD0iTTc0LjkxNyA1Mi43MTFjNy41Ni0xLjE3IDE4LjQ5Mi05LjEzIDE4LjQ5Mi0xNS4zMzUgMC0xLjg3My0xLjUxMi0zLjE2LTMuNzIyLTMuMTYtNC4xODcgMC0xMS4yOCA2LjMyLTE0Ljc3IDE4LjQ5NU0zOS45MTEgODMuNWMtOS44ODUgMC0xMC43IDkuODMzLS44MTQgOS44MzMgNC40MiAwIDkuNzctMS43NTYgMTIuNTYtNC45MTYtNC4wNy0zLjUxMi03LjQ0My00LjkxNy0xMS43NDYtNC45MTdtNjIuOTE4LTQuMjE0Yy41ODEgMTYuNTA2LTcuNzkyIDI1Ljc1NC0yMS45OCAyNS43NTQtOC4zNzQgMC0xMi41Ni0zLjE2MS0yMS41MTYtOS4wMTQtNC42NTIgNS4xNTEtMTMuNDkgOS4wMTQtMjAuODE4IDkuMDE0LTI1LjIzNiAwLTI0LjE5LTMyLjE5MyAxLjUxMi0zMi4xOTMgNS4zNSAwIDkuODg2IDEuNDA1IDE1LjcgNS4wMzRsMy44MzktMTMuNDYyQzQzLjc0OSA2MC4wODYgMzUuODQgNDcuOTEyIDQzLjYzMyAzMC40NjloMTIuNTZjLTYuOTc4IDExLjU5LTIuMjEgMjEuMTg5IDYuNjI5IDIyLjI0MkM2Ny41OSAzNS43MzcgNzcuODI1IDIyLjUxIDkxLjQzMiAyMi41MWM3LjY3NSAwIDEzLjcyMyA1LjAzNCAxMy43MjMgMTQuMTY1IDAgMTQuNjMzLTE5LjA3MyAyNi41NzMtMzMuNDk0IDI3Ljc0NEw2NS43MyA4NS4zNzJjNi43NDUgNy44NDMgMjUuNDY5IDE1LjQ1MiAyNS40NjktNi4wODd6Ii8+Cjwvc3ZnPg==",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"LeatherProvider"in window)return window.LeatherProvider},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=await this.request("signPsbt",{hex:e,broadcast:n.finalize});if(r?.error)throw r?.error;if(!r?.result?.hex)throw Error("Missing hex result from signed PSBT");return r.result.hex}throw new r.ab(e)},async connect(){if(!await this.getInternalProvider())throw new a;let t=await this.getAccounts(),r=await this.getChainId();return n&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:t,chainId:r}},async disconnect(){if(!await this.getInternalProvider())throw new a;n&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;let t=await e.request("getAddresses");if(!t.result)throw new r.vx(t.error?.message);return t.result.addresses.map(e=>e.address)},getChainId:async()=>t,async isAuthorized(){try{return n&&!!await e.storage?.getItem(`${this.id}.connected`)}catch{return!1}},async onAccountsChanged(){let{accounts:t}=await this.connect();e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function p(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"so.onekey.app.wallet.bitcoin",name:"OneKey",type:p.type,icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTMiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNi4wMDAxIDIyLjkxMDhDMTcuNTMwOSAyMi45MTA4IDE4Ljc3MTggMjEuNjY5OSAxOC43NzE4IDIwLjEzOTFDMTguNzcxOCAxOC42MDg0IDE3LjUzMDkgMTcuMzY3NCAxNi4wMDAxIDE3LjM2NzRDMTQuNDY5MyAxNy4zNjc0IDEzLjIyODQgMTguNjA4NCAxMy4yMjg0IDIwLjEzOTFDMTMuMjI4NCAyMS42Njk5IDE0LjQ2OTMgMjIuOTEwOCAxNi4wMDAxIDIyLjkxMDhaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE2IDMyQzI3LjA0NTcgMzIgMzIgMjcuMDQ1NyAzMiAxNkMzMiA0Ljk1NDMgMjcuMDQ1NyAwIDE2IDBDNC45NTQzIDAgMCA0Ljk1NDMgMCAxNkMwIDI3LjA0NTcgNC45NTQzIDMyIDE2IDMyWk0xMi45OTQ1IDYuNzg0NTdIMTcuNDQ1NlYxNC4xMTk2SDE0LjY4NTlWOS4xNDU4M0gxMi4yMTM2TDEyLjk5NDUgNi43ODQ1N1pNMTYuMDAwMSAyNS4yMTU0QzE4LjgwMzcgMjUuMjE1NCAyMS4wNzY0IDIyLjk0MjcgMjEuMDc2NCAyMC4xMzkxQzIxLjA3NjQgMTcuMzM1NiAxOC44MDM3IDE1LjA2MjggMTYuMDAwMSAxNS4wNjI4QzEzLjE5NjUgMTUuMDYyOCAxMC45MjM4IDE3LjMzNTYgMTAuOTIzOCAyMC4xMzkxQzEwLjkyMzggMjIuOTQyNyAxMy4xOTY1IDI1LjIxNTQgMTYuMDAwMSAyNS4yMTU0WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"$onekey"in window)return window.$onekey.btc},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=n.inputsToSign.flatMap(({sigHash:e,address:t,signingIndexes:n})=>n.map(n=>({index:n,address:t,sighashTypes:void 0!==e?[e]:void 0})));return await this.signPsbt(e,{toSignInputs:r,autoFinalized:n.finalize})}throw new r.ab},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function g(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"binance",name:"Binance",type:g.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxuczp4PSJuc19leHRlbmQ7IiB4bWxuczppPSJuc19haTsiIHhtbG5zOmdyYXBoPSJuc19ncmFwaHM7IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUwIDUwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MCA1MDsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgogPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KICAuc3Qwe2ZpbGw6I0YwQjkwQjt9CiA8L3N0eWxlPgogPG1ldGFkYXRhPgogIDxzZncgeG1sbnM9Im5zX3NmdzsiPgogICA8c2xpY2VzPgogICA8L3NsaWNlcz4KICAgPHNsaWNlU291cmNlQm91bmRzIGJvdHRvbUxlZnRPcmlnaW49InRydWUiIGhlaWdodD0iNTAiIHdpZHRoPSI1MCIgeD0iMjQ5Ny45IiB5PSItNzEyLjIiPgogICA8L3NsaWNlU291cmNlQm91bmRzPgogIDwvc2Z3PgogPC9tZXRhZGF0YT4KIDxnPgogIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0xMS4zLDI1bC01LjYsNS42TDAsMjVsNS43LTUuN0wxMS4zLDI1eiBNMjUsMTEuM2w5LjcsOS43bDUuNy01LjdMMjUsMEw5LjcsMTUuM2w1LjcsNS43TDI1LDExLjN6IE00NC4zLDE5LjMgICBMMzguNywyNWw1LjcsNS43TDUwLDI1TDQ0LjMsMTkuM3ogTTI1LDM4LjdMMTUuMywyOWwtNS43LDUuN0wyNSw1MGwxNS4zLTE1LjNMMzQuNywyOUwyNSwzOC43eiBNMjUsMzAuNmw1LjctNS43TDI1LDE5LjNMMTkuMywyNSAgIEwyNSwzMC42TDI1LDMwLjZ6Ij4KICA8L3BhdGg+CiA8L2c+Cjwvc3ZnPg==",async setup(){},async getInternalProvider(){if("undefined"!=typeof window){if("binancew3w"in window)return window.binancew3w.bitcoin;if("unisat"in window){let e=window;if(e.unisat.isBinance)return e.unisat}}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=n.inputsToSign.flatMap(({sigHash:e,address:t,signingIndexes:n})=>n.map(n=>({index:n,address:t,sighashTypes:void 0!==e?[e]:void 0})));return await this.signPsbt(e,{toSignInputs:r,autoFinalized:n.finalize})}throw new r.ab},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function y(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"bitget",name:"Bitget",type:y.type,icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiBmaWxsPSIjMDAxRjI5Ii8+CjxwYXRoIGQ9Ik0yMTkuOTQ4IDk1LjcwMjJDMjAxLjYyMyA5NS42OTI5IDE4My4zMyA5NS42ODM1IDE2NC45NDEgOTUuNzExNkMxNTMuODIyIDk1LjcxMTYgMTQ5LjY1MSAxMDkuNjcxIDE1Ny45MjEgMTE3LjkzOUwyODMuMDk4IDI0My4xMTdDMjg3LjAwNCAyNDYuNjkgMjg5LjQ0MSAyNTAuNTc0IDI4OS41MyAyNTUuNjkzQzI4OS40NDEgMjYwLjgxMiAyODcuMDA0IDI2NC42OTYgMjgzLjA5OCAyNjguMjY5TDE1Ny45MjEgMzkzLjQ0NkMxNDkuNjUxIDQwMS43MTUgMTUzLjgyMiA0MTUuNjc0IDE2NC45NDEgNDE1LjY3NEMxODMuMzMgNDE1LjcwMiAyMDEuNjIzIDQxNS42OTMgMjE5Ljk0OCA0MTUuNjgzQzIyOS4xMjIgNDE1LjY3OSAyMzguMzA1IDQxNS42NzQgMjQ3LjUxMSA0MTUuNjc0QzI1OS41NTUgNDE1LjY3NCAyNjYuNzIgNDA5LjI0IDI3My4xNTQgNDAyLjgwNUwzODYuMDQ3IDI4OS45MTJDMzk1LjA1NyAyODAuOTAyIDQwMy4xMTkgMjY4LjkzOSA0MDMuMDA5IDI1NS42OTNDNDAzLjExOSAyNDIuNDQ3IDM5NS4wNTcgMjMwLjQ4NCAzODYuMDQ3IDIyMS40NzRMMjczLjE1NCAxMDguNThDMjY2LjcyIDEwMi4xNDYgMjU5LjU1NSA5NS43MTE2IDI0Ny41MTEgOTUuNzExNkMyMzguMzA1IDk1LjcxMTYgMjI5LjEyMiA5NS43MDY5IDIxOS45NDggOTUuNzAyMloiIGZpbGw9IiMwMEYwRkYiLz4KPC9zdmc+",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"bitkeep"in window){let e=window;return e.bitkeep?.unisat}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=n.inputsToSign.flatMap(({sigHash:e,address:t,signingIndexes:n})=>n.map(n=>({index:n,address:t,sighashTypes:void 0!==e?[e]:void 0})));return await this.signPsbt(e,{toSignInputs:r,autoFinalized:n.finalize})}throw new r.ab},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await n.requestAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return await e.getAccounts()},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function m(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"OylProvider",name:"Oyl",type:m.type,icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMjAiIGhlaWdodD0iMzIwIiB2aWV3Qm94PSIwIDAgMzIwIDMyMCIgZmlsbD0ibm9uZSI+CjxyZWN0IHdpZHRoPSIzMjAiIGhlaWdodD0iMzIwIiBmaWxsPSJibGFjayIvPgo8ZyBjbGlwLXBhdGg9InVybCgjY2xpcDBfNV8yKSI+CjxwYXRoIGQ9Ik0xNjAgMjA0QzE3Ny41NTYgMjA0IDE5NC4wNzkgMjAyLjQzOSAyMDkuNTcgMTk5LjMxOEMyMjUuMDYxIDE5Ni4yNzYgMjM3LjY1MiAxOTEuNDc0IDI0Ny4zNDMgMTg0LjkxQzI1Ny4xMTQgMTc4LjM0NyAyNjIgMTcwLjEwMyAyNjIgMTYwLjE3OEMyNjIgMTUwLjI1MyAyNTcuMTE0IDE0MS44ODkgMjQ3LjM0MyAxMzUuMDg2QzIzNy41NzIgMTI4LjM2MiAyMjQuOTAyIDEyMy4zNiAyMDkuMzMyIDEyMC4wNzhDMTkzLjg0MSAxMTYuNzk2IDE3Ny4zOTcgMTE1LjE1NiAxNjAgMTE1LjE1NkMxNDIuNDQ0IDExNS4xNTYgMTI1LjkyMSAxMTYuNjc2IDExMC40MyAxMTkuNzE4Qzk0LjkzOTMgMTIyLjgzOSA4Mi4zMDg0IDEyNy42ODIgNzIuNTM3NCAxMzQuMjQ1QzYyLjg0NTggMTQwLjgwOCA1OCAxNDkuMDUyIDU4IDE1OC45NzhDNTggMTY4LjkwMyA2Mi44ODU1IDE3Ny4yMjcgNzIuNjU2NSAxODMuOTVDODIuNDI3NiAxOTAuNzUzIDk1LjA1ODQgMTk1Ljc5NiAxMTAuNTQ5IDE5OS4wNzhDMTI2LjExOSAyMDIuMzU5IDE0Mi42MDMgMjA0IDE2MCAyMDRaTTE2MC4yMzggMTMyLjIwNEMxNjguNTc5IDEzMi4yMDQgMTc2LjkyMSAxMzMuMDg0IDE4NS4yNjIgMTM0Ljg0NUMxOTMuNjgyIDEzNi42MDYgMjAwLjc1MiAxMzkuNTI4IDIwNi40NzIgMTQzLjYxQzIxMi4xOTIgMTQ3LjY5MiAyMTUuMDUxIDE1My4wMTUgMjE1LjA1MSAxNTkuNTc4QzIxNS4wNTEgMTY2LjE0MSAyMTIuMTkyIDE3MS40NjQgMjA2LjQ3MiAxNzUuNTQ2QzIwMC43NTIgMTc5LjYyOCAxOTMuNjgyIDE4Mi41NDkgMTg1LjI2MiAxODQuMzFDMTc2LjkyMSAxODYuMDcxIDE2OC41NzkgMTg2Ljk1MSAxNjAuMjM4IDE4Ni45NTFIMTU5Ljc2MkMxNTEuNDIxIDE4Ni45NTEgMTQzLjA0IDE4Ni4wNzEgMTM0LjYxOSAxODQuMzFDMTI2LjI3OCAxODIuNTQ5IDExOS4yNDggMTc5LjYyOCAxMTMuNTI4IDE3NS41NDZDMTA3LjgwOCAxNzEuNDY0IDEwNC45NDkgMTY2LjE0MSAxMDQuOTQ5IDE1OS41NzhDMTA0Ljk0OSAxNTMuMDE1IDEwNy44MDggMTQ3LjY5MiAxMTMuNTI4IDE0My42MUMxMTkuMjQ4IDEzOS41MjggMTI2LjI3OCAxMzYuNjA2IDEzNC42MTkgMTM0Ljg0NUMxNDMuMDQgMTMzLjA4NCAxNTEuNDIxIDEzMi4yMDQgMTU5Ljc2MiAxMzIuMjA0SDE2MC4yMzhaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzVfMiI+CjxyZWN0IHdpZHRoPSIyMDQiIGhlaWdodD0iODkiIGZpbGw9IndoaXRlIiB0cmFuc2Zvcm09Im1hdHJpeCgxIDAgMCAtMSA1OCAyMDQpIi8+CjwvY2xpcFBhdGg+CjwvZGVmcz4KPC9zdmc+",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"oyl"in window)return window.oyl},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,finalize:n}=t,{psbt:r}=await this.signPsbt({psbt:e,finalize:n});return r}throw new r.ab(e)},async connect(){try{let n=await this.getAccounts(),r=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:n,chainId:r}}catch(e){throw this.disconnect(),new r.vx(e.message)}},async disconnect(){let t=await this.getInternalProvider();if(!t)throw new a;t.disconnect(),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;return[(await e.getAddresses()).nativeSegwit.address]},getChainId:async()=>n,async isAuthorized(){try{let t=await this.getInternalProvider();if(!t)throw new a;return await t.isConnected()&&i&&!!await e.storage?.getItem(`${this.id}.connected`)}catch(e){return!1}},async onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t.filter(e=>"payment"===e.purpose).map(e=>e.address)})},async onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(){e.emitter.emit("disconnect")}})}function w(e={}){let t,{chainId:n,shimDisconnect:i=!0}=e;return e=>({id:"app.magiceden.bitcoin",name:"Magic Eden",type:w.type,icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIwIiBoZWlnaHQ9IjMyMCIgdmlld0JveD0iMCAwIDMyMCAzMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMjAiIGhlaWdodD0iMzIwIiBmaWxsPSIjMDcwQzM0Ii8+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF84XzIpIj4KPHBhdGggZD0iTTE5NS44MSAxMzQuNUwyMDUuOTYgMTQ2LjQzQzIwNy4xMyAxNDcuNzcgMjA4LjE1IDE0OC44NyAyMDguNTggMTQ5LjVDMjExLjYyIDE1Mi41MiAyMTMuMzIgMTU2LjU5IDIxMy4zMiAxNjAuODRDMjEzLjA0IDE2NS44NiAyMDkuNzYgMTY5LjI3IDIwNi43NSAxNzIuOTNMMTk5LjY1IDE4MS4yN0wxOTUuOTQgMTg1LjU5QzE5NS44MSAxODUuNzQgMTk1LjcyIDE4NS45MiAxOTUuNjkgMTg2LjEyQzE5NS42NiAxODYuMzIgMTk1LjY5IDE4Ni41MiAxOTUuNzggMTg2LjdDMTk1Ljg2IDE4Ni44OCAxOTYgMTg3LjAzIDE5Ni4xOCAxODcuMTRDMTk2LjM2IDE4Ny4yNSAxOTYuNTYgMTg3LjI5IDE5Ni43NiAxODcuMjhIMjMzLjhDMjM5LjQ1IDE4Ny4yOCAyNDYuNTggMTkyLjA0IDI0Ni4xNyAxOTkuMjVDMjQ2LjE3IDIwMi41MiAyNDQuODMgMjA1LjY3IDI0Mi40OCAyMDcuOTlDMjQwLjEyIDIxMC4zMSAyMzYuOTMgMjExLjYyIDIzMy42MSAyMTEuNjNIMTc1LjYxQzE3MS43OSAyMTEuNjMgMTYxLjUzIDIxMi4wNCAxNTguNjYgMjAzLjI5QzE1OC4wNSAyMDEuNDYgMTU3Ljk3IDE5OS41IDE1OC40MiAxOTcuNjJDMTU5LjI2IDE5NC44NSAxNjAuNTggMTkyLjI1IDE2Mi4zMiAxODkuOTNDMTY1LjI0IDE4NS42MSAxNjguNCAxODEuMjggMTcxLjUxIDE3Ny4wOUMxNzUuNTMgMTcxLjYgMTc5LjY1IDE2Ni4yOSAxODMuNyAxNjAuNjlDMTgzLjg0IDE2MC41MSAxODMuOTIgMTYwLjI4IDE4My45MiAxNjAuMDVDMTgzLjkyIDE1OS44MiAxODMuODQgMTU5LjU5IDE4My43IDE1OS40MUwxNjguOTYgMTQyLjEyQzE2OC44NyAxNDEuOTkgMTY4Ljc0IDE0MS45IDE2OC41OSAxNDEuODNDMTY4LjQ1IDE0MS43NiAxNjguMyAxNDEuNzIgMTY4LjEzIDE0MS43MkMxNjcuOTYgMTQxLjcyIDE2Ny44MSAxNDEuNzYgMTY3LjY3IDE0MS44M0MxNjcuNTMgMTQxLjkgMTY3LjQgMTQyLjAxIDE2Ny4zIDE0Mi4xMkMxNjMuMzUgMTQ3LjM3IDE0Ni4wNyAxNzAuNjMgMTQyLjM5IDE3NS4zNEMxMzguNzEgMTgwLjA1IDEyOS42MyAxODAuMzEgMTI0LjYgMTc1LjM0TDEwMS41NSAxNTIuNTNDMTAxLjQxIDE1Mi4zOSAxMDEuMjIgMTUyLjI4IDEwMS4wMSAxNTIuMjVDMTAwLjgxIDE1Mi4yMSAxMDAuNiAxNTIuMjMgMTAwLjQgMTUyLjMxQzEwMC4yMSAxNTIuMzkgMTAwLjA1IDE1Mi41MiA5OS45MyAxNTIuN0M5OS44MSAxNTIuODggOTkuNzUgMTUzLjA4IDk5Ljc1IDE1My4yOFYxOTcuMTJDOTkuODEgMjAwLjIzIDk4Ljg3IDIwMy4yOCA5Ny4wOCAyMDUuODVDOTUuMjkgMjA4LjQxIDkyLjcyIDIxMC4zNiA4OS43NSAyMTEuNDFDODcuODUgMjEyLjA2IDg1LjgzIDIxMi4yNiA4My44NCAyMTEuOThDODEuODUgMjExLjcgNzkuOTUgMjEwLjk2IDc4LjMyIDIwOS44MUM3Ni42OCAyMDguNjcgNzUuMzQgMjA3LjE1IDc0LjQyIDIwNS4zOUM3My41IDIwMy42MyA3My4wMSAyMDEuNjggNzMuMDEgMTk5LjdWMTIwLjg3QzczLjE0IDExOC4wMyA3NC4xOCAxMTUuMyA3NS45OCAxMTMuMDdDNzcuNzYgMTEwLjg0IDgwLjIyIDEwOS4yMyA4MyAxMDguNDdDODUuMzggMTA3Ljg1IDg3Ljg5IDEwNy44NSA5MC4yNyAxMDguNDlDOTIuNjUgMTA5LjEzIDk0LjgyIDExMC4zNyA5Ni41NSAxMTIuMTFMMTMxLjk4IDE0Ny4wN0MxMzIuMDkgMTQ3LjE4IDEzMi4yMiAxNDcuMjYgMTMyLjM2IDE0Ny4zMUMxMzIuNSAxNDcuMzYgMTMyLjY1IDE0Ny4zOCAxMzIuODEgMTQ3LjM3QzEzMi45NiAxNDcuMzYgMTMzLjEgMTQ3LjMxIDEzMy4yMyAxNDcuMjRDMTMzLjM2IDE0Ny4xNyAxMzMuNDggMTQ3LjA2IDEzMy41NiAxNDYuOTVMMTU4LjczIDExMi41OUMxNTkuOSAxMTEuMiAxNjEuMzYgMTEwLjA3IDE2My4wMSAxMDkuMjlDMTY0LjY2IDEwOC41MSAxNjYuNDYgMTA4LjEgMTY4LjMgMTA4LjA4SDIzMy43OEMyMzUuNTcgMTA4LjA4IDIzNy4zNCAxMDguNDcgMjM4Ljk3IDEwOS4yQzI0MC42IDEwOS45MyAyNDIuMDYgMTExIDI0My4yMyAxMTIuMzNDMjQ0LjQxIDExMy42NiAyNDUuMjkgMTE1LjIzIDI0NS44MSAxMTYuOTFDMjQ2LjMzIDExOC42MSAyNDYuNDcgMTIwLjM4IDI0Ni4yMyAxMjIuMTNDMjQ1Ljc3IDEyNS4xNyAyNDQuMiAxMjcuOTQgMjQxLjgyIDEyOS45MkMyMzkuNDQgMTMxLjkxIDIzNi40MiAxMzIuOTggMjMzLjMgMTMyLjk0SDE5Ni42M0MxOTYuNDQgMTMyLjk0IDE5Ni4yNiAxMzMgMTk2LjExIDEzMy4wOUMxOTUuOTYgMTMzLjE4IDE5NS44MyAxMzMuMzMgMTk1Ljc0IDEzMy40OEMxOTUuNjYgMTMzLjY0IDE5NS42MSAxMzMuODIgMTk1LjYyIDEzNEMxOTUuNjIgMTM0LjE4IDE5NS42OSAxMzQuMzUgMTk1LjggMTM0LjUxSDE5NS43OUwxOTUuODEgMTM0LjVaIiBmaWxsPSJ1cmwoI3BhaW50MF9saW5lYXJfOF8yKSIvPgo8L2c+CjxkZWZzPgo8bGluZWFyR3JhZGllbnQgaWQ9InBhaW50MF9saW5lYXJfOF8yIiB4MT0iNDQuMjIiIHkxPSI5My40MyIgeDI9IjIzOC42NCIgeTI9IjIwNS42OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPgo8c3RvcCBvZmZzZXQ9IjAuMjMiIHN0b3AtY29sb3I9IiNGRjAwNzUiLz4KPHN0b3Agb2Zmc2V0PSIwLjI3IiBzdG9wLWNvbG9yPSIjRkYwNTY5Ii8+CjxzdG9wIG9mZnNldD0iMC4zNCIgc3RvcC1jb2xvcj0iI0ZGMTM0OSIvPgo8c3RvcCBvZmZzZXQ9IjAuNDEiIHN0b3AtY29sb3I9IiNGRjIyMjgiLz4KPHN0b3Agb2Zmc2V0PSIwLjUxIiBzdG9wLWNvbG9yPSIjRkY0QTE1Ii8+CjxzdG9wIG9mZnNldD0iMC42MSIgc3RvcC1jb2xvcj0iI0ZGNkMwNSIvPgo8c3RvcCBvZmZzZXQ9IjAuNjYiIHN0b3AtY29sb3I9IiNGRjc5MDAiLz4KPHN0b3Agb2Zmc2V0PSIwLjciIHN0b3AtY29sb3I9IiNGRjg4MEMiLz4KPHN0b3Agb2Zmc2V0PSIwLjgyIiBzdG9wLWNvbG9yPSIjRkZBQzJCIi8+CjxzdG9wIG9mZnNldD0iMC45MiIgc3RvcC1jb2xvcj0iI0ZGQzIzRSIvPgo8c3RvcCBvZmZzZXQ9IjAuOTgiIHN0b3AtY29sb3I9IiNGRkNCNDUiLz4KPC9saW5lYXJHcmFkaWVudD4KPGNsaXBQYXRoIGlkPSJjbGlwMF84XzIiPgo8cmVjdCB3aWR0aD0iMTczLjM1IiBoZWlnaHQ9IjEwNC4xMSIgZmlsbD0id2hpdGUiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDczIDEwOCkiLz4KPC9jbGlwUGF0aD4KPC9kZWZzPgo8L3N2Zz4K",async setup(){},async getInternalProvider(){if("undefined"!=typeof window&&"magicEden"in window){let e=window;if(e?.magicEden?.bitcoin?.isMagicEden)return e.magicEden.bitcoin}},async getProvider(){let e=await this.getInternalProvider();if(e)return{request:this.request.bind(e)}},async request({method:e,params:t}){if("signPsbt"===e){let{psbt:e,...n}=t,r=I({network:{type:"Mainnet"},psbtBase64:(0,o.OG)(e),inputsToSign:n.inputsToSign}),i=await this.signTransaction(r);return(0,o.Qf)(i.psbtBase64)}throw new r.ab},async connect(){let n=await this.getInternalProvider();if(!n)throw new a;try{let r=await this.getAccounts(),a=await this.getChainId();return t||(t=this.onAccountsChanged.bind(this),n.addListener("accountsChanged",t)),i&&await Promise.all([e.storage?.setItem(`${this.id}.connected`,!0),e.storage?.removeItem(`${this.id}.disconnected`)]),{accounts:r,chainId:a}}catch(e){throw new r.vx(e.message)}},async disconnect(){let n=await this.getInternalProvider();t&&(n?.removeListener("accountsChanged",t),t=void 0),i&&await Promise.all([e.storage?.setItem(`${this.id}.disconnected`,!0),e.storage?.removeItem(`${this.id}.connected`)])},async getAccounts(){let e=await this.getInternalProvider();if(!e)throw new a;let t=I({purposes:["payment"]}),{addresses:n}=await e.connect(t);return n.filter(e=>"payment"===e.purpose).map(e=>e.address)},getChainId:async()=>n,async isAuthorized(){try{if(i&&await e.storage?.getItem(`${this.id}.disconnected`))return!1;return!!(await (0,c.b)(()=>this.getAccounts())).length}catch{return!1}},async onAccountsChanged(t){if(0===t.length)this.onDisconnect();else{let n=t.filter(e=>"payment"===e.purpose).map(e=>e.address);e.emitter.emit("change",{accounts:n})}},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect")}})}function I(e){var t=e;let n=(0,o.lu)(JSON.stringify({typ:"JWT",alg:"none"})),r=(0,o.lu)(JSON.stringify(t));return`${n}.${r}.`}l.type="UTXO",d.type="UTXO",h.type="UTXO",f.type="UTXO",p.type="UTXO",g.type="UTXO",y.type="UTXO",m.type="UTXO",w.type="UTXO";var M=n(26450),E=n(36824),v=n(71106),b=n(64546),T=n(97585),N=n(90192),A=n(64393);class S{constructor(e){this.uid=e,this._emitter=new A.b}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}emit(e,...t){let n=t[0];this._emitter.emit(e,{uid:this.uid,...n})}listenerCount(e){return this._emitter.listenerCount(e)}}function C(e,t){return JSON.parse(e,(e,n)=>{let r=n;return r?.__type==="bigint"&&(r=BigInt(r.value)),r?.__type==="Map"&&(r=new Map(r.value)),t?.(e,r)??r})}function D(e,t){return e.slice(0,t).join(".")||"."}function x(e,t){let{length:n}=e;for(let r=0;r<n;++r)if(e[r]===t)return r+1;return 0}function k(e,t,n,r){return JSON.stringify(e,function(e,t){let n="function"==typeof e,r="function"==typeof t,i=[],a=[];return function(s,o){if("object"==typeof o)if(i.length){let e=x(i,this);0===e?i[i.length]=this:(i.splice(e),a.splice(e)),a[a.length]=s;let n=x(i,o);if(0!==n)return r?t.call(this,s,o,D(a,n)):`[ref=${D(a,n)}]`}else i[0]=o,a[0]=s;return n?e.call(this,s,o):o}}((e,n)=>{let r=n;return"bigint"==typeof r&&(r={__type:"bigint",value:n.toString()}),r instanceof Map&&(r={__type:"Map",value:Array.from(n.entries())}),t?.(e,r)??r},r),n??void 0)}let O={getItem:()=>null,setItem:()=>{},removeItem:()=>{}},j={formatters:void 0,fees:void 0,serializers:void 0,id:0x12309ce54001,name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://node-router.thorswap.net/bitcoin"]}},blockExplorers:{default:{name:"Mempool",url:"https://mempool.space/"}}};var L=n(2479);class P extends i.C{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{name:"UrlRequiredError"})}}i.C;var _=n(16951);let U=new Map;var z=n(70341);let R=["getBalance","getTransactions","getUTXOs"];var B=n(10492);function H(e={bigmiConfig:{multiInjectedProviderDiscovery:!1}}){let t=[s({chainId:B.n.BTC}),u({chainId:B.n.BTC}),l({chainId:B.n.BTC}),d({chainId:B.n.BTC}),h({chainId:B.n.BTC}),f({chainId:B.n.BTC}),p({chainId:B.n.BTC}),g({chainId:B.n.BTC}),y({chainId:B.n.BTC}),m({chainId:B.n.BTC}),w({chainId:B.n.BTC}),...e?.connectors??[]];return{config:function(e){let t,{multiInjectedProviderDiscovery:n=!0,storage:r=function(e){let{deserialize:t=C,key:n="bigmi",serialize:r=k,storage:i=O}=e;function a(e){return e instanceof Promise?e.then(e=>e).catch(()=>null):e}return{...i,key:n,async getItem(e,r){let s=i.getItem(`${n}.${e}`),o=await a(s);return o?t(o)??null:r??null},async setItem(e,t){let s=`${n}.${e}`;null===t?await a(i.removeItem(s)):await a(i.setItem(s,r(t)))},async removeItem(e){await a(i.removeItem(`${n}.${e}`))}}}({key:"bigmi",storage:function(){let e="undefined"!=typeof window&&window.localStorage?window.localStorage:O;return{getItem:t=>e.getItem(t),removeItem(t){e.removeItem(t)},setItem(t,n){try{e.setItem(t,n)}catch{}}}}()}),syncConnectedChain:i=!0,ssr:a=!1,...s}=e,o=(0,N.y)(()=>s.chains),u=(0,N.y)(()=>{let e=[],t=new Set;for(let n of s.connectors??[]){let r=c(n);if(e.push(r),!a&&r.rdns)for(let e of"string"==typeof r.rdns?[r.rdns]:r.rdns)t.add(e)}return e});function c(e){let t=new S((0,M.L)()),n={...e({emitter:t,chains:o.getState(),storage:r,transports:s.transports}),emitter:t,uid:t.uid};return t.on("connect",y),n.setup?.(),n}let l=new Map;function d(){return{chainId:o.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let h="0.0.0-canary-";t=b.r.startsWith(h)?Number.parseInt(b.r.replace(h,"")):Number.parseInt(b.r.split(".")[0]??"0");let f=(0,N.y)((0,T.eh)(r?(0,T.Zr)(d,{migrate(e,n){if(n===t)return e;let r=d(),i=p(e,r.chainId);return{...r,chainId:i}},name:"store",partialize:e=>({connections:{__type:"Map",value:Array.from(e.connections.entries()).map(([e,t])=>{let{id:n,name:r,type:i,uid:a}=t.connector;return[e,{...t,connector:{id:n,name:r,type:i,uid:a}}]})},chainId:e.chainId,current:e.current}),merge(e,t){"object"==typeof e&&e&&"status"in e&&(e.status=void 0);let n=p(e,t.chainId);return{...t,...e,chainId:n}},skipHydration:a,storage:r,version:t}):d));function p(e,t){return e&&"object"==typeof e&&"chainId"in e&&"number"==typeof e.chainId&&o.getState().some(t=>t.id===e.chainId)?e.chainId:t}function g(e){f.setState(t=>{let n=t.connections.get(e.uid);return n?{...t,connections:new Map(t.connections).set(e.uid,{accounts:e.accounts??n.accounts,chainId:e.chainId??n.chainId,connector:n.connector})}:t})}function y(e){"connecting"!==f.getState().status&&"reconnecting"!==f.getState().status&&f.setState(t=>{let n=u.getState().find(t=>t.uid===e.uid);return n?(n.emitter.listenerCount("connect")&&n.emitter.off("connect",g),n.emitter.listenerCount("change")||n.emitter.on("change",g),n.emitter.listenerCount("disconnect")||n.emitter.on("disconnect",m),{...t,connections:new Map(t.connections).set(e.uid,{accounts:e.accounts,chainId:e.chainId,connector:n}),current:e.uid,status:"connected"}):t})}function m(e){f.setState(t=>{let n=t.connections.get(e.uid);if(n){let e=n.connector;e.emitter.listenerCount("change")&&n.connector.emitter.off("change",g),e.emitter.listenerCount("disconnect")&&n.connector.emitter.off("disconnect",m),e.emitter.listenerCount("connect")||n.connector.emitter.on("connect",y)}if(t.connections.delete(e.uid),0===t.connections.size)return{...t,connections:new Map,current:null,status:"disconnected"};let r=t.connections.values().next().value;return{...t,connections:new Map(t.connections),current:r.connector.uid}})}return f.setState(d()),i&&f.subscribe(({connections:e,current:t})=>t?e.get(t)?.chainId:void 0,e=>{if(o.getState().some(t=>t.id===e))return f.setState(t=>({...t,chainId:e??t.chainId}))}),{get chains(){return o.getState()},get connectors(){return u.getState()},storage:r,getClient:function(e={}){let t,n=e.chainId??f.getState().chainId,r=o.getState().find(e=>e.id===n);if(e.chainId&&!r)throw new E.nk;{let e=l.get(f.getState().chainId);if(e&&!r)return e;if(!r)throw new E.nk}{let e=l.get(n);if(e)return e}if(s.client)t=s.client({chain:r});else{let e=r.id,n=o.getState().map(e=>e.id),i={};for(let[t,r]of Object.entries(s))if("chains"!==t&&"client"!==t&&"connectors"!==t&&"transports"!==t)if("object"==typeof r)if(e in r)i[t]=r[e];else{if(n.some(e=>e in r))continue;i[t]=r}else i[t]=r;t=(0,v.U)({...i,chain:r,transport:t=>s.transports[e]({...t,connectors:u})})}return l.set(n,t),t},get state(){return f.getState()},setState(e){let t;t="function"==typeof e?e(f.getState()):e;let n=d();"object"!=typeof t&&(t=n),Object.keys(n).some(e=>!(e in t))&&(t=n),f.setState(t,!0)},subscribe:(e,t,n)=>f.subscribe(e,t,n?{...n,fireImmediately:n.emitImmediately}:void 0),_internal:{store:f,ssr:!!a,syncConnectedChain:i,transports:s.transports,chains:{setState(e){let t="function"==typeof e?e(o.getState()):e;if(0!==t.length)return o.setState(t,!0)},subscribe:e=>o.subscribe(e)},connectors:{setup:c,setState:e=>u.setState("function"==typeof e?e(u.getState()):e,!0),subscribe:e=>u.subscribe(e)},events:{change:g,connect:y,disconnect:m}}}}({chains:[j],connectors:t,client:({chain:e})=>(0,v.U)({chain:e,transport:function(e,t={}){let{batch:n,fetchOptions:r,key:i="http",methods:a={exclude:R},name:s="HTTP JSON-RPC",onFetchRequest:o,onFetchResponse:u,retryDelay:c,raw:l}=t;return({chain:e,retryCount:d,timeout:h})=>{let{batchSize:f=1e3,wait:p=0}="object"==typeof n?n:{},g=t.retryCount??d,y=h??t.timeout??1e4,m=e?.rpcUrls.default.http[0];if(!m)throw new P;let w=function(e,t={}){return{async request(n){let{body:r,onRequest:i=t.onRequest,onResponse:a=t.onResponse,timeout:s=t.timeout??1e4}=n,o={...t.fetchOptions??{},...n.fetchOptions??{}},{headers:u,method:c,signal:l}=o;try{let t,d=await function(e,{errorInstance:t=Error("timed out"),timeout:n,signal:r}){return new Promise((i,a)=>{(async()=>{let s;try{let o=new AbortController;n>0&&(s=setTimeout(()=>{r?o.abort():a(t)},n)),i(await e({signal:o?.signal||null}))}catch(e){e?.name==="AbortError"&&a(t),a(e)}finally{clearTimeout(s)}})()})}(async({signal:t})=>{let a={...o,body:r?(0,z.A)(r):void 0,headers:{..."GET"!==c?{"Content-Type":"application/json"}:void 0,...u},method:c||"POST",signal:l||(s>0?t:null)},d=new Request(n.url??e,a);return i&&await i(d,a),await fetch(n.url??e,a)},{errorInstance:new L.MU({body:r??{},url:e}),timeout:s,signal:!0});if(a&&await a(d),d.headers.get("Content-Type")?.startsWith("application/json")?t=await d.json():(t=await d.text(),t=JSON.parse(t||"{}")),!d.ok)throw new L.Ci({body:r,details:(0,z.A)(t.error)||d.statusText,headers:d.headers,status:d.status,url:e});return t}catch(t){if(t instanceof L.Ci||t instanceof L.MU)throw t;throw new L.Ci({body:r,cause:t,url:e})}}}}(m,{fetchOptions:r,onRequest:o,onResponse:u,timeout:y});return(0,_.o)({key:i,methods:a,name:s,async request({method:e,params:t}){let r={method:e,params:t},{schedule:i}=function({fn:e,id:t,shouldSplitBatch:n,wait:r=0,sort:i}){let a=async()=>{let t=u();s();let n=t.map(({args:e})=>e);0!==n.length&&e(n).then(e=>{i&&Array.isArray(e)&&e.sort(i);for(let n=0;n<t.length;n++){let{resolve:r}=t[n];r?.([e[n],e])}}).catch(e=>{for(let n=0;n<t.length;n++){let{reject:r}=t[n];r?.(e)}})},s=()=>U.delete(t),o=()=>u().map(({args:e})=>e),u=()=>U.get(t)||[],c=e=>U.set(t,[...u(),e]);return{flush:s,async schedule(e){let t,i,{promise:s,resolve:l,reject:d}=(t=()=>void 0,i=()=>void 0,{promise:new Promise((e,n)=>{t=e,i=n}),resolve:t,reject:i});return(n?.([...o(),e])&&a(),u().length>0)?c({args:e,resolve:l,reject:d}):(c({args:e,resolve:l,reject:d}),setTimeout(a,r)),s}}}({id:m,wait:p,shouldSplitBatch:e=>e.length>f,fn:e=>w.request({body:e}),sort:(e,t)=>e.id-t.id}),a=async e=>n?i(e):[await w.request({body:e})],[{error:s,result:o}]=await a(r);if(l)return{error:s,result:o};if(s)throw new L.J8({body:r,error:s,url:m});return o},retryCount:g,retryDelay:c,timeout:y,type:"http"},{fetchOptions:r,url:m})}}()}),...e?.bigmiConfig}),connectors:t}}},12322:e=>{e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},13575:(e,t)=>{t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};let n={N1:3,N2:3,N3:40,N4:10};t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){let t=e.size,r=0,i=0,a=0,s=null,o=null;for(let u=0;u<t;u++){i=a=0,s=o=null;for(let c=0;c<t;c++){let t=e.get(u,c);t===s?i++:(i>=5&&(r+=n.N1+(i-5)),s=t,i=1),(t=e.get(c,u))===o?a++:(a>=5&&(r+=n.N1+(a-5)),o=t,a=1)}i>=5&&(r+=n.N1+(i-5)),a>=5&&(r+=n.N1+(a-5))}return r},t.getPenaltyN2=function(e){let t=e.size,r=0;for(let n=0;n<t-1;n++)for(let i=0;i<t-1;i++){let t=e.get(n,i)+e.get(n,i+1)+e.get(n+1,i)+e.get(n+1,i+1);(4===t||0===t)&&r++}return r*n.N2},t.getPenaltyN3=function(e){let t=e.size,r=0,i=0,a=0;for(let n=0;n<t;n++){i=a=0;for(let s=0;s<t;s++)i=i<<1&2047|e.get(n,s),s>=10&&(1488===i||93===i)&&r++,a=a<<1&2047|e.get(s,n),s>=10&&(1488===a||93===a)&&r++}return r*n.N3},t.getPenaltyN4=function(e){let t=0,r=e.data.length;for(let n=0;n<r;n++)t+=e.data[n];return Math.abs(Math.ceil(100*t/r/5)-10)*n.N4},t.applyMask=function(e,n){let r=n.size;for(let i=0;i<r;i++)for(let a=0;a<r;a++)n.isReserved(a,i)||n.xor(a,i,function(e,n,r){switch(e){case t.Patterns.PATTERN000:return(n+r)%2==0;case t.Patterns.PATTERN001:return n%2==0;case t.Patterns.PATTERN010:return r%3==0;case t.Patterns.PATTERN011:return(n+r)%3==0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case t.Patterns.PATTERN101:return n*r%2+n*r%3==0;case t.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case t.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,a,i))},t.getBestMask=function(e,n){let r=Object.keys(t.Patterns).length,i=0,a=1/0;for(let s=0;s<r;s++){n(s),t.applyMask(s,e);let r=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(s,e),r<a&&(a=r,i=s)}return i}},14654:(e,t,n)=>{"use strict";n.d(t,{R:()=>a});var r=n(71245),i=n(56151);let a=e=>{(0,i.useEffect)(()=>{(0,r.M)(e)},[e])}},16591:(e,t,n)=>{"use strict";n.d(t,{Ce:()=>s,Ok:()=>r,qG:()=>o});var r,i=n(64393),a=n(38582);!function(e){e.Installed="Installed",e.NotDetected="NotDetected",e.Loadable="Loadable",e.Unsupported="Unsupported"}(r||(r={}));class s extends i.A{get connected(){return!!this.publicKey}async autoConnect(){await this.connect()}async prepareTransaction(e,t,n={}){let r=this.publicKey;if(!r)throw new a.kW;return e.feePayer=e.feePayer||r,e.recentBlockhash=e.recentBlockhash||(await t.getLatestBlockhash({commitment:n.preflightCommitment,minContextSlot:n.minContextSlot})).blockhash,e}}function o(e){if("undefined"==typeof window||"undefined"==typeof document)return;let t=[];function n(){if(e())for(let e of t)e()}let r=setInterval(n,1e3);t.push(()=>clearInterval(r)),"loading"===document.readyState&&(document.addEventListener("DOMContentLoaded",n,{once:!0}),t.push(()=>document.removeEventListener("DOMContentLoaded",n))),"complete"!==document.readyState&&(window.addEventListener("load",n,{once:!0}),t.push(()=>window.removeEventListener("load",n))),n()}},16784:e=>{function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){let t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(let n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},16951:(e,t,n)=>{"use strict";n.d(t,{o:()=>h});var r=n(30503),i=n(2479),a=n(22841),s=n(74160),o=n(70341);class u extends Map{constructor(e){super(),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let c=new u(8192);var l=n(33701),d=n(26450);function h({key:e,methods:t,name:n,request:u,retryCount:h=3,retryDelay:f=150,timeout:p,type:g},y){return{config:{key:e,methods:t,name:n,request:u,retryCount:h,retryDelay:f,timeout:p,type:g},request:function(e,t={}){return async(n,u={})=>{let{dedupe:d=!1,methods:h,retryDelay:f=150,retryCount:p=3,uid:g}={...t,...u},{method:y}=n;if(h?.exclude?.includes(y)||h?.include&&!h.include.includes(y))throw new a.ab(y);let m=d?(0,s.i3)(`${g}.${(0,o.A)(n)}`):void 0;return function(e,{enabled:t=!0,id:n}){if(!t||!n)return e();if(c.get(n))return c.get(n);let r=e().finally(()=>c.delete(n));return c.set(n,r),r}(()=>(0,l.b)(async()=>{try{return await e(n)}catch(e){switch(e.code){case a.dF.METHOD_NOT_SUPPORTED:throw new a.ab(y);case a.dF.USER_REJECTION:case 5e3:throw new a.vx(e.message);default:if(e instanceof r.C)throw e;throw new r.C("Unknown Error",{cause:e})}}},{delay:({count:e,error:t})=>{if(t&&t instanceof i.Ci){let e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e)}return~~(1<<e)*f},retryCount:p,shouldRetry:({error:e})=>{var t;return"code"in(t=e)&&"number"==typeof t.code?-1===t.code||t.code===a.dF.INTERNAL_ERROR:!(t instanceof i.Ci)||!t.status||403===t.status||408===t.status||413===t.status||429===t.status||500===t.status||502===t.status||503===t.status||504===t.status||!1}}),{enabled:d,id:m})}}(u,{methods:t,retryCount:h,retryDelay:f,uid:(0,d.L)()}),value:y}}},22e3:(e,t,n)=>{"use strict";n.d(t,{t:()=>i});var r=n(4377);async function i(e){return e.account?.type==="local"?[e.account.address]:(await e.request({method:"eth_accounts"},{dedupe:!0})).map(e=>(0,r.o)(e))}},22544:e=>{"use strict";var t={single_source_shortest_paths:function(e,n,r){var i,a,s,o,u,c,l,d={},h={};h[n]=0;var f=t.PriorityQueue.make();for(f.push(n,0);!f.empty();)for(s in a=(i=f.pop()).value,o=i.cost,u=e[a]||{})u.hasOwnProperty(s)&&(c=o+u[s],l=h[s],(void 0===h[s]||l>c)&&(h[s]=c,f.push(s,c),d[s]=a));if(void 0!==r&&void 0===h[r])throw Error(["Could not find a path from ",n," to ",r,"."].join(""));return d},extract_shortest_path_from_predecessor_list:function(e,t){for(var n=[],r=t;r;)n.push(r),e[r],r=e[r];return n.reverse(),n},find_path:function(e,n,r){var i=t.single_source_shortest_paths(e,n,r);return t.extract_shortest_path_from_predecessor_list(i,r)},PriorityQueue:{make:function(e){var n,r=t.PriorityQueue,i={};for(n in e=e||{},r)r.hasOwnProperty(n)&&(i[n]=r[n]);return i.queue=[],i.sorter=e.sorter||r.default_sorter,i},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},22841:(e,t,n)=>{"use strict";n.d(t,{ab:()=>s,dF:()=>r,vx:()=>a});var r,i=n(30503);!function(e){e[e.PARSE_ERROR=-32700]="PARSE_ERROR",e[e.INVALID_REQUEST=-32600]="INVALID_REQUEST",e[e.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",e[e.INVALID_PARAMS=-32602]="INVALID_PARAMS",e[e.INTERNAL_ERROR=-32603]="INTERNAL_ERROR",e[e.USER_REJECTION=-32e3]="USER_REJECTION",e[e.METHOD_NOT_SUPPORTED=-32001]="METHOD_NOT_SUPPORTED",e[e.ACCESS_DENIED=-32002]="ACCESS_DENIED"}(r||(r={}));class a extends i.C{constructor(e){let t="UserRejectedRequestError";super(`${t}:  ${e||"The user rejected your request, please try again"}`,{name:t}),this.code=r.USER_REJECTION}}class s extends i.C{constructor(e){let t="MethodNotSupportedError";super(`${t}: The method ${e} you are calling is not supported`,{name:t}),this.code=r.METHOD_NOT_SUPPORTED}}i.C},23066:(e,t)=>{t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,n){if(t.isValid(e))return e;try{if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw Error("Unknown EC Level: "+e)}}catch(e){return n}}},23502:(e,t,n)=>{"use strict";let r;n.d(t,{X:()=>a2});var i,a,s,o,u,c,l,d,h,f,p={};n.r(p),n.d(p,{decode:()=>e0,encode:()=>e1});var g={};n.r(g),n.d(g,{canAddToArray:()=>nf,check:()=>nh,decode:()=>nc,encode:()=>nl,expected:()=>nd});var y={};n.r(y),n.d(y,{encode:()=>np});var m={};n.r(m),n.d(m,{canAdd:()=>nI,check:()=>nw,decode:()=>ng,encode:()=>ny,expected:()=>nm});var w={};n.r(w),n.d(w,{canAdd:()=>nT,check:()=>nb,decode:()=>nM,encode:()=>nE,expected:()=>nv});var I={};n.r(I),n.d(I,{canAdd:()=>nD,check:()=>nC,decode:()=>nN,encode:()=>nA,expected:()=>nS});var M={};n.r(M),n.d(M,{canAddToArray:()=>nL,check:()=>nj,decode:()=>nx,encode:()=>nk,expected:()=>nO});var E={};n.r(E),n.d(E,{canAdd:()=>nR,check:()=>nz,decode:()=>nP,encode:()=>n_,expected:()=>nU});var v={};n.r(v),n.d(v,{canAdd:()=>nY,check:()=>nG,decode:()=>nB,encode:()=>nH,expected:()=>nW});var b={};n.r(b),n.d(b,{canAdd:()=>n$,check:()=>nV,decode:()=>nQ,encode:()=>nF,expected:()=>nK});var T={};n.r(T),n.d(T,{canAddToArray:()=>n0,check:()=>nJ,decode:()=>nq,encode:()=>nZ,expected:()=>nX});var N={};n.r(N),n.d(N,{canAdd:()=>n5,check:()=>n3,decode:()=>n1,encode:()=>n2,expected:()=>n4});var A={};n.r(A),n.d(A,{canAddToArray:()=>re,check:()=>n7,decode:()=>n8,encode:()=>n6,expected:()=>n9});var S={};n.r(S),n.d(S,{canAdd:()=>ra,check:()=>ri,decode:()=>rt,encode:()=>rn,expected:()=>rr});var C={};n.r(C),n.d(C,{canAdd:()=>rl,check:()=>rc,decode:()=>rs,encode:()=>ro,expected:()=>ru});var D={};n.r(D),n.d(D,{globals:()=>rM,inputs:()=>rE,outputs:()=>rv});var x=n(33500),k=n(41541),O=n(89745);!function(e){e.Mainnet="mainnet",e.Testnet="testnet",e.Regtest="regtest"}(i||(i={})),function(e){e.p2pkh="p2pkh",e.p2sh="p2sh",e.p2wpkh="p2wpkh",e.p2wsh="p2wsh",e.p2tr="p2tr"}(a||(a={}));let j={0:{type:a.p2pkh,network:i.Mainnet},111:{type:a.p2pkh,network:i.Testnet},5:{type:a.p2sh,network:i.Mainnet},196:{type:a.p2sh,network:i.Testnet}},L=e=>{let t,n;try{t=e.startsWith("bc1p")||e.startsWith("tb1p")||e.startsWith("bcrt1p")?k.p2.decode(e):k.I.decode(e)}catch(e){throw Error("Invalid address")}let r={bc:i.Mainnet,tb:i.Testnet,bcrt:i.Regtest}[t.prefix];if(void 0===r)throw Error("Invalid address");let s=t.words[0];if(s<0||s>16)throw Error("Invalid address");return{bech32:!0,network:r,address:e,type:20===k.I.fromWords(t.words.slice(1)).length?a.p2wpkh:1===s?a.p2tr:a.p2wsh}},P=e=>{let t,n=e.substring(0,2).toLowerCase();if("bc"===n||"tb"===n)return L(e);try{t=O.A.decode(e)}catch(e){throw Error("Invalid address")}let{length:r}=t;if(25!==r)throw Error("Invalid address");let i=t[0],a=t.slice(r-4,r),s=t.slice(0,r-4),o=(0,x.sc)((0,x.sc)(s)).slice(0,4);if(a.some((e,t)=>e!==o[t])||!Object.keys(j).map(Number).includes(i))throw Error("Invalid address");return{...j[i],address:e,bech32:!1}},_=(e,t)=>{try{let n=P(e);if(t)return t===n.network;return!0}catch(e){return!1}};var U=n(17058);async function z(e,t){return await e.request({method:"signPsbt",params:t},{dedupe:!0})}let R={messagePrefix:"\x18Bitcoin Signed Message:\n",bech32:"bc",bip32:{public:0x488b21e,private:0x488ade4},pubKeyHash:0,scriptHash:5,wif:128},B={OP_FALSE:0,OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_TRUE:81,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_NOP2:177,OP_CHECKLOCKTIMEVERIFY:177,OP_NOP3:178,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_CHECKSIGADD:186,OP_PUBKEYHASH:253,OP_PUBKEY:254,OP_INVALIDOPCODE:255},H={};for(let e of Object.keys(B))H[B[e]]=e;let W="0123456789abcdefABCDEF",G=W.split("").map(e=>e.codePointAt(0)),Y=Array(256).fill(!0).map((e,t)=>{let n=String.fromCodePoint(t),r=W.indexOf(n);return r<0?void 0:r<16?r:r-6}),Q=new TextEncoder,F=new TextDecoder;function K(e){let t=new Uint8Array(e.reduce((e,t)=>e+t.length,0)),n=0;for(let r of e)t.set(r,n),n+=r.length;return t}function V(e){let t=e||new Uint8Array;return t.length>512?function(e){let t=new Uint8Array(2*e.length);for(let n=0;n<e.length;++n)t[2*n]=G[e[n]>>4],t[2*n+1]=G[15&e[n]];return F.decode(t)}(t):function(e){let t="";for(let n=0;n<e.length;++n)t+=W[Y[G[e[n]>>4]]],t+=W[Y[G[15&e[n]]]];return t}(t)}function $(e){let t,n=Q.encode(e||""),r=new Uint8Array(Math.floor(n.length/2));for(t=0;t<r.length;t++){let e=Y[n[2*t]],i=Y[n[2*t+1]];if(void 0===e||void 0===i)break;r[t]=e<<4|i}return t===r.length?r:r.slice(0,t)}function q(e){let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);return n}function Z(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;++r)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return e.length===t.length?0:e.length>t.length?1:-1}function X(e,t,n){if(t+1>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(n>255)throw Error(`The value of "value" is out of range. It must be >= 0 and <= 255. Received ${n}`);return e[t]=n,t+1}function J(e,t,n,r){if(t+4>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>0xffffffff)throw Error(`The value of "value" is out of range. It must be >= 0 and <= 4294967295. Received ${n}`);return"LE"===r?(e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n),t+4}function ee(e,t){if(t+1>e.length)throw Error("Offset is outside the bounds of Uint8Array");return e[t]}function et(e,t,n){if(t+4>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=0;return(((0+e[t+3]>>>0<<8)+e[t+2]>>>0<<8)+e[t+1]>>>0<<8)+e[t]>>>0}{let n=0;return(((0+e[t]>>>0<<8)+e[t+1]>>>0<<8)+e[t+2]>>>0<<8)+e[t+3]>>>0}}function en(e,t,n,r){if(t+4>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(n>0x7fffffff||n<-0x80000000)throw Error(`The value of "value" is out of range. It must be >= -2147483648 and <= 2147483647. Received ${n}`);return"LE"===(r=r.toUpperCase())?(e[t]=255&n,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255):(e[t]=n>>24&255,e[t+1]=n>>16&255,e[t+2]=n>>8&255,e[t+3]=255&n),t+4}function er(e,t,n,r){if(t+8>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(n>0x7fffffffffffffffn||n<-0x8000000000000000n)throw Error(`The value of "value" is out of range. It must be >= ${-0x8000000000000000n} and <= ${0x7fffffffffffffffn}. Received ${n}`);return"LE"===(r=r.toUpperCase())?(e[t]=Number(255n&n),e[t+1]=Number(n>>8n&255n),e[t+2]=Number(n>>16n&255n),e[t+3]=Number(n>>24n&255n),e[t+4]=Number(n>>32n&255n),e[t+5]=Number(n>>40n&255n),e[t+6]=Number(n>>48n&255n),e[t+7]=Number(n>>56n&255n)):(e[t]=Number(n>>56n&255n),e[t+1]=Number(n>>48n&255n),e[t+2]=Number(n>>40n&255n),e[t+3]=Number(n>>32n&255n),e[t+4]=Number(n>>24n&255n),e[t+5]=Number(n>>16n&255n),e[t+6]=Number(n>>8n&255n),e[t+7]=Number(255n&n)),t+8}function ei(e,t,n){if(t+8>e.length)throw Error("Offset is outside the bounds of Uint8Array");n=n.toUpperCase();let r=0n;if("LE"===n)return r=((r=((r=((r=((r=((r=((r=((r=(r<<8n)+BigInt(e[t+7]))<<8n)+BigInt(e[t+6]))<<8n)+BigInt(e[t+5]))<<8n)+BigInt(e[t+4]))<<8n)+BigInt(e[t+3]))<<8n)+BigInt(e[t+2]))<<8n)+BigInt(e[t+1]))<<8n)+BigInt(e[t]),e[t+7]<=127?r:r-0x10000000000000000n;{let n=0n;return n=((n=((n=((n=((n=((n=((n=((n=(n<<8n)+BigInt(e[t]))<<8n)+BigInt(e[t+1]))<<8n)+BigInt(e[t+2]))<<8n)+BigInt(e[t+3]))<<8n)+BigInt(e[t+4]))<<8n)+BigInt(e[t+5]))<<8n)+BigInt(e[t+6]))<<8n)+BigInt(e[t+7]),e[t]<=127?n:n-0x10000000000000000n}}function ea(e){return e<B.OP_PUSHDATA1?1:e<=255?2:e<=65535?3:5}function es(e){return{lang:e?.lang??s?.lang,message:e?.message,abortEarly:e?.abortEarly??s?.abortEarly,abortPipeEarly:e?.abortPipeEarly??s?.abortPipeEarly}}function eo(e){let t=typeof e;return"string"===t?`"${e}"`:"number"===t||"bigint"===t||"boolean"===t?`${e}`:"object"===t||"function"===t?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":t}function eu(e,t,n,r,i){var a,s,l,d;let h=i&&"input"in i?i.input:n.value,f=i?.expected??e.expects??null,p=i?.received??eo(h),g={kind:e.kind,type:e.type,input:h,expected:f,received:p,message:`Invalid ${t}: ${f?`Expected ${f} but r`:"R"}eceived ${p}`,requirement:e.requirement,path:i?.path,issues:i?.issues,lang:r.lang,abortEarly:r.abortEarly,abortPipeEarly:r.abortPipeEarly},y="schema"===e.kind,m=i?.message??e.message??(a=e.reference,s=g.lang,c?.get(a)?.get(s))??(y?(l=g.lang,u?.get(l)):null)??r.message??(d=g.lang,o?.get(d));m&&(g.message="function"==typeof m?m(g):m),y&&(n.typed=!1),n.issues?n.issues.push(g):n.issues=[g]}var ec=/\D/gu,el=class extends Error{issues;constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}};function ed(e){return{kind:"validation",type:"integer",reference:ed,async:!1,expects:null,requirement:Number.isInteger,message:e,_run(e,t){return e.typed&&!this.requirement(e.value)&&eu(this,"integer",e,t),e}}}function eh(e,t){return{kind:"validation",type:"max_value",reference:eh,async:!1,expects:`<=${e instanceof Date?e.toJSON():eo(e)}`,requirement:e,message:t,_run(e,t){return e.typed&&e.value>this.requirement&&eu(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():eo(e.value)}),e}}}function ef(e,t){return{kind:"validation",type:"min_value",reference:ef,async:!1,expects:`>=${e instanceof Date?e.toJSON():eo(e)}`,requirement:e,message:t,_run(e,t){return e.typed&&e.value<this.requirement&&eu(this,"value",e,t,{received:e.value instanceof Date?e.value.toJSON():eo(e.value)}),e}}}function ep(e,t,n){return"function"==typeof e.fallback?e.fallback(t,n):e.fallback}function eg(e,t,n){return"function"==typeof e.default?e.default(t,n):e.default}function ey(e){if("entries"in e){let t={};for(let n in e.entries)t[n]=ey(e.entries[n]);return t}return"items"in e?e.items.map(ey):eg(e)}async function em(e){return"entries"in e?Object.fromEntries(await Promise.all(Object.entries(e.entries).map(async([e,t])=>[e,await em(t)]))):"items"in e?Promise.all(e.items.map(em)):eg(e)}function ew(e){if("entries"in e){let t={};for(let n in e.entries)t[n]=ew(e.entries[n]);return t}return"items"in e?e.items.map(ew):ep(e)}async function eI(e){return"entries"in e?Object.fromEntries(await Promise.all(Object.entries(e.entries).map(async([e,t])=>[e,await eI(t)]))):"items"in e?Promise.all(e.items.map(eI)):ep(e)}function eM(e,t){return!e._run({typed:!1,value:t},{abortEarly:!0}).issues}function eE(e,t){return{kind:"schema",type:"array",reference:eE,expects:"Array",async:!1,item:e,message:t,_run(e,t){let n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(let r=0;r<n.length;r++){let i=n[r],a=this.item._run({typed:!1,value:i},t);if(a.issues){let s={type:"array",origin:"value",input:n,key:r,value:i};for(let t of a.issues)t.path?t.path.unshift(s):t.path=[s],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),e.value.push(a.value)}}else eu(this,"type",e,t);return e}}}function ev(e,t){return{kind:"schema",type:"custom",reference:ev,expects:"unknown",async:!1,check:e,message:t,_run(e,t){return this.check(e.value)?e.typed=!0:eu(this,"type",e,t),e}}}function eb(e,t){return{kind:"schema",type:"instance",reference:eb,expects:e.name,async:!1,class:e,message:t,_run(e,t){return e.value instanceof this.class?e.typed=!0:eu(this,"type",e,t),e}}}function eT(e,...t){let n={kind:"schema",type:"nullable",reference:eT,expects:`(${e.expects} | null)`,async:!1,wrapped:e,_run(e,t){return null===e.value&&("default"in this&&(e.value=eg(this,e,t)),null===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function eN(e,...t){let n={kind:"schema",type:"nullable",reference:eN,expects:`(${e.expects} | null)`,async:!0,wrapped:e,async _run(e,t){return null===e.value&&("default"in this&&(e.value=await eg(this,e,t)),null===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function eA(e,...t){let n={kind:"schema",type:"nullish",reference:eA,expects:`(${e.expects} | null | undefined)`,async:!0,wrapped:e,async _run(e,t){return(null===e.value||void 0===e.value)&&("default"in this&&(e.value=await eg(this,e,t)),null===e.value||void 0===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function eS(e){return{kind:"schema",type:"number",reference:eS,expects:"number",async:!1,message:e,_run(e,t){return"number"!=typeof e.value||isNaN(e.value)?eu(this,"type",e,t):e.typed=!0,e}}}function eC(e,t){return{kind:"schema",type:"object",reference:eC,expects:"Object",async:!1,entries:e,message:t,_run(e,t){let n=e.value;if(n&&"object"==typeof n)for(let r in e.typed=!0,e.value={},this.entries){let i=n[r],a=this.entries[r]._run({typed:!1,value:i},t);if(a.issues){let s={type:"object",origin:"value",input:n,key:r,value:i};for(let t of a.issues)t.path?t.path.unshift(s):t.path=[s],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),(void 0!==a.value||r in n)&&(e.value[r]=a.value)}else eu(this,"type",e,t);return e}}}function eD(e,...t){let n={kind:"schema",type:"optional",reference:eD,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,_run(e,t){return void 0===e.value&&("default"in this&&(e.value=eg(this,e,t)),void 0===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in t&&(n.default=t[0]),n}function ex(e){return{kind:"schema",type:"string",reference:ex,expects:"string",async:!1,message:e,_run(e,t){return"string"==typeof e.value?e.typed=!0:eu(this,"type",e,t),e}}}function ek(e,t){return{kind:"schema",type:"tuple",reference:ek,expects:"Array",async:!1,items:e,message:t,_run(e,t){let n=e.value;if(Array.isArray(n)){e.typed=!0,e.value=[];for(let r=0;r<this.items.length;r++){let i=n[r],a=this.items[r]._run({typed:!1,value:i},t);if(a.issues){let s={type:"array",origin:"value",input:n,key:r,value:i};for(let t of a.issues)t.path?t.path.unshift(s):t.path=[s],e.issues?.push(t);if(e.issues||(e.issues=a.issues),t.abortEarly){e.typed=!1;break}}a.typed||(e.typed=!1),e.value.push(a.value)}}else eu(this,"type",e,t);return e}}}function eO(e){let t;if(e)for(let n of e)t?t.push(...n.issues):t=n.issues;return t}function ej(e,t){return{kind:"schema",type:"union",reference:ej,expects:function(e,t){let n=[...new Set(e)];return n.length>1?`(${n.join(" | ")})`:n[0]??"never"}(e.map(e=>e.expects),"|"),async:!1,options:e,message:t,_run(e,t){let n,r,i;for(let a of this.options){let s=a._run({typed:!1,value:e.value},t);if(s.typed)if(s.issues)r?r.push(s):r=[s];else{n=s;break}else i?i.push(s):i=[s]}if(n)return n;if(r){if(1===r.length)return r[0];eu(this,"type",e,t,{issues:eO(r)}),e.typed=!0}else{if(i?.length===1)return i[0];eu(this,"type",e,t,{issues:eO(i)})}return e}}}function eL(e,t,n){let r=e._run({typed:!1,value:t},es(n));if(r.issues)throw new el(r.issues);return r.value}function eP(e,t){let n={};for(let r in e.entries)n[r]=!t||t.includes(r)?eD(e.entries[r]):e.entries[r];return{...e,entries:n}}function e_(...e){return{...e[0],pipe:e,_run(t,n){for(let r of e)if("metadata"!==r.kind){if(t.issues&&("schema"===r.kind||"transformation"===r.kind)){t.typed=!1;break}t.issues&&(n.abortEarly||n.abortPipeEarly)||(t=r._run(t,n))}return t}}}let eU=new Uint8Array(32),ez=$("fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),eR=e=>e_(eb(Uint8Array),function e(t,n){return{kind:"validation",type:"length",reference:e,async:!1,expects:`${t}`,requirement:t,message:n,_run(e,t){return e.typed&&e.value.length!==this.requirement&&eu(this,"length",e,t,{received:`${e.value.length}`}),e}}}(e));function eB(e,t){return e.length===t.length&&e.every((e,n)=>0===Z(e,t[n]))}function eH(e){if(!(e instanceof Uint8Array)||e.length<33)return!1;let t=e[0],n=e.slice(1,33);if(0===Z(eU,n)||Z(n,ez)>=0)return!1;if((2===t||3===t)&&33===e.length)return!0;let r=e.slice(33);return!(0===Z(eU,r)||Z(r,ez)>=0)&&4===t&&65===e.length}function eW(e){return!!e&&"output"in e&&e.output instanceof Uint8Array&&(void 0===e.version||(254&e.version)===e.version)}let eG=eR(32),eY=eR(20),eQ=eR(32),eF=eb(Uint8Array);e_(ex(),function e(t,n){return{kind:"validation",type:"regex",reference:e,async:!1,expects:`${t}`,requirement:t,message:n,_run(e,t){return e.typed&&!this.requirement.test(e.value)&&eu(this,"format",e,t),e}}}(/^([0-9a-f]{2})+$/i));let eK=e_(eS(),ed(),ef(0),eh(255)),eV=e_(eS(),ed(),ef(0),eh(0xffffffff)),e$=e_(function e(t){return{kind:"schema",type:"bigint",reference:e,expects:"bigint",async:!1,message:t,_run(e,t){return"bigint"==typeof e.value?e.typed=!0:eu(this,"type",e,t),e}}}(),ef(0n),eh(0x7fffffffffffffffn)),eq=e=>eC(Object.entries(e).reduce((e,t)=>({...e,[t[0]]:function e(t,...n){let r={kind:"schema",type:"nullish",reference:e,expects:`(${t.expects} | null | undefined)`,async:!1,wrapped:t,_run(e,t){return(null===e.value||void 0===e.value)&&("default"in this&&(e.value=eg(this,e,t)),null===e.value||void 0===e.value)?(e.typed=!0,e):this.wrapped._run(e,t)}};return 0 in n&&(r.default=n[0]),r}(t[1])}),{})),eZ=new Uint8Array(1);function eX(e){let t=0;for(;0===e[t];)++t;return t===e.length?eZ:128&(e=e.slice(t))[0]?K([eZ,e]):e}function eJ(e){0===e[0]&&(e=e.slice(1));let t=new Uint8Array(32),n=Math.max(0,32-e.length);return t.set(e,n),t}function e0(e){let t=ee(e,e.length-1);if(!tn(t))throw Error("Invalid hashType "+t);let n=function(e){if(e.length<8)throw Error("DER sequence length is too short");if(e.length>72)throw Error("DER sequence length is too long");if(48!==e[0])throw Error("Expected DER sequence");if(e[1]!==e.length-2)throw Error("DER sequence length is invalid");if(2!==e[2])throw Error("Expected DER integer");let t=e[3];if(0===t)throw Error("R length is zero");if(5+t>=e.length)throw Error("R length is too long");if(2!==e[4+t])throw Error("Expected DER integer (2)");let n=e[5+t];if(0===n)throw Error("S length is zero");if(6+t+n!==e.length)throw Error("S length is invalid");if(128&e[4])throw Error("R value is negative");if(t>1&&0===e[4]&&!(128&e[5]))throw Error("R value excessively padded");if(128&e[t+6])throw Error("S value is negative");if(n>1&&0===e[t+6]&&!(128&e[t+7]))throw Error("S value excessively padded");return{r:e.slice(4,4+t),s:e.slice(6+t)}}(e.subarray(0,-1));return{signature:K([eJ(n.r),eJ(n.s)]),hashType:t}}function e1(e,t){if(eL(eC({signature:eR(64),hashType:eK}),{signature:e,hashType:t}),!tn(t))throw Error("Invalid hashType "+t);let n=new Uint8Array(1);return X(n,0,t),K([function(e,t){let n=e.length,r=t.length;if(0===n)throw Error("R length is zero");if(0===r)throw Error("S length is zero");if(n>33)throw Error("R length is too long");if(r>33)throw Error("S length is too long");if(128&e[0])throw Error("R value is negative");if(128&t[0])throw Error("S value is negative");if(n>1&&0===e[0]&&!(128&e[1]))throw Error("R value excessively padded");if(r>1&&0===t[0]&&!(128&t[1]))throw Error("S value excessively padded");let i=new Uint8Array(6+n+r);return i[0]=48,i[1]=i.length-2,i[2]=2,i[3]=e.length,i.set(e,4),i[4+n]=2,i[5+n]=t.length,i.set(t,6+n),i}(eX(e.slice(0,32)),eX(e.slice(32,64))),n])}let e2=B.OP_RESERVED,e4=eE(ej([eb(Uint8Array),eS()]));function e3(e){return eM(eF,e)||eM(eS(),e)&&(e===B.OP_0||e>=B.OP_1&&e<=B.OP_16||e===B.OP_1NEGATE)}function e5(e){return eM(e_(function e(){return{kind:"schema",type:"any",reference:e,expects:"any",async:!1,_run:e=>(e.typed=!0,e)}}(),function e(t,n){return{kind:"validation",type:"every_item",reference:e,async:!1,expects:null,requirement:t,message:n,_run(e,t){return e.typed&&!e.value.every(this.requirement)&&eu(this,"item",e,t),e}}}(e3)),e)}function e8(e){return e.length-e.filter(e3).length}function e6(e){if(0===e.length)return B.OP_0;if(1===e.length){if(e[0]>=1&&e[0]<=16)return e2+e[0];if(129===e[0])return B.OP_1NEGATE}}function e9(e){return e instanceof Uint8Array}function e7(e){return e instanceof Uint8Array}function te(e){if(e9(e))return e;eL(e4,e);let t=new Uint8Array(e.reduce((e,t)=>e7(t)?1===t.length&&void 0!==e6(t)?e+1:e+ea(t.length)+t.length:e+1,0)),n=0;if(e.forEach(e=>{if(e7(e)){let r=e6(e);if(void 0!==r){X(t,n,r),n+=1;return}n+=function(e,t,n){let r=ea(t);return 1===r?X(e,n,t):2===r?(X(e,n,B.OP_PUSHDATA1),X(e,n+1,t)):3===r?(X(e,n,B.OP_PUSHDATA2),!function(e,t,n,r){if(t+2>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>65535)throw Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${n}`);"LE"===r?(e[t]=255&n,e[t+1]=n>>8&255):(e[t]=n>>8&255,e[t+1]=255&n)}(e,n+1,t,"LE")):(X(e,n,B.OP_PUSHDATA4),J(e,n+1,t,"LE")),r}(t,e.length,n),t.set(e,n),n+=e.length}else X(t,n,e),n+=1}),n!==t.length)throw Error("Could not decode chunks");return t}function tt(e){if(eM(e4,e))return e;eL(eF,e);let t=[],n=0;for(;n<e.length;){let r=e[n];if(r>B.OP_0&&r<=B.OP_PUSHDATA4){let r=function(e,t){let n,r,i=ee(e,t);if(i<B.OP_PUSHDATA1)n=i,r=1;else if(i===B.OP_PUSHDATA1){if(t+2>e.length)return null;n=ee(e,t+1),r=2}else if(i===B.OP_PUSHDATA2){if(t+3>e.length)return null;n=function(e,t,n){if(t+2>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=0;return(0+e[t+1]<<8)+e[t]}{let n=0;return(0+e[t]<<8)+e[t+1]}}(e,t+1,"LE"),r=3}else{if(t+5>e.length)return null;if(i!==B.OP_PUSHDATA4)throw Error("Unexpected opcode");n=et(e,t+1,"LE"),r=5}return{opcode:i,number:n,size:r}}(e,n);if(null===r||(n+=r.size)+r.number>e.length)return null;let i=e.slice(n,n+r.number);n+=r.number;let a=e6(i);void 0!==a?t.push(a):t.push(i)}else t.push(r),n+=1}return t}function tn(e){let t=-129&e;return t>0&&t<4}function tr(e){if(!(e instanceof Uint8Array)||!tn(e[e.length-1]))return!1;var t=e.slice(0,-1);if(t.length<8||t.length>72||48!==t[0]||t[1]!==t.length-2||2!==t[2])return!1;let n=t[3];if(0===n||5+n>=t.length||2!==t[4+n])return!1;let r=t[5+n];return 0!==r&&6+n+r===t.length&&!(128&t[4])&&(!(n>1)||0!==t[4]||!!(128&t[5]))&&!(128&t[n+6])&&(!(r>1)||0!==t[n+6]||!!(128&t[n+7]))}function ti(e,t,n){Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get(){let e=n.call(this);return this[t]=e,e},set(e){Object.defineProperty(this,t,{configurable:!0,enumerable:!0,value:e,writable:!0})}})}function ta(e){let t;return()=>void 0!==t?t:t=e()}let ts=B.OP_RESERVED;function to(e,t){if(!e.input&&!e.output&&!(e.pubkeys&&void 0!==e.m)&&!e.signatures)throw TypeError("Not enough data");function n(e){return tr(e)||(t.allowIncomplete&&e===B.OP_0)!==void 0}t=Object.assign({validate:!0},t||{}),eL(eP(eC({network:eC({}),m:eS(),n:eS(),output:eF,pubkeys:eE(ev(eH),"Received invalid pubkey"),signatures:eE(ev(n),"Expected signature to be of type isAcceptableSignature"),input:eF})),e);let r={network:e.network||R},i=[],a=!1;function s(e){a||(a=!0,r.m=(i=tt(e))[0]-ts,r.n=i[i.length-2]-ts,r.pubkeys=i.slice(1,-2))}if(ti(r,"output",()=>{if(e.m&&r.n&&e.pubkeys)return te([].concat(ts+e.m,e.pubkeys,ts+r.n,B.OP_CHECKMULTISIG))}),ti(r,"m",()=>{if(r.output)return s(r.output),r.m}),ti(r,"n",()=>{if(r.pubkeys)return r.pubkeys.length}),ti(r,"pubkeys",()=>{if(e.output)return s(e.output),r.pubkeys}),ti(r,"signatures",()=>{if(e.input)return tt(e.input).slice(1)}),ti(r,"input",()=>{if(e.signatures)return te([B.OP_0].concat(e.signatures))}),ti(r,"witness",()=>{if(r.input)return[]}),ti(r,"name",()=>{if(r.m&&r.n)return`p2ms(${r.m} of ${r.n})`}),t.validate){if(e.output){if(s(e.output),eL(eS(),i[0],{message:"Output is invalid"}),eL(eS(),i[i.length-2],{message:"Output is invalid"}),i[i.length-1]!==B.OP_CHECKMULTISIG||r.m<=0||r.n>16||r.m>r.n||r.n!==i.length-3||!r.pubkeys.every(e=>eH(e)))throw TypeError("Output is invalid");if(void 0!==e.m&&e.m!==r.m)throw TypeError("m mismatch");if(void 0!==e.n&&e.n!==r.n)throw TypeError("n mismatch");if(e.pubkeys&&!eB(e.pubkeys,r.pubkeys))throw TypeError("Pubkeys mismatch")}if(e.pubkeys){if(void 0!==e.n&&e.n!==e.pubkeys.length)throw TypeError("Pubkey count mismatch");if(r.n=e.pubkeys.length,r.n<r.m)throw TypeError("Pubkey count cannot be less than m")}if(e.signatures){if(e.signatures.length<r.m)throw TypeError("Not enough signatures provided");if(e.signatures.length>r.m)throw TypeError("Too many signatures provided")}if(e.input){if(e.input[0]!==B.OP_0)throw TypeError("Input is invalid");if(0===r.signatures.length||!r.signatures.every(n))throw TypeError("Input has invalid signature(s)");if(e.signatures&&!eB(e.signatures,r.signatures))throw TypeError("Signature mismatch");if(void 0!==e.m&&e.m!==e.signatures.length)throw TypeError("Signature count mismatch")}}return Object.assign(r,e)}function tu(e,t){if(!e.input&&!e.output&&!e.pubkey&&!e.input&&!e.signature)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eP(eC({network:eC({}),output:eF,pubkey:ev(eH,"invalid pubkey"),signature:ev(tr,"Expected signature to be of type isCanonicalScriptSignature"),input:eF})),e);let n=ta(()=>tt(e.input)),r={name:"p2pk",network:e.network||R};if(ti(r,"output",()=>{if(e.pubkey)return te([e.pubkey,B.OP_CHECKSIG])}),ti(r,"pubkey",()=>{if(e.output)return e.output.slice(1,-1)}),ti(r,"signature",()=>{if(e.input)return n()[0]}),ti(r,"input",()=>{if(e.signature)return te([e.signature])}),ti(r,"witness",()=>{if(r.input)return[]}),t.validate){if(e.output){if(e.output[e.output.length-1]!==B.OP_CHECKSIG)throw TypeError("Output is invalid");if(!eH(r.pubkey))throw TypeError("Output pubkey is invalid");if(e.pubkey&&0!==Z(e.pubkey,r.pubkey))throw TypeError("Pubkey mismatch")}if(e.signature&&e.input&&0!==Z(e.input,r.input))throw TypeError("Signature mismatch");if(e.input){if(1!==n().length)throw TypeError("Input is invalid");if(!tr(r.signature))throw TypeError("Input has invalid signature")}}return Object.assign(r,e)}var tc=n(39525),tl=n(47989);let td=Uint32Array.from([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]);tc.ol,tc.ol;let th=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),tf=Uint8Array.from(Array(16).fill(0).map((e,t)=>t)),tp=tf.map(e=>(9*e+5)%16),tg=(()=>{let e=[[tf],[tp]];for(let t=0;t<4;t++)for(let n of e)n.push(n[t].map(e=>th[e]));return e})(),ty=tg[0],tm=tg[1],tw=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),tI=ty.map((e,t)=>e.map(e=>tw[t][e])),tM=tm.map((e,t)=>e.map(e=>tw[t][e])),tE=Uint32Array.from([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),tv=Uint32Array.from([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]);function tb(e,t,n,r){return 0===e?t^n^r:1===e?t&n|~t&r:2===e?(t|~n)^r:3===e?t&r|n&~r:t^(n|~r)}let tT=new Uint32Array(16);class tN extends tc.ol{constructor(){super(64,20,8,!0),this.h0=0x67452301,this.h1=-0x10325477,this.h2=-0x67452302,this.h3=0x10325476,this.h4=-0x3c2d1e10}get(){let{h0:e,h1:t,h2:n,h3:r,h4:i}=this;return[e,t,n,r,i]}set(e,t,n,r,i){this.h0=0|e,this.h1=0|t,this.h2=0|n,this.h3=0|r,this.h4=0|i}process(e,t){for(let n=0;n<16;n++,t+=4)tT[n]=e.getUint32(t,!0);let n=0|this.h0,r=n,i=0|this.h1,a=i,s=0|this.h2,o=s,u=0|this.h3,c=u,l=0|this.h4,d=l;for(let e=0;e<5;e++){let t=4-e,h=tE[e],f=tv[e],p=ty[e],g=tm[e],y=tI[e],m=tM[e];for(let t=0;t<16;t++){let r=(0,tl.aZ)(n+tb(e,i,s,u)+tT[p[t]]+h,y[t])+l|0;n=l,l=u,u=0|(0,tl.aZ)(s,10),s=i,i=r}for(let e=0;e<16;e++){let n=(0,tl.aZ)(r+tb(t,a,o,c)+tT[g[e]]+f,m[e])+d|0;r=d,d=c,c=0|(0,tl.aZ)(o,10),o=a,a=n}}this.set(this.h1+s+c|0,this.h2+u+d|0,this.h3+l+r|0,this.h4+n+a|0,this.h0+i+o|0)}roundClean(){(0,tl.uH)(tT)}destroy(){this.destroyed=!0,(0,tl.uH)(this.buffer),this.set(0,0,0,0,0)}}let tA=(0,tl.qj)(()=>new tN);function tS(e){return tA((0,x.sc)(e))}function tC(e){return(0,x.sc)((0,x.sc)(e))}let tD={"BIP0340/challenge":Uint8Array.from([123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124,123,181,45,122,159,239,88,50,62,177,191,122,64,125,179,130,210,243,242,216,27,177,34,79,73,254,81,143,109,72,211,124]),"BIP0340/aux":Uint8Array.from([241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144,241,239,78,94,192,99,202,218,109,148,202,250,157,152,126,160,105,38,88,57,236,193,31,151,45,119,165,46,216,193,204,144]),"BIP0340/nonce":Uint8Array.from([7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47,7,73,119,52,167,155,203,53,91,155,140,125,3,79,18,28,244,52,215,62,247,45,218,25,135,0,97,251,82,191,235,47]),TapLeaf:Uint8Array.from([174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238,174,234,143,220,66,8,152,49,5,115,75,88,8,29,30,38,56,211,95,28,181,64,8,212,211,87,202,3,190,120,233,238]),TapBranch:Uint8Array.from([25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21,25,65,161,242,229,110,185,95,162,169,241,148,190,92,1,247,33,111,51,237,130,176,145,70,52,144,208,91,245,22,160,21]),TapSighash:Uint8Array.from([244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49,244,10,72,223,75,42,112,200,180,146,75,242,101,70,97,237,61,149,253,102,163,19,235,135,35,117,151,198,40,228,160,49]),TapTweak:Uint8Array.from([232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233,232,15,225,99,156,156,160,80,227,175,27,57,193,67,198,62,66,156,188,235,21,217,64,251,181,197,161,244,175,87,197,233]),"KeyAgg list":Uint8Array.from([72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240,72,28,151,28,60,11,70,215,240,178,117,174,89,141,78,44,126,215,49,156,89,74,92,110,199,158,160,212,153,2,148,240]),"KeyAgg coefficient":Uint8Array.from([191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129,191,201,4,3,77,28,136,232,200,14,34,229,61,36,86,109,100,130,78,214,66,114,129,192,145,0,249,77,205,82,201,129])};function tx(e,t){return(0,x.sc)(K([tD[e],t]))}let tk=function(e){function t(t){var n=t.slice(0,-4),r=t.slice(-4),i=e(n);if(!(r[0]^i[0]|r[1]^i[1]|r[2]^i[2]|r[3]^i[3]))return n}return{encode:function(t){var n=Uint8Array.from(t),r=e(n),i=new Uint8Array(n.length+4);return i.set(n,0),i.set(r.subarray(0,4),n.length),O.A.encode(i)},decode:function(e){var n=t(O.A.decode(e));if(null==n)throw Error("Invalid checksum");return n},decodeUnsafe:function(e){var n=O.A.decodeUnsafe(e);if(null!=n)return t(n)}}}(function(e){return(0,x.sc)((0,x.sc)(e))});function tO(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.input)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eP(eC({network:eC({}),address:ex(),hash:eY,output:eR(25),pubkey:ev(eH),signature:ev(tr),input:eF})),e);let n=ta(()=>{let t=tk.decode(e.address);return{version:ee(t,0),hash:t.slice(1)}}),r=ta(()=>tt(e.input)),i=e.network||R,a={name:"p2pkh",network:i};if(ti(a,"address",()=>{if(!a.hash)return;let e=new Uint8Array(21);return X(e,0,i.pubKeyHash),e.set(a.hash,1),tk.encode(e)}),ti(a,"hash",()=>e.output?e.output.slice(3,23):e.address?n().hash:e.pubkey||a.pubkey?tS(e.pubkey||a.pubkey):void 0),ti(a,"output",()=>{if(a.hash)return te([B.OP_DUP,B.OP_HASH160,a.hash,B.OP_EQUALVERIFY,B.OP_CHECKSIG])}),ti(a,"pubkey",()=>{if(e.input)return r()[1]}),ti(a,"signature",()=>{if(e.input)return r()[0]}),ti(a,"input",()=>{if(e.pubkey&&e.signature)return te([e.signature,e.pubkey])}),ti(a,"witness",()=>{if(a.input)return[]}),t.validate){let t=Uint8Array.from([]);if(e.address){if(n().version!==i.pubKeyHash)throw TypeError("Invalid version or Network mismatch");if(20!==n().hash.length)throw TypeError("Invalid address");t=n().hash}if(e.hash)if(t.length>0&&0!==Z(t,e.hash))throw TypeError("Hash mismatch");else t=e.hash;if(e.output){if(25!==e.output.length||e.output[0]!==B.OP_DUP||e.output[1]!==B.OP_HASH160||20!==e.output[2]||e.output[23]!==B.OP_EQUALVERIFY||e.output[24]!==B.OP_CHECKSIG)throw TypeError("Output is invalid");let n=e.output.slice(3,23);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch");t=n}if(e.pubkey){let n=tS(e.pubkey);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch");t=n}if(e.input){let n=r();if(2!==n.length)throw TypeError("Input is invalid");if(!tr(n[0]))throw TypeError("Input has invalid signature");if(!eH(n[1]))throw TypeError("Input has invalid pubkey");if(e.signature&&0!==Z(e.signature,n[0]))throw TypeError("Signature mismatch");if(e.pubkey&&0!==Z(e.pubkey,n[1]))throw TypeError("Pubkey mismatch");let i=tS(n[1]);if(t.length>0&&0!==Z(t,i))throw TypeError("Hash mismatch")}}return Object.assign(a,e)}function tj(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.input)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eP(eC({network:eC({}),address:ex(),hash:eR(20),output:eR(23),redeem:eP(eC({network:eC({}),output:eF,input:eF,witness:eE(eF)})),input:eF,witness:eE(eF)})),e);let n=e.network;n||(n=e.redeem&&e.redeem.network||R);let r={network:n},i=ta(()=>{let t=tk.decode(e.address);return{version:ee(t,0),hash:t.slice(1)}}),a=ta(()=>tt(e.input)),s=ta(()=>{let t=a(),r=t[t.length-1];return{network:n,output:r===B.OP_FALSE?Uint8Array.from([]):r,input:te(t.slice(0,-1)),witness:e.witness||[]}});if(ti(r,"address",()=>{if(!r.hash)return;let e=new Uint8Array(21);return X(e,0,r.network.scriptHash),e.set(r.hash,1),tk.encode(e)}),ti(r,"hash",()=>e.output?e.output.slice(2,22):e.address?i().hash:r.redeem&&r.redeem.output?tS(r.redeem.output):void 0),ti(r,"output",()=>{if(r.hash)return te([B.OP_HASH160,r.hash,B.OP_EQUAL])}),ti(r,"redeem",()=>{if(e.input)return s()}),ti(r,"input",()=>{if(e.redeem&&e.redeem.input&&e.redeem.output)return te([].concat(tt(e.redeem.input),e.redeem.output))}),ti(r,"witness",()=>r.redeem&&r.redeem.witness?r.redeem.witness:r.input?[]:void 0),ti(r,"name",()=>{let e=["p2sh"];return void 0!==r.redeem&&void 0!==r.redeem.name&&e.push(r.redeem.name),e.join("-")}),t.validate){let t=Uint8Array.from([]);if(e.address){if(i().version!==n.scriptHash)throw TypeError("Invalid version or Network mismatch");if(20!==i().hash.length)throw TypeError("Invalid address");t=i().hash}if(e.hash)if(t.length>0&&0!==Z(t,e.hash))throw TypeError("Hash mismatch");else t=e.hash;if(e.output){if(23!==e.output.length||e.output[0]!==B.OP_HASH160||20!==e.output[1]||e.output[22]!==B.OP_EQUAL)throw TypeError("Output is invalid");let n=e.output.slice(2,22);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch");t=n}let r=e=>{if(e.output){let n=tt(e.output);if(!n||n.length<1)throw TypeError("Redeem.output too short");if(e.output.byteLength>520)throw TypeError("Redeem.output unspendable if larger than 520 bytes");if(e8(n)>201)throw TypeError("Redeem.output unspendable with more than 201 non-push ops");let r=tS(e.output);if(t.length>0&&0!==Z(t,r))throw TypeError("Hash mismatch");t=r}if(e.input){let t=e.input.length>0,n=e.witness&&e.witness.length>0;if(!t&&!n)throw TypeError("Empty input");if(t&&n)throw TypeError("Input and witness provided");if(t&&!e5(tt(e.input)))throw TypeError("Non push-only scriptSig")}};if(e.input){let e=a();if(!e||e.length<1)throw TypeError("Input too short");if(!(s().output instanceof Uint8Array))throw TypeError("Input is invalid");r(s())}if(e.redeem){if(e.redeem.network&&e.redeem.network!==n)throw TypeError("Network mismatch");if(e.input){let t=s();if(e.redeem.output&&0!==Z(e.redeem.output,t.output))throw TypeError("Redeem.output mismatch");if(e.redeem.input&&0!==Z(e.redeem.input,t.input))throw TypeError("Redeem.input mismatch")}r(e.redeem)}if(e.witness&&e.redeem&&e.redeem.witness&&!eB(e.redeem.witness,e.witness))throw TypeError("Witness and redeem.witness mismatch")}return Object.assign(r,e)}let tL=new Uint8Array(0);function tP(e,t){if(!e.address&&!e.hash&&!e.output&&!e.pubkey&&!e.witness)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eP(eC({address:ex(),hash:eR(20),input:eR(0),network:eC({}),output:eR(22),pubkey:ev(eH,"Not a valid pubkey"),signature:ev(tr),witness:eE(eF)})),e);let n=ta(()=>{let t=k.I.decode(e.address),n=t.words.shift(),r=k.I.fromWords(t.words);return{version:n,prefix:t.prefix,data:Uint8Array.from(r)}}),r=e.network||R,i={name:"p2wpkh",network:r};if(ti(i,"address",()=>{if(!i.hash)return;let e=k.I.toWords(i.hash);return e.unshift(0),k.I.encode(r.bech32,e)}),ti(i,"hash",()=>e.output?e.output.slice(2,22):e.address?n().data:e.pubkey||i.pubkey?tS(e.pubkey||i.pubkey):void 0),ti(i,"output",()=>{if(i.hash)return te([B.OP_0,i.hash])}),ti(i,"pubkey",()=>e.pubkey?e.pubkey:e.witness?e.witness[1]:void 0),ti(i,"signature",()=>{if(e.witness)return e.witness[0]}),ti(i,"input",()=>{if(i.witness)return tL}),ti(i,"witness",()=>{if(e.pubkey&&e.signature)return[e.signature,e.pubkey]}),t.validate){let t=Uint8Array.from([]);if(e.address){if(r&&r.bech32!==n().prefix)throw TypeError("Invalid prefix or Network mismatch");if(0!==n().version)throw TypeError("Invalid address version");if(20!==n().data.length)throw TypeError("Invalid address data");t=n().data}if(e.hash)if(t.length>0&&0!==Z(t,e.hash))throw TypeError("Hash mismatch");else t=e.hash;if(e.output){if(22!==e.output.length||e.output[0]!==B.OP_0||20!==e.output[1])throw TypeError("Output is invalid");if(t.length>0&&0!==Z(t,e.output.slice(2)))throw TypeError("Hash mismatch");t=e.output.slice(2)}if(e.pubkey){let n=tS(e.pubkey);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch");if(t=n,!eH(e.pubkey)||33!==e.pubkey.length)throw TypeError("Invalid pubkey for p2wpkh")}if(e.witness){if(2!==e.witness.length)throw TypeError("Witness is invalid");if(!tr(e.witness[0]))throw TypeError("Witness has invalid signature");if(!eH(e.witness[1])||33!==e.witness[1].length)throw TypeError("Witness has invalid pubkey");if(e.signature&&0!==Z(e.signature,e.witness[0]))throw TypeError("Signature mismatch");if(e.pubkey&&0!==Z(e.pubkey,e.witness[1]))throw TypeError("Pubkey mismatch");let n=tS(e.witness[1]);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch")}}return Object.assign(i,e)}let t_=new Uint8Array(0);function tU(e){return!!(e instanceof Uint8Array&&65===e.length&&4===e[0]&&eH(e))}function tz(e,t){if(!e.address&&!e.hash&&!e.output&&!e.redeem&&!e.witness)throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eq({network:eC({}),address:ex(),hash:eG,output:eR(34),redeem:eq({input:eF,network:eC({}),output:eF,witness:eE(eF)}),input:eR(0),witness:eE(eF)}),e);let n=ta(()=>{let t=k.I.decode(e.address),n=t.words.shift(),r=k.I.fromWords(t.words);return{version:n,prefix:t.prefix,data:Uint8Array.from(r)}}),r=ta(()=>tt(e.redeem.input)),i=e.network;i||(i=e.redeem&&e.redeem.network||R);let a={network:i};if(ti(a,"address",()=>{if(!a.hash)return;let e=k.I.toWords(a.hash);return e.unshift(0),k.I.encode(i.bech32,e)}),ti(a,"hash",()=>e.output?e.output.slice(2):e.address?n().data:a.redeem&&a.redeem.output?(0,x.sc)(a.redeem.output):void 0),ti(a,"output",()=>{if(a.hash)return te([B.OP_0,a.hash])}),ti(a,"redeem",()=>{if(e.witness)return{output:e.witness[e.witness.length-1],input:t_,witness:e.witness.slice(0,-1)}}),ti(a,"input",()=>{if(a.witness)return t_}),ti(a,"witness",()=>{if(e.redeem&&e.redeem.input&&e.redeem.input.length>0&&e.redeem.output&&e.redeem.output.length>0){var t;let n=(t=tt(t=r()),eL(ev(e5),t),t.map(e=>e7(e)?e:e===B.OP_0?new Uint8Array(0):function(e){var t;let n=Math.abs(e),r=(t=n)>0x7fffffff?5:t>8388607?4:t>32767?3:t>127?2:+(t>0),i=new Uint8Array(r),a=e<0;for(let e=0;e<r;++e)X(i,e,255&n),n>>=8;return 128&i[r-1]?X(i,r-1,128*!!a):a&&(i[r-1]|=128),i}(e-e2)));return a.redeem=Object.assign({witness:n},e.redeem),a.redeem.input=t_,[].concat(n,e.redeem.output)}if(e.redeem&&e.redeem.output&&e.redeem.witness)return[].concat(e.redeem.witness,e.redeem.output)}),ti(a,"name",()=>{let e=["p2wsh"];return void 0!==a.redeem&&void 0!==a.redeem.name&&e.push(a.redeem.name),e.join("-")}),t.validate){let t=Uint8Array.from([]);if(e.address){if(n().prefix!==i.bech32)throw TypeError("Invalid prefix or Network mismatch");if(0!==n().version)throw TypeError("Invalid address version");if(32!==n().data.length)throw TypeError("Invalid address data");t=n().data}if(e.hash)if(t.length>0&&0!==Z(t,e.hash))throw TypeError("Hash mismatch");else t=e.hash;if(e.output){if(34!==e.output.length||e.output[0]!==B.OP_0||32!==e.output[1])throw TypeError("Output is invalid");let n=e.output.slice(2);if(t.length>0&&0!==Z(t,n))throw TypeError("Hash mismatch");t=n}if(e.redeem){if(e.redeem.network&&e.redeem.network!==i)throw TypeError("Network mismatch");if(e.redeem.input&&e.redeem.input.length>0&&e.redeem.witness&&e.redeem.witness.length>0)throw TypeError("Ambiguous witness source");if(e.redeem.output){let n=tt(e.redeem.output);if(!n||n.length<1)throw TypeError("Redeem.output is invalid");if(e.redeem.output.byteLength>3600)throw TypeError("Redeem.output unspendable if larger than 3600 bytes");if(e8(n)>201)throw TypeError("Redeem.output unspendable with more than 201 non-push ops");let r=(0,x.sc)(e.redeem.output);if(t.length>0&&0!==Z(t,r))throw TypeError("Hash mismatch");t=r}if(e.redeem.input&&!e5(r()))throw TypeError("Non push-only scriptSig");if(e.witness&&e.redeem.witness&&!eB(e.witness,e.redeem.witness))throw TypeError("Witness and redeem.witness mismatch");if(e.redeem.input&&r().some(tU)||e.redeem.output&&(tt(e.redeem.output)||[]).some(tU))throw TypeError("redeem.input or redeem.output contains uncompressed pubkey")}if(e.witness&&e.witness.length>0){let t=e.witness[e.witness.length-1];if(e.redeem&&e.redeem.output&&0!==Z(e.redeem.output,t))throw TypeError("Witness and redeem.output mismatch");if(e.witness.some(tU)||(tt(t)||[]).some(tU))throw TypeError("Witness contains uncompressed pubkey")}}return Object.assign(a,e)}let tR={};function tB(){if(!tR.eccLib)throw Error("No ECC Library provided. You must call initEccLib() with a valid TinySecp256k1Interface instance");return tR.eccLib}let tH="0123456789abcdefABCDEF",tW=(tH.split("").map(e=>e.codePointAt(0)),Array(256).fill(!0).map((e,t)=>{let n=String.fromCodePoint(t),r=tH.indexOf(n);return r<0?void 0:r<16?r:r-6}),new TextEncoder,new TextDecoder,e=>{if(e<0||e>0xffffffffffffffffn)throw RangeError("value out of range")});function tG(e){if("number"==typeof e){if(e<0||e>Number.MAX_SAFE_INTEGER||e%1!=0)throw RangeError("value out of range")}else tW(e)}function tY(e,t,n){tG(e),void 0===n&&(n=0),void 0===t&&(t=new Uint8Array(tF(e)));let r=0;if(e<253)t.set([Number(e)],n),r=1;else if(e<=65535){t.set([253],n);var i=t,a=n+1,s=Number(e),o="LE";if(a+2>i.length)throw Error("Offset is outside the bounds of Uint8Array");if(o=o.toUpperCase(),s>65535)throw Error(`The value of "value" is out of range. It must be >= 0 and <= 65535. Received ${s}`);"LE"===o?(i[a]=255&s,i[a+1]=s>>8&255):(i[a]=s>>8&255,i[a+1]=255&s),r=3}else if(e<=0xffffffff){t.set([254],n);var u=t,c=n+1,l=Number(e),d="LE";if(c+4>u.length)throw Error("Offset is outside the bounds of Uint8Array");if(d=d.toUpperCase(),l>0xffffffff)throw Error(`The value of "value" is out of range. It must be >= 0 and <= 4294967295. Received ${l}`);"LE"===d?(u[c]=255&l,u[c+1]=l>>8&255,u[c+2]=l>>16&255,u[c+3]=l>>24&255):(u[c]=l>>24&255,u[c+1]=l>>16&255,u[c+2]=l>>8&255,u[c+3]=255&l),r=5}else{t.set([255],n);var h=t,f=n+1,p=BigInt(e),g="LE";if(f+8>h.length)throw Error("Offset is outside the bounds of Uint8Array");if(g=g.toUpperCase(),p>0xffffffffffffffffn)throw Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${p}`);"LE"===g?(h[f]=Number(255n&p),h[f+1]=Number(p>>8n&255n),h[f+2]=Number(p>>16n&255n),h[f+3]=Number(p>>24n&255n),h[f+4]=Number(p>>32n&255n),h[f+5]=Number(p>>40n&255n),h[f+6]=Number(p>>48n&255n),h[f+7]=Number(p>>56n&255n)):(h[f]=Number(p>>56n&255n),h[f+1]=Number(p>>48n&255n),h[f+2]=Number(p>>40n&255n),h[f+3]=Number(p>>32n&255n),h[f+4]=Number(p>>24n&255n),h[f+5]=Number(p>>16n&255n),h[f+6]=Number(p>>8n&255n),h[f+7]=Number(255n&p)),r=9}return{buffer:t,bytes:r}}function tQ(e,t){void 0===t&&(t=0);let n=e.at(t);if(void 0===n)throw Error("buffer too small");if(n<253)return{numberValue:n,bigintValue:BigInt(n),bytes:1};if(253===n){let n=function(e,t,n){if(t+2>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=0;return(0+e[t+1]<<8)+e[t]}{let n=0;return(0+e[t]<<8)+e[t+1]}}(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:3}}if(254===n){let n=function(e,t,n){if(t+4>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=0;return(((0+e[t+3]>>>0<<8)+e[t+2]>>>0<<8)+e[t+1]>>>0<<8)+e[t]>>>0}{let n=0;return(((0+e[t]>>>0<<8)+e[t+1]>>>0<<8)+e[t+2]>>>0<<8)+e[t+3]>>>0}}(e,t+1,"LE");return{numberValue:n,bigintValue:BigInt(n),bytes:5}}{let n=function(e,t,n){if(t+8>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=0n;return((n=((n=((n=((n=((n=((n=((n=(n<<8n)+BigInt(e[t+7]))<<8n)+BigInt(e[t+6]))<<8n)+BigInt(e[t+5]))<<8n)+BigInt(e[t+4]))<<8n)+BigInt(e[t+3]))<<8n)+BigInt(e[t+2]))<<8n)+BigInt(e[t+1]))<<8n)+BigInt(e[t])}{let n=0n;return((n=((n=((n=((n=((n=((n=((n=(n<<8n)+BigInt(e[t]))<<8n)+BigInt(e[t+1]))<<8n)+BigInt(e[t+2]))<<8n)+BigInt(e[t+3]))<<8n)+BigInt(e[t+4]))<<8n)+BigInt(e[t+5]))<<8n)+BigInt(e[t+6]))<<8n)+BigInt(e[t+7])}}(e,t+1,"LE");return{numberValue:n<=Number.MAX_SAFE_INTEGER?Number(n):null,bigintValue:n,bytes:9}}}function tF(e){return tG(e),e<253?1:e<=65535?3:e<=0xffffffff?5:9}function tK(e){if(e.length<1)return e;let t=e.length-1,n=0;for(let r=0;r<e.length/2;r++)n=e[r],e[r]=e[t],e[t]=n,t--;return e}function tV(e){let t=new Uint8Array(e.length);return t.set(e),t}class t${buffer;offset;static withCapacity(e){return new t$(new Uint8Array(e))}constructor(e,t=0){this.buffer=e,this.offset=t,eL(ek([eF,eV]),[e,t])}writeUInt8(e){this.offset=X(this.buffer,this.offset,e)}writeInt32(e){this.offset=en(this.buffer,this.offset,e,"LE")}writeInt64(e){this.offset=er(this.buffer,this.offset,BigInt(e),"LE")}writeUInt32(e){this.offset=J(this.buffer,this.offset,e,"LE")}writeUInt64(e){this.offset=function(e,t,n,r){if(t+8>e.length)throw Error("Offset is outside the bounds of Uint8Array");if(r=r.toUpperCase(),n>0xffffffffffffffffn)throw Error(`The value of "value" is out of range. It must be >= 0 and <= ${0xffffffffffffffffn}. Received ${n}`);return"LE"===r?(e[t]=Number(255n&n),e[t+1]=Number(n>>8n&255n),e[t+2]=Number(n>>16n&255n),e[t+3]=Number(n>>24n&255n),e[t+4]=Number(n>>32n&255n),e[t+5]=Number(n>>40n&255n),e[t+6]=Number(n>>48n&255n),e[t+7]=Number(n>>56n&255n)):(e[t]=Number(n>>56n&255n),e[t+1]=Number(n>>48n&255n),e[t+2]=Number(n>>40n&255n),e[t+3]=Number(n>>32n&255n),e[t+4]=Number(n>>24n&255n),e[t+5]=Number(n>>16n&255n),e[t+6]=Number(n>>8n&255n),e[t+7]=Number(255n&n)),t+8}(this.buffer,this.offset,BigInt(e),"LE")}writeVarInt(e){let{bytes:t}=tY(e,this.buffer,this.offset);this.offset+=t}writeSlice(e){if(this.buffer.length<this.offset+e.length)throw Error("Cannot write slice out of bounds");this.buffer.set(e,this.offset),this.offset+=e.length}writeVarSlice(e){this.writeVarInt(e.length),this.writeSlice(e)}writeVector(e){this.writeVarInt(e.length),e.forEach(e=>this.writeVarSlice(e))}end(){if(this.buffer.length===this.offset)return this.buffer;throw Error(`buffer size ${this.buffer.length}, offset ${this.offset}`)}}class tq{buffer;offset;constructor(e,t=0){this.buffer=e,this.offset=t,eL(ek([eF,eV]),[e,t])}readUInt8(){let e=ee(this.buffer,this.offset);return this.offset++,e}readInt32(){let e=function(e,t,n){if(t+4>e.length)throw Error("Offset is outside the bounds of Uint8Array");if("LE"===(n=n.toUpperCase())){let n=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24>>>0);return e[t+3]<=127?n:n-0x100000000}{let n=(e[t]<<24>>>0)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];return e[t]<=127?n:n-0x100000000}}(this.buffer,this.offset,"LE");return this.offset+=4,e}readUInt32(){let e=et(this.buffer,this.offset,"LE");return this.offset+=4,e}readInt64(){let e=ei(this.buffer,this.offset,"LE");return this.offset+=8,e}readVarInt(){let{bigintValue:e,bytes:t}=tQ(this.buffer,this.offset);return this.offset+=t,e}readSlice(e){if("number"!=typeof e&&"bigint"!=typeof e)throw Error("cannot write a non-number as a number");if(e<0&&e<BigInt(0))throw Error("specified a negative value for writing an unsigned value");if(e>0x1fffffffffffff&&e>BigInt(0x1fffffffffffff))throw Error("RangeError: value out of range");if(Math.floor(Number(e))!==Number(e))throw Error("value has a fractional component");let t=Number(e);if(this.buffer.length<this.offset+t)throw Error("Cannot read slice out of bounds");let n=this.buffer.slice(this.offset,this.offset+t);return this.offset+=t,n}readVarSlice(){return this.readSlice(this.readVarInt())}readVector(){let e=this.readVarInt(),t=[];for(let n=0;n<e;n++)t.push(this.readVarSlice());return t}}let tZ=e=>"left"in e&&"right"in e;function tX(e,t){if(e.length<33)throw TypeError(`The control-block length is too small. Got ${e.length}, expected min 33.`);let n=(e.length-33)/32,r=t;for(let t=0;t<n;t++){let n=e.slice(33+32*t,65+32*t);r=0>Z(r,n)?t2(r,n):t2(n,r)}return r}function tJ(e,t){if(tZ(e)){let n=tJ(e.left,t);if(void 0!==n)return[...n,e.right.hash];let r=tJ(e.right,t);if(void 0!==r)return[...r,e.left.hash]}else if(0===Z(e.hash,t))return[]}function t0(e){let t=e.version||192;return tx("TapLeaf",K([Uint8Array.from([t]),function(e){let t=new Uint8Array(tF(e.length));return tY(e.length,t),K([t,e])}(e.output)]))}function t1(e,t){if(!(e instanceof Uint8Array)||32!==e.length||t&&32!==t.length)return null;let n=tx("TapTweak",K(t?[e,t]:[e])),r=tB().xOnlyPointAddTweak(e,n);return r&&null!==r.xOnlyPubkey?{parity:r.parity,x:Uint8Array.from(r.xOnlyPubkey)}:null}function t2(e,t){return tx("TapBranch",K([e,t]))}function t4(e,t){if(!e.address&&!e.output&&!e.pubkey&&!e.internalPubkey&&!(e.witness&&e.witness.length>1))throw TypeError("Not enough data");t=Object.assign({validate:!0},t||{}),eL(eP(eC({address:ex(),input:eR(0),network:eC({}),output:eR(34),internalPubkey:eR(32),hash:eR(32),pubkey:eR(32),signature:ej([eR(64),eR(65)]),witness:eE(eF),scriptTree:ev(function e(t){return Array.isArray(t)?2===t.length&&t.every(t=>e(t)):eW(t)},"Taptree is not of type isTaptree"),redeem:eP(eC({output:eF,redeemVersion:eS(),witness:eE(eF)})),redeemVersion:eS()})),e);let n=ta(()=>t5(e.address)),r=ta(()=>{if(e.witness&&e.witness.length)return e.witness.length>=2&&80===e.witness[e.witness.length-1][0]?e.witness.slice(0,-1):e.witness.slice()}),i=ta(()=>e.scriptTree?function e(t){if(eW(t))return{hash:t0(t)};let n=[e(t[0]),e(t[1])];n.sort((e,t)=>Z(e.hash,t.hash));let[r,i]=n;return{hash:t2(r.hash,i.hash),left:r,right:i}}(e.scriptTree):e.hash?{hash:e.hash}:void 0),a=e.network||R,s={name:"p2tr",network:a};if(ti(s,"address",()=>{if(!s.pubkey)return;let e=k.p2.toWords(s.pubkey);return e.unshift(1),k.p2.encode(a.bech32,e)}),ti(s,"hash",()=>{let e=i();if(e)return e.hash;let t=r();if(t&&t.length>1){let e=t[t.length-1],n=254&e[0];return tX(e,t0({output:t[t.length-2],version:n}))}return null}),ti(s,"output",()=>{if(s.pubkey)return te([B.OP_1,s.pubkey])}),ti(s,"redeemVersion",()=>e.redeemVersion?e.redeemVersion:e.redeem&&void 0!==e.redeem.redeemVersion&&null!==e.redeem.redeemVersion?e.redeem.redeemVersion:192),ti(s,"redeem",()=>{let e=r();if(e&&!(e.length<2))return{output:e[e.length-2],witness:e.slice(0,-2),redeemVersion:254&e[e.length-1][0]}}),ti(s,"pubkey",()=>{if(e.pubkey)return e.pubkey;if(e.output)return e.output.slice(2);if(e.address)return n().data;if(s.internalPubkey){let e=t1(s.internalPubkey,s.hash);if(e)return e.x}}),ti(s,"internalPubkey",()=>{if(e.internalPubkey)return e.internalPubkey;let t=r();if(t&&t.length>1)return t[t.length-1].slice(1,33)}),ti(s,"signature",()=>{if(e.signature)return e.signature;let t=r();if(t&&1===t.length)return t[0]}),ti(s,"witness",()=>{if(e.witness)return e.witness;let t=i();if(t&&e.redeem&&e.redeem.output&&e.internalPubkey){let n=tJ(t,t0({output:e.redeem.output,version:s.redeemVersion}));if(!n)return;let r=t1(e.internalPubkey,t.hash);if(!r)return;let i=K([Uint8Array.from([s.redeemVersion|r.parity]),e.internalPubkey].concat(n));return[e.redeem.output,i]}if(e.signature)return[e.signature]}),t.validate){let t=Uint8Array.from([]);if(e.address){if(a&&a.bech32!==n().prefix)throw TypeError("Invalid prefix or Network mismatch");if(1!==n().version)throw TypeError("Invalid address version");if(32!==n().data.length)throw TypeError("Invalid address data");t=n().data}if(e.pubkey)if(t.length>0&&0!==Z(t,e.pubkey))throw TypeError("Pubkey mismatch");else t=e.pubkey;if(e.output){if(34!==e.output.length||e.output[0]!==B.OP_1||32!==e.output[1])throw TypeError("Output is invalid");if(t.length>0&&0!==Z(t,e.output.slice(2)))throw TypeError("Pubkey mismatch");t=e.output.slice(2)}if(e.internalPubkey){let n=t1(e.internalPubkey,s.hash);if(t.length>0&&0!==Z(t,n.x))throw TypeError("Pubkey mismatch");t=n.x}if(t&&t.length&&!tB().isXOnlyPoint(t))throw TypeError("Invalid pubkey for p2tr");let o=i();if(e.hash&&o&&0!==Z(e.hash,o.hash))throw TypeError("Hash mismatch");if(e.redeem&&e.redeem.output&&o&&!tJ(o,t0({output:e.redeem.output,version:s.redeemVersion})))throw TypeError("Redeem script not in tree");let u=r();if(e.redeem&&s.redeem){if(e.redeem.redeemVersion&&e.redeem.redeemVersion!==s.redeem.redeemVersion)throw TypeError("Redeem.redeemVersion and witness mismatch");if(e.redeem.output){if(0===tt(e.redeem.output).length)throw TypeError("Redeem.output is invalid");if(s.redeem.output&&0!==Z(e.redeem.output,s.redeem.output))throw TypeError("Redeem.output and witness mismatch")}if(e.redeem.witness&&s.redeem.witness&&!eB(e.redeem.witness,s.redeem.witness))throw TypeError("Redeem.witness and witness mismatch")}if(u&&u.length)if(1===u.length){if(e.signature&&0!==Z(e.signature,u[0]))throw TypeError("Signature mismatch")}else{let n=u[u.length-1];if(n.length<33)throw TypeError(`The control-block length is too small. Got ${n.length}, expected min 33.`);if((n.length-33)%32!=0)throw TypeError(`The control-block length of ${n.length} is incorrect!`);let r=(n.length-33)/32;if(r>128)throw TypeError(`The script path is too long. Got ${r}, expected max 128.`);let i=n.slice(1,33);if(e.internalPubkey&&0!==Z(e.internalPubkey,i))throw TypeError("Internal pubkey mismatch");if(!tB().isXOnlyPoint(i))throw TypeError("Invalid internalPubkey for p2tr witness");let a=254&n[0],s=t1(i,tX(n,t0({output:u[u.length-2],version:a})));if(!s)throw TypeError("Invalid outputKey for p2tr witness");if(t.length&&0!==Z(t,s.x))throw TypeError("Pubkey mismatch for p2tr witness");if(s.parity!==(1&n[0]))throw Error("Incorrect parity")}}return Object.assign(s,e)}let t3="WARNING: Sending to a future segwit version address can lead to loss of funds. End users MUST be warned carefully in the GUI and asked if they wish to proceed with caution. Wallets should verify the segwit version from the output of fromBech32, then decide when it is safe to use which version of segwit.";function t5(e){let t,n;try{t=k.I.decode(e)}catch(e){}if(t){if(0!==(n=t.words[0]))throw TypeError(e+" uses wrong encoding")}else if(0===(n=(t=k.p2.decode(e)).words[0]))throw TypeError(e+" uses wrong encoding");let r=k.I.fromWords(t.words.slice(1));return{version:n,prefix:t.prefix,data:Uint8Array.from(r)}}function t8(e,t){t=t||R;try{return tO({output:e,network:t}).address}catch(e){}try{return tj({output:e,network:t}).address}catch(e){}try{return tP({output:e,network:t}).address}catch(e){}try{return tz({output:e,network:t}).address}catch(e){}try{return t4({output:e,network:t}).address}catch(e){}try{var n=t;let r=e.slice(2);if(r.length<2||r.length>40)throw TypeError("Invalid program length for segwit address");let i=e[0]-80;if(i<2||i>16)throw TypeError("Invalid version for segwit address");if(e[1]!==r.length)throw TypeError("Invalid script for segwit address");return console.warn(t3),function(e,t,n){let r=k.I.toWords(e);return r.unshift(t),0===t?k.I.encode(n,r):k.p2.encode(n,r)}(r,i,n.bech32)}catch(e){}throw Error(function(e){if(e9(e)&&(e=tt(e)),!e)throw Error("Could not convert invalid chunks to ASM");return e.map(e=>{if(e7(e)){let t=e6(e);if(void 0===t)return V(e);e=t}return H[e]}).join(" ")}(e)+" has no matching Address")}function t6(e){let t=e.length;return tF(t)+t}let t9=new Uint8Array(0),t7=[],ne=$("0000000000000000000000000000000000000000000000000000000000000000"),nt=$("0000000000000000000000000000000000000000000000000000000000000001"),nn={script:t9,valueBuffer:$("ffffffffffffffff")};class nr{static DEFAULT_SEQUENCE=0xffffffff;static SIGHASH_DEFAULT=0;static SIGHASH_ALL=1;static SIGHASH_NONE=2;static SIGHASH_SINGLE=3;static SIGHASH_ANYONECANPAY=128;static SIGHASH_OUTPUT_MASK=3;static SIGHASH_INPUT_MASK=128;static ADVANCED_TRANSACTION_MARKER=0;static ADVANCED_TRANSACTION_FLAG=1;static fromBuffer(e,t){let n=new tq(e),r=new nr;r.version=n.readInt32();let i=n.readUInt8(),a=n.readUInt8(),s=!1;i===nr.ADVANCED_TRANSACTION_MARKER&&a===nr.ADVANCED_TRANSACTION_FLAG?s=!0:n.offset-=2;let o=n.readVarInt();for(let e=0;e<o;++e)r.ins.push({hash:n.readSlice(32),index:n.readUInt32(),script:n.readVarSlice(),sequence:n.readUInt32(),witness:t7});let u=n.readVarInt();for(let e=0;e<u;++e)r.outs.push({value:n.readInt64(),script:n.readVarSlice()});if(s){for(let e=0;e<o;++e)r.ins[e].witness=n.readVector();if(!r.hasWitnesses())throw Error("Transaction has superfluous witness data")}if(r.locktime=n.readUInt32(),t)return r;if(n.offset!==e.length)throw Error("Transaction has unexpected data");return r}static fromHex(e){return nr.fromBuffer($(e),!1)}static isCoinbaseHash(e){eL(eQ,e);for(let t=0;t<32;++t)if(0!==e[t])return!1;return!0}version=1;locktime=0;ins=[];outs=[];isCoinbase(){return 1===this.ins.length&&nr.isCoinbaseHash(this.ins[0].hash)}addInput(e,t,n,r){return eL(ek([eQ,eV,eT(eD(eV)),eT(eD(eF))]),[e,t,n,r]),null==n&&(n=nr.DEFAULT_SEQUENCE),this.ins.push({hash:e,index:t,script:r||t9,sequence:n,witness:t7})-1}addOutput(e,t){return eL(ek([eF,e$]),[e,t]),this.outs.push({script:e,value:t})-1}hasWitnesses(){return this.ins.some(e=>0!==e.witness.length)}weight(){return 3*this.byteLength(!1)+this.byteLength(!0)}virtualSize(){return Math.ceil(this.weight()/4)}byteLength(e=!0){let t=e&&this.hasWitnesses();return(t?10:8)+tF(this.ins.length)+tF(this.outs.length)+this.ins.reduce((e,t)=>e+40+t6(t.script),0)+this.outs.reduce((e,t)=>e+8+t6(t.script),0)+(t?this.ins.reduce((e,t)=>{var n;return e+(tF((n=t.witness).length)+n.reduce((e,t)=>e+t6(t),0))},0):0)}clone(){let e=new nr;return e.version=this.version,e.locktime=this.locktime,e.ins=this.ins.map(e=>({hash:e.hash,index:e.index,script:e.script,sequence:e.sequence,witness:e.witness})),e.outs=this.outs.map(e=>({script:e.script,value:e.value})),e}hashForSignature(e,t,n){if(eL(ek([eV,eF,eS()]),[e,t,n]),e>=this.ins.length)return nt;let r=te(tt(t).filter(e=>e!==B.OP_CODESEPARATOR)),i=this.clone();if((31&n)===nr.SIGHASH_NONE)i.outs=[],i.ins.forEach((t,n)=>{n!==e&&(t.sequence=0)});else if((31&n)===nr.SIGHASH_SINGLE){if(e>=this.outs.length)return nt;i.outs.length=e+1;for(let t=0;t<e;t++)i.outs[t]=nn;i.ins.forEach((t,n)=>{n!==e&&(t.sequence=0)})}n&nr.SIGHASH_ANYONECANPAY?(i.ins=[i.ins[e]],i.ins[0].script=r):(i.ins.forEach(e=>{e.script=t9}),i.ins[e].script=r);let a=new Uint8Array(i.byteLength(!1)+4);return en(a,a.length-4,n,"LE"),i.__toBuffer(a,0,!1),tC(a)}hashForWitnessV1(e,t,n,r,i,a){if(eL(ek([eV,eE(eF),eE(e$),eV]),[e,t,n,r]),n.length!==this.ins.length||t.length!==this.ins.length)throw Error("Must supply prevout script and value for all inputs");let s=r===nr.SIGHASH_DEFAULT?nr.SIGHASH_ALL:r&nr.SIGHASH_OUTPUT_MASK,o=(r&nr.SIGHASH_INPUT_MASK)===nr.SIGHASH_ANYONECANPAY,u=s===nr.SIGHASH_NONE,c=s===nr.SIGHASH_SINGLE,l=t9,d=t9,h=t9,f=t9,p=t9;if(!o){let e=t$.withCapacity(36*this.ins.length);this.ins.forEach(t=>{e.writeSlice(t.hash),e.writeUInt32(t.index)}),l=(0,x.sc)(e.end()),e=t$.withCapacity(8*this.ins.length),n.forEach(t=>e.writeInt64(t)),d=(0,x.sc)(e.end()),e=t$.withCapacity(t.map(t6).reduce((e,t)=>e+t)),t.forEach(t=>e.writeVarSlice(t)),h=(0,x.sc)(e.end()),e=t$.withCapacity(4*this.ins.length),this.ins.forEach(t=>e.writeUInt32(t.sequence)),f=(0,x.sc)(e.end())}if(u||c){if(c&&e<this.outs.length){let t=this.outs[e],n=t$.withCapacity(8+t6(t.script));n.writeInt64(t.value),n.writeVarSlice(t.script),p=(0,x.sc)(n.end())}}else{if(!this.outs.length)throw Error("Add outputs to the transaction before signing.");let e=this.outs.map(e=>8+t6(e.script)).reduce((e,t)=>e+t),t=t$.withCapacity(e);this.outs.forEach(e=>{t.writeInt64(e.value),t.writeVarSlice(e.script)}),p=(0,x.sc)(t.end())}let g=2*!!i+ +!!a,y=174-49*!!o-32*!!u+32*!!a+37*!!i,m=t$.withCapacity(y);if(m.writeUInt8(r),m.writeInt32(this.version),m.writeUInt32(this.locktime),m.writeSlice(l),m.writeSlice(d),m.writeSlice(h),m.writeSlice(f),u||c||m.writeSlice(p),m.writeUInt8(g),o){let r=this.ins[e];m.writeSlice(r.hash),m.writeUInt32(r.index),m.writeInt64(n[e]),m.writeVarSlice(t[e]),m.writeUInt32(r.sequence)}else m.writeUInt32(e);if(a){let e=t$.withCapacity(t6(a));e.writeVarSlice(a),m.writeSlice((0,x.sc)(e.end()))}return c&&m.writeSlice(p),i&&(m.writeSlice(i),m.writeUInt8(0),m.writeUInt32(0xffffffff)),tx("TapSighash",K([Uint8Array.from([0]),m.end()]))}hashForWitnessV0(e,t,n,r){let i;eL(ek([eV,eF,e$,eV]),[e,t,n,r]);let a=Uint8Array.from([]),s=ne,o=ne,u=ne;if(r&nr.SIGHASH_ANYONECANPAY||(i=new t$(a=new Uint8Array(36*this.ins.length),0),this.ins.forEach(e=>{i.writeSlice(e.hash),i.writeUInt32(e.index)}),o=tC(a)),r&nr.SIGHASH_ANYONECANPAY||(31&r)===nr.SIGHASH_SINGLE||(31&r)===nr.SIGHASH_NONE||(i=new t$(a=new Uint8Array(4*this.ins.length),0),this.ins.forEach(e=>{i.writeUInt32(e.sequence)}),u=tC(a)),(31&r)!==nr.SIGHASH_SINGLE&&(31&r)!==nr.SIGHASH_NONE)i=new t$(a=new Uint8Array(this.outs.reduce((e,t)=>e+8+t6(t.script),0)),0),this.outs.forEach(e=>{i.writeInt64(e.value),i.writeVarSlice(e.script)}),s=tC(a);else if((31&r)===nr.SIGHASH_SINGLE&&e<this.outs.length){let t=this.outs[e];(i=new t$(a=new Uint8Array(8+t6(t.script)),0)).writeInt64(t.value),i.writeVarSlice(t.script),s=tC(a)}i=new t$(a=new Uint8Array(156+t6(t)),0);let c=this.ins[e];return i.writeInt32(this.version),i.writeSlice(o),i.writeSlice(u),i.writeSlice(c.hash),i.writeUInt32(c.index),i.writeVarSlice(t),i.writeInt64(n),i.writeUInt32(c.sequence),i.writeSlice(s),i.writeUInt32(this.locktime),i.writeUInt32(r),tC(a)}getHash(e){return e&&this.isCoinbase()?new Uint8Array(32):tC(this.__toBuffer(void 0,void 0,e))}getId(){return V(tK(this.getHash(!1)))}toBuffer(e,t){return this.__toBuffer(e,t,!0)}toHex(){return V(this.toBuffer(void 0,void 0))}setInputScript(e,t){eL(ek([eS(),eF]),[e,t]),this.ins[e].script=t}setWitness(e,t){eL(ek([eS(),eE(eF)]),[e,t]),this.ins[e].witness=t}__toBuffer(e,t,n=!1){e||(e=new Uint8Array(this.byteLength(n)));let r=new t$(e,t||0);r.writeInt32(this.version);let i=n&&this.hasWitnesses();return(i&&(r.writeUInt8(nr.ADVANCED_TRANSACTION_MARKER),r.writeUInt8(nr.ADVANCED_TRANSACTION_FLAG)),r.writeVarInt(this.ins.length),this.ins.forEach(e=>{r.writeSlice(e.hash),r.writeUInt32(e.index),r.writeVarSlice(e.script),r.writeUInt32(e.sequence)}),r.writeVarInt(this.outs.length),this.outs.forEach(e=>{void 0!==e.value?r.writeInt64(e.value):r.writeSlice(e.valueBuffer),r.writeVarSlice(e.script)}),i&&this.ins.forEach(e=>{r.writeVector(e.witness)}),r.writeUInt32(this.locktime),void 0!==t)?e.slice(t,r.offset):e}}let ni=TypeError("Cannot compute merkle root for zero transactions"),na=TypeError("Cannot compute witness commit for non-segwit block");class ns{static fromBuffer(e){if(e.length<80)throw Error("Buffer too small (< 80 bytes)");let t=new tq(e),n=new ns;if(n.version=t.readInt32(),n.prevHash=t.readSlice(32),n.merkleRoot=t.readSlice(32),n.timestamp=t.readUInt32(),n.bits=t.readUInt32(),n.nonce=t.readUInt32(),80===e.length)return n;let r=()=>{let e=nr.fromBuffer(t.buffer.slice(t.offset),!0);return t.offset+=e.byteLength(),e},i=t.readVarInt();n.transactions=[];for(let e=0;e<i;++e){let e=r();n.transactions.push(e)}let a=n.getWitnessCommit();return a&&(n.witnessCommit=a),n}static fromHex(e){return ns.fromBuffer($(e))}static calculateTarget(e){let t=((0xff000000&e)>>24)-3,n=8388607&e,r=new Uint8Array(32);return r[29-t]=n>>16&255,r[30-t]=n>>8&255,r[31-t]=255&n,r}static calculateMerkleRoot(e,t){if(eL(eE(eC({getHash:function e(t){return{kind:"schema",type:"function",reference:e,expects:"Function",async:!1,message:t,_run(e,t){return"function"==typeof e.value?e.typed=!0:eu(this,"type",e,t),e}}}()})),e),0===e.length)throw ni;if(t&&!no(e))throw na;let n=function(e,t){if(!Array.isArray(e))throw TypeError("Expected values Array");if("function"!=typeof t)throw TypeError("Expected digest Function");let n=e.length,r=e.concat();for(;n>1;){let e=0;for(let i=0;i<n;i+=2,++e){let a=r[i],s=i+1===n?a:r[i+1],o=K([a,s]);r[e]=t(o)}n=e}return r[0]}(e.map(e=>e.getHash(t)),tC);return t?tC(K([n,e[0].ins[0].witness[0]])):n}version=1;prevHash=void 0;merkleRoot=void 0;timestamp=0;witnessCommit=void 0;bits=0;nonce=0;transactions=void 0;getWitnessCommit(){if(!no(this.transactions))return null;let e=this.transactions[0].outs.filter(e=>0===Z(e.script.slice(0,6),Uint8Array.from([106,36,170,33,169,237]))).map(e=>e.script.slice(6,38));if(0===e.length)return null;let t=e[e.length-1];return t instanceof Uint8Array&&32===t.length?t:null}hasWitnessCommit(){return this.witnessCommit instanceof Uint8Array&&32===this.witnessCommit.length||null!==this.getWitnessCommit()}hasWitness(){var e;return(e=this.transactions)instanceof Array&&e.some(e=>"object"==typeof e&&e.ins instanceof Array&&e.ins.some(e=>"object"==typeof e&&e.witness instanceof Array&&e.witness.length>0))}weight(){return 3*this.byteLength(!1,!1)+this.byteLength(!1,!0)}byteLength(e,t=!0){return e||!this.transactions?80:80+tF(this.transactions.length)+this.transactions.reduce((e,n)=>e+n.byteLength(t),0)}getHash(){return tC(this.toBuffer(!0))}getId(){return V(tK(this.getHash()))}getUTCDate(){let e=new Date(0);return e.setUTCSeconds(this.timestamp),e}toBuffer(e){let t=new Uint8Array(this.byteLength(e)),n=new t$(t);if(n.writeInt32(this.version),n.writeSlice(this.prevHash),n.writeSlice(this.merkleRoot),n.writeUInt32(this.timestamp),n.writeUInt32(this.bits),n.writeUInt32(this.nonce),e||!this.transactions)return t;let{bytes:r}=tY(this.transactions.length,t,n.offset);return n.offset+=r,this.transactions.forEach(e=>{let r=e.byteLength();e.toBuffer(t,n.offset),n.offset+=r}),t}toHex(e){return V(this.toBuffer(e))}checkTxRoots(){let e=this.hasWitnessCommit();return!(!e&&this.hasWitness())&&this.__checkMerkleRoot()&&(!e||this.__checkWitnessCommit())}checkProofOfWork(){return 0>=Z(tK(this.getHash()),ns.calculateTarget(this.bits))}__checkMerkleRoot(){if(!this.transactions)throw ni;let e=ns.calculateMerkleRoot(this.transactions);return 0===Z(this.merkleRoot,e)}__checkWitnessCommit(){if(!this.transactions)throw ni;if(!this.hasWitnessCommit())throw na;let e=ns.calculateMerkleRoot(this.transactions,!0);return 0===Z(this.witnessCommit,e)}}function no(e){return e instanceof Array&&e[0]&&e[0].ins&&e[0].ins instanceof Array&&e[0].ins[0]&&e[0].ins[0].witness&&e[0].ins[0].witness instanceof Array&&e[0].ins[0].witness.length>0}!function(e){e[e.UNSIGNED_TX=0]="UNSIGNED_TX",e[e.GLOBAL_XPUB=1]="GLOBAL_XPUB"}(l||(l={})),function(e){e[e.NON_WITNESS_UTXO=0]="NON_WITNESS_UTXO",e[e.WITNESS_UTXO=1]="WITNESS_UTXO",e[e.PARTIAL_SIG=2]="PARTIAL_SIG",e[e.SIGHASH_TYPE=3]="SIGHASH_TYPE",e[e.REDEEM_SCRIPT=4]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=5]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=6]="BIP32_DERIVATION",e[e.FINAL_SCRIPTSIG=7]="FINAL_SCRIPTSIG",e[e.FINAL_SCRIPTWITNESS=8]="FINAL_SCRIPTWITNESS",e[e.POR_COMMITMENT=9]="POR_COMMITMENT",e[e.TAP_KEY_SIG=19]="TAP_KEY_SIG",e[e.TAP_SCRIPT_SIG=20]="TAP_SCRIPT_SIG",e[e.TAP_LEAF_SCRIPT=21]="TAP_LEAF_SCRIPT",e[e.TAP_BIP32_DERIVATION=22]="TAP_BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=23]="TAP_INTERNAL_KEY",e[e.TAP_MERKLE_ROOT=24]="TAP_MERKLE_ROOT"}(d||(d={})),function(e){e[e.REDEEM_SCRIPT=0]="REDEEM_SCRIPT",e[e.WITNESS_SCRIPT=1]="WITNESS_SCRIPT",e[e.BIP32_DERIVATION=2]="BIP32_DERIVATION",e[e.TAP_INTERNAL_KEY=5]="TAP_INTERNAL_KEY",e[e.TAP_TREE=6]="TAP_TREE",e[e.TAP_BIP32_DERIVATION=7]="TAP_BIP32_DERIVATION"}(h||(h={}));let nu=e=>[...Array(e).keys()];function nc(e){if(e.key[0]!==l.GLOBAL_XPUB)throw Error("Decode Error: could not decode globalXpub with key 0x"+V(e.key));if(79!==e.key.length||![2,3].includes(e.key[46]))throw Error("Decode Error: globalXpub has invalid extended pubkey in key 0x"+V(e.key));if(e.value.length/4%1!=0)throw Error("Decode Error: Global GLOBAL_XPUB value length should be multiple of 4");let t=e.key.slice(1),n={masterFingerprint:e.value.slice(0,4),extendedPubkey:t,path:"m"};for(let t of nu(e.value.length/4-1)){let r=et(e.value,4*t+4,"LE"),i=!!(0x80000000&r),a=0x7fffffff&r;n.path+="/"+a.toString(10)+(i?"'":"")}return n}function nl(e){let t=K([new Uint8Array([l.GLOBAL_XPUB]),e.extendedPubkey]),n=e.path.split("/"),r=new Uint8Array(4*n.length);r.set(e.masterFingerprint,0);let i=4;return n.slice(1).forEach(e=>{let t="'"===e.slice(-1),n=0x7fffffff&parseInt(t?e.slice(0,-1):e,10);t&&(n+=0x80000000),J(r,i,n,"LE"),i+=4}),{key:t,value:r}}let nd="{ masterFingerprint: Uint8Array; extendedPubkey: Uint8Array; path: string; }";function nh(e){let t=e.extendedPubkey,n=e.masterFingerprint,r=e.path;return t instanceof Uint8Array&&78===t.length&&[2,3].indexOf(t[45])>-1&&n instanceof Uint8Array&&4===n.length&&"string"==typeof r&&!!r.match(/^m(\/\d+'?)*$/)}function nf(e,t,n){let r=V(t.extendedPubkey);return!n.has(r)&&(n.add(r),0===e.filter(e=>Z(e.extendedPubkey,t.extendedPubkey)).length)}function np(e){return{key:new Uint8Array([l.UNSIGNED_TX]),value:e.toBuffer()}}function ng(e){if(e.key[0]!==d.FINAL_SCRIPTSIG)throw Error("Decode Error: could not decode finalScriptSig with key 0x"+V(e.key));return e.value}function ny(e){return{key:new Uint8Array([d.FINAL_SCRIPTSIG]),value:e}}let nm="Uint8Array";function nw(e){return e instanceof Uint8Array}function nI(e,t){return!!e&&!!t&&void 0===e.finalScriptSig}function nM(e){if(e.key[0]!==d.FINAL_SCRIPTWITNESS)throw Error("Decode Error: could not decode finalScriptWitness with key 0x"+V(e.key));return e.value}function nE(e){return{key:new Uint8Array([d.FINAL_SCRIPTWITNESS]),value:e}}let nv="Uint8Array";function nb(e){return e instanceof Uint8Array}function nT(e,t){return!!e&&!!t&&void 0===e.finalScriptWitness}function nN(e){if(e.key[0]!==d.NON_WITNESS_UTXO)throw Error("Decode Error: could not decode nonWitnessUtxo with key 0x"+V(e.key));return e.value}function nA(e){return{key:new Uint8Array([d.NON_WITNESS_UTXO]),value:e}}let nS="Uint8Array";function nC(e){return e instanceof Uint8Array}function nD(e,t){return!!e&&!!t&&void 0===e.nonWitnessUtxo}function nx(e){if(e.key[0]!==d.PARTIAL_SIG)throw Error("Decode Error: could not decode partialSig with key 0x"+V(e.key));if(34!==e.key.length&&66!==e.key.length||![2,3,4].includes(e.key[1]))throw Error("Decode Error: partialSig has invalid pubkey in key 0x"+V(e.key));return{pubkey:e.key.slice(1),signature:e.value}}function nk(e){return{key:K([new Uint8Array([d.PARTIAL_SIG]),e.pubkey]),value:e.signature}}let nO="{ pubkey: Uint8Array; signature: Uint8Array; }";function nj(e){return e.pubkey instanceof Uint8Array&&e.signature instanceof Uint8Array&&[33,65].includes(e.pubkey.length)&&[2,3,4].includes(e.pubkey[0])&&function(e){if(!(e instanceof Uint8Array)||e.length<9||48!==e[0]||e.length!==e[1]+3||2!==e[2])return!1;let t=e[3];if(t>33||t<1||2!==e[3+t+1])return!1;let n=e[3+t+2];return!(n>33)&&!(n<1)&&e.length===3+t+2+n+2}(e.signature)}function nL(e,t,n){let r=V(t.pubkey);return!n.has(r)&&(n.add(r),0===e.filter(e=>0===Z(e.pubkey,t.pubkey)).length)}function nP(e){var t;if(e.key[0]!==d.POR_COMMITMENT)throw Error("Decode Error: could not decode porCommitment with key 0x"+V(e.key));return t=e.value,F.decode(t)}function n_(e){return{key:new Uint8Array([d.POR_COMMITMENT]),value:Q.encode(e)}}let nU="string";function nz(e){return"string"==typeof e}function nR(e,t){return!!e&&!!t&&void 0===e.porCommitment}function nB(e){if(e.key[0]!==d.SIGHASH_TYPE)throw Error("Decode Error: could not decode sighashType with key 0x"+V(e.key));return Number(et(e.value,0,"LE"))}function nH(e){let t=Uint8Array.from([d.SIGHASH_TYPE]),n=new Uint8Array(4);return J(n,0,e,"LE"),{key:t,value:n}}let nW="number";function nG(e){return"number"==typeof e}function nY(e,t){return!!e&&!!t&&void 0===e.sighashType}function nQ(e){if(e.key[0]!==d.TAP_KEY_SIG||1!==e.key.length)throw Error("Decode Error: could not decode tapKeySig with key 0x"+V(e.key));if(!nV(e.value))throw Error("Decode Error: tapKeySig not a valid 64-65-byte BIP340 signature");return e.value}function nF(e){return{key:Uint8Array.from([d.TAP_KEY_SIG]),value:e}}let nK="Uint8Array";function nV(e){return e instanceof Uint8Array&&(64===e.length||65===e.length)}function n$(e,t){return!!e&&!!t&&void 0===e.tapKeySig}function nq(e){if(e.key[0]!==d.TAP_LEAF_SCRIPT)throw Error("Decode Error: could not decode tapLeafScript with key 0x"+V(e.key));if((e.key.length-2)%32!=0)throw Error("Decode Error: tapLeafScript has invalid control block in key 0x"+V(e.key));let t=e.value[e.value.length-1];if((254&e.key[1])!==t)throw Error("Decode Error: tapLeafScript bad leaf version in key 0x"+V(e.key));let n=e.value.slice(0,-1);return{controlBlock:e.key.slice(1),script:n,leafVersion:t}}function nZ(e){let t=Uint8Array.from([d.TAP_LEAF_SCRIPT]),n=Uint8Array.from([e.leafVersion]);return{key:K([t,e.controlBlock]),value:K([e.script,n])}}let nX="{ controlBlock: Uint8Array; leafVersion: number, script: Uint8Array; }";function nJ(e){return e.controlBlock instanceof Uint8Array&&(e.controlBlock.length-1)%32==0&&(254&e.controlBlock[0])===e.leafVersion&&e.script instanceof Uint8Array}function n0(e,t,n){let r=V(t.controlBlock);return!n.has(r)&&(n.add(r),0===e.filter(e=>0===Z(e.controlBlock,t.controlBlock)).length)}function n1(e){if(e.key[0]!==d.TAP_MERKLE_ROOT||1!==e.key.length)throw Error("Decode Error: could not decode tapMerkleRoot with key 0x"+V(e.key));if(!n3(e.value))throw Error("Decode Error: tapMerkleRoot not a 32-byte hash");return e.value}function n2(e){return{key:Uint8Array.from([d.TAP_MERKLE_ROOT]),value:e}}let n4="Uint8Array";function n3(e){return e instanceof Uint8Array&&32===e.length}function n5(e,t){return!!e&&!!t&&void 0===e.tapMerkleRoot}function n8(e){if(e.key[0]!==d.TAP_SCRIPT_SIG)throw Error("Decode Error: could not decode tapScriptSig with key 0x"+V(e.key));if(65!==e.key.length)throw Error("Decode Error: tapScriptSig has invalid key 0x"+V(e.key));if(64!==e.value.length&&65!==e.value.length)throw Error("Decode Error: tapScriptSig has invalid signature in key 0x"+V(e.key));return{pubkey:e.key.slice(1,33),leafHash:e.key.slice(33),signature:e.value}}function n6(e){return{key:K([Uint8Array.from([d.TAP_SCRIPT_SIG]),e.pubkey,e.leafHash]),value:e.signature}}let n9="{ pubkey: Uint8Array; leafHash: Uint8Array; signature: Uint8Array; }";function n7(e){return e.pubkey instanceof Uint8Array&&e.leafHash instanceof Uint8Array&&e.signature instanceof Uint8Array&&32===e.pubkey.length&&32===e.leafHash.length&&(64===e.signature.length||65===e.signature.length)}function re(e,t,n){let r=V(t.pubkey)+V(t.leafHash);return!n.has(r)&&(n.add(r),0===e.filter(e=>0===Z(e.pubkey,t.pubkey)&&0===Z(e.leafHash,t.leafHash)).length)}function rt(e){if(e.key[0]!==d.WITNESS_UTXO)throw Error("Decode Error: could not decode witnessUtxo with key 0x"+V(e.key));let t=ei(e.value,0,"LE"),n=8,{numberValue:r,bytes:i}=tQ(e.value,n);n+=i;let a=e.value.slice(n);if(a.length!==r)throw Error("Decode Error: WITNESS_UTXO script is not proper length");return{script:a,value:t}}function rn(e){let{script:t,value:n}=e,r=tF(t.length),i=new Uint8Array(8+r+t.length);return er(i,0,BigInt(n),"LE"),tY(t.length,i,8),i.set(t,8+r),{key:Uint8Array.from([d.WITNESS_UTXO]),value:i}}let rr="{ script: Uint8Array; value: bigint; }";function ri(e){return e.script instanceof Uint8Array&&"bigint"==typeof e.value}function ra(e,t){return!!e&&!!t&&void 0===e.witnessUtxo}function rs(e){if(e.key[0]!==h.TAP_TREE||1!==e.key.length)throw Error("Decode Error: could not decode tapTree with key 0x"+V(e.key));let t=0,n=[];for(;t<e.value.length;){let r=e.value[t++],i=e.value[t++],{numberValue:a,bytes:s}=tQ(e.value,t);t+=s,n.push({depth:r,leafVersion:i,script:e.value.slice(t,t+a)}),t+=a}return{leaves:n}}function ro(e){return{key:Uint8Array.from([h.TAP_TREE]),value:K([].concat(...e.leaves.map(e=>[Uint8Array.of(e.depth,e.leafVersion),tY(BigInt(e.script.length)).buffer,e.script])))}}let ru="{ leaves: [{ depth: number; leafVersion: number, script: Uint8Array; }] }";function rc(e){return Array.isArray(e.leaves)&&e.leaves.every(e=>e.depth>=0&&e.depth<=128&&(254&e.leafVersion)===e.leafVersion&&e.script instanceof Uint8Array)}function rl(e,t){return!!e&&!!t&&void 0===e.tapTree}let rd=e=>[...Array(e).keys()],rh=e=>33===e.length&&[2,3].includes(e[0])||65===e.length&&4===e[0];function rf(e,t=rh){return{decode:function(n){if(n.key[0]!==e)throw Error("Decode Error: could not decode bip32Derivation with key 0x"+V(n.key));let r=n.key.slice(1);if(!t(r))throw Error("Decode Error: bip32Derivation has invalid pubkey in key 0x"+V(n.key));if(n.value.length/4%1!=0)throw Error("Decode Error: Input BIP32_DERIVATION value length should be multiple of 4");let i={masterFingerprint:n.value.slice(0,4),pubkey:r,path:"m"};for(let e of rd(n.value.length/4-1)){let t=et(n.value,4*e+4,"LE"),r=!!(0x80000000&t),a=0x7fffffff&t;i.path+="/"+a.toString(10)+(r?"'":"")}return i},encode:function(t){let n=K([Uint8Array.from([e]),t.pubkey]),r=t.path.split("/"),i=new Uint8Array(4*r.length);i.set(t.masterFingerprint,0);let a=4;return r.slice(1).forEach(e=>{let t="'"===e.slice(-1),n=0x7fffffff&parseInt(t?e.slice(0,-1):e,10);t&&(n+=0x80000000),J(i,a,n,"LE"),a+=4}),{key:n,value:i}},check:function(e){return e.pubkey instanceof Uint8Array&&e.masterFingerprint instanceof Uint8Array&&"string"==typeof e.path&&t(e.pubkey)&&4===e.masterFingerprint.length},expected:"{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; }",canAddToArray:function(e,t,n){let r=V(t.pubkey);return!n.has(r)&&(n.add(r),0===e.filter(e=>0===Z(e.pubkey,t.pubkey)).length)}}}function rp(e){return function(t){let n;if(e.includes(t.key[0])&&(33!==(n=t.key.slice(1)).length&&65!==n.length||![2,3,4].includes(n[0])))throw Error("Format Error: invalid pubkey in key 0x"+V(t.key));return n}}function rg(e){return{decode:function(t){if(t.key[0]!==e)throw Error("Decode Error: could not decode redeemScript with key 0x"+V(t.key));return t.value},encode:function(t){return{key:Uint8Array.from([e]),value:t}},check:function(e){return e instanceof Uint8Array},expected:"Uint8Array",canAdd:function(e,t){return!!e&&!!t&&void 0===e.redeemScript}}}let ry=e=>32===e.length;function rm(e){let t=rf(e,ry);return{decode:function(e){let{numberValue:n,bytes:r}=tQ(e.value),i=t.decode({key:e.key,value:e.value.slice(r+32*Number(n))}),a=Array(Number(n));for(let t=0,i=r;t<n;t++,i+=32)a[t]=e.value.slice(i,i+32);return{...i,leafHashes:a}},encode:function(e){let n=t.encode(e),r=new Uint8Array(tF(e.leafHashes.length));tY(e.leafHashes.length,r);let i=K([r,...e.leafHashes,n.value]);return{...n,value:i}},check:function(e){return Array.isArray(e.leafHashes)&&e.leafHashes.every(e=>e instanceof Uint8Array&&32===e.length)&&t.check(e)},expected:"{ masterFingerprint: Uint8Array; pubkey: Uint8Array; path: string; leafHashes: Uint8Array[]; }",canAddToArray:t.canAddToArray}}function rw(e){return{decode:function(t){if(t.key[0]!==e||1!==t.key.length)throw Error("Decode Error: could not decode tapInternalKey with key 0x"+V(t.key));if(32!==t.value.length)throw Error("Decode Error: tapInternalKey not a 32-byte x-only pubkey");return t.value},encode:function(t){return{key:Uint8Array.from([e]),value:t}},check:function(e){return e instanceof Uint8Array&&32===e.length},expected:"Uint8Array",canAdd:function(e,t){return!!e&&!!t&&void 0===e.tapInternalKey}}}function rI(e){return{decode:function(t){if(t.key[0]!==e)throw Error("Decode Error: could not decode witnessScript with key 0x"+V(t.key));return t.value},encode:function(t){return{key:Uint8Array.from([e]),value:t}},check:function(e){return e instanceof Uint8Array},expected:"Uint8Array",canAdd:function(e,t){return!!e&&!!t&&void 0===e.witnessScript}}}let rM={unsignedTx:y,globalXpub:g,checkPubkey:rp([])},rE={nonWitnessUtxo:I,partialSig:M,sighashType:v,finalScriptSig:m,finalScriptWitness:w,porCommitment:E,witnessUtxo:S,bip32Derivation:rf(d.BIP32_DERIVATION),redeemScript:rg(d.REDEEM_SCRIPT),witnessScript:rI(d.WITNESS_SCRIPT),checkPubkey:rp([d.PARTIAL_SIG,d.BIP32_DERIVATION]),tapKeySig:b,tapScriptSig:A,tapLeafScript:T,tapBip32Derivation:rm(d.TAP_BIP32_DERIVATION),tapInternalKey:rw(d.TAP_INTERNAL_KEY),tapMerkleRoot:N},rv={bip32Derivation:rf(h.BIP32_DERIVATION),redeemScript:rg(h.REDEEM_SCRIPT),witnessScript:rI(h.WITNESS_SCRIPT),checkPubkey:rp([h.BIP32_DERIVATION]),tapBip32Derivation:rm(h.TAP_BIP32_DERIVATION),tapTree:C,tapInternalKey:rw(h.TAP_INTERNAL_KEY)},rb=e=>[...Array(e).keys()];function rT(e){let t=e.map(rN);return t.push(Uint8Array.from([0])),K(t)}function rN(e){let t=e.key.length,n=e.value.length,r=tF(t),i=tF(n),a=new Uint8Array(r+t+i+n);return tY(t,a,0),a.set(e.key,r),tY(n,a,r+t),a.set(e.value,r+t+i),a}function rA(e,t,n){if(Z(t,Uint8Array.from([n])))throw Error(`Format Error: Invalid ${e} key: ${V(t)}`)}function rS(e,{globalMapKeyVals:t,inputKeyVals:n,outputKeyVals:r}){let i={unsignedTx:e},a=0;for(let e of t)switch(e.key[0]){case l.UNSIGNED_TX:if(rA("global",e.key,l.UNSIGNED_TX),a>0)throw Error("Format Error: GlobalMap has multiple UNSIGNED_TX");a++;break;case l.GLOBAL_XPUB:void 0===i.globalXpub&&(i.globalXpub=[]),i.globalXpub.push(rM.globalXpub.decode(e));break;default:i.unknownKeyVals||(i.unknownKeyVals=[]),i.unknownKeyVals.push(e)}let s=n.length,o=r.length,u=[],c=[];for(let e of rb(s)){let t={};for(let r of n[e])switch(rE.checkPubkey(r),r.key[0]){case d.NON_WITNESS_UTXO:if(rA("input",r.key,d.NON_WITNESS_UTXO),void 0!==t.nonWitnessUtxo)throw Error("Format Error: Input has multiple NON_WITNESS_UTXO");t.nonWitnessUtxo=rE.nonWitnessUtxo.decode(r);break;case d.WITNESS_UTXO:if(rA("input",r.key,d.WITNESS_UTXO),void 0!==t.witnessUtxo)throw Error("Format Error: Input has multiple WITNESS_UTXO");t.witnessUtxo=rE.witnessUtxo.decode(r);break;case d.PARTIAL_SIG:void 0===t.partialSig&&(t.partialSig=[]),t.partialSig.push(rE.partialSig.decode(r));break;case d.SIGHASH_TYPE:if(rA("input",r.key,d.SIGHASH_TYPE),void 0!==t.sighashType)throw Error("Format Error: Input has multiple SIGHASH_TYPE");t.sighashType=rE.sighashType.decode(r);break;case d.REDEEM_SCRIPT:if(rA("input",r.key,d.REDEEM_SCRIPT),void 0!==t.redeemScript)throw Error("Format Error: Input has multiple REDEEM_SCRIPT");t.redeemScript=rE.redeemScript.decode(r);break;case d.WITNESS_SCRIPT:if(rA("input",r.key,d.WITNESS_SCRIPT),void 0!==t.witnessScript)throw Error("Format Error: Input has multiple WITNESS_SCRIPT");t.witnessScript=rE.witnessScript.decode(r);break;case d.BIP32_DERIVATION:void 0===t.bip32Derivation&&(t.bip32Derivation=[]),t.bip32Derivation.push(rE.bip32Derivation.decode(r));break;case d.FINAL_SCRIPTSIG:rA("input",r.key,d.FINAL_SCRIPTSIG),t.finalScriptSig=rE.finalScriptSig.decode(r);break;case d.FINAL_SCRIPTWITNESS:rA("input",r.key,d.FINAL_SCRIPTWITNESS),t.finalScriptWitness=rE.finalScriptWitness.decode(r);break;case d.POR_COMMITMENT:rA("input",r.key,d.POR_COMMITMENT),t.porCommitment=rE.porCommitment.decode(r);break;case d.TAP_KEY_SIG:rA("input",r.key,d.TAP_KEY_SIG),t.tapKeySig=rE.tapKeySig.decode(r);break;case d.TAP_SCRIPT_SIG:void 0===t.tapScriptSig&&(t.tapScriptSig=[]),t.tapScriptSig.push(rE.tapScriptSig.decode(r));break;case d.TAP_LEAF_SCRIPT:void 0===t.tapLeafScript&&(t.tapLeafScript=[]),t.tapLeafScript.push(rE.tapLeafScript.decode(r));break;case d.TAP_BIP32_DERIVATION:void 0===t.tapBip32Derivation&&(t.tapBip32Derivation=[]),t.tapBip32Derivation.push(rE.tapBip32Derivation.decode(r));break;case d.TAP_INTERNAL_KEY:rA("input",r.key,d.TAP_INTERNAL_KEY),t.tapInternalKey=rE.tapInternalKey.decode(r);break;case d.TAP_MERKLE_ROOT:rA("input",r.key,d.TAP_MERKLE_ROOT),t.tapMerkleRoot=rE.tapMerkleRoot.decode(r);break;default:t.unknownKeyVals||(t.unknownKeyVals=[]),t.unknownKeyVals.push(r)}u.push(t)}for(let e of rb(o)){let t={};for(let n of r[e])switch(rv.checkPubkey(n),n.key[0]){case h.REDEEM_SCRIPT:if(rA("output",n.key,h.REDEEM_SCRIPT),void 0!==t.redeemScript)throw Error("Format Error: Output has multiple REDEEM_SCRIPT");t.redeemScript=rv.redeemScript.decode(n);break;case h.WITNESS_SCRIPT:if(rA("output",n.key,h.WITNESS_SCRIPT),void 0!==t.witnessScript)throw Error("Format Error: Output has multiple WITNESS_SCRIPT");t.witnessScript=rv.witnessScript.decode(n);break;case h.BIP32_DERIVATION:void 0===t.bip32Derivation&&(t.bip32Derivation=[]),t.bip32Derivation.push(rv.bip32Derivation.decode(n));break;case h.TAP_INTERNAL_KEY:rA("output",n.key,h.TAP_INTERNAL_KEY),t.tapInternalKey=rv.tapInternalKey.decode(n);break;case h.TAP_TREE:rA("output",n.key,h.TAP_TREE),t.tapTree=rv.tapTree.decode(n);break;case h.TAP_BIP32_DERIVATION:void 0===t.tapBip32Derivation&&(t.tapBip32Derivation=[]),t.tapBip32Derivation.push(rv.tapBip32Derivation.decode(n));break;default:t.unknownKeyVals||(t.unknownKeyVals=[]),t.unknownKeyVals.push(n)}c.push(t)}return{globalMap:i,inputs:u,outputs:c}}let rC=(e,t)=>Z(e.key,t.key);function rD(e,t){let n=new Set,r=Object.entries(e).reduce((e,[r,i])=>{if("unknownKeyVals"===r)return e;let a=t[r];if(void 0===a)return e;let s=(Array.isArray(i)?i:[i]).map(a.encode);return s.map(e=>V(e.key)).forEach(e=>{if(n.has(e))throw Error("Serialize Error: Duplicate key: "+e);n.add(e)}),e.concat(s)},[]),i=e.unknownKeyVals?e.unknownKeyVals.filter(e=>!n.has(V(e.key))):[];return r.concat(i).sort(rC)}function rx({globalMap:e,inputs:t,outputs:n}){return{globalKeyVals:rD(e,rM),inputKeyVals:t.map(e=>rD(e,rE)),outputKeyVals:n.map(e=>rD(e,rv))}}function rk(e,t,n){return r=>{if(e.has(r))return;let i=n.filter(e=>V(e.key)===r)[0];t.push(i),e.add(r)}}function rO(e){return e.globalMap.unsignedTx}function rj(e){let t=new Set;return e.forEach(e=>{let n=V(e.key);if(t.has(n))throw Error("Combine: KeyValue Map keys should be unique");t.add(n)}),t}function rL(e,t){let n=e[t];if(void 0===n)throw Error(`No input #${t}`);return n}function rP(e,t){let n=e[t];if(void 0===n)throw Error(`No output #${t}`);return n}function r_(e,t,n){if(e.key[0]<n)throw Error("Use the method for your specific key instead of addUnknownKeyVal*");if(t&&0!==t.filter(t=>0===Z(t.key,e.key)).length)throw Error(`Duplicate Key: ${V(e.key)}`)}function rU(e){let t=0;return Object.keys(e).forEach(e=>{Number(isNaN(Number(e)))&&t++}),t}function rz(e,t,n,r){throw Error(`Data for ${e} key ${t} is incorrect: Expected ${n} and got ${JSON.stringify(r)}`)}function rR(e){return(t,n)=>{for(let r of Object.keys(t)){let i=t[r],{canAdd:a,canAddToArray:s,check:o,expected:u}=D[e+"s"][r]||{},c=!!s;if(o)if(c){if(!Array.isArray(i)||n[r]&&!Array.isArray(n[r]))throw Error(`Key type ${r} must be an array`);i.every(o)||rz(e,r,u,i);let t=n[r]||[],a=new Set;if(!i.every(e=>s(t,e,a)))throw Error("Can not add duplicate data to array");n[r]=t.concat(i)}else{if(o(i)||rz(e,r,u,i),!a(n,i))throw Error(`Can not add duplicate data to ${e}`);n[r]=i}}}}let rB=rR("global"),rH=rR("input"),rW=rR("output");class rG{constructor(e){this.inputs=[],this.outputs=[],this.globalMap={unsignedTx:e}}static fromBase64(e,t){let n=q(e);return this.fromBuffer(n,t)}static fromHex(e,t){let n=$(e);return this.fromBuffer(n,t)}static fromBuffer(e,t){let n=function(e,t){let n=0;function r(){let{numberValue:t,bytes:r}=tQ(e,n);n+=r;let i=e.slice(n,n+Number(t));return n+=Number(t),i}function i(){return{key:r(),value:r()}}function a(){if(n>=e.length)throw Error("Format Error: Unexpected End of PSBT");let t=0===ee(e,n);return t&&n++,t}if(0x70736274!==function(){let t=et(e,n,"BE");return n+=4,t}())throw Error("Format Error: Invalid Magic Number");if(255!==function(){let t=ee(e,n);return n+=1,t}())throw Error("Format Error: Magic Number must be followed by 0xff separator");let s=[],o={};for(;!a();){let e=i(),t=V(e.key);if(o[t])throw Error("Format Error: Keys must be unique for global keymap: key "+t);o[t]=1,s.push(e)}let u=s.filter(e=>e.key[0]===l.UNSIGNED_TX);if(1!==u.length)throw Error("Format Error: Only one UNSIGNED_TX allowed");let c=t(u[0].value),{inputCount:d,outputCount:h}=c.getInputOutputCounts(),f=[],p=[];for(let e of rb(d)){let t={},n=[];for(;!a();){let r=i(),a=V(r.key);if(t[a])throw Error("Format Error: Keys must be unique for each input: input index "+e+" key "+a);t[a]=1,n.push(r)}f.push(n)}for(let e of rb(h)){let t={},n=[];for(;!a();){let r=i(),a=V(r.key);if(t[a])throw Error("Format Error: Keys must be unique for each output: output index "+e+" key "+a);t[a]=1,n.push(r)}p.push(n)}return rS(c,{globalMapKeyVals:s,inputKeyVals:f,outputKeyVals:p})}(e,t),r=new this(n.globalMap.unsignedTx);return Object.assign(r,n),r}toBase64(){return btoa(String.fromCharCode(...this.toBuffer()))}toHex(){return V(this.toBuffer())}toBuffer(){return function({globalMap:e,inputs:t,outputs:n}){let{globalKeyVals:r,inputKeyVals:i,outputKeyVals:a}=rx({globalMap:e,inputs:t,outputs:n}),s=rT(r),o=e=>0===e.length?[Uint8Array.from([0])]:e.map(rT),u=o(i),c=o(a),l=new Uint8Array(5);return l.set([112,115,98,116,255],0),K([l,s].concat(u,c))}(this)}updateGlobal(e){return rB(e,this.globalMap),this}updateInput(e,t){return rH(t,rL(this.inputs,e)),this}updateOutput(e,t){return rW(t,rP(this.outputs,e)),this}addUnknownKeyValToGlobal(e){return r_(e,this.globalMap.unknownKeyVals,rU(l)),this.globalMap.unknownKeyVals||(this.globalMap.unknownKeyVals=[]),this.globalMap.unknownKeyVals.push(e),this}addUnknownKeyValToInput(e,t){let n=rL(this.inputs,e);return r_(t,n.unknownKeyVals,rU(d)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(t),this}addUnknownKeyValToOutput(e,t){let n=rP(this.outputs,e);return r_(t,n.unknownKeyVals,rU(h)),n.unknownKeyVals||(n.unknownKeyVals=[]),n.unknownKeyVals.push(t),this}addInput(e){this.globalMap.unsignedTx.addInput(e),this.inputs.push({unknownKeyVals:[]});let t=e.unknownKeyVals||[],n=this.inputs.length-1;if(!Array.isArray(t))throw Error("unknownKeyVals must be an Array");t.forEach(e=>this.addUnknownKeyValToInput(n,e));var r=this.inputs;let i=r.length-1;return rH(e,rL(r,i)),this}addOutput(e){this.globalMap.unsignedTx.addOutput(e),this.outputs.push({unknownKeyVals:[]});let t=e.unknownKeyVals||[],n=this.outputs.length-1;if(!Array.isArray(t))throw Error("unknownKeyVals must be an Array");t.forEach(e=>this.addUnknownKeyValToOutput(n,e));var r=this.outputs;let i=r.length-1;return rW(e,rP(r,i)),this}clearFinalizedInput(e){let t=rL(this.inputs,e);for(let n of(!function(e,t){let n=!1;if(t.nonWitnessUtxo||t.witnessUtxo){let e=!!t.redeemScript,r=!!t.witnessScript,i=!e||!!t.finalScriptSig,a=!r||!!t.finalScriptWitness,s=!!t.finalScriptSig||!!t.finalScriptWitness;n=i&&a&&s}if(!1===n)throw Error(`Input #${e} has too much or too little data to clean`)}(e,t),Object.keys(t)))["witnessUtxo","nonWitnessUtxo","finalScriptSig","finalScriptWitness","unknownKeyVals"].includes(n)||delete t[n];return this}combine(...e){return Object.assign(this,function(e){let t=e[0],n=rx(t),r=e.slice(1);if(0===r.length)throw Error("Combine: Nothing to combine");let i=rO(t);if(void 0===i)throw Error("Combine: Self missing transaction");let a=rj(n.globalKeyVals),s=n.inputKeyVals.map(rj),o=n.outputKeyVals.map(rj);for(let e of r){let t=rO(e);if(void 0===t||0!==Z(t.toBuffer(),i.toBuffer()))throw Error("Combine: One of the Psbts does not have the same transaction.");let r=rx(e);rj(r.globalKeyVals).forEach(rk(a,n.globalKeyVals,r.globalKeyVals)),r.inputKeyVals.map(rj).forEach((e,t)=>e.forEach(rk(s[t],n.inputKeyVals[t],r.inputKeyVals[t]))),r.outputKeyVals.map(rj).forEach((e,t)=>e.forEach(rk(o[t],n.outputKeyVals[t],r.outputKeyVals[t])))}return rS(i,{globalMapKeyVals:n.globalKeyVals,inputKeyVals:n.inputKeyVals,outputKeyVals:n.outputKeyVals})}([this].concat(e))),this}getTransaction(){return this.globalMap.unsignedTx.toBuffer()}}function rY(e){return t=>{try{return e({output:t}),!0}catch(e){return!1}}}let rQ=rY(to),rF=rY(tu),rK=rY(tO),rV=rY(tP),r$=rY(tz),rq=rY(tj),rZ=rY(t4);function rX(e){let t=new Uint8Array(0);function n(e){let n=t.length,r=tF(e);tY(e,t=K([t,new Uint8Array(r)]),n)}return n(e.length),e.forEach(function(e){n(e.length),t=K([t,e])}),t}function rJ(e,t){let n=tS(e),r=e.slice(1,33),i=tt(t);if(null===i)throw Error("Unknown script error");return i.findIndex(t=>"number"!=typeof t&&(0===Z(e,t)||0===Z(n,t)||0===Z(r,t)))}function r0(e,t){return -1!==rJ(e,t)}function r1(e,t,n){let{hashType:r}=t(e),i=[];switch(r&nr.SIGHASH_ANYONECANPAY&&i.push("addInput"),31&r){case nr.SIGHASH_ALL:break;case nr.SIGHASH_SINGLE:case nr.SIGHASH_NONE:i.push("addOutput"),i.push("setInputSequence")}return -1===i.indexOf(n)}let r2=e=>32===e.length?e:e.slice(1,33);function r4(e,t,n){let r=function(e,t,n){if(!e.tapScriptSig||!e.tapScriptSig.length)throw Error(`Can not finalize taproot input #${t}. No tapleaf script signature provided.`);let r=(e.tapLeafScript||[]).sort((e,t)=>e.controlBlock.length-t.controlBlock.length).find(t=>(function(e,t,n){let r=t0({output:e.script,version:e.leafVersion});return(!n||0===Z(r,n))&&void 0!==t.find(e=>0===Z(e.leafHash,r))})(t,e.tapScriptSig,n));if(!r)throw Error(`Can not finalize taproot input #${t}. Signature for tapleaf script not found.`);return r}(t,e,n);try{let e=(function(e,t){let n=t0({output:t.script,version:t.leafVersion});return(e.tapScriptSig||[]).filter(e=>0===Z(e.leafHash,n)).map(e=>{var n,r;return n=t.script,r=e,Object.assign({positionInScript:rJ(r.pubkey,n)},r)}).sort((e,t)=>t.positionInScript-e.positionInScript).map(e=>e.signature)})(t,r).concat(r.script).concat(r.controlBlock);return{finalScriptWitness:rX(e)}}catch(t){throw Error(`Can not finalize taproot input #${e}: ${t}`)}}function r3(e,t){return K([e,t?Uint8Array.from([t]):Uint8Array.from([])])}function r5(e){return e&&!!(e.tapInternalKey||e.tapMerkleRoot||e.tapLeafScript&&e.tapLeafScript.length||e.tapBip32Derivation&&e.tapBip32Derivation.length||e.witnessUtxo&&rZ(e.witnessUtxo.script))}function r8(e,t){return e&&!!(e.tapInternalKey||e.tapTree||e.tapBip32Derivation&&e.tapBip32Derivation.length||t&&rZ(t))}function r6(e,t,n){(function(e,t,n){let r=r5(e)&&ir(t),i=ir(e)&&r5(t),a=e===t&&r5(t)&&ir(t);if(r||i||a)throw Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)})(e,t,n),function(e,t,n){if(t.tapMerkleRoot){let r=(t.tapLeafScript||[]).every(e=>it(e,t.tapMerkleRoot)),i=(e.tapLeafScript||[]).every(e=>it(e,t.tapMerkleRoot));if(!r||!i)throw Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}else if(e.tapMerkleRoot&&!(t.tapLeafScript||[]).every(t=>it(t,e.tapMerkleRoot)))throw Error(`Invalid arguments for Psbt.${n}. Tapleaf not part of taptree.`)}(e,t,n)}function r9(e,t){if(!t.tapTree&&!t.tapInternalKey)return;let n=t.tapInternalKey||e.tapInternalKey,r=t.tapTree||e.tapTree;if(n){let{script:t}=e,i=function(e,t){let{output:n}=t4({internalPubkey:e,scriptTree:t&&function(e=[]){return 1===e.length&&0===e[0].depth?{output:e[0].script,version:e[0].leafVersion}:function(e){let t;for(let n of e)if(!(t=function e(t,n,r=0){if(r>128)throw Error("Max taptree depth exceeded.");if(t.depth===r)return n?void 0:{output:t.script,version:t.leafVersion};if(eW(n))return;let i=e(t,n&&n[0],r+1);if(i)return[i,n&&n[1]];let a=e(t,n&&n[1],r+1);if(a)return[n&&n[0],a]}(n,t)))throw Error("No room left to insert tapleaf in tree");return t}(e)}(t.leaves)});return n}(n,r);if(t&&0!==Z(i,t))throw Error("Error adding output. Script or address mismatch.")}}function r7(e){return{signature:e.slice(0,64),hashType:e.slice(64)[0]||nr.SIGHASH_DEFAULT}}function ie(e,t,n){let r=r8(e)&&ir(t),i=ir(e)&&r8(t),a=e===t&&r8(t)&&ir(t);if(r||i||a)throw Error(`Invalid arguments for Psbt.${n}. Cannot use both taproot and non-taproot fields.`)}function it(e,t){if(!t)return!0;let n=t0({output:e.script,version:e.leafVersion});return 0===Z(tX(e.controlBlock,n),t)}function ir(e){return e&&!!(e.redeemScript||e.witnessScript||e.bip32Derivation&&e.bip32Derivation.length)}let ii={network:R,maximumFeeRate:5e3};class ia{data;static fromBase64(e,t={}){let n=q(e);return this.fromBuffer(n,t)}static fromHex(e,t={}){let n=$(e);return this.fromBuffer(n,t)}static fromBuffer(e,t={}){var n,r;let i=new ia(t,rG.fromBuffer(e,is));return n=i.__CACHE.__TX,r=i.__CACHE,n.ins.forEach(e=>{iy(r,e)}),i}__CACHE;opts;constructor(e={},t=new rG(new io)){this.data=t,this.opts=Object.assign({},ii,e),this.__CACHE={__NON_WITNESS_UTXO_TX_CACHE:[],__NON_WITNESS_UTXO_BUF_CACHE:[],__TX_IN_CACHE:{},__TX:this.data.globalMap.unsignedTx.tx,__UNSAFE_SIGN_NONSEGWIT:!1},0===this.data.inputs.length&&this.setVersion(2);let n=(e,t,n,r)=>Object.defineProperty(e,t,{enumerable:n,writable:r});n(this,"__CACHE",!1,!0),n(this,"opts",!1,!0)}get inputCount(){return this.data.inputs.length}get version(){return this.__CACHE.__TX.version}set version(e){this.setVersion(e)}get locktime(){return this.__CACHE.__TX.locktime}set locktime(e){this.setLocktime(e)}get txInputs(){return this.__CACHE.__TX.ins.map(e=>({hash:tV(e.hash),index:e.index,sequence:e.sequence}))}get txOutputs(){return this.__CACHE.__TX.outs.map(e=>{let t;try{t=t8(e.script,this.opts.network)}catch(e){}return{script:tV(e.script),value:e.value,address:t}})}combine(...e){return this.data.combine(...e.map(e=>e.data)),this}clone(){let e=ia.fromBuffer(this.data.toBuffer());return e.opts=JSON.parse(JSON.stringify(this.opts)),e}setMaximumFeeRate(e){ih(e),this.opts.maximumFeeRate=e}setVersion(e){ih(e),ip(this.data.inputs,"setVersion");let t=this.__CACHE;return t.__TX.version=e,t.__EXTRACTED_TX=void 0,this}setLocktime(e){ih(e),ip(this.data.inputs,"setLocktime");let t=this.__CACHE;return t.__TX.locktime=e,t.__EXTRACTED_TX=void 0,this}setInputSequence(e,t){ih(t),ip(this.data.inputs,"setInputSequence");let n=this.__CACHE;if(n.__TX.ins.length<=e)throw Error("Input index too high");return n.__TX.ins[e].sequence=t,n.__EXTRACTED_TX=void 0,this}addInputs(e){return e.forEach(e=>this.addInput(e)),this}addInput(e){if(arguments.length>1||!e||void 0===e.hash||void 0===e.index)throw Error("Invalid arguments for Psbt.addInput. Requires single object with at least [hash] and [index]");r6(e,e,"addInput"),ip(this.data.inputs,"addInput"),e.witnessScript&&iU(e.witnessScript);let t=this.__CACHE;this.data.addInput(e);let n=t.__TX.ins[t.__TX.ins.length-1];iy(t,n);let r=this.data.inputs.length-1,i=this.data.inputs[r];return i.nonWitnessUtxo&&ix(this.__CACHE,i,r),t.__FEE=void 0,t.__FEE_RATE=void 0,t.__EXTRACTED_TX=void 0,this}addOutputs(e){return e.forEach(e=>this.addOutput(e)),this}addOutput(e){var t,n;if(arguments.length>1||!e||void 0===e.value||void 0===e.address&&void 0===e.script)throw Error("Invalid arguments for Psbt.addOutput. Requires single object with at least [script or address] and [value]");ip(this.data.inputs,"addOutput");let{address:r}=e;if("string"==typeof r){let{network:t}=this.opts,n=function(e,t){let n,r;t=t||R;try{n=function(e){let t=tk.decode(e);if(t.length<21)throw TypeError(e+" is too short");if(t.length>21)throw TypeError(e+" is too long");return{version:ee(t,0),hash:t.slice(1)}}(e)}catch(e){}if(n){if(n.version===t.pubKeyHash)return tO({hash:n.hash}).output;if(n.version===t.scriptHash)return tj({hash:n.hash}).output}else{try{r=t5(e)}catch(e){}if(r){if(r.prefix!==t.bech32)throw Error(e+" has an invalid prefix");if(0===r.version){if(20===r.data.length)return tP({hash:r.data}).output;if(32===r.data.length)return tz({hash:r.data}).output}else if(1===r.version){if(32===r.data.length)return t4({pubkey:r.data}).output}else if(r.version>=2&&r.version<=16&&r.data.length>=2&&r.data.length<=40)return console.warn(t3),te([r.version+80,r.data])}}throw Error(e+" has no matching Script")}(r,t);e=Object.assign({},e,{script:n})}ie(t=e,n=e,"addOutput"),r9(t,n);let i=this.__CACHE;return this.data.addOutput(e),i.__FEE=void 0,i.__FEE_RATE=void 0,i.__EXTRACTED_TX=void 0,this}extractTransaction(e){if(!this.data.inputs.every(il))throw Error("Not finalized");let t=this.__CACHE;if(e||function(e,t,n){let r=t.__FEE_RATE||e.getFeeRate(),i=t.__EXTRACTED_TX.virtualSize();if(r>=n.maximumFeeRate)throw Error(`Warning: You are paying around ${(r*i/1e8).toFixed(8)} in fees, which is ${r} satoshi per byte for a transaction with a VSize of ${i} bytes (segwit counted as 0.25 byte per byte). Use setMaximumFeeRate method to raise your threshold, or pass true to the first arg of extractTransaction.`)}(this,t,this.opts),t.__EXTRACTED_TX)return t.__EXTRACTED_TX;let n=t.__TX.clone();return ik(this.data.inputs,n,t,!0),n}getFeeRate(){return iM("__FEE_RATE","fee rate",this.data.inputs,this.__CACHE)}getFee(){return iM("__FEE","fee",this.data.inputs,this.__CACHE)}finalizeAllInputs(){return rL(this.data.inputs,0),iR(this.data.inputs.length).forEach(e=>this.finalizeInput(e)),this}finalizeInput(e,t){let n=rL(this.data.inputs,e);return r5(n)?this._finalizeTaprootInput(e,n,void 0,t):this._finalizeInput(e,n,t)}finalizeTaprootInput(e,t,n=r4){let r=rL(this.data.inputs,e);if(r5(r))return this._finalizeTaprootInput(e,r,t,n);throw Error(`Cannot finalize input #${e}. Not Taproot.`)}_finalizeInput(e,t,n=iE){let{script:r,isP2SH:i,isP2WSH:a,isSegwit:s}=function(e,t,n){let r=n.__TX,i={script:null,isSegwit:!1,isP2SH:!1,isP2WSH:!1};if(i.isP2SH=!!t.redeemScript,i.isP2WSH=!!t.witnessScript,t.witnessScript)i.script=t.witnessScript;else if(t.redeemScript)i.script=t.redeemScript;else if(t.nonWitnessUtxo){let a=iO(n,t,e),s=r.ins[e].index;i.script=a.outs[s].script}else t.witnessUtxo&&(i.script=t.witnessUtxo.script);return(t.witnessScript||rV(i.script))&&(i.isSegwit=!0),i}(e,t,this.__CACHE);if(!r)throw Error(`No script found for input #${e}`);!function(e){if(!e.sighashType||!e.partialSig)return;let{partialSig:t,sighashType:n}=e;t.forEach(e=>{let{hashType:t}=p.decode(e.signature);if(n!==t)throw Error("Signature sighash does not match input sighash type")})}(t);let{finalScriptSig:o,finalScriptWitness:u}=n(e,t,r,s,i,a);if(o&&this.data.updateInput(e,{finalScriptSig:o}),u&&this.data.updateInput(e,{finalScriptWitness:u}),!o&&!u)throw Error(`Unknown error finalizing input #${e}`);return this.data.clearFinalizedInput(e),this}_finalizeTaprootInput(e,t,n,r=r4){if(!t.witnessUtxo)throw Error(`Cannot finalize input #${e}. Missing withness utxo.`);if(t.tapKeySig){let n=rX(t4({output:t.witnessUtxo.script,signature:t.tapKeySig}).witness);this.data.updateInput(e,{finalScriptWitness:n})}else{let{finalScriptWitness:i}=r(e,t,n);this.data.updateInput(e,{finalScriptWitness:i})}return this.data.clearFinalizedInput(e),this}getInputType(e){let t=rL(this.data.inputs,e),n=i_(ij(e,t,this.__CACHE),e,"input",t.redeemScript||function(e){if(!e)return;let t=tt(e);if(!t)return;let n=t[t.length-1];if(!(!(n instanceof Uint8Array)||iP(n)||tr(n))&&tt(n))return n}(t.finalScriptSig),t.witnessScript||function(e){if(!e)return;let t=iD(e),n=t[t.length-1];if(!iP(n)&&tt(n))return n}(t.finalScriptWitness));return("raw"===n.type?"":n.type+"-")+iz(n.meaningfulScript)}inputHasPubkey(e,t){return function(e,t,n,r){let{meaningfulScript:i}=i_(ij(n,t,r),n,"input",t.redeemScript,t.witnessScript);return r0(e,i)}(t,rL(this.data.inputs,e),e,this.__CACHE)}inputHasHDKey(e,t){let n=rL(this.data.inputs,e),r=id(t);return!!n.bip32Derivation&&n.bip32Derivation.some(r)}outputHasPubkey(e,t){return function(e,t,n,r){let{meaningfulScript:i}=i_(r.__TX.outs[n].script,n,"output",t.redeemScript,t.witnessScript);return r0(e,i)}(t,rP(this.data.outputs,e),e,this.__CACHE)}outputHasHDKey(e,t){let n=rP(this.data.outputs,e),r=id(t);return!!n.bip32Derivation&&n.bip32Derivation.some(r)}validateSignaturesOfAllInputs(e){return rL(this.data.inputs,0),iR(this.data.inputs.length).map(t=>this.validateSignaturesOfInput(t,e)).reduce((e,t)=>!0===t&&e,!0)}validateSignaturesOfInput(e,t,n){return r5(this.data.inputs[e])?this.validateSignaturesOfTaprootInput(e,t,n):this._validateSignaturesOfInput(e,t,n)}_validateSignaturesOfInput(e,t,n){let r,i,a,s=this.data.inputs[e],o=(s||{}).partialSig;if(!s||!o||o.length<1)throw Error("No signatures to validate");if("function"!=typeof t)throw Error("Need validator function to validate signatures");let u=n?o.filter(e=>0===Z(e.pubkey,n)):o;if(u.length<1)throw Error("No signatures for this pubkey");let c=[];for(let n of u){let o=p.decode(n.signature),{hash:u,script:l}=a!==o.hashType?ib(e,Object.assign({},s,{sighashType:o.hashType}),this.__CACHE,!0):{hash:r,script:i};a=o.hashType,r=u,i=l,ig(n.pubkey,l,"verify"),c.push(t(n.pubkey,u,o.signature))}return c.every(e=>!0===e)}validateSignaturesOfTaprootInput(e,t,n){let r=this.data.inputs[e],i=(r||{}).tapKeySig,a=(r||{}).tapScriptSig;if(!r&&!i&&!(a&&!a.length))throw Error("No signatures to validate");if("function"!=typeof t)throw Error("Need validator function to validate signatures");let s=(n=n&&r2(n))?iA(e,r,this.data.inputs,n,this.__CACHE):function(e,t,n,r){let i=[];if(t.tapInternalKey){let n=iT(e,t,r);n&&i.push(n)}if(t.tapScriptSig){let e=t.tapScriptSig.map(e=>e.pubkey);i.push(...e)}return i.map(i=>iA(e,t,n,i,r)).flat()}(e,r,this.data.inputs,this.__CACHE);if(!s.length)throw Error("No signatures for this pubkey");let o=s.find(e=>!e.leafHash),u=0;if(i&&o){if(!t(o.pubkey,o.hash,iN(i)))return!1;u++}if(a)for(let e of a){let n=s.find(t=>0===Z(t.pubkey,e.pubkey));if(n){if(!t(e.pubkey,n.hash,iN(e.signature)))return!1;u++}}return u>0}signAllInputsHD(e,t=[nr.SIGHASH_ALL]){if(!e||!e.publicKey||!e.fingerprint)throw Error("Need HDSigner to sign input");let n=[];for(let r of iR(this.data.inputs.length))try{this.signInputHD(r,e,t),n.push(!0)}catch(e){n.push(!1)}if(n.every(e=>!1===e))throw Error("No inputs were signed");return this}signAllInputsHDAsync(e,t=[nr.SIGHASH_ALL]){return new Promise((n,r)=>{if(!e||!e.publicKey||!e.fingerprint)return r(Error("Need HDSigner to sign input"));let i=[],a=[];for(let n of iR(this.data.inputs.length))a.push(this.signInputHDAsync(n,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(a).then(()=>{if(i.every(e=>!1===e))return r(Error("No inputs were signed"));n()})})}signInputHD(e,t,n=[nr.SIGHASH_ALL]){if(!t||!t.publicKey||!t.fingerprint)throw Error("Need HDSigner to sign input");return iC(e,this.data.inputs,t).forEach(t=>this.signInput(e,t,n)),this}signInputHDAsync(e,t,n=[nr.SIGHASH_ALL]){return new Promise((r,i)=>t&&t.publicKey&&t.fingerprint?Promise.all(iC(e,this.data.inputs,t).map(t=>this.signInputAsync(e,t,n))).then(()=>{r()}).catch(i):i(Error("Need HDSigner to sign input")))}signAllInputs(e,t){if(!e||!e.publicKey)throw Error("Need Signer to sign input");let n=[];for(let r of iR(this.data.inputs.length))try{this.signInput(r,e,t),n.push(!0)}catch(e){n.push(!1)}if(n.every(e=>!1===e))throw Error("No inputs were signed");return this}signAllInputsAsync(e,t){return new Promise((n,r)=>{if(!e||!e.publicKey)return r(Error("Need Signer to sign input"));let i=[],a=[];for(let[n]of this.data.inputs.entries())a.push(this.signInputAsync(n,e,t).then(()=>{i.push(!0)},()=>{i.push(!1)}));return Promise.all(a).then(()=>{if(i.every(e=>!1===e))return r(Error("No inputs were signed"));n()})})}signInput(e,t,n){if(!t||!t.publicKey)throw Error("Need Signer to sign input");let r=rL(this.data.inputs,e);return r5(r)?this._signTaprootInput(e,r,t,void 0,n):this._signInput(e,t,n)}signTaprootInput(e,t,n,r){if(!t||!t.publicKey)throw Error("Need Signer to sign input");let i=rL(this.data.inputs,e);if(r5(i))return this._signTaprootInput(e,i,t,n,r);throw Error(`Input #${e} is not of type Taproot.`)}_signInput(e,t,n=[nr.SIGHASH_ALL]){let{hash:r,sighashType:i}=iv(this.data.inputs,e,t.publicKey,this.__CACHE,n),a=[{pubkey:t.publicKey,signature:p.encode(t.sign(r),i)}];return this.data.updateInput(e,{partialSig:a}),this}_signTaprootInput(e,t,n,r,i=[nr.SIGHASH_DEFAULT]){let a=this.checkTaprootHashesForSig(e,t,n,r,i),s=a.filter(e=>!e.leafHash).map(e=>r3(n.signSchnorr(e.hash),t.sighashType))[0],o=a.filter(e=>!!e.leafHash).map(e=>({pubkey:r2(n.publicKey),signature:r3(n.signSchnorr(e.hash),t.sighashType),leafHash:e.leafHash}));return s&&this.data.updateInput(e,{tapKeySig:s}),o.length&&this.data.updateInput(e,{tapScriptSig:o}),this}signInputAsync(e,t,n){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw Error("Need Signer to sign input");let r=rL(this.data.inputs,e);return r5(r)?this._signTaprootInputAsync(e,r,t,void 0,n):this._signInputAsync(e,t,n)})}signTaprootInputAsync(e,t,n,r){return Promise.resolve().then(()=>{if(!t||!t.publicKey)throw Error("Need Signer to sign input");let i=rL(this.data.inputs,e);if(r5(i))return this._signTaprootInputAsync(e,i,t,n,r);throw Error(`Input #${e} is not of type Taproot.`)})}_signInputAsync(e,t,n=[nr.SIGHASH_ALL]){let{hash:r,sighashType:i}=iv(this.data.inputs,e,t.publicKey,this.__CACHE,n);return Promise.resolve(t.sign(r)).then(n=>{let r=[{pubkey:t.publicKey,signature:p.encode(n,i)}];this.data.updateInput(e,{partialSig:r})})}async _signTaprootInputAsync(e,t,n,r,i=[nr.SIGHASH_DEFAULT]){let a=this.checkTaprootHashesForSig(e,t,n,r,i),s=[],o=a.filter(e=>!e.leafHash)[0];if(o){let e=Promise.resolve(n.signSchnorr(o.hash)).then(e=>({tapKeySig:r3(e,t.sighashType)}));s.push(e)}let u=a.filter(e=>!!e.leafHash);if(u.length){let e=u.map(e=>Promise.resolve(n.signSchnorr(e.hash)).then(r=>({tapScriptSig:[{pubkey:r2(n.publicKey),signature:r3(r,t.sighashType),leafHash:e.leafHash}]})));s.push(...e)}return Promise.all(s).then(t=>{t.forEach(t=>this.data.updateInput(e,t))})}checkTaprootHashesForSig(e,t,n,r,i){if("function"!=typeof n.signSchnorr)throw Error(`Need Schnorr Signer to sign taproot input #${e}.`);let a=iA(e,t,this.data.inputs,n.publicKey,this.__CACHE,r,i);if(!a||!a.length)throw Error(`Can not sign for input #${e} with the key ${V(n.publicKey)}`);return a}toBuffer(){return iu(this.__CACHE),this.data.toBuffer()}toHex(){return iu(this.__CACHE),this.data.toHex()}toBase64(){return iu(this.__CACHE),this.data.toBase64()}updateGlobal(e){return this.data.updateGlobal(e),this}updateInput(e,t){return t.witnessScript&&iU(t.witnessScript),r6(this.data.inputs[e],t,"updateInput"),this.data.updateInput(e,t),t.nonWitnessUtxo&&ix(this.__CACHE,this.data.inputs[e],e),this}updateOutput(e,t){var n,r;return r="updateOutput",ie(n=this.data.outputs[e],t,r),r9(n,t),this.data.updateOutput(e,t),this}addUnknownKeyValToGlobal(e){return this.data.addUnknownKeyValToGlobal(e),this}addUnknownKeyValToInput(e,t){return this.data.addUnknownKeyValToInput(e,t),this}addUnknownKeyValToOutput(e,t){return this.data.addUnknownKeyValToOutput(e,t),this}clearFinalizedInput(e){return this.data.clearFinalizedInput(e),this}}let is=e=>new io(e);class io{tx;constructor(e=Uint8Array.from([2,0,0,0,0,0,0,0,0,0])){this.tx=nr.fromBuffer(e),function(e){if(!e.ins.every(e=>e.script&&0===e.script.length&&e.witness&&0===e.witness.length))throw Error("Format Error: Transaction ScriptSigs are not empty")}(this.tx),Object.defineProperty(this,"tx",{enumerable:!1,writable:!0})}getInputOutputCounts(){return{inputCount:this.tx.ins.length,outputCount:this.tx.outs.length}}addInput(e){if(void 0===e.hash||void 0===e.index||!(e.hash instanceof Uint8Array)&&"string"!=typeof e.hash||"number"!=typeof e.index)throw Error("Error adding input.");let t="string"==typeof e.hash?tK($(e.hash)):e.hash;this.tx.addInput(t,e.index,e.sequence)}addOutput(e){if(void 0===e.script||void 0===e.value||!(e.script instanceof Uint8Array)||"bigint"!=typeof e.value)throw Error("Error adding output.");this.tx.addOutput(e.script,e.value)}toBuffer(){return this.tx.toBuffer()}}function iu(e){if(!1!==e.__UNSAFE_SIGN_NONSEGWIT)throw Error("Not BIP174 compliant, can not export")}function ic(e,t,n){let r;if(!t)return!1;if((r=n?n.map(e=>{let n=function(e){if(65===e.length){let t=1&e[64],n=e.slice(0,33);return n[0]=2|t,n}return e.slice()}(e);return t.find(e=>0===Z(e.pubkey,n))}).filter(e=>!!e):t).length>e)throw Error("Too many signatures");return r.length===e}function il(e){return!!e.finalScriptSig||!!e.finalScriptWitness}function id(e){return t=>!(Z(e.fingerprint,t.masterFingerprint)||Z(e.derivePath(t.path).publicKey,t.pubkey))}function ih(e){if("number"!=typeof e||e!==Math.floor(e)||e>0xffffffff||e<0)throw Error("Invalid 32 bit integer")}function ip(e,t){e.forEach(e=>{if(r5(e)?(function(e){let t=[];if(e.tapKeySig&&t.push(e.tapKeySig),e.tapScriptSig&&t.push(...e.tapScriptSig.map(e=>e.signature)),!t.length){let n=function(e){if(!e)return;let t=e.slice(2);if(64===t.length||65===t.length)return t}(e.finalScriptWitness);n&&t.push(n)}return t})(e).some(e=>r1(e,r7,t)):(function(e){let t=[];if(0===(e.partialSig||[]).length){if(!e.finalScriptSig&&!e.finalScriptWitness)return[];t=function(e){let t=e.finalScriptSig&&tt(e.finalScriptSig)||[],n=e.finalScriptWitness&&tt(e.finalScriptWitness)||[];return t.concat(n).filter(e=>e instanceof Uint8Array&&tr(e)).map(e=>({signature:e}))}(e)}else t=e.partialSig;return t.map(e=>e.signature)})(e).some(e=>r1(e,p.decode,t)))throw Error("Can not modify transaction, signatures exist.")})}function ig(e,t,n){if(!r0(e,t))throw Error(`Can not ${n} for this input with the key ${V(e)}`)}function iy(e,t){let n=V(tK(Uint8Array.from(t.hash)))+":"+t.index;if(e.__TX_IN_CACHE[n])throw Error("Duplicate input detected.");e.__TX_IN_CACHE[n]=1}function im(e,t){return(n,r,i,a)=>{if(Z(r,e({redeem:{output:i}}).output))throw Error(`${t} for ${a} #${n} doesn't match the scriptPubKey in the prevout`)}}let iw=im(tj,"Redeem script"),iI=im(tz,"Witness script");function iM(e,t,n,r){let i;if(!n.every(il))throw Error(`PSBT must be finalized to calculate ${t}`);if("__FEE_RATE"===e&&r.__FEE_RATE)return r.__FEE_RATE;if("__FEE"===e&&r.__FEE)return r.__FEE;let a=!0;return(r.__EXTRACTED_TX?(i=r.__EXTRACTED_TX,a=!1):i=r.__TX.clone(),ik(n,i,r,a),"__FEE_RATE"===e)?r.__FEE_RATE:"__FEE"===e?r.__FEE:void 0}function iE(e,t,n,r,i,a){let s=iz(n);if(!function(e,t,n){switch(n){case"pubkey":case"pubkeyhash":case"witnesspubkeyhash":return ic(1,e.partialSig);case"multisig":let r=to({output:t});return ic(r.m,e.partialSig,r.pubkeys);default:return!1}}(t,n,s))throw Error(`Can not finalize input #${e}`);return function(e,t,n,r,i,a){let s,o,u=function(e,t,n){let r;switch(t){case"multisig":var i,a;let s=(i=e,a=n,to({output:i}).pubkeys.map(e=>(a.filter(t=>0===Z(t.pubkey,e))[0]||{}).signature).filter(e=>!!e));r=to({output:e,signatures:s});break;case"pubkey":r=tu({output:e,signature:n[0].signature});break;case"pubkeyhash":r=tO({output:e,pubkey:n[0].pubkey,signature:n[0].signature});break;case"witnesspubkeyhash":r=tP({output:e,pubkey:n[0].pubkey,signature:n[0].signature})}return r}(e,t,n),c=a?tz({redeem:u}):null,l=i?tj({redeem:c||u}):null;return r?(o=c?rX(c.witness):rX(u.witness),l&&(s=l.input)):s=l?l.input:u.input,{finalScriptSig:s,finalScriptWitness:o}}(n,s,t.partialSig,r,i,a)}function iv(e,t,n,r,i){let a=rL(e,t),{hash:s,sighashType:o,script:u}=ib(t,a,r,!1,i);return ig(n,u,"sign"),{hash:s,sighashType:o}}function ib(e,t,n,r,i){let a,s,o=n.__TX,u=t.sighashType||nr.SIGHASH_ALL;if(iS(u,i),t.nonWitnessUtxo){let r=iO(n,t,e);if(0!==Z(o.ins[e].hash,r.getHash()))throw Error(`Non-witness UTXO hash for input #${e} doesn't match the hash specified in the prevout`);let i=o.ins[e].index;s=r.outs[i]}else if(t.witnessUtxo)s=t.witnessUtxo;else throw Error("Need a Utxo input item for signing");let{meaningfulScript:c,type:l}=i_(s.script,e,"input",t.redeemScript,t.witnessScript);if(["p2sh-p2wsh","p2wsh"].indexOf(l)>=0)a=o.hashForWitnessV0(e,c,s.value,u);else if(rV(c)){let t=tO({hash:c.slice(2)}).output;a=o.hashForWitnessV0(e,t,s.value,u)}else{if(void 0===t.nonWitnessUtxo&&!1===n.__UNSAFE_SIGN_NONSEGWIT)throw Error(`Input #${e} has witnessUtxo but non-segwit script: ${V(c)}`);r||!1===n.__UNSAFE_SIGN_NONSEGWIT||console.warn("Warning: Signing non-segwit inputs without the full parent transaction means there is a chance that a miner could feed you incorrect information to trick you into paying large fees. This behavior is the same as Psbt's predecessor (TransactionBuilder - now removed) when signing non-segwit scripts. You are not able to export this Psbt with toBuffer|toBase64|toHex since it is not BIP174 compliant.\n*********************\nPROCEED WITH CAUTION!\n*********************"),a=o.hashForSignature(e,c,u)}return{script:c,sighashType:u,hash:a}}function iT(e,t,n){let{script:r}=iL(e,t,n);return rZ(r)?r.subarray(2,34):null}function iN(e){return 64===e.length?e:e.subarray(0,64)}function iA(e,t,n,r,i,a,s){let o=i.__TX,u=t.sighashType||nr.SIGHASH_DEFAULT;iS(u,s);let c=n.map((e,t)=>iL(t,e,i)),l=c.map(e=>e.script),d=c.map(e=>e.value),h=[];if(t.tapInternalKey&&!a){let n=iT(e,t,i)||Uint8Array.from([]);if(0===Z(r2(r),n)){let t=o.hashForWitnessV1(e,l,d,u);h.push({pubkey:r,hash:t})}}let f=(t.tapLeafScript||[]).filter(e=>r0(r,e.script)).map(e=>Object.assign({hash:t0({output:e.script,version:e.leafVersion})},e)).filter(e=>!a||0===Z(a,e.hash)).map(t=>({pubkey:r,hash:o.hashForWitnessV1(e,l,d,u,t.hash),leafHash:t.hash}));return h.concat(f)}function iS(e,t){if(t&&0>t.indexOf(e)){let t=function(e){let t=e&nr.SIGHASH_ANYONECANPAY?"SIGHASH_ANYONECANPAY | ":"";switch(31&e){case nr.SIGHASH_ALL:t+="SIGHASH_ALL";break;case nr.SIGHASH_SINGLE:t+="SIGHASH_SINGLE";break;case nr.SIGHASH_NONE:t+="SIGHASH_NONE"}return t}(e);throw Error(`Sighash type is not allowed. Retry the sign method passing the sighashTypes array of whitelisted types. Sighash type: ${t}`)}}function iC(e,t,n){let r=rL(t,e);if(!r.bip32Derivation||0===r.bip32Derivation.length)throw Error("Need bip32Derivation to sign with HD");let i=r.bip32Derivation.map(e=>0===Z(e.masterFingerprint,n.fingerprint)?e:void 0).filter(e=>!!e);if(0===i.length)throw Error("Need one bip32Derivation masterFingerprint to match the HDSigner fingerprint");return i.map(e=>{let t=n.derivePath(e.path);if(0!==Z(e.pubkey,t.publicKey))throw Error("pubkey did not match bip32Derivation");return t})}function iD(e){let t=0;function n(){let n=tQ(e,t);return t+=tF(n.bigintValue),n.numberValue}let r=n(),i=[];for(let a=0;a<r;a++)i.push(function(){var r;return r=n(),t+=r,e.slice(t-r,t)}());return i}function ix(e,t,n){e.__NON_WITNESS_UTXO_BUF_CACHE[n]=t.nonWitnessUtxo;let r=nr.fromBuffer(t.nonWitnessUtxo);e.__NON_WITNESS_UTXO_TX_CACHE[n]=r,delete t.nonWitnessUtxo,Object.defineProperty(t,"nonWitnessUtxo",{enumerable:!0,get(){let t=e.__NON_WITNESS_UTXO_BUF_CACHE[n],r=e.__NON_WITNESS_UTXO_TX_CACHE[n];if(void 0!==t)return t;{let t=r.toBuffer();return e.__NON_WITNESS_UTXO_BUF_CACHE[n]=t,t}},set(t){e.__NON_WITNESS_UTXO_BUF_CACHE[n]=t}})}function ik(e,t,n,r){let i=0n;e.forEach((e,a)=>{if(r&&e.finalScriptSig&&(t.ins[a].script=e.finalScriptSig),r&&e.finalScriptWitness&&(t.ins[a].witness=iD(e.finalScriptWitness)),e.witnessUtxo)i+=e.witnessUtxo.value;else if(e.nonWitnessUtxo){let r=iO(n,e,a),s=t.ins[a].index,o=r.outs[s];i+=o.value}});let a=t.outs.reduce((e,t)=>e+t.value,0n),s=i-a;if(s<0)throw Error("Outputs are spending more than Inputs");let o=t.virtualSize();n.__FEE=s,n.__EXTRACTED_TX=t,n.__FEE_RATE=Math.floor(Number(s/BigInt(o)))}function iO(e,t,n){let r=e.__NON_WITNESS_UTXO_TX_CACHE;return r[n]||ix(e,t,n),r[n]}function ij(e,t,n){let{script:r}=iL(e,t,n);return r}function iL(e,t,n){if(void 0!==t.witnessUtxo)return{script:t.witnessUtxo.script,value:t.witnessUtxo.value};if(void 0!==t.nonWitnessUtxo){let r=iO(n,t,e).outs[n.__TX.ins[e].index];return{script:r.script,value:r.value}}throw Error("Can't find pubkey in input without Utxo data")}function iP(e){return 33===e.length&&eH(e)}function i_(e,t,n,r,i){let a,s=rq(e),o=s&&r&&r$(r),u=r$(e);if(s&&void 0===r)throw Error("scriptPubkey is P2SH but redeemScript missing");if((u||o)&&void 0===i)throw Error("scriptPubkey or redeemScript is P2WSH but witnessScript missing");return o?(a=i,iw(t,e,r,n),iI(t,r,i,n),iU(a)):u?(a=i,iI(t,e,i,n),iU(a)):s?(a=r,iw(t,e,r,n)):a=e,{meaningfulScript:a,type:o?"p2sh-p2wsh":s?"p2sh":u?"p2wsh":"raw"}}function iU(e){if(rV(e)||rq(e))throw Error("P2WPKH or P2SH can not be contained within P2WSH")}function iz(e){return rV(e)?"witnesspubkeyhash":rK(e)?"pubkeyhash":rQ(e)?"multisig":rF(e)?"pubkey":"nonstandard"}function iR(e){return[...Array(e).keys()]}let iB="0.3.1",iH={version:`bigmi@${iB}`};class iW extends Error{constructor(e,t={}){let n=t.cause instanceof iW?t.cause.details:t.cause?.message?t.cause.message:t.details;super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...n?[`Details: ${n}`]:[],...iH.version?[`Version: ${iH.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),this.name="BaseError",this.details=n,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=iB}walk(e){return function e(t,n){return n?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,n):n?null:t}(this,e)}}class iG extends iW{constructor({blockHash:e,blockNumber:t,blockTag:n,hash:r,index:i}){let a="Transaction";n&&void 0!==i&&(a=`Transaction at block time "${n}" at index "${i}"`),e&&void 0!==i&&(a=`Transaction at block hash "${e}" at index "${i}"`),t&&void 0!==i&&(a=`Transaction at block number "${t}" at index "${i}"`),r&&(a=`Transaction with hash "${r}"`),super(`${a} could not be found.`,{name:"TransactionNotFoundError"})}}class iY extends iW{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class iQ extends iW{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}function iF(e,t,n){let r=e[t.name];if("function"==typeof r)return r;let i=e[n];return"function"==typeof i?i:n=>t(e,n)}let iK=new Map,iV=new Map,i$=0;function iq(e,t,n){let r=++i$,i=()=>iK.get(e)||[],a=()=>{let t=i();iK.set(e,t.filter(e=>e.id!==r))},s=()=>{let t=iV.get(e);1===i().length&&t&&t(),a()},o=i();if(iK.set(e,[...o,{id:r,fns:t}]),o&&o.length>0)return s;let u={};for(let e in t)u[e]=(...t)=>{let n=i();if(0!==n.length)for(let r of n)r.fns[e]?.(...t)};let c=n(u);return"function"==typeof c&&iV.set(e,c),s}let iZ=(e,t,n)=>JSON.stringify(e,(e,n)=>{let r="bigint"==typeof n?n.toString():n;return"function"==typeof t?t(e,r):r},n);async function iX(e){return new Promise(t=>setTimeout(t,e))}function iJ(e,{delay:t=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((i,a)=>{let s=async({count:o=0}={})=>{let u=async({error:e})=>{let n="function"==typeof t?t({count:o,error:e}):t;n&&await iX(n),s({count:o+1})};try{let t=await e();i(t)}catch(e){if(o<n&&await r({count:o,error:e}))return u({error:e});a(e)}};s()})}class i0 extends iW{constructor({blockHash:e,blockNumber:t}){let n="Block";e&&(n=`Block at hash "${e}"`),t&&(n=`Block at number "${t}"`),super(`${n} could not be found.`,{name:"BlockNotFoundError"})}}async function i1(e,{blockHash:t,blockNumber:n}){let r;try{let i=t;!i&&n&&(i=await e.request({method:"getblockhash",params:[n]},{dedupe:!0})),i&&(r=await e.request({method:"getblock",params:[i,0]},{dedupe:!0}))}catch(e){throw new i0({blockHash:t,blockNumber:n})}if(!r)throw new i0({blockHash:t,blockNumber:n});return ns.fromHex(r)}async function i2(e,{blockHash:t,blockNumber:n,stats:r}){let i=t||n;if(!i)throw new i0({blockHash:t,blockNumber:n});try{let t=[i];return r&&t.push(r),await e.request({method:"getblockstats",params:t},{dedupe:!0})}catch(e){throw new i0({blockHash:t,blockNumber:n})}}async function i4(e,{txId:t,blockHash:n}){try{let r=[t,!0];return n&&r.push(n),await e.request({method:"getrawtransaction",params:r})}catch(e){throw new iG({blockHash:n,hash:t})}}function i3(e){return new Promise(t=>{setTimeout(()=>t(null),e)})}async function i5(e){return await e.request({method:"getblockcount",params:[]},{dedupe:!0})}function i8(e,{emitOnBegin:t=!1,emitMissed:n=!1,onBlockNumber:r,onError:i,pollingInterval:a=e.pollingInterval}){let s;return iq(iZ(["watchBlockNumber",e.uid,t,n,a]),{onBlockNumber:r,onError:i},r=>(function(e,{emitOnBegin:t,initialWaitTime:n,interval:r}){let i=!0,a=()=>{i=!1};return(async()=>{let s;t&&(s=await e({unpoll:a}));let o=await n?.(s)??r;await i3(o);let u=async()=>{i&&(await e({unpoll:a}),await i3(r),u())};u()})(),a})(async()=>{try{let t=await iF(e,i5,"getBlockCount")({cacheTime:0});if(s){if(t===s)return;if(t-s>1&&n)for(let e=s+1;e<t;e++)await r.onBlockNumber(e,s),s=e}(!s||t>s)&&(await r.onBlockNumber(t,s),s=t)}catch(e){r.onError?.(e)}},{emitOnBegin:t,interval:a}))}async function i6(e,{confirmations:t=1,txId:n,txHex:r,senderAddress:i,onReplaced:a,pollingInterval:s=e.pollingInterval,retryCount:o=10,retryDelay:u=3e3,timeout:c}){let l,d,h=iZ(["waitForTransaction",e.uid,n]),f=0,p=!1;return new Promise((g,y)=>{c&&setTimeout(()=>y(new iQ({hash:n})),c);let m=iq(h,{onReplaced:a,resolve:g,reject:y},a=>{let c=iF(e,i8,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,pollingInterval:s,async onBlockNumber(s){let h=e=>{c(),e(),m()},g=s;if(!p){f>o&&h(()=>a.reject(new iQ({hash:n})));try{if(l?.blockhash){let n=await iF(e,i2,"getBlockStats")({blockHash:l.blockhash,stats:["height"]});if(t>1&&(!n.height||g-n.height+1<t))return;h(()=>a.resolve(l));return}if(p=!0,(l=await iJ(()=>iF(e,i4,"getUTXOTransaction")({txId:l?.txid||n}),{delay:u,retryCount:o})).blockhash){let t=await iF(e,i2,"getBlockStats")({blockHash:l.blockhash,stats:["height"]});t.height&&(g=t.height)}if(p=!1,!l?.confirmations)throw new iY({hash:n});if(l.confirmations<t)return;h(()=>a.resolve(l))}catch(n){if(n instanceof iG||n instanceof iY)try{let n;d=nr.fromHex(l?.hex||r),p=!0;let s=await iJ(()=>iF(e,i1,"getBlock")({blockNumber:g}),{delay:u,retryCount:o});p=!1;let c=new Set;for(let e of d.ins){let t=Array.from(e.hash).reverse().map(e=>`00${e.toString(16)}`.slice(-2)).join(""),n=e.index,r=`${t}:${n}`;c.add(r)}for(let e of s.transactions)if(!e.isCoinbase()){for(let t of e.ins){let r=Array.from(t.hash).reverse().map(e=>`00${e.toString(16)}`.slice(-2)).join(""),i=t.index,a=`${r}:${i}`;if(c.has(a)){n=e;break}}if(n)break}if(!n||(l=await iF(e,i4,"getUTXOTransaction")({txId:n.getId()})).confirmations&&l.confirmations<t)return;let f="replaced";function y(e){let t=[];for(let n of e.outs)try{let e=t8(n.script);t.push(e)}catch(e){}return t}let m=y(d),w=y(n);m.length===w.length&&m.every(e=>w.includes(e))?f="repriced":i&&1===w.length&&w.includes(i)&&(f="cancelled"),h(()=>{a.onReplaced?.({reason:f,replacedTransaction:d,transaction:l}),a.resolve(l)})}catch(e){h(()=>a.reject(e))}else h(()=>a.reject(n))}finally{f++}}}})})})}function i9(e,{errorInstance:t=Error("timed out"),timeout:n,signal:r}){return new Promise((i,a)=>{(async()=>{let s;try{let o=new AbortController;n>0&&(s=setTimeout(()=>{r?o.abort():a(t)},n)),i(await e({signal:o?.signal||null}))}catch(e){e?.name==="AbortError"&&a(t),a(e)}finally{clearTimeout(s)}})()})}var i7=n(10492),ae=n(30172),at=n(87131),an=n(66337),ar=n(7821),ai=n(12131),aa=n(6982),as=n(53528),ao=n(40981);let au=e=>e;class ac extends iW{constructor({body:e,cause:t,details:n,headers:r,status:i,url:a}){super("HTTP request failed.",{cause:t,details:n,metaMessages:[i&&`Status: ${i}`,`URL: ${au(a)}`,e&&`Request body: ${iZ(e)}`].filter(Boolean),name:"HttpRequestError"}),this.body=e,this.headers=r,this.status=i,this.url=a}}class al extends iW{constructor({body:e,error:t,url:n}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${au(n)}`,`Request body: ${iZ(e)}`],name:"RpcRequestError"}),this.code=t.code,this.data=t.data}}class ad extends iW{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${au(t)}`,`Request body: ${iZ(e)}`],name:"TimeoutError"})}}class ah extends iW{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{name:"UrlRequiredError"})}}class af extends iW{constructor({method:e}){super(`No transport found that supports the method: ${e}`,{name:"TransportMethodNotSupportedError"})}}!function(e){e[e.PARSE_ERROR=-32700]="PARSE_ERROR",e[e.INVALID_REQUEST=-32600]="INVALID_REQUEST",e[e.METHOD_NOT_FOUND=-32601]="METHOD_NOT_FOUND",e[e.INVALID_PARAMS=-32602]="INVALID_PARAMS",e[e.INTERNAL_ERROR=-32603]="INTERNAL_ERROR",e[e.USER_REJECTION=-32e3]="USER_REJECTION",e[e.METHOD_NOT_SUPPORTED=-32001]="METHOD_NOT_SUPPORTED",e[e.ACCESS_DENIED=-32002]="ACCESS_DENIED"}(f||(f={}));class ap extends iW{constructor(e){let t="UserRejectedRequestError";super(`${t}:  ${e||"The user rejected your request, please try again"}`,{name:t}),this.code=f.USER_REJECTION}}class ag extends iW{constructor(e){let t="MethodNotSupportedError";super(`${t}: The method ${e} you are calling is not supported`,{name:t}),this.code=f.METHOD_NOT_SUPPORTED}}class ay extends Map{constructor(e){super(),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let am=new ay(8192),aw=256;function aI(e=11){if(!r||aw+e>512){r="",aw=0;for(let e=0;e<256;e++)r+=(256+256*Math.random()|0).toString(16).substring(1)}return r.substring(aw,aw+++e)}function aM({key:e,methods:t,name:n,request:r,retryCount:i=3,retryDelay:a=150,timeout:s,type:o},u){return{config:{key:e,methods:t,name:n,request:r,retryCount:i,retryDelay:a,timeout:s,type:o},request:function(e,t={}){return async(n,r={})=>{let{dedupe:i=!1,methods:a,retryDelay:s=150,retryCount:o=3,uid:u}={...t,...r},{method:c}=n;if(a?.exclude?.includes(c)||a?.include&&!a.include.includes(c))throw new ag(c);let l=i?function(e){let t=Array.from(e).map(e=>e.charCodeAt(0).toString(16).padStart(2,"0")).join("");return`0x${t}`}(`${u}.${iZ(n)}`):void 0;return function(e,{enabled:t=!0,id:n}){if(!t||!n)return e();if(am.get(n))return am.get(n);let r=e().finally(()=>am.delete(n));return am.set(n,r),r}(()=>iJ(async()=>{try{return await e(n)}catch(e){switch(e.code){case f.METHOD_NOT_SUPPORTED:throw new ag(c);case f.USER_REJECTION:case 5e3:throw new ap(e.message);default:if(e instanceof iW)throw e;throw new iW("Unknown Error",{cause:e})}}},{delay:({count:e,error:t})=>{if(t&&t instanceof ac){let e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e)}return~~(1<<e)*s},retryCount:o,shouldRetry:({error:e})=>{var t;return"code"in(t=e)&&"number"==typeof t.code?-1===t.code||t.code===f.INTERNAL_ERROR:!(t instanceof ac)||!t.status||403===t.status||408===t.status||413===t.status||429===t.status||500===t.status||502===t.status||503===t.status||504===t.status||!1}}),{enabled:i,id:l})}}(r,{methods:t,retryCount:i,retryDelay:a,uid:aI()}),value:u}}let aE=new Map;function av(e,t={}){return{async request(n){let{body:r,onRequest:i=t.onRequest,onResponse:a=t.onResponse,timeout:s=t.timeout??1e4}=n,o={...t.fetchOptions??{},...n.fetchOptions??{}},{headers:u,method:c,signal:l}=o;try{let t,d=await i9(async({signal:t})=>{let a={...o,body:r?iZ(r):void 0,headers:{..."GET"!==c?{"Content-Type":"application/json"}:void 0,...u},method:c||"POST",signal:l||(s>0?t:null)},d=new Request(n.url??e,a);return i&&await i(d,a),await fetch(n.url??e,a)},{errorInstance:new ad({body:r??{},url:e}),timeout:s,signal:!0});if(a&&await a(d),d.headers.get("Content-Type")?.startsWith("application/json")?t=await d.json():(t=await d.text(),t=JSON.parse(t||"{}")),!d.ok)throw new ac({body:r,details:iZ(t.error)||d.statusText,headers:d.headers,status:d.status,url:e});return t}catch(t){if(t instanceof ac||t instanceof ad)throw t;throw new ac({body:r,cause:t,url:e})}}}}let ab=["getBalance","getTransactions","getUTXOs"];class aT extends iW{constructor({minValue:e,address:t,balance:n}){super(`Not enough UTXOs required for ${e}`,{metaMessages:[`${t&&n&&`Address ${t} has a balance of ${n}.`}`],name:"InsufficientUTXOBalanceError"})}}function aN(e){return"code"in e&&"number"==typeof e.code&&(e.code===f.INTERNAL_ERROR||e.code===f.USER_REJECTION||5e3===e.code||e instanceof aT)}async function aA(e,t){return await e.request({method:"getBalance",params:t},{dedupe:!0})}async function aS(e,{address:t,offset:n,limit:r,lastBlock:i}){return await e.request({method:"getTransactions",params:{address:t,offset:n,limit:r,lastBlock:i}})}async function aC(e,{address:t,minValue:n}){return await e.request({method:"getUTXOs",params:{address:t,minValue:n}})}function aD(e){return{getBalance:t=>aA(e,t),getBlock:t=>i1(e,t),getBlockCount:()=>i5(e),getBlockStats:t=>i2(e,t),getTransactions:t=>aS(e,t),getUTXOTransaction:t=>i4(e,t),getUTXOs:t=>aC(e,t)}}async function ax(e,{hex:t,maxFeeRate:n}){let r=[t];return n&&r.push(n),await e.request({method:"sendrawtransaction",params:r})}function ak(e){return{sendUTXOTransaction:t=>ax(e,t),signPbst:t=>z(e,t)}}let aO=(e,t)=>{let n=new URL(e);return Object.entries(t).forEach(([e,t])=>{void 0!==t&&n.searchParams.set(e,String(t))}),decodeURIComponent(n.toString())},aj=e=>({blockhash:e?.blockHash,blocktime:e.blockTime,confirmations:e.confirmations,hex:e.hex,locktime:e?.coinSpecificData?.locktime,hash:e.coinSpecificData?.hash,size:e.size,txid:e.txid,version:e.version,vin:e.vin.map(e=>({scriptSig:e.scriptSig,sequence:e.sequence,txid:e.txid,vout:e.vout,txinwitness:e.addresses})),vsize:e.vsize,vout:e.vout.map(e=>({n:e.n,scriptPubKey:e.scriptPubKey,value:e.value}))}),aL={getBalance:async(e,{baseUrl:t},{address:n})=>{let r=`${t}/address/${n}?details=basic`,i=await e.request({url:r,fetchOptions:{method:"GET"}});return i.error?{error:{code:-1,message:i.error}}:{result:BigInt(i.balance)}},getTransactions:async(e,{baseUrl:t},{address:n,limit:r=50,offset:i=0,lastBlock:a})=>{let s=aO(`${t}/address/${n}`,{details:"txs",pageSize:r,to:a}),o=await e.request({url:s,fetchOptions:{method:"GET"}});if(o.error)return{error:o.error};let u=o.txs||0,c=Math.floor(i/r)+1,l=u>i+o.transactions.length;return{result:{transactions:o.transactions.map(aj),total:u,page:c,itemsPerPage:r,hasMore:l}}}},aP=async(e,{baseUrl:t,apiKey:n},{address:r})=>{let i=aO(`${t}/addresses/balances`,{key:n,addresses:r}),a=await e.request({url:i,fetchOptions:{method:"GET"}});return a.context?.code!==200?{error:{code:a.context?.code,message:a.context?.error}}:{result:BigInt(a.data[r])}},a_=e=>t=>({blockHeight:t.block_id,scriptHex:e,txId:t.transaction_hash,value:t.value,vout:t.index}),aU=async(e,{baseUrl:t,apiKey:n},{address:r,minValue:i})=>{async function*a(){let a=0,s=!0;for(;s;){let o=aO(`${t}/dashboards/addresses/${r}`,{key:n,offset:`0,${a}`,limit:"100,100"}),u=await e.request({url:o,fetchOptions:{method:"GET"}});if(u.context?.code!==200&&u.context?.code!==404)throw new al({url:o,body:{method:"fetchUTXOs",params:{address:r,minValue:i}},error:{code:u.context.code,message:u.context.error||"Error fetching utxos"}});if(!u.data||0===u.data.utxo.length){s=!1;continue}let{limit:c}=u.context,l=u.data.addresses[r].unspent_output_count;if(c&&l){let[,e]=String(c).split(",").map(e=>Number(e));s=a+e<l,a+=e}else s=!1,a+=0;yield u.data}}if(i){let{result:a}=await aP(e,{baseUrl:t,apiKey:n},{address:r});if(i>Number(a))throw new aT({minValue:i,address:r,balance:Number(a)})}let s=[],o=0;for await(let e of a()){let t=e.addresses[r].script_hex,n=e.utxo.map(a_(t));if(s.push(...n),i&&(o+=n.reduce((e,t)=>e+t.value,0))>=i)break}return{result:s}},az={getBalance:aP,getUTXOs:aU},aR=e=>({blockHeight:e.block_height,isConfirmed:!!e.confirmations,confirmations:e.confirmations,value:e.value,vout:e.tx_output_n,txId:e.tx_hash,scriptHex:e.script}),aB={getBalance:async(e,{baseUrl:t,apiKey:n},{address:r})=>{let i=aO(`${t}/addrs/${r}`,{token:n}),a=await e.request({url:i,fetchOptions:{method:"GET"}});return a.error?{error:{code:-1,message:a.error}}:{result:BigInt(a.balance)}},getUTXOs:async(e,{baseUrl:t,apiKey:n},{address:r,minValue:i})=>{let a=[],s=0;for await(let o of async function*(){let a,s=!0;for(;s;){let o=aO(`${t}/addrs/${r}`,{token:n,unspentOnly:"true",includeScript:"true",before:a,limit:2e3}),u=await e.request({url:o,fetchOptions:{method:"GET"}});if(u.error)throw new al({url:o,body:{method:"fetchUTXOs",params:{address:r,minValue:i}},error:{code:-1,message:u.error}});if(i&&i>u.final_balance)throw new aT({minValue:i,address:r,balance:u.final_balance});if(!u.txrefs||0===u.txrefs.length){s=!1;continue}let{hasMore:c}=u;s=!!c,a=u.txrefs[u.txrefs.length-1].block_height,yield u.txrefs}}()){let e=o.map(aR);if(a.push(...e),i&&(s+=e.reduce((e,t)=>e+t.value,0))>=i)break}return{result:a}}},aH=e=>({hash:e.txid,txid:e.txid,vout:e.vout.map((e,t)=>({n:t,scriptPubKey:{address:e.scriptpubkey_address,asm:e.scriptpubkey_asm,type:e.scriptpubkey_type,desc:e.scriptpubkey,hex:e.scriptpubkey},value:e.value})),vin:e.vin.map(e=>({scriptSig:{asm:e.scriptsig_asm,hex:e.scriptsig},sequence:e.sequence,txinwitness:e.witness,txid:e.txid,vout:e.vout}))}),aW={getBalance:async(e,{baseUrl:t},{address:n})=>{let r=`${t}/address/${n}`,i=await e.request({url:r,fetchOptions:{method:"GET"}});return{result:BigInt(i.chain_stats.funded_txo_sum-i.chain_stats.spent_txo_sum)}},getTransactions:async(e,{baseUrl:t},{address:n,limit:r=50,offset:i=0,afterTxId:a})=>{let s=`${t}/address/${n}`,o=await e.request({url:s,fetchOptions:{method:"GET"}}),u=o.chain_stats.tx_count+o.mempool_stats.tx_count,c=aO(`${t}/address/${n}/txs`,{after_txid:a}),l=(await e.request({url:c,fetchOptions:{method:"GET"}})).map(aH);return{result:{transactions:l,total:u,itemsPerPage:r,hasMore:i+l.length<u}}}};function aG(e,t={}){let{fetchOptions:n,key:r="utxo",name:i="UTXO HTTP API",onFetchRequest:a,onFetchResponse:s,retryDelay:o,apiKey:u,methods:c}=t;return({chain:l,retryCount:d,timeout:h})=>{let f=t.retryCount??d,p=h??t.timeout??1e4,g=e;if(t.includeChainToURL){let t=l?.name.replace(" ","-").toLowerCase();g=`${e}${t?`/${t}`:""}`}if(!g)throw new ah;let y=av(g,{fetchOptions:n,onRequest:a,onResponse:s,timeout:p}),m=function(e){switch(e){case"blockchair":return az;case"ankr":return aL;case"blockcypher":return aB;case"mempool":return aW;default:return null}}(r);return aM({key:r,name:i,methods:c,async request({method:e,params:t}){let n={method:e,params:t},r=m?.[e],{error:i,result:a}=await (r?.(y,{baseUrl:g,apiKey:u},t)??y.request({body:n}));if(i)throw new al({body:n,error:i,url:g});return a},retryCount:f,retryDelay:o,timeout:p,type:"http"},{fetchOptions:n,url:g})}}let aY=e=>aG(e?.baseUrl||"https://api.blockchair.com",{key:"blockchair",includeChainToURL:!0,methods:{include:Object.keys(az)},...e}),aQ=e=>aG(e?.baseUrl||"https://api.blockcypher.com/v1/btc/main",{key:"blockcypher",methods:{include:Object.keys(aB)},...e}),aF=e=>aG(e?.baseUrl||"https://mempool.space/api",{key:"mempool",methods:{include:Object.keys(aW)},...e});var aK=n(7141);let aV={},a$=async e=>{if(!aV[e]){let t=(await (0,aK.C)(e)).map(e=>(function(e,t={}){let{batch:n,fetchOptions:r,key:i="http",methods:a={exclude:ab},name:s="HTTP JSON-RPC",onFetchRequest:o,onFetchResponse:u,retryDelay:c,raw:l}=t;return({chain:d,retryCount:h,timeout:f})=>{let{batchSize:p=1e3,wait:g=0}="object"==typeof n?n:{},y=t.retryCount??h,m=f??t.timeout??1e4,w=e||d?.rpcUrls.default.http[0];if(!w)throw new ah;let I=av(w,{fetchOptions:r,onRequest:o,onResponse:u,timeout:m});return aM({key:i,methods:a,name:s,async request({method:e,params:t}){let r={method:e,params:t},{schedule:i}=function({fn:e,id:t,shouldSplitBatch:n,wait:r=0,sort:i}){let a=async()=>{let t=u();s();let n=t.map(({args:e})=>e);0!==n.length&&e(n).then(e=>{i&&Array.isArray(e)&&e.sort(i);for(let n=0;n<t.length;n++){let{resolve:r}=t[n];r?.([e[n],e])}}).catch(e=>{for(let n=0;n<t.length;n++){let{reject:r}=t[n];r?.(e)}})},s=()=>aE.delete(t),o=()=>u().map(({args:e})=>e),u=()=>aE.get(t)||[],c=e=>aE.set(t,[...u(),e]);return{flush:s,async schedule(e){let t,i,{promise:s,resolve:l,reject:d}=(t=()=>void 0,i=()=>void 0,{promise:new Promise((e,n)=>{t=e,i=n}),resolve:t,reject:i});return(n?.([...o(),e])&&a(),u().length>0)?c({args:e,resolve:l,reject:d}):(c({args:e,resolve:l,reject:d}),setTimeout(a,r)),s}}}({id:w,wait:g,shouldSplitBatch:e=>e.length>p,fn:e=>I.request({body:e}),sort:(e,t)=>e.id-t.id}),a=async e=>n?i(e):[await I.request({body:e})],[{error:s,result:o}]=await a(r);if(l)return{error:s,result:o};if(s)throw new al({body:r,error:s,url:w});return o},retryCount:y,retryDelay:c,timeout:m,type:"http"},{fetchOptions:r,url:w})}})(e,{fetchOptions:{method:"POST"}})),n=await ae.$.getChainById(e),r=(function(e){var t;let{cacheTime:n=e.pollingInterval??4e3,key:r="base",name:i="Base Client",pollingInterval:a=4e3,type:s="base"}=e,o=e.chain,u=e.account?"string"==typeof(t=e.account)?{address:t,type:"json-rpc"}:t:void 0,{config:c,request:l,value:d}=e.transport({chain:o,pollingInterval:a}),h={account:u,cacheTime:n,chain:o,key:r,name:i,pollingInterval:a,request:l,transport:{...c,...d},type:s,uid:aI()};return Object.assign(h,{extend:function e(t){return n=>{let r=n(t);for(let e in h)delete r[e];let i={...t,...r};return Object.assign(i,{extend:e(i)})}}(h)})})({chain:{...n,...n.metamask,name:n.metamask.chainName,rpcUrls:{default:{http:n.metamask.rpcUrls},public:{http:n.metamask.rpcUrls}}},rpcSchema:null,transport:function(e,t={}){let{key:n="fallback",name:r="Fallback",rank:i=!1,shouldThrow:a=aN,retryCount:s,retryDelay:o}=t;return({chain:t,pollingInterval:u=4e3,timeout:c,...l})=>{let d=e,h=()=>{},f=aM({key:n,name:r,async request({method:e,params:n}){let r=d.reduce((n,r)=>{let i=r({...l,chain:t,retryCount:0,timeout:c}),{include:a,exclude:s}=i.config.methods||{};return a?a.includes(e)&&n.push(i):s&&s.includes(e)||n.push(i),n},[]);if(!r.length)throw new af({method:e});let i=async(t=0)=>{let s=r[t];try{let t=await s.request({method:e,params:n});return h({method:e,params:n,response:t,transport:s,status:"success"}),t}catch(o){if(h({error:o,method:e,params:n,transport:s,status:"error"}),a(o)||t===r.length-1)throw o;return i(t+1)}};return i()},retryCount:s,retryDelay:o,type:"fallback"},{onResponse:e=>{h=e},transports:d.map(e=>e({chain:t,retryCount:0}))});if(i){let e="object"==typeof i?i:{};!function({chain:e,interval:t=4e3,onTransports:n,ping:r,sampleCount:i=10,timeout:a=1e3,transports:s,weights:o={}}){let{stability:u=.7,latency:c=.3}=o,l=[],d=async()=>{let o=await Promise.all(s.map(async t=>{let n,i,s=t({chain:e,retryCount:0,timeout:a}),o=Date.now();try{await (r?r({transport:s}):s.request({method:"net_listening",params:void 0})),i=1}catch{i=0}finally{n=Date.now()}return{latency:n-o,success:i}}));l.push(o),l.length>i&&l.shift();let h=Math.max(...l.map(e=>Math.max(...e.map(({latency:e})=>e))));n(s.map((e,t)=>{let n=l.map(e=>e[t].latency),r=n.reduce((e,t)=>e+t,0)/n.length,i=l.map(e=>e[t].success),a=i.reduce((e,t)=>e+t,0)/i.length;return 0===a?[0,t]:[c*(1-r/h)+u*a,t]}).sort((e,t)=>t[0]-e[0]).map(([,e])=>s[e])),await iX(t),d()};d()}({chain:t,interval:e.interval??u,onTransports:e=>{d=e},ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:d,weights:e.weights})}return f}}([aY(),aQ(),aF(),...t]),pollingInterval:1e4}).extend(aD).extend(ak);aV[e]=r}if(!aV[e])throw Error(`Unable to configure provider for chain ${e}`);return aV[e]};var aq=n(75600),aZ=n(25043);let aX=async(e,t,n)=>{if(e instanceof aq.J)return e.step=e.step??t,e.process=e.process??n,e;let r=aJ(e);return new aq.J(r,t,n)},aJ=e=>e.details?.includes?.("conflict")||e.cause?.message?.includes?.("conflict")?new an.Jn(at.Gf.TransactionConflict,"Your transaction conflicts with another transaction already in the mempool. One or more inputs have been spent by another transaction.",e):4001===e.code||-32e3===e.code||e.cause?.includes?.("rejected")?new an.Jn(at.Gf.SignatureRejected,e.message,e):-5===e.code||-32700===e.code||-32064===e.code?new an.Jn(at.Gf.NotFound,e.message,e):e instanceof aZ.C?e:new an.Bk(e.message||at.Kw.UnknownError,e);class a0 extends ai.d{client;constructor(e){super(e),this.client=e.client}checkClient=e=>{if(this.client.account?.address!==e.action.fromAddress)throw new an.Jn(at.Gf.WalletChangedDuringExecution,"The wallet address that requested the quote does not match the wallet address attempting to sign the transaction.")};executeStep=async e=>{e.execution=this.statusManager.initExecutionObject(e);let t=await ae.$.getChainById(e.action.fromChainId),n=await ae.$.getChainById(e.action.toChainId),r=t.id!==n.id,i=this.statusManager.findOrCreateProcess({step:e,type:r?"CROSS_CHAIN":"SWAP",chainId:t.id}),a=await a$(i7.n.BTC);if("DONE"!==i.status)try{let n,s,o;if(i.txHash)this.checkClient(e),n=i.txHash,s=i.txHex;else{if(i=this.statusManager.updateProcess(e,i.type,"STARTED"),await (0,aa.r)(this.client.account.address,e),!e.transactionRequest){let{execution:t,...n}=e,r=await (0,ar.Bv)(n),i=await (0,as.w)(this.statusManager,e,r,this.allowUserInteraction,this.executionOptions);Object.assign(e,{...i,execution:e.execution})}if(!e.transactionRequest?.data)throw new an.Jn(at.Gf.TransactionUnprepared,"Unable to prepare transaction.");if(i=this.statusManager.updateProcess(e,i.type,"ACTION_REQUIRED"),!this.allowUserInteraction)return e;let r={data:e.transactionRequest.data};if(this.executionOptions?.updateTransactionRequestHook){let e=await this.executionOptions.updateTransactionRequestHook({requestType:"transaction",...r});r={...r,...e}}if(!r.data)throw new an.Jn(at.Gf.TransactionUnprepared,"Unable to prepare transaction.");this.checkClient(e);let o=r.data,u=ia.fromHex(o,{network:R}),c=Array.from(u.data.inputs.reduce((e,t,n)=>{let r=t.witnessUtxo?t8(t.witnessUtxo.script,R):this.client.account?.address;return e.has(r)?e.get(r).signingIndexes.push(n):e.set(r,{address:r,sigHash:1,signingIndexes:[n]}),e},new Map).values()),l=await i9(()=>z(this.client,{psbt:o,inputsToSign:c,finalize:!1}),{timeout:6e5,errorInstance:new an.Jn(at.Gf.TransactionExpired,"Transaction has expired.")});s=ia.fromHex(l).finalizeAllInputs().extractTransaction().toHex(),n=await a.sendUTXOTransaction({hex:s}),i=this.statusManager.updateProcess(e,i.type,"PENDING",{txHash:n,txLink:`${t.metamask.blockExplorerUrls[0]}tx/${n}`,txHex:s})}let u=await i6(a,{txId:n,txHex:s,senderAddress:this.client.account?.address,onReplaced:n=>{o=n.reason,i=this.statusManager.updateProcess(e,i.type,"PENDING",{txHash:n.transaction.txid,txLink:`${t.metamask.blockExplorerUrls[0]}tx/${n.transaction.txid}`})}});if("cancelled"===o)throw new an.Jn(at.Gf.TransactionCanceled,"User canceled transaction.");u.txid!==n&&(i=this.statusManager.updateProcess(e,i.type,"PENDING",{txHash:u.txid,txLink:`${t.metamask.blockExplorerUrls[0]}tx/${u.txid}`})),r&&(i=this.statusManager.updateProcess(e,i.type,"DONE"))}catch(n){let t=await aX(n,e,i);throw i=this.statusManager.updateProcess(e,i.type,"FAILED",{error:{message:t.cause.message,code:t.code}}),this.statusManager.updateExecution(e,"FAILED"),t}return await (0,ao.w)(e,i,t,n,this.statusManager,1e4),e}}let a1=async(e,t)=>{if(0===t.length)return[];let{chainId:n}=t[0];for(let e of t)e.chainId!==n&&console.warn("Requested tokens have to be on the same chain.");let r=await a$(i7.n.BTC),[i,a]=await Promise.all([r.getBalance({address:e}),r.getBlockCount()]);return t.map(e=>({...e,amount:i,blockNumber:BigInt(a)}))};function a2(e){let t=e??{};return{get type(){return U.I.UTXO},isAddress:_,resolveAddress:async e=>e,getBalance:a1,async getStepExecutor(e){if(!t.getWalletClient)throw Error("Client is not provided.");return new a0({client:await t.getWalletClient(),routeId:e.routeId,executionOptions:{...e.executionOptions}})},setOptions(e){Object.assign(t,e)}}}},23691:(e,t,n)=>{"use strict";function r(e){return!!e.typedData&&e.typedData.length>0}function i(e){return!!e.typedData?.find(e=>"PermitWitnessTransferFrom"===e.primaryType)}n.d(t,{F:()=>r,b:()=>i})},23965:(e,t,n)=>{"use strict";function r(e){switch(e){case"mainnet":return"https://fullnode.mainnet.sui.io:443";case"testnet":return"https://fullnode.testnet.sui.io:443";case"devnet":return"https://fullnode.devnet.sui.io:443";case"localnet":return"http://127.0.0.1:9000";default:throw Error(`Unknown network: ${e}`)}}n.d(t,{T:()=>r})},26450:(e,t,n)=>{"use strict";let r;n.d(t,{L:()=>a});let i=256;function a(e=11){if(!r||i+e>512){r="",i=0;for(let e=0;e<256;e++)r+=(256+256*Math.random()|0).toString(16).substring(1)}return r.substring(i,i+++e)}},27417:(e,t,n)=>{"use strict";n.d(t,{F:()=>u});var r=n(17058),i=n(80774),a=n(44694),s=n(30172),o=n(19495);async function u({client:e,chainId:t}){let n=e??await s.$.getProvider(r.I.EVM)?.getWalletClient?.();if(!n)throw Error("WalletClient is not provided.");try{let e=await Promise.race([(0,a.T)(n,i.F,"getCapabilities")({chainId:t}),(0,o.y)(2e3)]);return e?.atomicBatch?.supported||e?.atomic?.status==="supported"||e?.atomic?.status==="ready"||!1}catch{return!1}}},29500:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});let r=e=>{let t="undefined"!=typeof window?window:void 0;switch(e){case"metaMask":return t?.ethereum?.isMetaMask||t?.ethereum?.providers?.some(e=>e.isMetaMask);case"coinbase":return t?.ethereum?.isCoinbaseWallet&&!t?.ethereum?.isCoinbaseBrowser||t?.coinbaseWalletExtension?.isCoinbaseWallet||t?.ethereum?.providers?.some(e=>e.isCoinbaseWallet);case"app.phantom.bitcoin":return t.phantom?.bitcoin?.isPhantom;case"com.okex.wallet.bitcoin":return t.okxwallet?.bitcoin?.isOkxWallet;case"XverseProviders.BitcoinProvider":return t.XverseProviders?.BitcoinProvider;case"unisat":return t.unisat&&!t.unisat?.isBinance&&!t.unisat?.isBitKeep;case"io.xdefi.bitcoin":return t.xfi?.bitcoin;case"so.onekey.app.wallet.bitcoin":return t.$onekey?.btc;case"LeatherProvider":return t.LeatherProvider;case"bitget":return t.bitkeep?.unisat||t.unisat?.isBitKeep;case"OylProvider":return t.oyl;case"binance":return t.binancew3w?.bitcoin||t.unisat?.isBinance;case"app.magiceden.bitcoin":return t?.magicEden?.bitcoin?.isMagicEden;default:return!0}}},30422:(e,t,n)=>{let r=n(86116);t.mul=function(e,t){let n=new Uint8Array(e.length+t.length-1);for(let i=0;i<e.length;i++)for(let a=0;a<t.length;a++)n[i+a]^=r.mul(e[i],t[a]);return n},t.mod=function(e,t){let n=new Uint8Array(e);for(;n.length-t.length>=0;){let e=n[0];for(let i=0;i<t.length;i++)n[i]^=r.mul(t[i],e);let i=0;for(;i<n.length&&0===n[i];)i++;n=n.slice(i)}return n},t.generateECPolynomial=function(e){let n=new Uint8Array([1]);for(let i=0;i<e;i++)n=t.mul(n,new Uint8Array([1,r.exp(i)]));return n}},33701:(e,t,n)=>{"use strict";async function r(e){return new Promise(t=>setTimeout(t,e))}function i(e,{delay:t=100,retryCount:n=2,shouldRetry:a=()=>!0}={}){return new Promise((i,s)=>{let o=async({count:u=0}={})=>{let c=async({error:e})=>{let n="function"==typeof t?t({count:u,error:e}):t;n&&await r(n),o({count:u+1})};try{let t=await e();i(t)}catch(e){if(u<n&&await a({count:u,error:e}))return c({error:e});s(e)}};o()})}n.d(t,{b:()=>i})},36338:(e,t,n)=>{let r=n(5041),i=n(23066),a=n(16784),s=n(74679),o=n(81214),u=n(56459),c=n(13575),l=n(3201),d=n(57767),h=n(85604),f=n(56882),p=n(6343),g=n(57266);function y(e,t,n){let r,i,a=e.size,s=f.getEncodedBits(t,n);for(r=0;r<15;r++)i=(s>>r&1)==1,r<6?e.set(r,8,i,!0):r<8?e.set(r+1,8,i,!0):e.set(a-15+r,8,i,!0),r<8?e.set(8,a-r-1,i,!0):r<9?e.set(8,15-r-1+1,i,!0):e.set(8,15-r-1,i,!0);e.set(a-8,8,1,!0)}t.create=function(e,t){let n,f;if(void 0===e||""===e)throw Error("No input text");let m=i.M;return void 0!==t&&(m=i.from(t.errorCorrectionLevel,i.M),n=h.from(t.version),f=c.from(t.maskPattern),t.toSJISFunc&&r.setToSJISFunction(t.toSJISFunc)),function(e,t,n,i){let f;if(Array.isArray(e))f=g.fromArray(e);else if("string"==typeof e){let r=t;if(!r){let t=g.rawSplit(e);r=h.getBestVersionForData(t,n)}f=g.fromString(e,r||40)}else throw Error("Invalid data");let m=h.getBestVersionForData(f,n);if(!m)throw Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<m)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+m+".\n")}else t=m;let w=function(e,t,n){let i=new a;n.forEach(function(t){i.put(t.mode.bit,4),i.put(t.getLength(),p.getCharCountIndicator(t.mode,e)),t.write(i)});let s=(r.getSymbolTotalCodewords(e)-l.getTotalCodewordsCount(e,t))*8;for(i.getLengthInBits()+4<=s&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(0);let o=(s-i.getLengthInBits())/8;for(let e=0;e<o;e++)i.put(e%2?17:236,8);return function(e,t,n){let i,a,s=r.getSymbolTotalCodewords(t),o=s-l.getTotalCodewordsCount(t,n),u=l.getBlocksCount(t,n),c=s%u,h=u-c,f=Math.floor(s/u),p=Math.floor(o/u),g=p+1,y=f-p,m=new d(y),w=0,I=Array(u),M=Array(u),E=0,v=new Uint8Array(e.buffer);for(let e=0;e<u;e++){let t=e<h?p:g;I[e]=v.slice(w,w+t),M[e]=m.encode(I[e]),w+=t,E=Math.max(E,t)}let b=new Uint8Array(s),T=0;for(i=0;i<E;i++)for(a=0;a<u;a++)i<I[a].length&&(b[T++]=I[a][i]);for(i=0;i<y;i++)for(a=0;a<u;a++)b[T++]=M[a][i];return b}(i,e,t)}(t,n,f),I=new s(r.getSymbolSize(t));!function(e,t){let n=e.size,r=u.getPositions(t);for(let t=0;t<r.length;t++){let i=r[t][0],a=r[t][1];for(let t=-1;t<=7;t++)if(!(i+t<=-1)&&!(n<=i+t))for(let r=-1;r<=7;r++)a+r<=-1||n<=a+r||(t>=0&&t<=6&&(0===r||6===r)||r>=0&&r<=6&&(0===t||6===t)||t>=2&&t<=4&&r>=2&&r<=4?e.set(i+t,a+r,!0,!0):e.set(i+t,a+r,!1,!0))}}(I,t);let M=I.size;for(let e=8;e<M-8;e++){let t=e%2==0;I.set(e,6,t,!0),I.set(6,e,t,!0)}return!function(e,t){let n=o.getPositions(t);for(let t=0;t<n.length;t++){let r=n[t][0],i=n[t][1];for(let t=-2;t<=2;t++)for(let n=-2;n<=2;n++)-2===t||2===t||-2===n||2===n||0===t&&0===n?e.set(r+t,i+n,!0,!0):e.set(r+t,i+n,!1,!0)}}(I,t),y(I,n,0),t>=7&&function(e,t){let n,r,i,a=e.size,s=h.getEncodedBits(t);for(let t=0;t<18;t++)n=Math.floor(t/3),r=t%3+a-8-3,i=(s>>t&1)==1,e.set(n,r,i,!0),e.set(r,n,i,!0)}(I,t),!function(e,t){let n=e.size,r=-1,i=n-1,a=7,s=0;for(let o=n-1;o>0;o-=2)for(6===o&&o--;;){for(let n=0;n<2;n++)if(!e.isReserved(i,o-n)){let r=!1;s<t.length&&(r=(t[s]>>>a&1)==1),e.set(i,o-n,r),-1==--a&&(s++,a=7)}if((i+=r)<0||n<=i){i-=r,r=-r;break}}}(I,w),isNaN(i)&&(i=c.getBestMask(I,y.bind(null,I,n))),c.applyMask(i,I),y(I,n,i),{modules:I,version:t,errorCorrectionLevel:n,maskPattern:i,segments:f}}(e,n,m,f)}},36824:(e,t,n)=>{"use strict";n.d(t,{aj:()=>o,gC:()=>s,nM:()=>a,nk:()=>i,xU:()=>u});var r=n(30503);class i extends r.C{constructor(){super("Chain not configured."),this.name="ChainNotConfiguredError"}}class a extends r.C{constructor(){super("Connector already connected."),this.name="ConnectorAlreadyConnectedError"}}class s extends r.C{constructor(){super("Connector not connected."),this.name="ConnectorNotConnectedError"}}r.C;class o extends r.C{constructor({address:e,connector:t}){super(`Account "${e}" not found for connector "${t}".`),this.name="ConnectorAccountNotFoundError"}}class u extends r.C{constructor({connectionChainId:e,connectorChainId:t}){super(`The current chain of the connector (id: ${t}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${t}`,`Expected Chain ID: ${e}`]}),this.name="ConnectorChainMismatchError"}}r.C},37723:(e,t,n)=>{"use strict";n.d(t,{C:()=>o});let r=()=>"@wagmi/core@2.17.3";var i,a,s=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class o extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return r()}constructor(e,t={}){super(),i.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});let n=t.cause instanceof o?t.cause.details:t.cause?.message?t.cause.message:t.details,r=t.cause instanceof o&&t.cause.docsPath||t.docsPath;this.message=[e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...r?[`Docs: ${this.docsBaseUrl}${r}.html${t.docsSlug?`#${t.docsSlug}`:""}`]:[],...n?[`Details: ${n}`]:[],`Version: ${this.version}`].join("\n"),t.cause&&(this.cause=t.cause),this.details=n,this.docsPath=r,this.metaMessages=t.metaMessages,this.shortMessage=e}walk(e){return s(this,i,"m",a).call(this,this,e)}}i=new WeakSet,a=function e(t,n){return n?.(t)?t:t.cause?s(this,i,"m",e).call(this,t.cause,n):t}},38156:(e,t,n)=>{"use strict";n.d(t,{c:()=>c});var r=n(17058),i=n(56151),a=n(33374),s=n(16738);let o=async(e,t,n)=>{let r=n.find(e=>e.id===a.r.id);r&&(r.contracts={...a.r.contracts,...r.contracts}),e._internal.chains.setState(n),e._internal.connectors.setState(()=>[...t,...e._internal.mipd?.getProviders().map(e._internal.connectors.providerDetailToConnector)??[]].map(e._internal.connectors.setup)),(0,s.M)(e)},u=e=>({...e,...e.metamask,blockExplorers:e.metamask.blockExplorerUrls.reduce((e,t,n)=>(e[0===n?"default":`${n}`]={name:t,url:t},e),{}),name:e.metamask.chainName,rpcUrls:{default:{http:e.metamask.rpcUrls},public:{http:e.metamask.rpcUrls}},contracts:{...e.multicallAddress?{multicall3:{address:e.multicallAddress}}:void 0}}),c=(e,t,n)=>{let a=(0,i.useMemo)(()=>n?.map(e=>!function(e){return"object"==typeof e&&null!==e&&"key"in e&&"chainType"in e&&"coin"in e&&"mainnet"in e&&"logoURI"in e&&"object"==typeof e.metamask&&null!==e.metamask&&"object"==typeof e.nativeToken&&null!==e.nativeToken}(e)?e:e.chainType===r.I.EVM?u(e):void 0).filter(Boolean),[n]);(0,i.useEffect)(()=>{a?.length&&o(e,t,a)},[a,t,e])}},38582:(e,t,n)=>{"use strict";n.d(t,{AE:()=>i,Ez:()=>a,K3:()=>p,KL:()=>y,Kd:()=>l,PQ:()=>o,UF:()=>h,Y6:()=>s,Y8:()=>u,fk:()=>c,kW:()=>d,m7:()=>r,o7:()=>g,z4:()=>f});class r extends Error{constructor(e,t){super(e),this.error=t}}class i extends r{constructor(){super(...arguments),this.name="WalletNotReadyError"}}class a extends r{constructor(){super(...arguments),this.name="WalletConfigError"}}class s extends r{constructor(){super(...arguments),this.name="WalletConnectionError"}}class o extends r{constructor(){super(...arguments),this.name="WalletDisconnectedError"}}class u extends r{constructor(){super(...arguments),this.name="WalletDisconnectionError"}}class c extends r{constructor(){super(...arguments),this.name="WalletAccountError"}}class l extends r{constructor(){super(...arguments),this.name="WalletPublicKeyError"}}class d extends r{constructor(){super(...arguments),this.name="WalletNotConnectedError"}}class h extends r{constructor(){super(...arguments),this.name="WalletSendTransactionError"}}class f extends r{constructor(){super(...arguments),this.name="WalletSignTransactionError"}}class p extends r{constructor(){super(...arguments),this.name="WalletSignMessageError"}}class g extends r{constructor(){super(...arguments),this.name="WalletSignInError"}}class y extends r{constructor(){super(...arguments),this.name="WalletWindowClosedError"}}},39456:(e,t,n)=>{let r=n(12322),i=n(36338),a=n(43992),s=n(59055);function o(e,t,n,a,s){let o=[].slice.call(arguments,1),u=o.length,c="function"==typeof o[u-1];if(!c&&!r())throw Error("Callback required as last argument");if(c){if(u<2)throw Error("Too few arguments provided");2===u?(s=n,n=t,t=a=void 0):3===u&&(t.getContext&&void 0===s?(s=a,a=void 0):(s=a,a=n,n=t,t=void 0))}else{if(u<1)throw Error("Too few arguments provided");return 1===u?(n=t,t=a=void 0):2!==u||t.getContext||(a=n,n=t,t=void 0),new Promise(function(r,s){try{let s=i.create(n,a);r(e(s,t,a))}catch(e){s(e)}})}try{let r=i.create(n,a);s(null,e(r,t,a))}catch(e){s(e)}}t.create=i.create,t.toCanvas=o.bind(null,a.render),t.toDataURL=o.bind(null,a.renderToDataURL),t.toString=o.bind(null,function(e,t,n){return s.render(e,n)})},40440:(e,t,n)=>{"use strict";function r(e){return e}n.d(t,{U:()=>r})},41541:(e,t)=>{"use strict";t.p2=t.I=void 0;let n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",r={};for(let e=0;e<n.length;e++)r[n.charAt(e)]=e;function i(e){let t=e>>25;return(0x1ffffff&e)<<5^0x3b6a57b2&-((0|t)&1)^0x26508e6d&-(t>>1&1)^0x1ea119fa&-(t>>2&1)^0x3d4233dd&-(t>>3&1)^0x2a1462b3&-(t>>4&1)}function a(e){let t=1;for(let n=0;n<e.length;++n){let r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=i(t)^r>>5}t=i(t);for(let n=0;n<e.length;++n){let r=e.charCodeAt(n);t=i(t)^31&r}return t}function s(e,t,n,r){let i=0,a=0,s=(1<<n)-1,o=[];for(let r=0;r<e.length;++r)for(i=i<<t|e[r],a+=t;a>=n;)o.push(i>>(a-=n)&s);if(r)a>0&&o.push(i<<n-a&s);else{if(a>=t)return"Excess padding";if(i<<n-a&s)return"Non-zero padding"}return o}function o(e){return s(e,8,5,!0)}function u(e){let t=s(e,5,8,!1);if(Array.isArray(t))return t}function c(e){let t=s(e,5,8,!1);if(Array.isArray(t))return t;throw Error(t)}function l(e){let t;function s(e,n){if(n=n||90,e.length<8)return e+" too short";if(e.length>n)return"Exceeds length limit";let s=e.toLowerCase(),o=e.toUpperCase();if(e!==s&&e!==o)return"Mixed-case string "+e;let u=(e=s).lastIndexOf("1");if(-1===u)return"No separator character for "+e;if(0===u)return"Missing prefix for "+e;let c=e.slice(0,u),l=e.slice(u+1);if(l.length<6)return"Data too short";let d=a(c);if("string"==typeof d)return d;let h=[];for(let e=0;e<l.length;++e){let t=l.charAt(e),n=r[t];if(void 0===n)return"Unknown character "+t;d=i(d)^n,e+6>=l.length||h.push(n)}return d!==t?"Invalid checksum for "+e:{prefix:c,words:h}}return t="bech32"===e?1:0x2bc830a3,{decodeUnsafe:function(e,t){let n=s(e,t);if("object"==typeof n)return n},decode:function(e,t){let n=s(e,t);if("object"==typeof n)return n;throw Error(n)},encode:function(e,r,s){if(s=s||90,e.length+7+r.length>s)throw TypeError("Exceeds length limit");let o=a(e=e.toLowerCase());if("string"==typeof o)throw Error(o);let u=e+"1";for(let e=0;e<r.length;++e){let t=r[e];if(t>>5!=0)throw Error("Non 5-bit word");o=i(o)^t,u+=n.charAt(t)}for(let e=0;e<6;++e)o=i(o);o^=t;for(let e=0;e<6;++e){let t=o>>(5-e)*5&31;u+=n.charAt(t)}return u},toWords:o,fromWordsUnsafe:u,fromWords:c}}t.I=l("bech32"),t.p2=l("bech32m")},41894:e=>{"use strict";e.exports=function(e){if(e.length>=255)throw TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var r=0;r<e.length;r++){var i=e.charAt(r),a=i.charCodeAt(0);if(255!==t[a])throw TypeError(i+" is ambiguous");t[a]=r}var s=e.length,o=e.charAt(0),u=Math.log(s)/Math.log(256),c=Math.log(256)/Math.log(s);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var n=0,r=0,i=0;e[n]===o;)r++,n++;for(var a=(e.length-n)*u+1>>>0,c=new Uint8Array(a);e[n];){var l=e.charCodeAt(n);if(l>255)return;var d=t[l];if(255===d)return;for(var h=0,f=a-1;(0!==d||h<i)&&-1!==f;f--,h++)d+=s*c[f]>>>0,c[f]=d%256>>>0,d=d/256>>>0;if(0!==d)throw Error("Non-zero carry");i=h,n++}for(var p=a-i;p!==a&&0===c[p];)p++;for(var g=new Uint8Array(r+(a-p)),y=r;p!==a;)g[y++]=c[p++];return g}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,r=0,i=0,a=t.length;i!==a&&0===t[i];)i++,n++;for(var u=(a-i)*c+1>>>0,l=new Uint8Array(u);i!==a;){for(var d=t[i],h=0,f=u-1;(0!==d||h<r)&&-1!==f;f--,h++)d+=256*l[f]>>>0,l[f]=d%s>>>0,d=d/s>>>0;if(0!==d)throw Error("Non-zero carry");r=h,i++}for(var p=u-r;p!==u&&0===l[p];)p++;for(var g=o.repeat(n);p<u;++p)g+=e.charAt(l[p]);return g},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw Error("Non-base"+s+" character")}}}},43992:(e,t,n)=>{let r=n(6085);t.render=function(e,t,n){var i;let a=n,s=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(s=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),a=r.getOptions(a);let o=r.getImageWidth(e.modules.size,a),u=s.getContext("2d"),c=u.createImageData(o,o);return r.qrToImageData(c.data,e,a),i=s,u.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px",u.putImageData(c,0,0),s},t.renderToDataURL=function(e,n,r){let i=r;void 0!==i||n&&n.getContext||(i=n,n=void 0),i||(i={});let a=t.render(e,n,i),s=i.type||"image/png",o=i.rendererOpts||{};return a.toDataURL(s,o.quality)}},44409:(e,t,n)=>{let r=n(6343);function i(e){this.mode=r.BYTE,"string"==typeof e?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}i.getBitsLength=function(e){return 8*e},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){for(let t=0,n=this.data.length;t<n;t++)e.put(this.data[t],8)},e.exports=i},45986:(e,t,n)=>{"use strict";n.d(t,{E:()=>i,w:()=>a});var r=n(56151);let i=(0,r.createContext)({});function a(){return(0,r.useContext)(i)}},46303:(e,t,n)=>{"use strict";n.d(t,{N:()=>i});var r=n(37723);class i extends r.C{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}r.C},47704:(e,t,n)=>{"use strict";n.d(t,{Np:()=>o});var r=n(99498),i=n(59441),a=n(73769),s=n(94181);function o(e,t={}){let{key:n="fallback",name:r="Fallback",rank:i=!1,shouldThrow:c=u,retryCount:l,retryDelay:d}=t;return({chain:t,pollingInterval:o=4e3,timeout:u,...h})=>{let f=e,p=()=>{},g=(0,s.o)({key:n,name:r,async request({method:e,params:n}){let r,i=async(a=0)=>{let s=f[a]({...h,chain:t,retryCount:0,timeout:u});try{let t=await s.request({method:e,params:n});return p({method:e,params:n,response:t,transport:s,status:"success"}),t}catch(o){if(p({error:o,method:e,params:n,transport:s,status:"error"}),c(o)||a===f.length-1||!(r??=f.slice(a+1).some(n=>{let{include:r,exclude:i}=n({chain:t}).config.methods||{};return r?r.includes(e):!i||!i.includes(e)})))throw o;return i(a+1)}};return i()},retryCount:l,retryDelay:d,type:"fallback"},{onResponse:e=>p=e,transports:f.map(e=>e({chain:t,retryCount:0}))});if(i){let e="object"==typeof i?i:{};!function({chain:e,interval:t=4e3,onTransports:n,ping:r,sampleCount:i=10,timeout:s=1e3,transports:o,weights:u={}}){let{stability:c=.7,latency:l=.3}=u,d=[],h=async()=>{let u=await Promise.all(o.map(async t=>{let n,i,a=t({chain:e,retryCount:0,timeout:s}),o=Date.now();try{await (r?r({transport:a}):a.request({method:"net_listening"})),i=1}catch{i=0}finally{n=Date.now()}return{latency:n-o,success:i}}));d.push(u),d.length>i&&d.shift();let f=Math.max(...d.map(e=>Math.max(...e.map(({latency:e})=>e))));n(o.map((e,t)=>{let n=d.map(e=>e[t].latency),r=n.reduce((e,t)=>e+t,0)/n.length,i=d.map(e=>e[t].success),a=i.reduce((e,t)=>e+t,0)/i.length;return 0===a?[0,t]:[l*(1-r/f)+c*a,t]}).sort((e,t)=>t[0]-e[0]).map(([,e])=>o[e])),await (0,a.u)(t),h()};h()}({chain:t,interval:e.interval??o,onTransports:e=>f=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:f,weights:e.weights})}return g}}function u(e){return!!("code"in e&&"number"==typeof e.code&&(e.code===i.YW.code||e.code===i.vx.code||r.A7.nodeMessage.test(e.message)||5e3===e.code))}},48149:(e,t,n)=>{"use strict";n.d(t,{d:()=>u});var r=n(88371),i=n(16591),a=n(38582),s=n(75031),o=n(4398);class u extends r.DE{constructor(e={}){super(),this.name="Coinbase Wallet",this.url="https://chrome.google.com/webstore/detail/coinbase-wallet-extension/hnfanknocfeofbddgcijnmhnfnkdnaad",this.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAyNCIgaGVpZ2h0PSIxMDI0IiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8Y2lyY2xlIGN4PSI1MTIiIGN5PSI1MTIiIHI9IjUxMiIgZmlsbD0iIzAwNTJGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTE1MiA1MTJDMTUyIDcxMC44MjMgMzEzLjE3NyA4NzIgNTEyIDg3MkM3MTAuODIzIDg3MiA4NzIgNzEwLjgyMyA4NzIgNTEyQzg3MiAzMTMuMTc3IDcxMC44MjMgMTUyIDUxMiAxNTJDMzEzLjE3NyAxNTIgMTUyIDMxMy4xNzcgMTUyIDUxMlpNNDIwIDM5NkM0MDYuNzQ1IDM5NiAzOTYgNDA2Ljc0NSAzOTYgNDIwVjYwNEMzOTYgNjE3LjI1NSA0MDYuNzQ1IDYyOCA0MjAgNjI4SDYwNEM2MTcuMjU1IDYyOCA2MjggNjE3LjI1NSA2MjggNjA0VjQyMEM2MjggNDA2Ljc0NSA2MTcuMjU1IDM5NiA2MDQgMzk2SDQyMFoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=",this.supportedTransactionVersions=new Set(["legacy",0]),this._readyState="undefined"==typeof window||"undefined"==typeof document?i.Ok.Unsupported:i.Ok.NotDetected,this._disconnected=()=>{let e=this._wallet;e&&(e.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null,this.emit("error",new a.PQ),this.emit("disconnect"))},this._connecting=!1,this._wallet=null,this._publicKey=null,this._readyState!==i.Ok.Unsupported&&(0,i.qG)(()=>!!window?.coinbaseSolana&&(this._readyState=i.Ok.Installed,this.emit("readyStateChange",this._readyState),!0))}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{let e;if(this.connected||this.connecting)return;if(this._readyState!==i.Ok.Installed)throw new a.AE;this._connecting=!0;let t=window.coinbaseSolana;try{await t.connect()}catch(e){throw new a.Y6(e?.message,e)}if(!t.publicKey)throw new a.fk;try{e=new o.J3(t.publicKey.toBytes())}catch(e){throw new a.Kd(e?.message,e)}t.on("disconnect",this._disconnected),this._wallet=t,this._publicKey=e,this.emit("connect",e)}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){e.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null;try{await e.disconnect()}catch(e){this.emit("error",new a.Y8(e?.message,e))}}this.emit("disconnect")}async sendTransaction(e,t,n={}){try{let r=this._wallet;if(!r)throw new a.kW;try{let{signers:i,...a}=n;(0,s.Y)(e)?i?.length&&e.sign(i):(e=await this.prepareTransaction(e,t,a),i?.length&&e.partialSign(...i)),a.preflightCommitment=a.preflightCommitment||t.commitment;let{signature:o}=await r.signAndSendTransaction(e,a);return o}catch(e){if(e instanceof a.m7)throw e;throw new a.UF(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signTransaction(e){try{let t=this._wallet;if(!t)throw new a.kW;try{return await t.signTransaction(e)||e}catch(e){throw new a.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new a.kW;try{return await t.signAllTransactions(e)||e}catch(e){throw new a.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new a.kW;try{let{signature:n}=await t.signMessage(e);return n}catch(e){throw new a.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},48422:(e,t,n)=>{"use strict";function r(e){return"string"==typeof e?{address:e,type:"json-rpc"}:e}n.d(t,{J:()=>r})},50651:(e,t,n)=>{"use strict";n.d(t,{c:()=>c});var r=n(46729),i=n(63748),a=n(24733),s=n(3241),o=n(2781),u=n(95375);async function c(e,t){let n,{id:r,pollingInterval:c=e.pollingInterval,status:d=({statusCode:e})=>e>=200,timeout:h=6e4}=t,f=(0,o.A)(["waitForCallsStatus",e.uid,r]),{promise:p,resolve:g,reject:y}=(0,s.Y)(),m=(0,i.lB)(f,{resolve:g,reject:y},t=>{let i=(0,a.w)(async()=>{let a=e=>{clearTimeout(n),i(),e(),m()};try{let n=await (0,u.k)(e,{id:r});if(!d(n))return;a(()=>t.resolve(n))}catch(e){a(()=>t.reject(e))}},{interval:c,emitOnBegin:!0});return i});return n=h?setTimeout(()=>{m(),clearTimeout(n),y(new l({id:r}))},h):void 0,await p}class l extends r.C{constructor({id:e}){super(`Timed out while waiting for call bundle with id "${e}" to be confirmed.`,{name:"WaitForCallsStatusTimeoutError"})}}},52716:(e,t,n)=>{"use strict";n.d(t,{Z:()=>e1});var r=n(17058),i=n(74655),a=n(22e3),s=n(99995),o=n(6875),u=n(81611),c=n(9694),l=n(44694),d=n(30172),h=n(87131),f=n(66337),p=n(7821),g=n(12131),y=n(6982),m=n(53528),w=n(40981),I=n(50267),M=n(10492),E=n(48275),v=n(69231);n(53560);var b=n(69971),T=n(85377),N=n(16657);let A=new Map;async function S(e){let{getSocket:t,keepAlive:n=!0,key:r="socket",reconnect:i=!0,url:a}=e,{interval:s=3e4}="object"==typeof n?n:{},{attempts:o=5,delay:u=2e3}="object"==typeof i?i:{},c=A.get(`${r}:${a}`);if(c)return c;let l=0,{schedule:d}=(0,b.u)({id:`${r}:${a}`,fn:async()=>{let e,d,h,f=new Map,p=new Map;async function g(){let r=await t({onClose(){for(let e of f.values())e.onError?.(new E.Oz({url:a}));for(let e of p.values())e.onError?.(new E.Oz({url:a}));i&&l<o?setTimeout(async()=>{l++,await g().catch(console.error)},u):(f.clear(),p.clear())},onError(t){for(let n of(e=t,f.values()))n.onError?.(e);for(let t of p.values())t.onError?.(e);c?.close(),i&&l<o?setTimeout(async()=>{l++,await g().catch(console.error)},u):(f.clear(),p.clear())},onOpen(){e=void 0,l=0},onResponse(e){let t="eth_subscription"===e.method,n=t?e.params.subscription:e.id,r=t?p:f,i=r.get(n);i&&i.onResponse(e),t||r.delete(n)}});return d=r,n&&(h&&clearInterval(h),h=setInterval(()=>d.ping?.(),s)),r}return await g(),e=void 0,c={close(){h&&clearInterval(h),d.close(),A.delete(`${r}:${a}`)},get socket(){return d},request({body:t,onError:n,onResponse:r}){e&&n&&n(e);let i=t.id??N.q.take(),a=e=>{("number"!=typeof e.id||i===e.id)&&("eth_subscribe"===t.method&&"string"==typeof e.result&&p.set(e.result,{onResponse:a,onError:n}),"eth_unsubscribe"===t.method&&p.delete(t.params?.[0]),r(e))};f.set(i,{onResponse:a,onError:n});try{d.request({body:{jsonrpc:"2.0",id:i,...t}})}catch(e){n?.(e)}},requestAsync({body:e,timeout:t=1e4}){return(0,T.w)(()=>new Promise((t,n)=>this.request({body:e,onError:n,onResponse:t})),{errorInstance:new E.MU({body:e,url:a}),timeout:t})},requests:f,subscriptions:p,url:a},A.set(`${r}:${a}`,c),[c]}}),[h,[f]]=await d();return f}async function C(e,t={}){let{keepAlive:r,reconnect:i}=t;return S({async getSocket({onClose:t,onError:r,onOpen:i,onResponse:a}){let s=await n.e(8945).then(n.bind(n,88945)).then(e=>e.WebSocket),o=new s(e);function u(){o.removeEventListener("close",u),o.removeEventListener("message",c),o.removeEventListener("error",r),o.removeEventListener("open",i),t()}function c({data:e}){try{let t=JSON.parse(e);a(t)}catch(e){r(e)}}o.addEventListener("close",u),o.addEventListener("message",c),o.addEventListener("error",r),o.addEventListener("open",i),o.readyState===s.CONNECTING&&await new Promise((e,t)=>{o&&(o.onopen=e,o.onerror=t)});let{close:l}=o;return Object.assign(o,{close(){l.bind(o)(),u()},ping(){try{if(o.readyState===o.CLOSED||o.readyState===o.CLOSING)throw new E.Pr({url:o.url,cause:new E.Oz({url:o.url})});o.send(JSON.stringify({jsonrpc:"2.0",method:"net_version",params:[]}))}catch(e){r(e)}},request({body:e}){if(o.readyState===o.CLOSED||o.readyState===o.CLOSING)throw new E.Pr({body:e,url:o.url,cause:new E.Oz({url:o.url})});return o.send(JSON.stringify(e))}})},keepAlive:r,reconnect:i,url:e})}async function D(e){let t=await C(e);return Object.assign(t.socket,{requests:t.requests,subscriptions:t.subscriptions})}var x=n(94181),k=n(86742),O=n(36292),j=n(47704),L=n(33374),P=n(7141);let _={},U=async e=>{if(_[e])return _[e];let t=(await (0,P.C)(e)).map(e=>e.startsWith("wss")?function(e,t={}){let{keepAlive:n,key:r="webSocket",methods:i,name:a="WebSocket JSON-RPC",reconnect:s,retryDelay:o}=t;return({chain:u,retryCount:c,timeout:l})=>{let d=t.retryCount??c,h=l??t.timeout??1e4,f=e||u?.rpcUrls.default.webSocket?.[0],p={keepAlive:n,reconnect:s};if(!f)throw new v.b;return(0,x.o)({key:r,methods:i,name:a,async request({method:e,params:t}){let n={method:e,params:t},r=await C(f,p),{error:i,result:a}=await r.requestAsync({body:n,timeout:h});if(i)throw new E.J8({body:n,error:i,url:f});return a},retryCount:d,retryDelay:o,timeout:h,type:"webSocket"},{getSocket:()=>D(f),getRpcClient:()=>C(f,p),async subscribe({params:e,onData:t,onError:n}){let r=await C(f,p),{result:i}=await new Promise((i,a)=>r.request({body:{method:"eth_subscribe",params:e},onError(e){a(e),n?.(e)},onResponse(e){if(e.error){a(e.error),n?.(e.error);return}if("number"==typeof e.id)return void i(e);"eth_subscription"===e.method&&t(e.params)}}));return{subscriptionId:i,unsubscribe:async()=>new Promise(e=>r.request({body:{method:"eth_unsubscribe",params:[i]},onResponse:e}))}}})}}(e):(0,k.L)(e,{batch:{batchSize:64}})),n=await d.$.getChainById(e),i={...n,...n.metamask,name:n.metamask.chainName,rpcUrls:{default:{http:n.metamask.rpcUrls},public:{http:n.metamask.rpcUrls}}};i.id===M.n.ETH&&(i.contracts={...L.r.contracts,...i.contracts});let a=d.$.getProvider(r.I.EVM);return _[e]=(0,O.U)({chain:i,transport:(0,j.Np)(t,a?.options?.fallbackTransportConfig),batch:{multicall:!0}}),_[e]},z=async(e,t,n,r)=>{try{return await (0,l.T)(e,t,n)(r)}catch(s){if(!e.account?.address)throw s;let i=e.chain?.id;if(!i)throw s;let a=await U(i);return await (0,l.T)(a,t,n)(r)}};var R=n(38890),B=n(39287);let H=(0,B.U)(["function callDiamondWithPermit2(bytes, ((address, uint256), uint256, uint256), bytes) external","function callDiamondWithEIP2612Signature(address, uint256, uint256, uint8, bytes32, bytes32, bytes) external payable","function nextNonce(address) external view returns (uint256)","function callDiamondWithPermit2Witness(bytes, address, ((address, uint256), uint256, uint256), bytes) external payable"]),W=(0,B.U)(["function permit(address, address, uint256, uint256, uint8, bytes32, bytes32) external","function DOMAIN_SEPARATOR() external view returns (bytes32)","function nonces(address) external view returns (uint256)","function name() external view returns (string)","function version() external view returns (string)"]),G=(0,B.U)(["function approve(address, uint256) external returns (bool)"]),Y=(0,B.U)(["function allowance(address, address) external view returns (uint256)"]),Q=(0,B.U)(["function getEthBalance(address) external view returns (uint256)"]),F=(0,B.U)(["function balanceOf(address) external view returns (uint256)"]),K={Permit:[{name:"owner",type:"address"},{name:"spender",type:"address"},{name:"value",type:"uint256"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},V=async(e,t,n,r)=>{try{return await z(e,R.J,"readContract",{address:t,abi:Y,functionName:"allowance",args:[n,r]})}catch(e){return 0n}};var $=n(59441),q=n(75600),Z=n(25043);let X=async(e,t)=>{try{let n=await fetch(`https://api.tenderly.co/api/v1/public-contract/${t}/tx/${e}`);return await n.json()}catch(e){}},J=async(e,t,n)=>{if(e instanceof q.J)return e.step=e.step??t,e.process=e.process??n,e;let r=await ee(e,t,n);return new q.J(r,t,n)},ee=async(e,t,n)=>{if("UserRejectedRequestError"===e.name||e.cause?.name==="UserRejectedRequestError"||e.cause?.code===-32e3||"TransactionExecutionError"===e.name&&e.cause?.details?.includes("rejected"))return new f.Jn(h.Gf.SignatureRejected,e.message,e);if(e.cause?.code===-32603)return new f.Jn(h.Gf.TransactionRejected,e.message,e);if(t&&n?.txHash&&e.code===h.Gf.TransactionFailed&&e.message===h.Kw.TransactionReverted){let r=await X(n.txHash,t.action.fromChainId),i=r?.error_message;if(i?.toLowerCase().includes("out of gas"))return new f.Jn(h.Gf.GasLimitError,h.Kw.GasLimitLow,e)}return e instanceof Z.C?e:new f.Bk(e.message||h.Kw.UnknownError,e)},et=e=>{if(e.cause?.code===$.G1.code)return!0;let t=e.cause?.details?.toLowerCase(),n="TransactionExecutionError"===e.name||e.cause?.name==="TransactionExecutionError",r=t?.includes("rejected")&&t?.includes("upgrade"),i=t?.includes("7702");return n&&(r||i)};var en=n(66328),er=n(29966),ei=n(26357),ea=n(62595),es=n(10730),eo=n(7672),eu=n(57973),ec=n(15853);let el=e=>{if(!e.length)return;let t=[...e].sort((e,t)=>e>t?1:e<t?-1:0),n=Math.floor(t.length/2);return t.length%2==0?(t[n-1]+t[n])/2n:t[n]},ed=e=>({...e,...e.metamask,blockExplorers:e.metamask.blockExplorerUrls.reduce((e,t,n)=>(e[0===n?"default":`${n}`]={name:t,url:t},e),{}),name:e.metamask.chainName,rpcUrls:{default:{http:e.metamask.rpcUrls},public:{http:e.metamask.rpcUrls}},contracts:{...e.multicallAddress?{multicall3:{address:e.multicallAddress}}:void 0}}),eh=async e=>{let t=(await z(e,ec.g,"getBlock",{includeTransactions:!0})).transactions.filter(e=>e.maxPriorityFeePerGas).map(e=>e.maxPriorityFeePerGas);if(!t.length)return;let n=0n;for(let e of t)n+=e;let r=el(t)??0n,i=n/BigInt(t.length);return r>i?i:r},ef=async e=>{let t=await d.$.getChains();return t.find(t=>t.id===e)?.multicallAddress};function ep({name:e,version:t,chainId:n,verifyingContract:r,domainSeparator:i}){if(!e||!i)return{isValid:!1,domain:{}};for(let a of[!1,!0]){let s=function({name:e,version:t,chainId:n,verifyingContract:r,withSalt:i=!1}){let a=(0,en.S)((0,er.ZJ)(e)),s=(0,en.S)((0,er.ZJ)(t)),o=i?(0,ei.h)((0,ea.m)("bytes32, bytes32, bytes32, address, bytes32"),["0x36c25de3e541d5d970f66e4210d728721220fff5c077cc6cd008b3a0c62adab7",a,s,r,(0,es.eV)((0,eo.nj)(n),{size:32})]):(0,ei.h)((0,ea.m)("bytes32, bytes32, bytes32, uint256, address"),["0x8b73c3c69bb8fe3d512ecc4cf759cc79239f7b179b0ffacaa9a75d522b39400f",a,s,BigInt(n),r]);return(0,en.S)(o)}({name:e,version:t,chainId:n,verifyingContract:r,withSalt:a});if(i.toLowerCase()===s.toLowerCase())return{isValid:!0,domain:a?{name:e,version:t,verifyingContract:r,salt:(0,es.eV)((0,eo.nj)(n),{size:32})}:{name:e,version:t,chainId:n,verifyingContract:r}}}return{isValid:!1,domain:{}}}let eg=async(e,{chainId:t,tokenAddress:n,spenderAddress:r,amount:i})=>{try{let a=await ef(t),s=[{address:n,abi:W,functionName:"name"},{address:n,abi:W,functionName:"DOMAIN_SEPARATOR"},{address:n,abi:W,functionName:"nonces",args:[e.account.address]},{address:n,abi:W,functionName:"version"}];if(a)try{let[o,u,c,l]=await z(e,eu.C,"multicall",{contracts:s,multicallAddress:a});if("success"!==o.status||"success"!==u.status||"success"!==c.status||!o.result||!u.result||void 0===c.result)throw Error("Multicall failed");let{isValid:d,domain:h}=ep({name:o.result,version:l.result??"1",chainId:t,verifyingContract:n,domainSeparator:u.result});if(!d)return;let f={owner:e.account.address,spender:r,value:i.toString(),nonce:c.result.toString(),deadline:BigInt(Math.floor(Date.now()/1e3)+1800).toString()};return{primaryType:"Permit",domain:h,types:K,message:f}}catch{}let[o,u,c,l]=await Promise.allSettled(s.map(t=>z(e,R.J,"readContract",t)));if("fulfilled"!==o.status||"fulfilled"!==u.status||"fulfilled"!==c.status)return;let d=o.value,h="fulfilled"===l.status?l.value:"1",{isValid:f,domain:p}=ep({name:d,version:h,chainId:t,verifyingContract:n,domainSeparator:u.value});if(!f)return;let g={owner:e.account.address,spender:r,value:i.toString(),nonce:c.value.toString(),deadline:BigInt(Math.floor(Date.now()/1e3)+1800).toString()};return{primaryType:"Permit",domain:p,types:K,message:g}}catch{return}};var ey=n(9908);let em=async(e,t,n,r,i,a)=>{let s=(0,ey.p)({abi:G,functionName:"approve",args:[n,r]});if(a)return s;let o={to:t,data:s,maxPriorityFeePerGas:e.account?.type==="local"?await eh(e):void 0};if(i?.updateTransactionRequestHook){let e=await i.updateTransactionRequestHook({requestType:"approve",...o});o={...o,...e}}return(0,l.T)(e,c.v,"sendTransaction")({to:o.to,account:e.account,data:o.data,gas:o.gas,gasPrice:o.gasPrice,maxFeePerGas:o.maxFeePerGas,maxPriorityFeePerGas:o.maxPriorityFeePerGas})};var ew=n(23691),eI=n(59772);async function eM({client:e,chainId:t,txHash:n,onReplaced:r}){let{transactionReceipt:i,replacementReason:a}=await eE(e,n,r);if(!i?.status){let e=await U(t),s=await eE(e,n,r);i=s.transactionReceipt,a=s.replacementReason}if(i?.status==="reverted")throw new f.Jn(h.Gf.TransactionFailed,"Transaction was reverted.");if("cancelled"===a||"replaced"===a)throw new f.Jn(h.Gf.TransactionCanceled,"Transaction was canceled or replaced.");return i}async function eE(e,t,n){let r,i;try{i=await (0,eI.n)(e,{hash:t,onReplaced:e=>{r=e.reason,n?.(e)}})}catch{}return{transactionReceipt:i,replacementReason:r}}let ev=async({client:e,chain:t,step:n,statusManager:r,executionOptions:i,allowUserInteraction:a=!1,batchingSupported:s=!1,permit2Supported:u=!1,disableMessageSigning:c=!1})=>{let d=r.findOrCreateProcess({step:n,type:"TOKEN_ALLOWANCE",chainId:n.action.fromChainId});try{let h;if(d.txHash&&"DONE"!==d.status)return await eb(e,d.txHash,d.type,n,t,r),{status:"DONE"};r.updateProcess(n,d.type,"STARTED");let f=u?t.permit2:n.estimate.approvalAddress,p=BigInt(n.action.fromAmount),g=await V(e,n.action.fromToken.address,e.account.address,f);if(p<=g)return r.updateProcess(n,d.type,"DONE"),{status:"DONE"};let y=(0,ew.F)(n),m=!!t.permit2Proxy&&!s&&!c;if(y?h=n.typedData.find(e=>"Permit"===e.primaryType):m&&(h=await z(e,eg,"getNativePermit",{chainId:t.id,tokenAddress:n.action.fromToken.address,spenderAddress:t.permit2Proxy,amount:p})),r.updateProcess(n,d.type,"ACTION_REQUIRED"),!a)return{status:"ACTION_REQUIRED"};if(m&&h){let t=await (0,l.T)(e,o.C,"signTypedData")({account:e.account,domain:h.domain,types:h.types,primaryType:"Permit",message:h.message});return r.updateProcess(n,d.type,"DONE"),{status:"NATIVE_PERMIT",data:{...h,signature:t}}}let w=u?I.Is:p,M=await em(e,n.action.fromToken.address,f,w,i,s);if(s)return r.updateProcess(n,d.type,"DONE"),{status:"BATCH_APPROVAL",data:{to:n.action.fromToken.address,data:M,chainId:n.action.fromToken.chainId}};return await eb(e,M,d.type,n,t,r),{status:"DONE"}}catch(t){let e=await J(t,n,d);throw r.updateProcess(n,d.type,"FAILED",{error:{message:e.cause.message,code:e.code}}),r.updateExecution(n,"FAILED"),e}},eb=async(e,t,n,r,i,a)=>{let s=i.metamask.blockExplorerUrls[0],o=e=>`${s}tx/${e}`;a.updateProcess(r,n,"PENDING",{txHash:t,txLink:o(t)});let u=await eM({client:e,chainId:i.id,txHash:t,onReplaced(e){let t=e.transaction.hash;a.updateProcess(r,n,"PENDING",{txHash:t,txLink:o(t)})}}),c=u?.transactionHash||t;a.updateProcess(r,n,"DONE",{txHash:c,txLink:o(c)})};var eT=n(27417),eN=n(100);let eA=(e,t,n,r,i)=>{let{v:a,r:s,s:o}=(0,eN.u)(r);return(0,ey.p)({abi:H,functionName:"callDiamondWithEIP2612Signature",args:[e,t,n,Number(a),s,o,i]})},eS=(e,t,n,r,i,a,s,o)=>o&&s?(0,ey.p)({abi:H,functionName:"callDiamondWithPermit2Witness",args:[i,s,[[e,t],n,r],a]}):(0,ey.p)({abi:H,functionName:"callDiamondWithPermit2",args:[i,[[e,t],n,r],a]}),eC=async(e,t,n,r)=>{let i=await z(e,R.J,"readContract",{address:t.permit2Proxy,abi:H,functionName:"nextNonce",args:[e.account.address]});return{permitted:{token:n,amount:r},spender:t.permit2Proxy,nonce:i,deadline:BigInt(Math.floor(Date.now()/1e3)+1800)}};function eD(e,t){if(!e)throw Error("Invariant failed")}let ex=I.Is,ek=I.Is,eO=I.Is;function ej(e,t){return{name:"Permit2",chainId:t,verifyingContract:e}}let eL=[{name:"token",type:"address"},{name:"amount",type:"uint256"}],eP={TokenPermissions:eL,PermitTransferFrom:[{name:"permitted",type:"TokenPermissions"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]},e_={TokenPermissions:eL,PermitBatchTransferFrom:[{name:"permitted",type:"TokenPermissions[]"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"}]};function eU(e){eD(ex>=e.amount,"AMOUNT_OUT_OF_RANGE")}async function ez(e){var t,n;let{client:r,chain:i,tokenAddress:a,amount:s,data:u,witness:c}=e,d=await eC(r,i,a,s),h=c?{witness:{diamondAddress:i.diamondAddress,diamondCalldataHash:(0,en.S)(u)},witnessTypeName:"LiFiCall",witnessType:{LiFiCall:[{name:"diamondAddress",type:"address"},{name:"diamondCalldataHash",type:"bytes32"}]}}:void 0,f=(t=i.permit2,n=i.id,Array.isArray(d.permitted)?function(e,t,n,r){eD(eO>=e.deadline,"SIG_DEADLINE_OUT_OF_RANGE"),eD(ek>=e.nonce,"NONCE_OUT_OF_RANGE");let i=ej(t,n);return e.permitted.forEach(eU),{domain:i,types:r?{...r.witnessType,TokenPermissions:eL,PermitBatchWitnessTransferFrom:[{name:"permitted",type:"TokenPermissions[]"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"},{name:"witness",type:r.witnessTypeName}]}:e_,message:r?Object.assign(e,{witness:r.witness}):e}}(d,t,n,h):function(e,t,n,r){eD(eO>=e.deadline,"SIG_DEADLINE_OUT_OF_RANGE"),eD(ek>=e.nonce,"NONCE_OUT_OF_RANGE");let i=ej(t,n);return eU(e.permitted),{domain:i,types:r?{TokenPermissions:eL,...r.witnessType,PermitWitnessTransferFrom:[{name:"permitted",type:"TokenPermissions"},{name:"spender",type:"address"},{name:"nonce",type:"uint256"},{name:"deadline",type:"uint256"},{name:"witness",type:r.witnessTypeName}]}:eP,message:r?Object.assign(e,{witness:r.witness}):e}}(d,t,n,h)),p=c?"PermitWitnessTransferFrom":"PermitTransferFrom",g=await (0,l.T)(r,o.C,"signTypedData")({account:r.account,primaryType:p,domain:f.domain,types:f.types,message:f.message});return{...f,primaryType:p,signature:g}}var eR=n(78764);let eB=async(e,t,n,r,i)=>{if(await (0,l.T)(e,eR.T,"getChainId")(void 0)===n.action.fromChainId)return e;n.execution=t.initExecutionObject(n),t.updateExecution(n,"ACTION_REQUIRED");let a=t.findOrCreateProcess({step:n,type:"SWITCH_CHAIN",status:"ACTION_REQUIRED"});if(r)try{let e,r=await i?.(n.action.fromChainId);if(r&&(e=await (0,l.T)(r,eR.T,"getChainId")(void 0)),e!==n.action.fromChainId)throw new f.mZ(h.Gf.ChainSwitchError,"Chain switch required.");return a=t.updateProcess(n,a.type,"DONE"),t.updateExecution(n,"PENDING"),r}catch(e){throw t.updateProcess(n,a.type,"FAILED",{error:{message:e.message,code:h.Gf.ChainSwitchError}}),t.updateExecution(n,"FAILED"),e}};var eH=n(50651);let eW=async(e,t)=>{let{receipts:n,status:r,statusCode:i}=await (0,l.T)(e,eH.c,"waitForCallsStatus")({id:t,timeout:864e5});if("success"===r||"CONFIRMED"===r){if(!n?.length||!n.every(e=>e.transactionHash)||n.some(e=>"reverted"===e.status))throw new f.Jn(h.Gf.TransactionFailed,"Transaction was reverted.");return n.at(-1)}if(i>=400&&i<500)throw new f.Jn(h.Gf.TransactionCanceled,"Transaction was canceled.");throw new f.Jn(h.Gf.TransactionFailed,"Transaction failed.")};var eG=n(56881);let eY=async(e,t)=>(0,eG.s)(async()=>{let n=await (0,p.Dd)({taskId:e,fromChain:t.action.fromChainId,toChain:t.action.toChainId,..."custom"!==t.tool&&{bridge:t.tool}}).catch(e=>{});switch(n?.status){case"PENDING":return;case"DONE":{let e=n?.transactionStatus?.sending;return{status:"success",gasUsed:e?.gasUsed,transactionHash:n?.metadata.txHash}}case"FAILED":throw new f.Jn(h.Gf.TransactionFailed,"Transaction was reverted.");default:throw new f.Jn(h.Gf.TransactionNotFound,"Transaction not found.")}},5e3,3,(e,t)=>!(t instanceof f.Jn));class eQ extends g.d{client;constructor(e){super(e),this.client=e.client}checkClient=async(e,t)=>{let n=await eB(this.client,this.statusManager,e,this.allowUserInteraction,this.executionOptions?.switchChainHook);n&&(this.client=n);let r=this.client.account?.address;if(!r){let e=await (0,l.T)(this.client,a.t,"getAddresses")(void 0);r=e?.[0]}if(r?.toLowerCase()!==e.action.fromAddress?.toLowerCase()){let n=t;n||(n=this.statusManager.findOrCreateProcess({step:e,type:"TRANSACTION"}));let r="The wallet address that requested the quote does not match the wallet address attempting to sign the transaction.";throw this.statusManager.updateProcess(e,n.type,"FAILED",{error:{code:h.Gf.WalletChangedDuringExecution,message:r}}),this.statusManager.updateExecution(e,"FAILED"),await J(new f.Jn(h.Gf.WalletChangedDuringExecution,r),e,t)}return n};waitForTransaction=async({step:e,process:t,fromChain:n,toChain:r,txType:i,txHash:a,isBridgeExecution:s})=>{let o;switch(i){case"batched":o=await eW(this.client,a);break;case"relayed":o=await eY(a,e);break;default:o=await eM({client:this.client,chainId:n.id,txHash:a,onReplaced:r=>{this.statusManager.updateProcess(e,t.type,"PENDING",{txHash:r.transaction.hash,txLink:`${n.metamask.blockExplorerUrls[0]}tx/${r.transaction.hash}`})}})}o?.transactionHash&&o.transactionHash!==a&&(t=this.statusManager.updateProcess(e,t.type,"PENDING",{txHash:o.transactionHash,txLink:`${n.metamask.blockExplorerUrls[0]}tx/${o.transactionHash}`})),s&&(t=this.statusManager.updateProcess(e,t.type,"DONE")),await (0,w.w)(e,t,n,r,this.statusManager)};executeStep=async(e,t=!1)=>{let n;e.execution=this.statusManager.initExecutionObject(e);let r=e.execution?.process.find(e=>"RECEIVING_CHAIN"===e.type);if(r?.substatus!=="WAIT_DESTINATION_TRANSACTION"&&!await this.checkClient(e))return e;let i=await d.$.getChainById(e.action.fromChainId),a=await d.$.getChainById(e.action.toChainId),g=[],I=!t&&"thorswap"!==e.tool&&await (0,eT.F)({client:this.client,chainId:i.id}),M=i.id!==a.id,E=M?"CROSS_CHAIN":"SWAP",v=e.execution.process.find(e=>e.type===E),b=i.nativeToken.address===e.action.fromToken.address,T=(0,ew.F)(e),N=this.executionOptions?.disableMessageSigning||"lifi"!==e.type,A=!!i.permit2&&!!i.permit2Proxy&&!I&&!b&&!N&&!!e.estimate.approvalAddress;if(!v?.txHash&&!b&&e.estimate.approvalAddress){let t=await ev({client:this.client,chain:i,step:e,statusManager:this.statusManager,executionOptions:this.executionOptions,allowUserInteraction:this.allowUserInteraction,batchingSupported:I,permit2Supported:A,disableMessageSigning:N});if("BATCH_APPROVAL"===t.status&&I&&g.push(t.data),"NATIVE_PERMIT"===t.status&&(n=t.data),"ACTION_REQUIRED"===t.status&&!this.allowUserInteraction)return e}let S=this.statusManager.findProcess(e,E);if(S?.status==="DONE")return await (0,w.w)(e,S,i,a,this.statusManager),e;try{let t;if(S?.txHash){if(!await this.checkClient(e,S))return e;let t=S.txHash,n=S.txType;return await this.waitForTransaction({step:e,process:S,fromChain:i,toChain:a,txType:n,txHash:t,isBridgeExecution:M}),e}let r=!I&&!n&&A;if(S=this.statusManager.findOrCreateProcess({step:e,type:r?"PERMIT":E,status:"STARTED",chainId:i.id}),await (0,y.r)(this.client.account.address,e),!e.transactionRequest){let t,{execution:n,...r}=e;t=T?{...await (0,p.XD)({fromChain:r.action.fromChainId,fromToken:r.action.fromToken.address,fromAddress:r.action.fromAddress,fromAmount:r.action.fromAmount,toChain:r.action.toChainId,toToken:r.action.toToken.address,slippage:r.action.slippage,toAddress:r.action.toAddress,allowBridges:[r.tool]}),id:r.id}:await (0,p.Bv)(r);let i=await (0,m.w)(this.statusManager,e,t,this.allowUserInteraction,this.executionOptions);Object.assign(e,{...i,execution:e.execution})}if(!e.transactionRequest)throw new f.Jn(h.Gf.TransactionUnprepared,"Unable to prepare transaction.");let d={to:e.transactionRequest.to,from:e.transactionRequest.from,data:e.transactionRequest.data,value:e.transactionRequest.value?BigInt(e.transactionRequest.value):void 0,gas:e.transactionRequest.gasLimit?BigInt(e.transactionRequest.gasLimit):void 0,maxPriorityFeePerGas:this.client.account?.type==="local"?await eh(this.client):e.transactionRequest.maxPriorityFeePerGas?BigInt(e.transactionRequest.maxPriorityFeePerGas):void 0};if(this.executionOptions?.updateTransactionRequestHook){let e=await this.executionOptions.updateTransactionRequestHook({requestType:"transaction",...d});d={...d,...e}}if(!await this.checkClient(e,S)||(S=this.statusManager.updateProcess(e,S.type,"ACTION_REQUIRED"),!this.allowUserInteraction))return e;let w="standard";if(I){let e={chainId:i.id,data:d.data,to:d.to,value:d.value};g.push(e);let{id:n}=await (0,l.T)(this.client,s.yM,"sendCalls")({account:this.client.account,calls:g});t=n,w="batched"}else if(T){let r=e.typedData.find(e=>"PermitWitnessTransferFrom"===e.primaryType||"Order"===e.primaryType);if(!r)throw new f.Jn(h.Gf.TransactionUnprepared,"Unable to prepare transaction. Typed data for transfer is not found.");let a=await (0,l.T)(this.client,o.C,"signTypedData")({account:this.client.account,primaryType:r.primaryType,domain:r.domain,types:r.types,message:r.message});this.statusManager.updateProcess(e,S.type,"DONE"),S=this.statusManager.findOrCreateProcess({step:e,type:E,status:"PENDING",chainId:i.id});let s=[{...r,signature:a}];n&&s.unshift(n);let{execution:u,...c}=e;t=(await (0,p.mn)({...c,typedData:s})).taskId,w="relayed"}else{if(n)d.data=eA(e.action.fromToken.address,BigInt(e.action.fromAmount),n.message.deadline,n.signature,d.data);else if(A){let t=await ez({client:this.client,chain:i,tokenAddress:e.action.fromToken.address,amount:BigInt(e.action.fromAmount),data:d.data});this.statusManager.updateProcess(e,S.type,"DONE"),S=this.statusManager.findOrCreateProcess({step:e,type:E,status:"PENDING",chainId:i.id}),d.data=eS(e.action.fromToken.address,BigInt(e.action.fromAmount),t.message.nonce,t.message.deadline,d.data,t.signature)}if(n||A){d.to=i.permit2Proxy;try{let e=await z(this.client,u.Q,"estimateGas",{account:this.client.account,to:d.to,data:d.data,value:d.value});d.gas=d.gas&&d.gas>e?d.gas:e}catch(e){}finally{this.statusManager.updateProcess(e,S.type,"DONE")}}S=this.statusManager.updateProcess(e,S.type,"ACTION_REQUIRED"),t=await (0,l.T)(this.client,c.v,"sendTransaction")({to:d.to,account:this.client.account,data:d.data,value:d.value,gas:d.gas,gasPrice:d.gasPrice,maxFeePerGas:d.maxFeePerGas,maxPriorityFeePerGas:d.maxPriorityFeePerGas,chain:ed(i)})}return S=this.statusManager.updateProcess(e,S.type,"PENDING",{txHash:t,txType:w,txLink:"standard"===w?`${i.metamask.blockExplorerUrls[0]}tx/${t}`:void 0}),await this.waitForTransaction({step:e,process:S,fromChain:i,toChain:a,txHash:t,txType:w,isBridgeExecution:M}),e}catch(r){if(et(r)&&!t)return e.execution=void 0,this.executeStep(e,!0);let n=await J(r,e,S);throw S=this.statusManager.updateProcess(e,S?.type||E,"FAILED",{error:{message:n.cause.message,code:n.code}}),this.statusManager.updateExecution(e,"FAILED"),n}}}var eF=n(2881),eK=n(46383);let eV=async e=>{try{let t=await U(M.n.ETH);return await (0,eF.B)(t,{name:(0,eK.S)(e)})}catch(e){return}};var e$=n(77665),eq=n(77032);let eZ=e=>e===I.LV||e===I.gK,eX=async(e,t)=>{if(0===t.length)return[];let{chainId:n}=t[0];for(let e of t)e.chainId!==n&&console.warn("Requested tokens have to be on the same chain.");let r=await ef(n);return r&&t.length>1?eJ(n,t,e,r):e0(n,t,e)},eJ=async(e,t,n,r)=>{let i=await U(e),a=t.map(e=>eZ(e.address)?{address:r,abi:Q,functionName:"getEthBalance",args:[n]}:{address:e.address,abi:F,functionName:"balanceOf",args:[n]}),[s,o]=await Promise.all([(0,e$.G)(i),(0,eu.C)(i,{contracts:a,multicallAddress:r})]);return o.length?t.map((e,t)=>({...e,amount:o[t].result,blockNumber:s})):[]},e0=async(e,t,n)=>{let r=await U(e),i=t.map(e=>eZ(e.address)?(0,eq.r)(r,{address:n}):(0,R.J)(r,{address:e.address,abi:F,functionName:"balanceOf",args:[n]})),[a,s]=await Promise.all([(0,e$.G)(r),Promise.allSettled(i)]);return t.map((e,t)=>{let n=s[t];return"rejected"===n.status?{...e,blockNumber:a}:{...e,amount:n.value,blockNumber:a}})};function e1(e){let t=e??{};return{get type(){return r.I.EVM},get options(){return t},isAddress:i.P,resolveAddress:eV,getBalance:eX,getWalletClient:t.getWalletClient,async getStepExecutor(e){if(!t.getWalletClient)throw Error("Client is not provided.");return new eQ({client:await t.getWalletClient(),routeId:e.routeId,executionOptions:{...e.executionOptions,switchChainHook:t.switchChain??e.executionOptions?.switchChainHook}})},setOptions(e){Object.assign(t,e)}}}},55187:(e,t)=>{let n="[0-9]+",r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",i="(?:(?![A-Z0-9 $%*+\\-./:]|"+(r=r.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";t.KANJI=RegExp(r,"g"),t.BYTE_KANJI=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=RegExp(i,"g"),t.NUMERIC=RegExp(n,"g"),t.ALPHANUMERIC=RegExp("[A-Z $%*+\\-./:]+","g");let a=RegExp("^"+r+"$"),s=RegExp("^"+n+"$"),o=RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return a.test(e)},t.testNumeric=function(e){return s.test(e)},t.testAlphanumeric=function(e){return o.test(e)}},56459:(e,t,n)=>{let r=n(5041).getSymbolSize;t.getPositions=function(e){let t=r(e);return[[0,0],[t-7,0],[0,t-7]]}},56530:(e,t,n)=>{"use strict";let r,i;n.d(t,{r:()=>nR});var a,s,o,u,c,l,d,h,f,p,g,y,m,w,I,M,E,v,b,T,N,A,S,C,D,x,k,O,j,L,P,_,U,z,R,B,H,W,G,Y,Q,F,K,V,$,q,Z,X,J,ee,et,en,er,ei,ea,es,eo,eu,ec,el,ed,eh,ef,ep,eg,ey,em,ew,eI,eM,eE,ev,eb,eT,eN,eA,eS,eC,eD,ex,ek,eO,ej,eL,eP,e_,eU,ez,eR,eB,eH,eW,eG,eY,eQ,eF,eK,eV,e$,eq,eZ,eX,eJ,e0,e1,e2,e4,e3,e5,e8,e6,e9=n(88371),e7=n(16591),te=n(38582),tt=n(4398);let tn="solana:signIn",tr="solana:signMessage",ti="solana:signAndSendTransaction",ta="solana:signTransaction";var ts=n(39456),to=n(4774);let tu="standard:disconnect";var tc=n(57437);let tl="solana:mainnet",td="solana:devnet",th="solana:testnet",tf="solana:localnet",tp=`(?:\\nURI: (?<uri>[^\\n]+))?(?:\\nVersion: (?<version>[^\\n]+))?(?:\\nChain ID: (?<chainId>[^\\n]+))?(?:\\nNonce: (?<nonce>[^\\n]+))?(?:\\nIssued At: (?<issuedAt>[^\\n]+))?(?:\\nExpiration Time: (?<expirationTime>[^\\n]+))?(?:\\nNot Before: (?<notBefore>[^\\n]+))?(?:\\nRequest ID: (?<requestId>[^\\n]+))?(?:\\nResources:(?<resources>(?:\\n- [^\\n]+)*))?`;RegExp(`^(?<domain>[^\\n]+?) wants you to sign in with your Solana account:\\n(?<address>[^\\n]+)(?:\\n|$)(?:\\n(?<statement>[\\S\\s]*?)(?:\\n|$))??${tp}\\n*$`);let tg={ERROR_ASSOCIATION_PORT_OUT_OF_RANGE:"ERROR_ASSOCIATION_PORT_OUT_OF_RANGE",ERROR_FORBIDDEN_WALLET_BASE_URL:"ERROR_FORBIDDEN_WALLET_BASE_URL",ERROR_SECURE_CONTEXT_REQUIRED:"ERROR_SECURE_CONTEXT_REQUIRED",ERROR_SESSION_CLOSED:"ERROR_SESSION_CLOSED",ERROR_SESSION_TIMEOUT:"ERROR_SESSION_TIMEOUT",ERROR_WALLET_NOT_FOUND:"ERROR_WALLET_NOT_FOUND",ERROR_INVALID_PROTOCOL_VERSION:"ERROR_INVALID_PROTOCOL_VERSION"};class ty extends Error{constructor(...e){let[t,n,r]=e;super(n),this.code=t,this.data=r,this.name="SolanaMobileWalletAdapterError"}}class tm extends Error{constructor(...e){let[t,n,r,i]=e;super(r),this.code=n,this.data=i,this.jsonRpcMessageId=t,this.name="SolanaMobileWalletAdapterProtocolError"}}function tw(e,t,n,r){return new(n||(n=Promise))(function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}u((r=r.apply(e,t||[])).next())})}function tI(e,t){let n=window.btoa(String.fromCharCode.call(null,...e));return t?n.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):n}function tM(e,t){return tw(this,void 0,void 0,function*(){let n=yield crypto.subtle.exportKey("raw",e),r=yield crypto.subtle.sign({hash:"SHA-256",name:"ECDSA"},t,n),i=new Uint8Array(n.byteLength+r.byteLength);return i.set(new Uint8Array(n),0),i.set(new Uint8Array(r),n.byteLength),i})}let tE="solana:cloneAuthorization";function tv(e,t){return new Proxy({},{get:(n,r)=>"then"===r?null:(null==n[r]&&(n[r]=function(n){return tw(this,void 0,void 0,function*(){let{method:i,params:a}=function(e,t,n){let r=t,i=e.toString().replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`).toLowerCase();switch(e){case"authorize":{let{chain:e}=r;if("legacy"===n){switch(e){case"solana:testnet":e="testnet";break;case"solana:devnet":e="devnet";break;case"solana:mainnet":e="mainnet-beta";break;default:e=r.cluster}r.cluster=e}else{switch(e){case"testnet":case"devnet":e=`solana:${e}`;break;case"mainnet-beta":e="solana:mainnet"}r.chain=e}}case"reauthorize":{let{auth_token:e,identity:t}=r;e&&("legacy"===n?(i="reauthorize",r={auth_token:e,identity:t}):i="authorize")}}return{method:i,params:r}}(r,n,e),s=yield t(i,a);return"authorize"===i&&a.sign_in_payload&&!s.sign_in_result&&(s.sign_in_result=yield function(e,t,n){var r;return tw(this,void 0,void 0,function*(){var i;let a=null!=(r=e.domain)?r:window.location.host,s=t.accounts[0].address,o=(i=function(e){let t=`${e.domain} wants you to sign in with your Solana account:
`;t+=`${e.address}`,e.statement&&(t+=`

${e.statement}`);let n=[];if(e.uri&&n.push(`URI: ${e.uri}`),e.version&&n.push(`Version: ${e.version}`),e.chainId&&n.push(`Chain ID: ${e.chainId}`),e.nonce&&n.push(`Nonce: ${e.nonce}`),e.issuedAt&&n.push(`Issued At: ${e.issuedAt}`),e.expirationTime&&n.push(`Expiration Time: ${e.expirationTime}`),e.notBefore&&n.push(`Not Before: ${e.notBefore}`),e.requestId&&n.push(`Request ID: ${e.requestId}`),e.resources)for(let t of(n.push("Resources:"),e.resources))n.push(`- ${t}`);return n.length&&(t+=`

${n.join("\n")}`),t}(Object.assign(Object.assign({},e),{domain:a,address:s})),window.btoa(i)),u=yield n("sign_messages",{addresses:[s],payloads:[o]});return{address:s,signed_message:o,signature:u.signed_payloads[0].slice(o.length)}})}(a.sign_in_payload,s,t)),function(e,t,n){if("getCapabilities"===e)switch(n){case"legacy":{let e=["solana:signTransactions"];return!0===t.supports_clone_authorization&&e.push(tE),Object.assign(Object.assign({},t),{features:e})}case"v1":return Object.assign(Object.assign({},t),{supports_sign_and_send_transactions:!0,supports_clone_authorization:t.features.includes(tE)})}return t}(r,s,e)})}),n[r]),defineProperty:()=>!1,deleteProperty:()=>!1})}function tb(e,t){return tw(this,void 0,void 0,function*(){let n=e.slice(0,4),i=e.slice(4,16),a=e.slice(16),s=yield crypto.subtle.decrypt(tT(n,i),t,a);return(void 0===r&&(r=new TextDecoder("utf-8")),r).decode(s)})}function tT(e,t){return{additionalData:e,iv:t,name:"AES-GCM",tagLength:128}}function tN(){return tw(this,void 0,void 0,function*(){return yield crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign"])})}function tA(){return tw(this,void 0,void 0,function*(){return yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey","deriveBits"])})}function tS(e){let t="",n=new Uint8Array(e),r=n.byteLength;for(let e=0;e<r;e++)t+=String.fromCharCode(n[e]);return window.btoa(t)}function tC(e){if(e<49152||e>65535)throw new ty(tg.ERROR_ASSOCIATION_PORT_OUT_OF_RANGE,`Association port number must be between 49152 and 65535. ${e} given.`,{port:e});return e}function tD(e){return e.replace(/[/+=]/g,e=>({"/":"_","+":"-","=":"."})[e])}function tx(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function tk(e,t){let n=null;if(t){try{n=new URL(t)}catch(e){}if((null==n?void 0:n.protocol)!=="https:")throw new ty(tg.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}return n||(n=new URL("solana-wallet:/")),new URL(e.startsWith("/")?e:[...tx(n.pathname),...tx(e)].join("/"),n)}function tO(e,t){return tw(this,void 0,void 0,function*(){return function(e,t,n){return tw(this,void 0,void 0,function*(){let r=function(e){if(e>=0x100000000)throw Error("Outbound sequence number overflow. The maximum sequence number is 32-bytes.");let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!1),new Uint8Array(t)}(t),i=new Uint8Array(12);crypto.getRandomValues(i);let a=yield crypto.subtle.encrypt(tT(r,i),n,new TextEncoder().encode(e)),s=new Uint8Array(r.byteLength+i.byteLength+a.byteLength);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(i),r.byteLength),s.set(new Uint8Array(a),r.byteLength+i.byteLength),s})}(JSON.stringify(e),e.id,t)})}function tj(e,t){return tw(this,void 0,void 0,function*(){let n=JSON.parse((yield tb(e,t)));if(Object.hasOwnProperty.call(n,"error"))throw new tm(n.id,n.error.code,n.error.message);return n})}function tL(e,t,n){return tw(this,void 0,void 0,function*(){let[r,i]=yield Promise.all([crypto.subtle.exportKey("raw",t),crypto.subtle.importKey("raw",e.slice(0,65),{name:"ECDH",namedCurve:"P-256"},!1,[])]),a=yield crypto.subtle.deriveBits({name:"ECDH",public:i},n,256),s=yield crypto.subtle.importKey("raw",a,"HKDF",!1,["deriveKey"]);return yield crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:new Uint8Array(r),info:new Uint8Array},s,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])})}function tP(e,t){return tw(this,void 0,void 0,function*(){let n=JSON.parse((yield tb(e,t))),r="legacy";if(Object.hasOwnProperty.call(n,"v"))switch(n.v){case 1:case"1":case"v1":r="v1";break;case"legacy":r="legacy";break;default:throw new ty(tg.ERROR_INVALID_PROTOCOL_VERSION,`Unknown/unsupported protocol version: ${n.v}`)}return{protocol_version:r}})}let t_={Firefox:0,Other:1},tU=null,tz={retryDelayScheduleMs:[150,150,200,500,500,750,750,1e3],timeoutMs:3e4},tR="com.solana.mobilewalletadapter.v1",tB="com.solana.mobilewalletadapter.v1.base64";function tH(){if("undefined"==typeof window||!0!==window.isSecureContext)throw new ty(tg.ERROR_SECURE_CONTEXT_REQUIRED,"The mobile wallet adapter protocol must be used in a secure context (`https`).")}function tW(e){let t;try{t=new URL(e)}catch(e){throw new ty(tg.ERROR_FORBIDDEN_WALLET_BASE_URL,"Invalid base URL supplied by wallet")}if("https:"!==t.protocol)throw new ty(tg.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}function tG(e){return new DataView(e).getUint32(0,!1)}var tY=n(77527);function tQ(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}function tF(e,t,n,r){return new(n||(n=Promise))(function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}u((r=r.apply(e,t||[])).next())})}function tK(e){return window.btoa(String.fromCharCode.call(null,...e))}function tV(e){return new Uint8Array(window.atob(e).split("").map(e=>e.charCodeAt(0)))}function t$(e){return tK("version"in e?e.serialize():e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}function tq(e){let t=e[0]*tt.P3+1;return"legacy"===tt.B2.deserializeMessageVersion(e.slice(t,e.length))?tt.ZX.from(e):tt.Kt.deserialize(e)}function tZ(e){return new Proxy({},{get(t,n){if(null==t[n])switch(n){case"signAndSendTransactions":t[n]=function(t){var{minContextSlot:n,commitment:r,skipPreflight:i,maxRetries:a,waitForCommitmentToSendNextTransaction:s,transactions:o}=t,u=tQ(t,["minContextSlot","commitment","skipPreflight","maxRetries","waitForCommitmentToSendNextTransaction","transactions"]);return tF(this,void 0,void 0,function*(){let t=o.map(t$),c={min_context_slot:n,commitment:r,skip_preflight:i,max_retries:a,wait_for_commitment_to_send_next_transaction:s},{signatures:l}=yield e.signAndSendTransactions(Object.assign(Object.assign(Object.assign({},u),Object.values(c).some(e=>null!=e)?{options:c}:null),{payloads:t}));return l.map(tV).map(tY.encode)})};break;case"signMessages":t[n]=function(t){var{payloads:n}=t,r=tQ(t,["payloads"]);return tF(this,void 0,void 0,function*(){let t=n.map(tK),{signed_payloads:i}=yield e.signMessages(Object.assign(Object.assign({},r),{payloads:t}));return i.map(tV)})};break;case"signTransactions":t[n]=function(t){var{transactions:n}=t,r=tQ(t,["transactions"]);return tF(this,void 0,void 0,function*(){let t=n.map(t$),{signed_payloads:i}=yield e.signTransactions(Object.assign(Object.assign({},r),{payloads:t}));return i.map(tV).map(tq)})};break;default:t[n]=e[n]}return t[n]},defineProperty:()=>!1,deleteProperty:()=>!1})}function tX(e,t,n,r){return new(n||(n=Promise))(function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}u((r=r.apply(e,t||[])).next())})}function tJ(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function t0(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}let t1=`
<div class="mobile-wallet-adapter-embedded-modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div data-modal-close style="position: absolute; width: 100%; height: 100%;"></div>
	<div class="mobile-wallet-adapter-embedded-modal-card">
		<div>
			<button data-modal-close class="mobile-wallet-adapter-embedded-modal-close">
				<svg width="14" height="14">
					<path d="M 6.7125,8.3036995 1.9082,13.108199 c -0.2113,0.2112 -0.4765,0.3168 -0.7957,0.3168 -0.3192,0 -0.5844,-0.1056 -0.7958,-0.3168 C 0.1056,12.896899 0,12.631699 0,12.312499 c 0,-0.3192 0.1056,-0.5844 0.3167,-0.7958 L 5.1212,6.7124995 0.3167,1.9082 C 0.1056,1.6969 0,1.4317 0,1.1125 0,0.7933 0.1056,0.5281 0.3167,0.3167 0.5281,0.1056 0.7933,0 1.1125,0 1.4317,0 1.6969,0.1056 1.9082,0.3167 L 6.7125,5.1212 11.5167,0.3167 C 11.7281,0.1056 11.9933,0 12.3125,0 c 0.3192,0 0.5844,0.1056 0.7957,0.3167 0.2112,0.2114 0.3168,0.4766 0.3168,0.7958 0,0.3192 -0.1056,0.5844 -0.3168,0.7957 L 8.3037001,6.7124995 13.1082,11.516699 c 0.2112,0.2114 0.3168,0.4766 0.3168,0.7958 0,0.3192 -0.1056,0.5844 -0.3168,0.7957 -0.2113,0.2112 -0.4765,0.3168 -0.7957,0.3168 -0.3192,0 -0.5844,-0.1056 -0.7958,-0.3168 z" />
				</svg>
			</button>
		</div>
		<div class="mobile-wallet-adapter-embedded-modal-content"></div>
	</div>
</div>
`,t2=`
.mobile-wallet-adapter-embedded-modal-container {
    display: flex; /* Use flexbox to center content */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    overflow-y: auto; /* enable scrolling */
}

.mobile-wallet-adapter-embedded-modal-card {
    display: flex;
    flex-direction: column;
    margin: auto 20px;
    max-width: 780px;
    padding: 20px;
    border-radius: 24px;
    background: #ffffff;
    font-family: "Inter Tight", "PT Sans", Calibri, sans-serif;
    transform: translateY(-200%);
    animation: slide-in 0.5s forwards;
}

@keyframes slide-in {
    100% { transform: translateY(0%); }
}

.mobile-wallet-adapter-embedded-modal-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    cursor: pointer;
    background: #e4e9e9;
    border: none;
    border-radius: 50%;
}

.mobile-wallet-adapter-embedded-modal-close:focus-visible {
    outline-color: red;
}

.mobile-wallet-adapter-embedded-modal-close svg {
    fill: #546266;
    transition: fill 200ms ease 0s;
}

.mobile-wallet-adapter-embedded-modal-close:hover svg {
    fill: #fff;
}
`,t4=`
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
`;class t3{constructor(){a.add(this),s.set(this,null),o.set(this,{}),u.set(this,!1),this.dom=null,this.open=()=>{console.debug("Modal open"),tJ(this,a,"m",l).call(this),tJ(this,s,"f")&&(tJ(this,s,"f").style.display="flex")},this.close=e=>{var t;console.debug("Modal close"),tJ(this,a,"m",d).call(this),tJ(this,s,"f")&&(tJ(this,s,"f").style.display="none"),null==(t=tJ(this,o,"f").close)||t.forEach(t=>t(e))},h.set(this,e=>{"Escape"===e.key&&this.close(e)}),this.init=this.init.bind(this),t0(this,s,document.getElementById("mobile-wallet-adapter-embedded-root-ui"),"f")}init(){return tX(this,void 0,void 0,function*(){console.log("Injecting modal"),tJ(this,a,"m",c).call(this)})}addEventListener(e,t){var n;return(null==(n=tJ(this,o,"f")[e])?void 0:n.push(t))||(tJ(this,o,"f")[e]=[t]),()=>this.removeEventListener(e,t)}removeEventListener(e,t){var n;tJ(this,o,"f")[e]=null==(n=tJ(this,o,"f")[e])?void 0:n.filter(e=>t!==e)}}s=new WeakMap,o=new WeakMap,u=new WeakMap,h=new WeakMap,a=new WeakSet,c=function(){if(document.getElementById("mobile-wallet-adapter-embedded-root-ui")){tJ(this,s,"f")||t0(this,s,document.getElementById("mobile-wallet-adapter-embedded-root-ui"),"f");return}t0(this,s,document.createElement("div"),"f"),tJ(this,s,"f").id="mobile-wallet-adapter-embedded-root-ui",tJ(this,s,"f").innerHTML=t1,tJ(this,s,"f").style.display="none";let e=tJ(this,s,"f").querySelector(".mobile-wallet-adapter-embedded-modal-content");e&&(e.innerHTML=this.contentHtml);let t=document.createElement("style");t.id="mobile-wallet-adapter-embedded-modal-styles",t.textContent=t2+this.contentStyles;let n=document.createElement("div");n.innerHTML=t4,this.dom=n.attachShadow({mode:"closed"}),this.dom.appendChild(t),this.dom.appendChild(tJ(this,s,"f")),document.body.appendChild(n)},l=function(){!tJ(this,s,"f")||tJ(this,u,"f")||([...tJ(this,s,"f").querySelectorAll("[data-modal-close]")].forEach(e=>null==e?void 0:e.addEventListener("click",this.close)),window.addEventListener("load",this.close),document.addEventListener("keydown",tJ(this,h,"f")),t0(this,u,!0,"f"))},d=function(){if(tJ(this,u,"f"))window.removeEventListener("load",this.close),document.removeEventListener("keydown",tJ(this,h,"f")),tJ(this,s,"f")&&([...tJ(this,s,"f").querySelectorAll("[data-modal-close]")].forEach(e=>null==e?void 0:e.removeEventListener("click",this.close)),t0(this,u,!1,"f"))};class t5 extends t3{constructor(){super(...arguments),this.contentStyles=t6,this.contentHtml=t8}initWithQR(e){let t=Object.create(null,{init:{get:()=>super.init}});return tX(this,void 0,void 0,function*(){t.init.call(this),this.populateQRCode(e)})}populateQRCode(e){var t;return tX(this,void 0,void 0,function*(){let n=null==(t=this.dom)?void 0:t.getElementById("mobile-wallet-adapter-embedded-modal-qr-code-container");if(n){let t=yield ts.toCanvas(e,{width:200,margin:0});null!==n.firstElementChild?n.replaceChild(t,n.firstElementChild):n.appendChild(t)}else console.error("QRCode Container not found")})}}let t8=`
<div class="mobile-wallet-adapter-embedded-modal-qr-content">
    <div>
        <svg class="mobile-wallet-adapter-embedded-modal-icon" width="100%" height="100%">
            <circle r="52" cx="53" cy="53" fill="#99b3be" stroke="#000000" stroke-width="2"/>
            <path d="m 53,82.7305 c -3.3116,0 -6.1361,-1.169 -8.4735,-3.507 -2.338,-2.338 -3.507,-5.1625 -3.507,-8.4735 0,-3.3116 1.169,-6.1364 3.507,-8.4744 2.3374,-2.338 5.1619,-3.507 8.4735,-3.507 3.3116,0 6.1361,1.169 8.4735,3.507 2.338,2.338 3.507,5.1628 3.507,8.4744 0,3.311 -1.169,6.1355 -3.507,8.4735 -2.3374,2.338 -5.1619,3.507 -8.4735,3.507 z m 0.007,-5.25 c 1.8532,0 3.437,-0.6598 4.7512,-1.9793 1.3149,-1.3195 1.9723,-2.9058 1.9723,-4.7591 0,-1.8526 -0.6598,-3.4364 -1.9793,-4.7512 -1.3195,-1.3149 -2.9055,-1.9723 -4.7582,-1.9723 -1.8533,0 -3.437,0.6598 -4.7513,1.9793 -1.3148,1.3195 -1.9722,2.9058 -1.9722,4.7591 0,1.8527 0.6597,3.4364 1.9792,4.7512 1.3195,1.3149 2.9056,1.9723 4.7583,1.9723 z m -28,-33.5729 -3.85,-3.6347 c 4.1195,-4.025 8.8792,-7.1984 14.2791,-9.52 5.4005,-2.3223 11.2551,-3.4834 17.5639,-3.4834 6.3087,0 12.1634,1.1611 17.5639,3.4834 5.3999,2.3216 10.1596,5.495 14.2791,9.52 l -3.85,3.6347 C 77.2999,40.358 73.0684,37.5726 68.2985,35.5514 63.5292,33.5301 58.4296,32.5195 53,32.5195 c -5.4297,0 -10.5292,1.0106 -15.2985,3.0319 -4.7699,2.0212 -9.0014,4.8066 -12.6945,8.3562 z m 44.625,10.8771 c -2.2709,-2.1046 -4.7962,-3.7167 -7.5758,-4.8361 -2.7795,-1.12 -5.7983,-1.68 -9.0562,-1.68 -3.2579,0 -6.2621,0.56 -9.0125,1.68 -2.7504,1.1194 -5.2903,2.7315 -7.6195,4.8361 L 32.5189,51.15 c 2.8355,-2.6028 5.9777,-4.6086 9.4263,-6.0174 3.4481,-1.4087 7.133,-2.1131 11.0548,-2.1131 3.9217,0 7.5979,0.7044 11.0285,2.1131 3.43,1.4088 6.5631,3.4146 9.3992,6.0174 z"/>
        </svg>
        <div class="mobile-wallet-adapter-embedded-modal-title">Remote Mobile Wallet Adapter</div>
    </div>
    <div>
        <div>
            <h4 class="mobile-wallet-adapter-embedded-modal-qr-label">
                Open your wallet and scan this code
            </h4>
        </div>
        <div id="mobile-wallet-adapter-embedded-modal-qr-code-container" class="mobile-wallet-adapter-embedded-modal-qr-code-container"></div>
    </div>
</div>
<div class="mobile-wallet-adapter-embedded-modal-divider"><hr></div>
<div class="mobile-wallet-adapter-embedded-modal-footer">
    <div class="mobile-wallet-adapter-embedded-modal-subtitle">
        Follow the instructions on your device. When you're finished, this screen will update.
    </div>
    <div class="mobile-wallet-adapter-embedded-modal-progress-badge">
        <div>
            <div class="spinner">
                <div class="leftWrapper">
                    <div class="left">
                        <div class="circle"></div>
                    </div>
                </div>
                <div class="rightWrapper">
                    <div class="right">
                        <div class="circle"></div>
                    </div>
                </div>
            </div>
        </div>
        <div>Waiting for scan</div>
    </div>
</div>
`,t6=`
.mobile-wallet-adapter-embedded-modal-qr-content {
    display: flex; 
    margin-top: 10px;
    padding: 10px;
}

.mobile-wallet-adapter-embedded-modal-qr-content > div:first-child {
    display: flex;
    flex-direction: column;
    flex: 2;
    margin-top: auto;
    margin-right: 30px;
}

.mobile-wallet-adapter-embedded-modal-qr-content > div:nth-child(2) {
    display: flex;
    flex-direction: column;
    flex: 1;
    margin-left: auto;
}

.mobile-wallet-adapter-embedded-modal-footer {
    display: flex;
    padding: 10px;
}

.mobile-wallet-adapter-embedded-modal-icon {}

.mobile-wallet-adapter-embedded-modal-title {
    color: #000000;
    font-size: 2.5em;
    font-weight: 600;
}

.mobile-wallet-adapter-embedded-modal-qr-label {
    text-align: right;
    color: #000000;
}

.mobile-wallet-adapter-embedded-modal-qr-code-container {
    margin-left: auto;
}

.mobile-wallet-adapter-embedded-modal-divider {
    margin-top: 20px;
    padding-left: 10px;
    padding-right: 10px;
}

.mobile-wallet-adapter-embedded-modal-divider hr {
    border-top: 1px solid #D9DEDE;
}

.mobile-wallet-adapter-embedded-modal-subtitle {
    margin: auto;
    margin-right: 60px;
    padding: 20px;
    color: #6E8286;
}

.mobile-wallet-adapter-embedded-modal-progress-badge {
    display: flex;
    background: #F7F8F8;
    height: 56px;
    min-width: 200px;
    margin: auto;
    padding-left: 20px;
    padding-right: 20px;
    border-radius: 18px;
    color: #A8B6B8;
    align-items: center;
}

.mobile-wallet-adapter-embedded-modal-progress-badge > div:first-child {
    margin-left: auto;
    margin-right: 20px;
}

.mobile-wallet-adapter-embedded-modal-progress-badge > div:nth-child(2) {
    margin-right: auto;
}

/* Smaller screens */
@media all and (max-width: 600px) {
    .mobile-wallet-adapter-embedded-modal-card {
        text-align: center;
    }
    .mobile-wallet-adapter-embedded-modal-qr-content {
        flex-direction: column;
    }
    .mobile-wallet-adapter-embedded-modal-qr-content > div:first-child {
        margin: auto;
    }
    .mobile-wallet-adapter-embedded-modal-qr-content > div:nth-child(2) {
        margin: auto;
        flex: 2 auto;
    }
    .mobile-wallet-adapter-embedded-modal-footer {
        flex-direction: column;
    }
    .mobile-wallet-adapter-embedded-modal-icon {
        display: none;
    }
    .mobile-wallet-adapter-embedded-modal-title {
        font-size: 1.5em;
    }
    .mobile-wallet-adapter-embedded-modal-subtitle {
        margin-right: unset;
    }
    .mobile-wallet-adapter-embedded-modal-qr-label {
        text-align: center;
    }
    .mobile-wallet-adapter-embedded-modal-qr-code-container {
        margin: auto;
    }
}

/* Spinner */
@keyframes spinLeft {
    0% {
        transform: rotate(20deg);
    }
    50% {
        transform: rotate(160deg);
    }
    100% {
        transform: rotate(20deg);
    }
}
@keyframes spinRight {
    0% {
        transform: rotate(160deg);
    }
    50% {
        transform: rotate(20deg);
    }
    100% {
        transform: rotate(160deg);
    }
}
@keyframes spin {
    0% {
        transform: rotate(0deg);
    }
    100% {
        transform: rotate(2520deg);
    }
}

.spinner {
    position: relative;
    width: 1.5em;
    height: 1.5em;
    margin: auto;
    animation: spin 10s linear infinite;
}
.spinner::before {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
}
.right, .rightWrapper, .left, .leftWrapper {
    position: absolute;
    top: 0;
    overflow: hidden;
    width: .75em;
    height: 1.5em;
}
.left, .leftWrapper {
    left: 0;
}
.right {
    left: -12px;
}
.rightWrapper {
    right: 0;
}
.circle {
    border: .125em solid #A8B6B8;
    width: 1.25em; /* 1.5em - 2*0.125em border */
    height: 1.25em; /* 1.5em - 2*0.125em border */
    border-radius: 0.75em; /* 0.5*1.5em spinner size 8 */
}
.left {
    transform-origin: 100% 50%;
    animation: spinLeft 2.5s cubic-bezier(.2,0,.8,1) infinite;
}
.right {
    transform-origin: 100% 50%;
    animation: spinRight 2.5s cubic-bezier(.2,0,.8,1) infinite;
}
`,t9="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDIuNUgxN0MxNy44Mjg0IDIuNSAxOC41IDMuMTcxNTcgMTguNSA0VjIwQzE4LjUgMjAuODI4NCAxNy44Mjg0IDIxLjUgMTcgMjEuNUg3QzYuMTcxNTcgMjEuNSA1LjUgMjAuODI4NCA1LjUgMjBWNEM1LjUgMy4xNzE1NyA2LjE3MTU3IDIuNSA3IDIuNVpNMyA0QzMgMS43OTA4NiA0Ljc5MDg2IDAgNyAwSDE3QzE5LjIwOTEgMCAyMSAxLjc5MDg2IDIxIDRWMjBDMjEgMjIuMjA5MSAxOS4yMDkxIDI0IDE3IDI0SDdDNC43OTA4NiAyNCAzIDIyLjIwOTEgMyAyMFY0Wk0xMSA0LjYxNTM4QzEwLjQ0NzcgNC42MTUzOCAxMCA1LjA2MzEgMTAgNS42MTUzOFY2LjM4NDYyQzEwIDYuOTM2OSAxMC40NDc3IDcuMzg0NjIgMTEgNy4zODQ2MkgxM0MxMy41NTIzIDcuMzg0NjIgMTQgNi45MzY5IDE0IDYuMzg0NjJWNS42MTUzOEMxNCA1LjA2MzEgMTMuNTUyMyA0LjYxNTM4IDEzIDQuNjE1MzhIMTFaIiBmaWxsPSIjRENCOEZGIi8+Cjwvc3ZnPgo=";function t7(e){return"version"in e}function ne(e){return window.btoa(String.fromCharCode.call(null,...e))}function nt(e){return new Uint8Array(window.atob(e).split("").map(e=>e.charCodeAt(0)))}let nn="Mobile Wallet Adapter",nr=[ti,ta,tr,tn];class ni{constructor(e){f.add(this),p.set(this,{}),g.set(this,"1.0.0"),y.set(this,nn),m.set(this,"https://solanamobile.com/wallets"),w.set(this,t9),I.set(this,void 0),M.set(this,void 0),E.set(this,void 0),v.set(this,!1),b.set(this,0),T.set(this,[]),N.set(this,void 0),A.set(this,void 0),S.set(this,void 0),C.set(this,(e,t)=>{var n;return(null==(n=tJ(this,p,"f")[e])?void 0:n.push(t))||(tJ(this,p,"f")[e]=[t]),()=>tJ(this,f,"m",x).call(this,e,t)}),k.set(this,({silent:e}={})=>tX(this,void 0,void 0,function*(){if(tJ(this,v,"f")||this.connected)return{accounts:this.accounts};t0(this,v,!0,"f");try{if(e){let e=yield tJ(this,E,"f").get();if(!e)return{accounts:this.accounts};yield tJ(this,j,"f").call(this,e)}else yield tJ(this,O,"f").call(this)}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}finally{t0(this,v,!1,"f")}return{accounts:this.accounts}})),O.set(this,e=>tX(this,void 0,void 0,function*(){try{let t=yield tJ(this,E,"f").get();if(t)return tJ(this,j,"f").call(this,t),t;let n=yield tJ(this,N,"f").select(tJ(this,T,"f"));return yield tJ(this,U,"f").call(this,t=>tX(this,void 0,void 0,function*(){let[r,i]=yield Promise.all([t.getCapabilities(),t.authorize({chain:n,identity:tJ(this,I,"f"),sign_in_payload:e})]),a=tJ(this,R,"f").call(this,i.accounts),s=Object.assign(Object.assign({},i),{accounts:a,chain:n});return Promise.all([tJ(this,L,"f").call(this,r),tJ(this,E,"f").set(s),tJ(this,j,"f").call(this,s)]),s}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),j.set(this,e=>tX(this,void 0,void 0,function*(){var t;let n=null==tJ(this,M,"f")||(null==(t=tJ(this,M,"f"))?void 0:t.accounts.length)!==e.accounts.length||tJ(this,M,"f").accounts.some((t,n)=>t.address!==e.accounts[n].address);t0(this,M,e,"f"),n&&tJ(this,f,"m",D).call(this,"change",{accounts:this.accounts})})),L.set(this,e=>tX(this,void 0,void 0,function*(){let t=e.features.includes("solana:signTransactions"),n=e.supports_sign_and_send_transactions,r=ti in this.features!==n||ta in this.features!==t;t0(this,A,Object.assign(Object.assign({},(n||!n&&!t)&&{[ti]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:tJ(this,W,"f")}}),t&&{[ta]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:tJ(this,G,"f")}}),"f"),r&&tJ(this,f,"m",D).call(this,"change",{features:this.features})})),P.set(this,(e,t,n)=>tX(this,void 0,void 0,function*(){try{let r=yield e.authorize({auth_token:t,identity:tJ(this,I,"f"),chain:n}),i=tJ(this,R,"f").call(this,r.accounts),a=Object.assign(Object.assign({},r),{accounts:i,chain:n});Promise.all([tJ(this,E,"f").set(a),tJ(this,j,"f").call(this,a)])}catch(e){throw tJ(this,_,"f").call(this),Error(e instanceof Error&&e.message||"Unknown error")}})),_.set(this,()=>tX(this,void 0,void 0,function*(){var e;tJ(this,E,"f").clear(),t0(this,v,!1,"f"),t0(this,b,(e=tJ(this,b,"f"),++e),"f"),t0(this,M,void 0,"f"),tJ(this,f,"m",D).call(this,"change",{accounts:this.accounts})})),U.set(this,e=>tX(this,void 0,void 0,function*(){var t;let n=null==(t=tJ(this,M,"f"))?void 0:t.wallet_uri_base,r=tJ(this,b,"f");try{return yield function(e,t){return tF(this,void 0,void 0,function*(){return yield function(e,t){return tw(this,void 0,void 0,function*(){let n;tH();let r=yield tN(),i=yield function(e,t){return tw(this,void 0,void 0,function*(){let n=tC(49152+Math.floor(16384*Math.random())),r=yield function(e,t,n,r=["v1"]){return tw(this,void 0,void 0,function*(){let i=tC(t),a=tS((yield crypto.subtle.exportKey("raw",e))),s=tk("v1/associate/local",n);return s.searchParams.set("association",tD(a)),s.searchParams.set("port",`${i}`),r.forEach(e=>{s.searchParams.set("v",e)}),s})}(e,n,t);return yield function(e){return tw(this,void 0,void 0,function*(){if("https:"===e.protocol)window.location.assign(e);else try{switch(-1!==navigator.userAgent.indexOf("Firefox/")?t_.Firefox:t_.Other){case t_.Firefox:null==tU&&((tU=document.createElement("iframe")).style.display="none",document.body.appendChild(tU)),tU.contentWindow.location.href=e.toString();break;case t_.Other:{let t=new Promise((e,t)=>{function n(){clearTimeout(i),window.removeEventListener("blur",r)}function r(){n(),e()}window.addEventListener("blur",r);let i=setTimeout(()=>{n(),t()},3e3)});window.location.assign(e),yield t}}}catch(e){throw new ty(tg.ERROR_WALLET_NOT_FOUND,"Found no installed wallet that supports the mobile wallet protocol.")}})}(r),n})}(r.publicKey,null==t?void 0:t.baseUri),a=`ws://localhost:${i}/solana-wallet`,s=(()=>{let e=[...tz.retryDelayScheduleMs];return()=>e.length>1?e.shift():e[0]})(),o=1,u=0,c={__type:"disconnected"};return new Promise((t,i)=>{let l,d,h,f={},p=()=>tw(this,void 0,void 0,function*(){if("connecting"!==c.__type)return void console.warn(`Expected adapter state to be \`connecting\` at the moment the websocket opens. Got \`${c.__type}\`.`);l.removeEventListener("open",p);let{associationKeypair:e}=c,t=yield tA();l.send((yield tM(t.publicKey,e.privateKey))),c={__type:"hello_req_sent",associationPublicKey:e.publicKey,ecdhPrivateKey:t.privateKey}}),g=e=>{e.wasClean?c={__type:"disconnected"}:i(new ty(tg.ERROR_SESSION_CLOSED,`The wallet session dropped unexpectedly (${e.code}: ${e.reason}).`,{closeEvent:e})),d()},y=e=>tw(this,void 0,void 0,function*(){d(),Date.now()-n>=tz.timeoutMs?i(new ty(tg.ERROR_SESSION_TIMEOUT,`Failed to connect to the wallet websocket at ${a}.`)):(yield new Promise(e=>{let t=s();h=window.setTimeout(e,t)}),w())}),m=n=>tw(this,void 0,void 0,function*(){let a=yield n.data.arrayBuffer();switch(c.__type){case"connecting":if(0!==a.byteLength)throw Error("Encountered unexpected message while connecting");let s=yield tA();l.send((yield tM(s.publicKey,r.privateKey))),c={__type:"hello_req_sent",associationPublicKey:r.publicKey,ecdhPrivateKey:s.privateKey};break;case"connected":try{let e=a.slice(0,4),t=tG(e);if(t!==u+1)throw Error("Encrypted message has invalid sequence number");u=t;let n=yield tj(a,c.sharedSecret),r=f[n.id];delete f[n.id],r.resolve(n.result)}catch(e){if(e instanceof tm){let t=f[e.jsonRpcMessageId];delete f[e.jsonRpcMessageId],t.reject(e)}else throw e}break;case"hello_req_sent":{if(0===a.byteLength){let e=yield tA();l.send((yield tM(e.publicKey,r.privateKey))),c={__type:"hello_req_sent",associationPublicKey:r.publicKey,ecdhPrivateKey:e.privateKey};break}let n=yield tL(a,c.associationPublicKey,c.ecdhPrivateKey),s=a.slice(65),h=0!==s.byteLength?yield tw(this,void 0,void 0,function*(){let e=tG(s.slice(0,4));if(e!==u+1)throw Error("Encrypted message has invalid sequence number");return u=e,tP(s,n)}):{protocol_version:"legacy"};c={__type:"connected",sharedSecret:n,sessionProperties:h};let p=tv(h.protocol_version,(e,t)=>tw(this,void 0,void 0,function*(){let r=o++;return l.send((yield tO({id:r,jsonrpc:"2.0",method:e,params:null!=t?t:{}},n))),new Promise((t,n)=>{f[r]={resolve(r){switch(e){case"authorize":case"reauthorize":{let{wallet_uri_base:e}=r;if(null!=e)try{tW(e)}catch(e){n(e);return}}}t(r)},reject:n}})}));try{t((yield e(p)))}catch(e){i(e)}finally{d(),l.close()}}}}),w=()=>{d&&d(),c={__type:"connecting",associationKeypair:r},void 0===n&&(n=Date.now()),(l=new WebSocket(a,[tR])).addEventListener("open",p),l.addEventListener("close",g),l.addEventListener("error",y),l.addEventListener("message",m),d=()=>{window.clearTimeout(h),l.removeEventListener("open",p),l.removeEventListener("close",g),l.removeEventListener("error",y),l.removeEventListener("message",m)}};w()})})}(t=>e(tZ(t)),t)})}(e,n?{baseUri:n}:void 0)}catch(e){throw tJ(this,b,"f")!==r&&(yield new Promise(()=>{})),e instanceof Error&&"SolanaMobileWalletAdapterError"===e.name&&"ERROR_WALLET_NOT_FOUND"===e.code&&(yield tJ(this,S,"f").call(this,this)),e}})),z.set(this,()=>{if(!tJ(this,M,"f"))throw Error("Wallet not connected");return{authToken:tJ(this,M,"f").auth_token,chain:tJ(this,M,"f").chain}}),R.set(this,e=>e.map(e=>{var t,n;let r=nt(e.address);return{address:tY.encode(r),publicKey:r,label:e.label,icon:e.icon,chains:null!=(t=e.chains)?t:tJ(this,T,"f"),features:null!=(n=e.features)?n:nr}})),B.set(this,e=>tX(this,void 0,void 0,function*(){let{authToken:t,chain:n}=tJ(this,z,"f").call(this);try{return yield tJ(this,U,"f").call(this,r=>tX(this,void 0,void 0,function*(){return yield tJ(this,P,"f").call(this,r,t,n),yield r.signTransactions({transactions:e})}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),H.set(this,(e,t)=>tX(this,void 0,void 0,function*(){let{authToken:n,chain:r}=tJ(this,z,"f").call(this);try{return yield tJ(this,U,"f").call(this,i=>tX(this,void 0,void 0,function*(){let[a,s]=yield Promise.all([i.getCapabilities(),tJ(this,P,"f").call(this,i,n,r)]);if(a.supports_sign_and_send_transactions)return(yield i.signAndSendTransactions(Object.assign(Object.assign({},t),{transactions:[e]})))[0];throw Error("connected wallet does not support signAndSendTransaction")}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),W.set(this,(...e)=>tX(this,void 0,void 0,function*(){let t=[];for(let n of e){let e=tt.Kt.deserialize(n.transaction),r=yield tJ(this,H,"f").call(this,e,n.options);t.push({signature:tY.decode(r)})}return t})),G.set(this,(...e)=>tX(this,void 0,void 0,function*(){let t=e.map(({transaction:e})=>tt.Kt.deserialize(e));return(yield tJ(this,B,"f").call(this,t)).map(e=>({signedTransaction:t7(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}))})),Y.set(this,(...e)=>tX(this,void 0,void 0,function*(){let{authToken:t,chain:n}=tJ(this,z,"f").call(this),r=e.map(({account:e})=>ne(e.publicKey)),i=e.map(({message:e})=>e);try{return yield tJ(this,U,"f").call(this,e=>tX(this,void 0,void 0,function*(){return yield tJ(this,P,"f").call(this,e,t,n),(yield e.signMessages({addresses:r,payloads:i})).map(e=>({signedMessage:e,signature:e.slice(-64)}))}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),Q.set(this,(...e)=>tX(this,void 0,void 0,function*(){let t=[];if(!(e.length>1))return[(yield tJ(this,F,"f").call(this,e[0]))];for(let n of e)t.push((yield tJ(this,F,"f").call(this,n)));return t})),F.set(this,e=>tX(this,void 0,void 0,function*(){var t,n;t0(this,v,!0,"f");try{let r=yield tJ(this,O,"f").call(this,Object.assign(Object.assign({},e),{domain:null!=(t=null==e?void 0:e.domain)?t:window.location.host}));if(!r.sign_in_result)throw Error("Sign in failed, no sign in result returned by wallet");let i=r.sign_in_result.address;return{account:Object.assign(Object.assign({},null!=(n=r.accounts.find(e=>e.address==i))?n:{address:i}),{publicKey:nt(i)}),signedMessage:nt(r.sign_in_result.signed_message),signature:nt(r.sign_in_result.signature)}}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}finally{t0(this,v,!1,"f")}})),t0(this,E,e.authorizationCache,"f"),t0(this,I,e.appIdentity,"f"),t0(this,T,e.chains,"f"),t0(this,N,e.chainSelector,"f"),t0(this,S,e.onWalletNotFound,"f"),t0(this,A,{[ti]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:tJ(this,W,"f")}},"f")}get version(){return tJ(this,g,"f")}get name(){return tJ(this,y,"f")}get url(){return tJ(this,m,"f")}get icon(){return tJ(this,w,"f")}get chains(){return tJ(this,T,"f")}get features(){return Object.assign({[to.u]:{version:"1.0.0",connect:tJ(this,k,"f")},[tu]:{version:"1.0.0",disconnect:tJ(this,_,"f")},[tc.j]:{version:"1.0.0",on:tJ(this,C,"f")},[tr]:{version:"1.0.0",signMessage:tJ(this,Y,"f")},[tn]:{version:"1.0.0",signIn:tJ(this,Q,"f")}},tJ(this,A,"f"))}get accounts(){var e,t;return null!=(t=null==(e=tJ(this,M,"f"))?void 0:e.accounts)?t:[]}get connected(){return!!tJ(this,M,"f")}get isAuthorized(){return!!tJ(this,M,"f")}get currentAuthorization(){return tJ(this,M,"f")}get cachedAuthorizationResult(){return tJ(this,E,"f").get()}}p=new WeakMap,g=new WeakMap,y=new WeakMap,m=new WeakMap,w=new WeakMap,I=new WeakMap,M=new WeakMap,E=new WeakMap,v=new WeakMap,b=new WeakMap,T=new WeakMap,N=new WeakMap,A=new WeakMap,S=new WeakMap,C=new WeakMap,k=new WeakMap,O=new WeakMap,j=new WeakMap,L=new WeakMap,P=new WeakMap,_=new WeakMap,U=new WeakMap,z=new WeakMap,R=new WeakMap,B=new WeakMap,H=new WeakMap,W=new WeakMap,G=new WeakMap,Y=new WeakMap,Q=new WeakMap,F=new WeakMap,f=new WeakSet,D=function(e,...t){var n;null==(n=tJ(this,p,"f")[e])||n.forEach(e=>e.apply(null,t))},x=function(e,t){var n;tJ(this,p,"f")[e]=null==(n=tJ(this,p,"f")[e])?void 0:n.filter(e=>t!==e)};V=new WeakMap,$=new WeakMap,q=new WeakMap,Z=new WeakMap,X=new WeakMap,J=new WeakMap,ee=new WeakMap,et=new WeakMap,en=new WeakMap,er=new WeakMap,ei=new WeakMap,ea=new WeakMap,es=new WeakMap,eo=new WeakMap,eu=new WeakMap,ec=new WeakMap,el=new WeakMap,ef=new WeakMap,ep=new WeakMap,eg=new WeakMap,ey=new WeakMap,em=new WeakMap,ew=new WeakMap,eI=new WeakMap,eM=new WeakMap,eE=new WeakMap,ev=new WeakMap,eb=new WeakMap,eT=new WeakMap,eN=new WeakMap,eA=new WeakMap,eS=new WeakMap,eC=new WeakMap,K=new WeakSet,ed=function(e,...t){var n;null==(n=tJ(this,V,"f")[e])||n.forEach(e=>e.apply(null,t))},eh=function(e,t){var n;tJ(this,V,"f")[e]=null==(n=tJ(this,V,"f")[e])?void 0:n.filter(e=>t!==e)};var na=function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n},ns=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)};class no extends Event{constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),eD.set(this,void 0),na(this,eD,e,"f")}get detail(){return ns(this,eD,"f")}get type(){return"wallet-standard:register-wallet"}preventDefault(){throw Error("preventDefault cannot be called")}stopImmediatePropagation(){throw Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw Error("stopPropagation cannot be called")}}eD=new WeakMap;class nu extends t3{constructor(){super(...arguments),this.contentStyles=nl,this.contentHtml=nc}initWithError(e){super.init(),this.populateError(e)}populateError(e){var t,n;let r=null==(t=this.dom)?void 0:t.getElementById("mobile-wallet-adapter-error-message"),i=null==(n=this.dom)?void 0:n.getElementById("mobile-wallet-adapter-error-action");if(r){if("SolanaMobileWalletAdapterError"===e.name)switch(e.code){case"ERROR_WALLET_NOT_FOUND":r.innerHTML="To use mobile wallet adapter, you must have a compatible mobile wallet application installed on your device.",i&&i.addEventListener("click",()=>{window.location.href="https://solanamobile.com/wallets"});return;case"ERROR_BROWSER_NOT_SUPPORTED":r.innerHTML="This browser appears to be incompatible with mobile wallet adapter. Open this page in a compatible mobile browser app and try again.",i&&(i.style.display="none");return}r.innerHTML=`An unexpected error occurred: ${e.message}`}else console.log("Failed to locate error dialog element")}}let nc=`
<svg class="mobile-wallet-adapter-embedded-modal-error-icon" xmlns="http://www.w3.org/2000/svg" height="50px" viewBox="0 -960 960 960" width="50px" fill="#000000"><path d="M 280,-80 Q 197,-80 138.5,-138.5 80,-197 80,-280 80,-363 138.5,-421.5 197,-480 280,-480 q 83,0 141.5,58.5 58.5,58.5 58.5,141.5 0,83 -58.5,141.5 Q 363,-80 280,-80 Z M 824,-120 568,-376 Q 556,-389 542.5,-402.5 529,-416 516,-428 q 38,-24 61,-64 23,-40 23,-88 0,-75 -52.5,-127.5 Q 495,-760 420,-760 345,-760 292.5,-707.5 240,-655 240,-580 q 0,6 0.5,11.5 0.5,5.5 1.5,11.5 -18,2 -39.5,8 -21.5,6 -38.5,14 -2,-11 -3,-22 -1,-11 -1,-23 0,-109 75.5,-184.5 Q 311,-840 420,-840 q 109,0 184.5,75.5 75.5,75.5 75.5,184.5 0,43 -13.5,81.5 Q 653,-460 629,-428 l 251,252 z m -615,-61 71,-71 70,71 29,-28 -71,-71 71,-71 -28,-28 -71,71 -71,-71 -28,28 71,71 -71,71 z"/></svg>
<div class="mobile-wallet-adapter-embedded-modal-title">We can't find a wallet.</div>
<div id="mobile-wallet-adapter-error-message" class="mobile-wallet-adapter-embedded-modal-subtitle"></div>
<div>
    <button data-error-action id="mobile-wallet-adapter-error-action" class="mobile-wallet-adapter-embedded-modal-error-action">
        Find a wallet
    </button>
</div>
`,nl=`
.mobile-wallet-adapter-embedded-modal-content {
    text-align: center;
}

.mobile-wallet-adapter-embedded-modal-error-icon {
    margin-top: 24px;
}

.mobile-wallet-adapter-embedded-modal-title {
    margin: 18px 100px auto 100px;
    color: #000000;
    font-size: 2.75em;
    font-weight: 600;
}

.mobile-wallet-adapter-embedded-modal-subtitle {
    margin: 30px 60px 40px 60px;
    color: #000000;
    font-size: 1.25em;
    font-weight: 400;
}

.mobile-wallet-adapter-embedded-modal-error-action {
    display: block;
    width: 100%;
    height: 56px;
    /*margin-top: 40px;*/
    font-size: 1.25em;
    /*line-height: 24px;*/
    /*letter-spacing: -1%;*/
    background: #000000;
    color: #FFFFFF;
    border-radius: 18px;
}

/* Smaller screens */
@media all and (max-width: 600px) {
    .mobile-wallet-adapter-embedded-modal-title {
        font-size: 1.5em;
        margin-right: 12px;
        margin-left: 12px;
    }
    .mobile-wallet-adapter-embedded-modal-subtitle {
        margin-right: 12px;
        margin-left: 12px;
    }
}
`,nd="SolanaMobileWalletAdapterDefaultAuthorizationCache";function nh(e,t,n,r){return new(n||(n=Promise))(function(i,a){function s(e){try{u(r.next(e))}catch(e){a(e)}}function o(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(s,o)}u((r=r.apply(e,t||[])).next())})}function nf(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)}function np(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n}let ng="standard:connect";function ny(e){return window.btoa(String.fromCharCode.call(null,...e))}let nm="Mobile Wallet Adapter";function nw(e){switch(e){case"mainnet-beta":return"solana:mainnet";case"testnet":return"solana:testnet";case"devnet":return"solana:devnet";default:return e}}class nI extends e9.Xl{constructor(e,t){super(),ex.add(this),this.supportedTransactionVersions=new Set(["legacy",0]),ek.set(this,void 0),eO.set(this,!1),ej.set(this,"undefined"!=typeof window&&window.isSecureContext&&"undefined"!=typeof document&&/android/i.test(navigator.userAgent)?e7.Ok.Loadable:e7.Ok.Unsupported),eL.set(this,void 0),eP.set(this,void 0),e_.set(this,void 0),eU.set(this,e=>nh(this,void 0,void 0,function*(){if(e.accounts&&e.accounts.length>0){nf(this,ex,"m",eR).call(this);let t=yield nf(this,eL,"f").call(this,e.accounts);t!==nf(this,eP,"f")&&(np(this,eP,t,"f"),np(this,e_,void 0,"f"),this.emit("connect",this.publicKey))}})),np(this,eL,e=>nh(this,void 0,void 0,function*(){var n;let r=yield t.addressSelector.select(e.map(({publicKey:e})=>ny(e)));return null!=(n=e.find(({publicKey:e})=>ny(e)===r))?n:e[0]}),"f"),np(this,ek,e,"f"),nf(this,ek,"f").features["standard:events"].on("change",nf(this,eU,"f")),this.name=nf(this,ek,"f").name,this.icon=nf(this,ek,"f").icon,this.url=nf(this,ek,"f").url}get publicKey(){var e;if(!nf(this,e_,"f")&&nf(this,eP,"f"))try{np(this,e_,new tt.J3(nf(this,eP,"f").publicKey),"f")}catch(e){throw new te.Kd(e instanceof Error&&(null==e?void 0:e.message)||"Unknown error",e)}return null!=(e=nf(this,e_,"f"))?e:null}get connected(){return nf(this,ek,"f").connected}get connecting(){return nf(this,eO,"f")}get readyState(){return nf(this,ej,"f")}autoConnect_DO_NOT_USE_OR_YOU_WILL_BE_FIRED(){return nh(this,void 0,void 0,function*(){return yield this.autoConnect()})}autoConnect(){return nh(this,void 0,void 0,function*(){nf(this,ex,"m",ez).call(this,!0)})}connect(){return nh(this,void 0,void 0,function*(){nf(this,ex,"m",ez).call(this)})}performAuthorization(e){return nh(this,void 0,void 0,function*(){try{let t=yield nf(this,ek,"f").cachedAuthorizationResult;if(t)return yield nf(this,ek,"f").features[ng].connect({silent:!0}),t;return e?yield nf(this,ek,"f").features[tn].signIn(e):yield nf(this,ek,"f").features[ng].connect(),yield yield nf(this,ek,"f").cachedAuthorizationResult}catch(e){throw new te.Y6(e instanceof Error&&e.message||"Unknown error",e)}})}disconnect(){return nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){np(this,eO,!1,"f"),np(this,e_,void 0,"f"),np(this,eP,void 0,"f"),yield nf(this,ek,"f").features["standard:disconnect"].disconnect(),this.emit("disconnect")}))})}signIn(e){return nh(this,void 0,void 0,function*(){return nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){var t;if(nf(this,ej,"f")!==e7.Ok.Installed&&nf(this,ej,"f")!==e7.Ok.Loadable)throw new te.AE;np(this,eO,!0,"f");try{let n=yield nf(this,ek,"f").features[tn].signIn(Object.assign(Object.assign({},e),{domain:null!=(t=null==e?void 0:e.domain)?t:window.location.host}));if(n.length>0)return n[0];throw Error("Sign in failed, no sign in result returned by wallet")}catch(e){throw new te.Y6(e instanceof Error&&e.message||"Unknown error",e)}finally{np(this,eO,!1,"f")}}))})}signMessage(e){return nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){let t=nf(this,ex,"m",eB).call(this);try{return(yield nf(this,ek,"f").features[tr].signMessage({account:t,message:e}))[0].signature}catch(e){throw new te.K3(null==e?void 0:e.message,e)}}))})}sendTransaction(e,t,n){return nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){let r=nf(this,ex,"m",eB).call(this);try{if(ti in nf(this,ek,"f").features){let t=nw(nf(this,ek,"f").currentAuthorization.chain),[i]=(yield nf(this,ek,"f").features[ti].signAndSendTransaction({account:r,transaction:e.serialize(),chain:t,options:n?{skipPreflight:n.skipPreflight,maxRetries:n.maxRetries}:void 0})).map(e=>ny(e.signature));return i}{let[r]=yield nf(this,ex,"m",eH).call(this,[e]);if("version"in r)return yield t.sendTransaction(r);{let e=r.serialize();return yield t.sendRawTransaction(e,Object.assign(Object.assign({},n),{preflightCommitment:function(){let e,r;switch(t.commitment){case"confirmed":case"finalized":case"processed":e=t.commitment;break;default:e="finalized"}switch(null==n?void 0:n.preflightCommitment){case"confirmed":case"finalized":case"processed":r=n.preflightCommitment;break;case void 0:r=e;break;default:r="finalized"}let i="finalized"===r?2:+("confirmed"===r),a="finalized"===e?2:+("confirmed"===e);return i<a?r:e}()}))}}}catch(e){throw new te.UF(null==e?void 0:e.message,e)}}))})}signTransaction(e){return nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){let[t]=yield nf(this,ex,"m",eH).call(this,[e]);return t}))})}signAllTransactions(e){return nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){return yield nf(this,ex,"m",eH).call(this,e)}))})}}ek=new WeakMap,eO=new WeakMap,ej=new WeakMap,eL=new WeakMap,eP=new WeakMap,e_=new WeakMap,eU=new WeakMap,ex=new WeakSet,ez=function(e=!1){return nh(this,void 0,void 0,function*(){if(!this.connecting&&!this.connected)return yield nf(this,ex,"m",eW).call(this,()=>nh(this,void 0,void 0,function*(){if(nf(this,ej,"f")!==e7.Ok.Installed&&nf(this,ej,"f")!==e7.Ok.Loadable)throw new te.AE;np(this,eO,!0,"f");try{yield nf(this,ek,"f").features[ng].connect({silent:e})}catch(e){throw new te.Y6(e instanceof Error&&e.message||"Unknown error",e)}finally{np(this,eO,!1,"f")}}))})},eR=function(){nf(this,ej,"f")!==e7.Ok.Installed&&this.emit("readyStateChange",np(this,ej,e7.Ok.Installed,"f"))},eB=function(){if(!nf(this,ek,"f").isAuthorized||!nf(this,eP,"f"))throw new te.kW;return nf(this,eP,"f")},eH=function(e){return nh(this,void 0,void 0,function*(){let t=nf(this,ex,"m",eB).call(this);try{if(ta in nf(this,ek,"f").features)return nf(this,ek,"f").features[ta].signTransaction(...e.map(e=>({account:t,transaction:e.serialize()}))).then(e=>e.map(e=>{let t=e.signedTransaction,n=t[0],r=tt.B2.deserializeMessageVersion(t.slice(64*n+1,t.length));return"legacy"===r?tt.ZX.from(t):tt.Kt.deserialize(t)}));throw Error("Connected wallet does not support signing transactions")}catch(e){throw new te.z4(null==e?void 0:e.message,e)}})},eW=function(e){return nh(this,void 0,void 0,function*(){try{return yield e()}catch(e){throw this.emit("error",e),e}})};class nM extends nI{constructor(e){var t;let n=nw(null!=(t=e.chain)?t:e.cluster);super(new ni({appIdentity:e.appIdentity,authorizationCache:{set:e.authorizationResultCache.set,get:()=>nh(this,void 0,void 0,function*(){let t=yield e.authorizationResultCache.get();return t&&"chain"in t?t:t?Object.assign(Object.assign({},t),{chain:n}):void 0}),clear:e.authorizationResultCache.clear},chains:[n],chainSelector:{select(e){return tX(this,void 0,void 0,function*(){return 1===e.length?e[0]:e.includes(tl)?tl:e[0]})}},onWalletNotFound:()=>nh(this,void 0,void 0,function*(){e.onWalletNotFound(this)})}),{addressSelector:e.addressSelector,chain:n})}}class nE extends nM{}function nv(e){return nh(this,void 0,void 0,function*(){return function(){return tX(this,void 0,void 0,function*(){if("undefined"!=typeof window){let e=window.navigator.userAgent.toLowerCase(),t=new nu;e.includes("wv")?t.initWithError({name:"SolanaMobileWalletAdapterError",code:"ERROR_BROWSER_NOT_SUPPORTED",message:""}):t.initWithError({name:"SolanaMobileWalletAdapterError",code:"ERROR_WALLET_NOT_FOUND",message:""}),t.open()}})}()})}let nb=function(e){return to.u in e.features&&tc.j in e.features&&(ti in e.features||ta in e.features)};var nT=n(75031);function nN(e){switch(e){case"processed":case"confirmed":case"finalized":case void 0:return e;case"recent":return"processed";case"single":case"singleGossip":return"confirmed";case"max":case"root":return"finalized";default:return}}var nA=n(9104),nS=function(e,t,n,r){if("a"===n&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(e):r?r.value:t.get(e)},nC=function(e,t,n,r,i){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!i)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(e,n):i?i.value=n:t.set(e,n),n};class nD extends e7.Ce{get name(){return nS(this,eq,"f").name}get url(){return"https://github.com/solana-labs/wallet-standard"}get icon(){return nS(this,eq,"f").icon}get readyState(){return nS(this,eZ,"f")}get publicKey(){return nS(this,eQ,"f")}get connecting(){return nS(this,eF,"f")}get supportedTransactionVersions(){return nS(this,e$,"f")}get wallet(){return nS(this,eq,"f")}get standard(){return!0}constructor({wallet:e}){super(),eG.add(this),eY.set(this,void 0),eQ.set(this,void 0),eF.set(this,void 0),eK.set(this,void 0),eV.set(this,void 0),e$.set(this,void 0),eq.set(this,void 0),eZ.set(this,"undefined"==typeof window||"undefined"==typeof document?e7.Ok.Unsupported:e7.Ok.Installed),e2.set(this,e=>{if("accounts"in e){let e=nS(this,eq,"f").accounts[0];nS(this,eY,"f")&&!nS(this,eK,"f")&&e!==nS(this,eY,"f")&&(e?nS(this,eG,"m",eJ).call(this,e):(this.emit("error",new te.PQ),nS(this,eG,"m",e0).call(this)))}"features"in e&&nS(this,eG,"m",e1).call(this)}),nC(this,eq,e,"f"),nC(this,eY,null,"f"),nC(this,eQ,null,"f"),nC(this,eF,!1,"f"),nC(this,eK,!1,"f"),nC(this,eV,nS(this,eq,"f").features[tc.j].on("change",nS(this,e2,"f")),"f"),nS(this,eG,"m",e1).call(this)}destroy(){nC(this,eY,null,"f"),nC(this,eQ,null,"f"),nC(this,eF,!1,"f"),nC(this,eK,!1,"f");let e=nS(this,eV,"f");e&&(nC(this,eV,null,"f"),e())}async autoConnect(){return nS(this,eG,"m",eX).call(this,{silent:!0})}async connect(){return nS(this,eG,"m",eX).call(this)}async disconnect(){if(tu in nS(this,eq,"f").features)try{nC(this,eK,!0,"f"),await nS(this,eq,"f").features[tu].disconnect()}catch(e){this.emit("error",new te.Y8(e?.message,e))}finally{nC(this,eK,!1,"f")}nS(this,eG,"m",e0).call(this)}async sendTransaction(e,t,n={}){try{var r;let i,a=nS(this,eY,"f");if(!a)throw new te.kW;if(ti in nS(this,eq,"f").features)if(a.features.includes(ti))i=ti;else if(ta in nS(this,eq,"f").features&&a.features.includes(ta))i=ta;else throw new te.fk;else if(ta in nS(this,eq,"f").features){if(!a.features.includes(ta))throw new te.fk;i=ta}else throw new te.Ez;let s=(r=t.rpcEndpoint).includes("https://api.mainnet-beta.solana.com")?tl:/\bdevnet\b/i.test(r)?td:/\btestnet\b/i.test(r)?th:/\blocalhost\b/i.test(r)||/\b127\.0\.0\.1\b/.test(r)?tf:tl;if(!a.chains.includes(s))throw new te.UF;try{let r,{signers:o,...u}=n;if((0,nT.Y)(e)?(o?.length&&e.sign(o),r=e.serialize()):(e=await this.prepareTransaction(e,t,u),o?.length&&e.partialSign(...o),r=new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))),i===ti){let[e]=await nS(this,eq,"f").features[ti].signAndSendTransaction({account:a,chain:s,transaction:r,options:{preflightCommitment:nN(u.preflightCommitment||t.commitment),skipPreflight:u.skipPreflight,maxRetries:u.maxRetries,minContextSlot:u.minContextSlot}});return tY.encode(e.signature)}{let[e]=await nS(this,eq,"f").features[ta].signTransaction({account:a,chain:s,transaction:r,options:{preflightCommitment:nN(u.preflightCommitment||t.commitment),minContextSlot:u.minContextSlot}});return await t.sendRawTransaction(e.signedTransaction,{...u,preflightCommitment:nN(u.preflightCommitment||t.commitment)})}}catch(e){if(e instanceof te.m7)throw e;throw new te.UF(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}eY=new WeakMap,eQ=new WeakMap,eF=new WeakMap,eK=new WeakMap,eV=new WeakMap,e$=new WeakMap,eq=new WeakMap,eZ=new WeakMap,e2=new WeakMap,eG=new WeakSet,eX=async function(e){try{if(this.connected||this.connecting)return;if(nS(this,eZ,"f")!==e7.Ok.Installed)throw new te.AE;if(nC(this,eF,!0,"f"),!nS(this,eq,"f").accounts.length)try{await nS(this,eq,"f").features[to.u].connect(e)}catch(e){throw new te.Y6(e?.message,e)}let t=nS(this,eq,"f").accounts[0];if(!t)throw new te.fk;nS(this,eG,"m",eJ).call(this,t)}catch(e){throw this.emit("error",e),e}finally{nC(this,eF,!1,"f")}},eJ=function(e){let t;try{t=new tt.J3(e.address)}catch(e){throw new te.Kd(e?.message,e)}nC(this,eY,e,"f"),nC(this,eQ,t,"f"),nS(this,eG,"m",e1).call(this),this.emit("connect",t)},e0=function(){nC(this,eY,null,"f"),nC(this,eQ,null,"f"),nS(this,eG,"m",e1).call(this),this.emit("disconnect")},e1=function(){let e=ti in nS(this,eq,"f").features?nS(this,eq,"f").features[ti].supportedTransactionVersions:nS(this,eq,"f").features[ta].supportedTransactionVersions;nC(this,e$,(0,nA.r1)(e,["legacy"])?null:new Set(e),"f"),ta in nS(this,eq,"f").features&&nS(this,eY,"f")?.features.includes(ta)?(this.signTransaction=nS(this,eG,"m",e4),this.signAllTransactions=nS(this,eG,"m",e3)):(delete this.signTransaction,delete this.signAllTransactions),tr in nS(this,eq,"f").features&&nS(this,eY,"f")?.features.includes(tr)?this.signMessage=nS(this,eG,"m",e5):delete this.signMessage,tn in nS(this,eq,"f").features?this.signIn=nS(this,eG,"m",e8):delete this.signIn},e4=async function(e){try{let t=nS(this,eY,"f");if(!t)throw new te.kW;if(!(ta in nS(this,eq,"f").features))throw new te.Ez;if(!t.features.includes(ta))throw new te.fk;try{let n=(await nS(this,eq,"f").features[ta].signTransaction({account:t,transaction:(0,nT.Y)(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}))[0].signedTransaction;return(0,nT.Y)(e)?tt.Kt.deserialize(n):tt.ZX.from(n)}catch(e){if(e instanceof te.m7)throw e;throw new te.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}},e3=async function(e){try{let t=nS(this,eY,"f");if(!t)throw new te.kW;if(!(ta in nS(this,eq,"f").features))throw new te.Ez;if(!t.features.includes(ta))throw new te.fk;try{let n=await nS(this,eq,"f").features[ta].signTransaction(...e.map(e=>({account:t,transaction:(0,nT.Y)(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))})));return e.map((e,t)=>{let r=n[t].signedTransaction;return(0,nT.Y)(e)?tt.Kt.deserialize(r):tt.ZX.from(r)})}catch(e){throw new te.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}},e5=async function(e){try{let t=nS(this,eY,"f");if(!t)throw new te.kW;if(!(tr in nS(this,eq,"f").features))throw new te.Ez;if(!t.features.includes(tr))throw new te.fk;try{return(await nS(this,eq,"f").features[tr].signMessage({account:t,message:e}))[0].signature}catch(e){throw new te.K3(e?.message,e)}}catch(e){throw this.emit("error",e),e}},e8=async function(e={}){try{let t;if(!(tn in nS(this,eq,"f").features))throw new te.Ez;try{[t]=await nS(this,eq,"f").features[tn].signIn(e)}catch(e){throw new te.o7(e?.message,e)}if(!t)throw new te.o7;return nS(this,eG,"m",eJ).call(this,t.account),t}catch(e){throw this.emit("error",e),e}};var nx=n(2996),nk=n(56151);function nO(e){let t=(0,nk.useRef)(void 0);return void 0===t.current&&(t.current={value:e()}),t.current.value}function nj(e){return e.filter(nb).map(e=>new nD({wallet:e}))}!function(e){e[e.DESKTOP_WEB=0]="DESKTOP_WEB",e[e.MOBILE_WEB=1]="MOBILE_WEB"}(e6||(e6={}));var nL=n(45986);class nP extends te.m7{constructor(){super(...arguments),this.name="WalletNotSelectedError"}}var n_=n(20915);function nU({children:e,wallets:t,adapter:n,isUnloadingRef:r,onAutoConnectRequest:i,onConnectError:a,onError:s,onSelectWallet:o}){let u=(0,nk.useRef)(!1),[c,l]=(0,nk.useState)(!1),d=(0,nk.useRef)(!1),[h,f]=(0,nk.useState)(!1),[p,g]=(0,nk.useState)(()=>n?.publicKey??null),[y,m]=(0,nk.useState)(()=>n?.connected??!1),w=(0,nk.useRef)(s);(0,nk.useEffect)(()=>(w.current=s,()=>{w.current=void 0}),[s]);let I=(0,nk.useRef)((e,t)=>(!r.current&&(w.current?w.current(e,t):(console.error(e,t),e instanceof te.AE&&"undefined"!=typeof window&&t&&window.open(t.url,"_blank"))),e)),[M,E]=(0,nk.useState)(()=>t.map(e=>({adapter:e,readyState:e.readyState})).filter(({readyState:e})=>e!==e7.Ok.Unsupported));(0,nk.useEffect)(()=>{function e(e){E(t=>{let n=t.findIndex(({adapter:e})=>e===this);if(-1===n)return t;let{adapter:r}=t[n];return[...t.slice(0,n),{adapter:r,readyState:e},...t.slice(n+1)].filter(({readyState:e})=>e!==e7.Ok.Unsupported)})}return E(e=>t.map((t,n)=>{let r=e[n];return r&&r.adapter===t&&r.readyState===t.readyState?r:{adapter:t,readyState:t.readyState}}).filter(({readyState:e})=>e!==e7.Ok.Unsupported)),t.forEach(t=>t.on("readyStateChange",e,t)),()=>{t.forEach(t=>t.off("readyStateChange",e,t))}},[n,t]);let v=(0,nk.useMemo)(()=>M.find(e=>e.adapter===n)??null,[n,M]);(0,nk.useEffect)(()=>{if(!n)return;let e=e=>{g(e),u.current=!1,l(!1),m(!0),d.current=!1,f(!1)},t=()=>{r.current||(g(null),u.current=!1,l(!1),m(!1),d.current=!1,f(!1))},i=e=>{I.current(e,n)};return n.on("connect",e),n.on("disconnect",t),n.on("error",i),()=>{n.off("connect",e),n.off("disconnect",t),n.off("error",i),t()}},[n,r]);let b=(0,nk.useRef)(!1);(0,nk.useEffect)(()=>()=>{b.current=!1},[n]),(0,nk.useEffect)(()=>{b.current||u.current||y||!i||v?.readyState!==e7.Ok.Installed&&v?.readyState!==e7.Ok.Loadable||(u.current=!0,l(!0),b.current=!0,async function(){try{await i()}catch{a()}finally{l(!1),u.current=!1}}())},[y,i,a,v]);let T=(0,nk.useCallback)(async(e,t,r)=>{if(!n)throw I.current(new nP);if(!y)throw I.current(new te.kW,n);return await n.sendTransaction(e,t,r)},[n,y]),N=(0,nk.useMemo)(()=>n&&"signTransaction"in n?async e=>{if(!y)throw I.current(new te.kW,n);return await n.signTransaction(e)}:void 0,[n,y]),A=(0,nk.useMemo)(()=>n&&"signAllTransactions"in n?async e=>{if(!y)throw I.current(new te.kW,n);return await n.signAllTransactions(e)}:void 0,[n,y]),S=(0,nk.useMemo)(()=>n&&"signMessage"in n?async e=>{if(!y)throw I.current(new te.kW,n);return await n.signMessage(e)}:void 0,[n,y]),C=(0,nk.useMemo)(()=>n&&"signIn"in n?async e=>await n.signIn(e):void 0,[n]),D=(0,nk.useCallback)(async()=>{if(u.current||d.current||v?.adapter.connected)return;if(!v)throw I.current(new nP);let{adapter:e,readyState:t}=v;if(t!==e7.Ok.Installed&&t!==e7.Ok.Loadable)throw I.current(new te.AE,e);u.current=!0,l(!0);try{await e.connect()}catch(e){throw a(),e}finally{l(!1),u.current=!1}},[a,v]),x=(0,nk.useCallback)(async()=>{if(!d.current&&n){d.current=!0,f(!0);try{await n.disconnect()}finally{f(!1),d.current=!1}}},[n]);return nk.createElement(n_.b.Provider,{value:{autoConnect:!!i,wallets:M,wallet:v,publicKey:p,connected:y,connecting:c,disconnecting:h,select:o,connect:D,disconnect:x,sendTransaction:T,signTransaction:N,signAllTransactions:A,signMessage:S,signIn:C}},e)}function nz(e){return function({adapters:e,userAgentString:t}){return e.some(e=>e.name!==nm&&e.readyState===e7.Ok.Installed)?e6.DESKTOP_WEB:t&&/android/i.test(t)&&!/(WebView|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)?e6.MOBILE_WEB:e6.DESKTOP_WEB}({adapters:e,userAgentString:(void 0===i&&(i=globalThis.navigator?.userAgent??null),i)})===e6.MOBILE_WEB}function nR({children:e,wallets:t,autoConnect:n,localStorageKey:r="walletName",onError:i}){let{connection:a}=(0,nL.w)(),s=function(e){let t=nO(()=>new Set),{get:n,on:r}=nO(()=>(0,nx.N)()),[i,a]=(0,nk.useState)(()=>nj(n()));(0,nk.useEffect)(()=>{let e=[r("register",(...e)=>a(t=>[...t,...nj(e)])),r("unregister",(...e)=>a(t=>t.filter(t=>e.some(e=>e===t.wallet))))];return()=>e.forEach(e=>e())},[r]);let s=function(e){let t=(0,nk.useRef)(void 0);return(0,nk.useEffect)(()=>{t.current=e}),t.current}(i);return(0,nk.useEffect)(()=>{if(!s)return;let e=new Set(i);new Set(s.filter(t=>!e.has(t))).forEach(e=>e.destroy())},[s,i]),(0,nk.useEffect)(()=>()=>i.forEach(e=>e.destroy()),[]),(0,nk.useMemo)(()=>[...i,...e.filter(({name:e})=>!i.some(t=>t.name===e)||(t.has(e)||(t.add(e),console.warn(`${e} was registered as a Standard Wallet. The Wallet Adapter for ${e} can be removed from your app.`)),!1))],[i,e,t])}(t),o=(0,nk.useMemo)(()=>{var e;if(!nz(s))return null;let t=s.find(e=>e.name===nm);return t?t:new nE({addressSelector:{select(e){return nh(this,void 0,void 0,function*(){return e[0]})}},appIdentity:{uri:function(){let e=globalThis.location;if(e)return`${e.protocol}//${e.host}`}()},authorizationResultCache:function(){let e;try{e=window.localStorage}catch(e){}return{clear(){return tX(this,void 0,void 0,function*(){if(e)try{e.removeItem(nd)}catch(e){}})},get(){return tX(this,void 0,void 0,function*(){if(e)try{let t=JSON.parse(e.getItem(nd));if(!t||!t.accounts)return t||void 0;{let e=t.accounts.map(e=>Object.assign(Object.assign({},e),{publicKey:"publicKey"in e?new Uint8Array(Object.values(e.publicKey)):new tt.J3(e.address).toBytes()}));return Object.assign(Object.assign({},t),{accounts:e})}}catch(e){}})},set(t){return tX(this,void 0,void 0,function*(){if(e)try{e.setItem(nd,JSON.stringify(t))}catch(e){}})}}}(),cluster:(e=a?.rpcEndpoint)?/devnet/i.test(e)?"devnet":/testnet/i.test(e)?"testnet":"mainnet-beta":"mainnet-beta",onWalletNotFound:nv})},[s,a?.rpcEndpoint]),u=(0,nk.useMemo)(()=>null==o||-1!==s.indexOf(o)?s:[o,...s],[s,o]),[c,l]=function(e,t){let n=(0,nk.useState)(()=>{try{let t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch(e){"undefined"!=typeof window&&console.error(e)}return null}),r=n[0],i=(0,nk.useRef)(!0);return(0,nk.useEffect)(()=>{if(i.current){i.current=!1;return}try{null===r?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(r))}catch(e){"undefined"!=typeof window&&console.error(e)}},[r,e]),n}(r,0),d=(0,nk.useMemo)(()=>u.find(e=>e.name===c)??null,[u,c]),h=(0,nk.useCallback)(e=>{c!==e&&(d&&d.name!==nm&&d.disconnect(),l(e))},[d,l,c]);(0,nk.useEffect)(()=>{if(d)return d.on("disconnect",e),()=>{d.off("disconnect",e)};function e(){g.current||l(null)}},[d,s,l,c]);let f=(0,nk.useRef)(!1),p=(0,nk.useMemo)(()=>{if(n&&d)return async()=>{(!0===n||await n(d))&&(f.current?await d.connect():await d.autoConnect())}},[n,d]),g=(0,nk.useRef)(!1);(0,nk.useEffect)(()=>{if(c===nm&&nz(s)){g.current=!1;return}function e(){g.current=!0}return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[s,c]);let y=(0,nk.useCallback)(()=>{d&&h(null)},[d,h]),m=(0,nk.useCallback)(e=>{f.current=!0,h(e)},[h]);return nk.createElement(nU,{wallets:u,adapter:d,isUnloadingRef:g,onAutoConnectRequest:p,onConnectError:y,onError:i,onSelectWallet:m},e)}},56882:(e,t,n)=>{let r=n(5041),i=r.getBCHDigit(1335);t.getEncodedBits=function(e,t){let n=e.bit<<3|t,a=n<<10;for(;r.getBCHDigit(a)-i>=0;)a^=1335<<r.getBCHDigit(a)-i;return(n<<10|a)^21522}},57266:(e,t,n)=>{let r=n(6343),i=n(62114),a=n(76586),s=n(44409),o=n(418),u=n(55187),c=n(5041),l=n(22544);function d(e){return unescape(encodeURIComponent(e)).length}function h(e,t,n){let r,i=[];for(;null!==(r=e.exec(n));)i.push({data:r[0],index:r.index,mode:t,length:r[0].length});return i}function f(e){let t,n,i=h(u.NUMERIC,r.NUMERIC,e),a=h(u.ALPHANUMERIC,r.ALPHANUMERIC,e);return c.isKanjiModeEnabled()?(t=h(u.BYTE,r.BYTE,e),n=h(u.KANJI,r.KANJI,e)):(t=h(u.BYTE_KANJI,r.BYTE,e),n=[]),i.concat(a,t,n).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function p(e,t){switch(t){case r.NUMERIC:return i.getBitsLength(e);case r.ALPHANUMERIC:return a.getBitsLength(e);case r.KANJI:return o.getBitsLength(e);case r.BYTE:return s.getBitsLength(e)}}function g(e,t){let n,u=r.getBestModeForData(e);if((n=r.from(t,u))!==r.BYTE&&n.bit<u.bit)throw Error('"'+e+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(u));switch(n===r.KANJI&&!c.isKanjiModeEnabled()&&(n=r.BYTE),n){case r.NUMERIC:return new i(e);case r.ALPHANUMERIC:return new a(e);case r.KANJI:return new o(e);case r.BYTE:return new s(e)}}t.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e},[])},t.fromString=function(e,n){let i=function(e,t){let n={},i={start:{}},a=["start"];for(let s=0;s<e.length;s++){let o=e[s],u=[];for(let e=0;e<o.length;e++){let c=o[e],l=""+s+e;u.push(l),n[l]={node:c,lastCount:0},i[l]={};for(let e=0;e<a.length;e++){let s=a[e];n[s]&&n[s].node.mode===c.mode?(i[s][l]=p(n[s].lastCount+c.length,c.mode)-p(n[s].lastCount,c.mode),n[s].lastCount+=c.length):(n[s]&&(n[s].lastCount=c.length),i[s][l]=p(c.length,c.mode)+4+r.getCharCountIndicator(c.mode,t))}}a=u}for(let e=0;e<a.length;e++)i[a[e]].end=0;return{map:i,table:n}}(function(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n];switch(i.mode){case r.NUMERIC:t.push([i,{data:i.data,mode:r.ALPHANUMERIC,length:i.length},{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.ALPHANUMERIC:t.push([i,{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.KANJI:t.push([i,{data:i.data,mode:r.BYTE,length:d(i.data)}]);break;case r.BYTE:t.push([{data:i.data,mode:r.BYTE,length:d(i.data)}])}}return t}(f(e,c.isKanjiModeEnabled())),n),a=l.find_path(i.map,"start","end"),s=[];for(let e=1;e<a.length-1;e++)s.push(i.table[a[e]].node);return t.fromArray(s.reduce(function(e,t){let n=e.length-1>=0?e[e.length-1]:null;return n&&n.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},t.rawSplit=function(e){return t.fromArray(f(e,c.isKanjiModeEnabled()))}},57767:(e,t,n)=>{let r=n(30422);function i(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}i.prototype.initialize=function(e){this.degree=e,this.genPoly=r.generateECPolynomial(this.degree)},i.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let n=r.mod(t,this.genPoly),i=this.degree-n.length;if(i>0){let e=new Uint8Array(this.degree);return e.set(n,i),e}return n},e.exports=i},57973:(e,t,n)=>{"use strict";n.d(t,{C:()=>f});var r=n(18279),i=n(48720),a=n(46729),s=n(53824),o=n(65860),u=n(9908),c=n(73663),l=n(90132),d=n(44694),h=n(38890);async function f(e,t){let{account:n,allowFailure:f=!0,batchSize:p,blockNumber:g,blockTag:y,multicallAddress:m,stateOverride:w}=t,I=t.contracts,M=p??("object"==typeof e.batch?.multicall&&e.batch.multicall.batchSize||1024),E=m;if(!E){if(!e.chain)throw Error("client chain not configured. multicallAddress is required.");E=(0,c.M)({blockNumber:g,chain:e.chain,contract:"multicall3"})}let v=[[]],b=0,T=0;for(let e=0;e<I.length;e++){let{abi:t,address:r,args:i,functionName:a}=I[e];try{let e=(0,u.p)({abi:t,args:i,functionName:a});T+=(e.length-2)/2,M>0&&T>M&&v[b].length>0&&(b++,T=(e.length-2)/2,v[b]=[]),v[b]=[...v[b],{allowFailure:!0,callData:e,target:r}]}catch(s){let e=(0,l.j)(s,{abi:t,address:r,args:i,docsPath:"/docs/contract/multicall",functionName:a,sender:n});if(!f)throw e;v[b]=[...v[b],{allowFailure:!0,callData:"0x",target:r}]}}let N=await Promise.allSettled(v.map(t=>(0,d.T)(e,h.J,"readContract")({abi:r.v2,account:n,address:E,args:[t],blockNumber:g,blockTag:y,functionName:"aggregate3",stateOverride:w}))),A=[];for(let e=0;e<N.length;e++){let t=N[e];if("rejected"===t.status){if(!f)throw t.reason;for(let n=0;n<v[e].length;n++)A.push({status:"failure",error:t.reason,result:void 0});continue}let n=t.value;for(let t=0;t<n.length;t++){let{returnData:r,success:a}=n[t],{callData:u}=v[e][t],{abi:c,address:d,functionName:h,args:p}=I[A.length];try{if("0x"===u)throw new i.O;if(!a)throw new s.$S({data:r});let e=(0,o.e)({abi:c,args:p,data:r,functionName:h});A.push(f?{result:e,status:"success"}:e)}catch(t){let e=(0,l.j)(t,{abi:c,address:d,args:p,docsPath:"/docs/contract/multicall",functionName:h});if(!f)throw e;A.push({error:e,result:void 0,status:"failure"})}}}if(A.length!==I.length)throw new a.C("multicall results mismatch");return A}},59055:(e,t,n)=>{let r=n(6085);function i(e,t){let n=e.a/255,r=t+'="'+e.hex+'"';return n<1?r+" "+t+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function a(e,t,n){let r=e+t;return void 0!==n&&(r+=" "+n),r}t.render=function(e,t,n){let s=r.getOptions(t),o=e.modules.size,u=e.modules.data,c=o+2*s.margin,l=s.color.light.a?"<path "+i(s.color.light,"fill")+' d="M0 0h'+c+"v"+c+'H0z"/>':"",d="<path "+i(s.color.dark,"stroke")+' d="'+function(e,t,n){let r="",i=0,s=!1,o=0;for(let u=0;u<e.length;u++){let c=Math.floor(u%t),l=Math.floor(u/t);c||s||(s=!0),e[u]?(o++,u>0&&c>0&&e[u-1]||(r+=s?a("M",c+n,.5+l+n):a("m",i,0),i=0,s=!1),c+1<t&&e[u+1]||(r+=a("h",o),o=0)):i++}return r}(u,o,s.margin)+'"/>',h='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+('viewBox="0 0 '+c+" ")+c+'" shape-rendering="crispEdges">'+l+d+"</svg>\n";return"function"==typeof n&&n(null,h),h}},62114:(e,t,n)=>{let r=n(6343);function i(e){this.mode=r.NUMERIC,this.data=e.toString()}i.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(e){let t,n,r;for(t=0;t+3<=this.data.length;t+=3)r=parseInt(this.data.substr(t,3),10),e.put(r,10);let i=this.data.length-t;i>0&&(r=parseInt(this.data.substr(t),10),e.put(r,3*i+1))},e.exports=i},62595:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var r=n(86629),i=n(92418),a=n(36331),s=n(19024);function o(e){let t=[];if("string"==typeof e){let n=(0,s.NV)(e),r=n.length;for(let e=0;e<r;e++)t.push((0,s.Pj)(n[e],{modifiers:i.Dv}))}else{let n=(0,a.e)(e),r=e.length;for(let a=0;a<r;a++){let r=e[a];if((0,i.WL)(r))continue;let o=(0,s.NV)(r),u=o.length;for(let e=0;e<u;e++)t.push((0,s.Pj)(o[e],{modifiers:i.Dv,structs:n}))}}if(0===t.length)throw new r.A9({params:e});return t}},63340:(e,t,n)=>{"use strict";function r(e){let{chain:t}=e,n=t.rpcUrls.default.http[0];if(!e.transports)return[n];let r=e.transports?.[t.id]?.({chain:t});return(r?.value?.transports||[r]).map(({value:e})=>e?.url||n)}n.d(t,{R:()=>r})},68205:(e,t)=>{t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},69821:(e,t,n)=>{"use strict";n.d(t,{z:()=>y});var r=n(36292),i=n(86742),a=n(33374),s=n(88484),o=n(40440),u=n(46303),c=n(4377),l=n(85377);function d(e={}){let t,r,{shimDisconnect:i=!1}=e;return(0,o.U)(a=>({id:"safe",name:"Safe",type:d.type,async connect(){let e=await this.getProvider();if(!e)throw new u.N;let t=await this.getAccounts(),n=await this.getChainId();return r||(r=this.onDisconnect.bind(this),e.on("disconnect",r)),i&&await a.storage?.removeItem("safe.disconnected"),{accounts:t,chainId:n}},async disconnect(){let e=await this.getProvider();if(!e)throw new u.N;r&&(e.removeListener("disconnect",r),r=void 0),i&&await a.storage?.setItem("safe.disconnected",!0)},async getAccounts(){let e=await this.getProvider();if(!e)throw new u.N;return(await e.request({method:"eth_accounts"})).map(c.b)},async getProvider(){if("undefined"!=typeof window&&window?.parent!==window){if(!t){let{default:r}=await Promise.all([n.e(1902),n.e(2643)]).then(n.bind(n,82643)),i=new r(e),a=await (0,l.w)(()=>i.safe.getInfo(),{timeout:e.unstable_getInfoTimeout??10});if(!a)throw Error("Could not load Safe information");t=new(await (async()=>{let e=await Promise.all([n.e(1902),n.e(7330),n.e(4093)]).then(n.t.bind(n,94093,19));return"function"!=typeof e.SafeAppProvider&&"function"==typeof e.default.SafeAppProvider?e.default.SafeAppProvider:e.SafeAppProvider})())(a,i)}return t}},async getChainId(){let e=await this.getProvider();if(!e)throw new u.N;return Number(e.chainId)},async isAuthorized(){try{if(i&&await a.storage?.getItem("safe.disconnected"))return!1;return!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){a.emitter.emit("disconnect")}}))}d.type="safe";var h=n(87737),f=n(1324),p=n(74010),g=n(29500);function y(e){let t=[...e?.connectors??[]],n="undefined"!=typeof window?window:void 0,o=n?.localStorage,u=n&&n.parent!==n,c=!u&&(e?.wagmiConfig?.multiInjectedProviderDiscovery??!0),l=(0,s.Z)({chains:[a.r],client:({chain:e})=>(0,r.U)({chain:e,transport:(0,i.L)()}),...e?.wagmiConfig,multiInjectedProviderDiscovery:c});if(u&&t.unshift(d()),e?.walletConnect){let n=o?.getItem(`${l.storage?.key}.recentConnectorId`);(n?.includes?.("walletConnect")||!e.lazy)&&t.unshift((0,p.D)(e.walletConnect))}if(e?.coinbase&&!(0,g.q)("coinbase")){let n=o?.getItem(`${l.storage?.key}.recentConnectorId`);(n?.includes?.("coinbaseWalletSDK")||!e.lazy)&&t.unshift((0,h.G)(e.coinbase))}if(e?.metaMask&&!(0,g.q)("metaMask")){let n=o?.getItem(`${l.storage?.key}.recentConnectorId`);(n?.includes?.("metaMaskSDK")||!e.lazy)&&t.unshift((0,f.b)(e.metaMask))}return{config:l,connectors:t}}},69990:(e,t,n)=>{"use strict";var r;n.d(t,{B:()=>r}),function(e){e.Mainnet="mainnet-beta",e.Testnet="testnet",e.Devnet="devnet"}(r||(r={}))},70341:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});let r=(e,t,n)=>JSON.stringify(e,(e,n)=>{let r="bigint"==typeof n?n.toString():n;return"function"==typeof t?t(e,r):r},n)},71106:(e,t,n)=>{"use strict";n.d(t,{U:()=>a});var r=n(48422),i=n(26450);function a(e){let{cacheTime:t=e.pollingInterval??4e3,key:n="base",name:a="Base Client",pollingInterval:s=4e3,type:o="base"}=e,u=e.chain,c=e.account?(0,r.J)(e.account):void 0,{config:l,request:d,value:h}=e.transport({chain:u,pollingInterval:s}),f={account:c,cacheTime:t,chain:u,key:n,name:a,pollingInterval:s,request:d,transport:{...l,...h},type:o,uid:(0,i.L)()};return Object.assign(f,{extend:function e(t){return n=>{let r=n(t);for(let e in f)delete r[e];let i={...t,...r};return Object.assign(i,{extend:e(i)})}}(f)})}},74010:(e,t,n)=>{"use strict";n.d(t,{D:()=>h});var r=n(40440),i=n(46303),a=n(63340),s=n(80994),o=n(4377),u=n(59441),c=n(7672);function l(e){let t,d,h,f,p,g,y,m,w=e.isNewChainsStale??!0;return(0,r.U)(r=>({id:"walletConnect",name:"WalletConnect",type:l.type,async setup(){let e=await this.getProvider().catch(()=>null);e&&(p||(p=this.onConnect.bind(this),e.on("connect",p)),y||(y=this.onSessionDelete.bind(this),e.on("session_delete",y)))},async connect({chainId:e,...t}={}){try{let n=await this.getProvider();if(!n)throw new i.N;g||(g=this.onDisplayUri,n.on("display_uri",g));let a=e;if(!a){let e=await r.storage?.getItem("state")??{};a=r.chains.some(t=>t.id===e.chainId)?e.chainId:r.chains[0]?.id}if(!a)throw Error("No chains found on connector.");let s=await this.isChainsStale();if(n.session&&s&&await n.disconnect(),!n.session||s){let e=r.chains.filter(e=>e.id!==a).map(e=>e.id);await n.connect({optionalChains:[a,...e],..."pairingTopic"in t?{pairingTopic:t.pairingTopic}:{}}),this.setRequestedChainsIds(r.chains.map(e=>e.id))}let u=(await n.enable()).map(e=>(0,o.b)(e)),c=await this.getChainId();return g&&(n.removeListener("display_uri",g),g=void 0),p&&(n.removeListener("connect",p),p=void 0),h||(h=this.onAccountsChanged.bind(this),n.on("accountsChanged",h)),f||(f=this.onChainChanged.bind(this),n.on("chainChanged",f)),m||(m=this.onDisconnect.bind(this),n.on("disconnect",m)),y||(y=this.onSessionDelete.bind(this),n.on("session_delete",y)),{accounts:u,chainId:c}}catch(e){if(/(user rejected|connection request reset)/i.test(e?.message))throw new u.vx(e);throw e}},async disconnect(){let e=await this.getProvider();try{await e?.disconnect()}catch(e){if(!/No matching key/i.test(e.message))throw e}finally{f&&(e?.removeListener("chainChanged",f),f=void 0),m&&(e?.removeListener("disconnect",m),m=void 0),p||(p=this.onConnect.bind(this),e?.on("connect",p)),h&&(e?.removeListener("accountsChanged",h),h=void 0),y&&(e?.removeListener("session_delete",y),y=void 0),this.setRequestedChainsIds([])}},async getAccounts(){return(await this.getProvider()).accounts.map(e=>(0,o.b)(e))},async getProvider({chainId:i}={}){async function s(){let t=r.chains.map(e=>e.id);if(!t.length)return;let{EthereumProvider:i}=await Promise.all([n.e(4912),n.e(3086)]).then(n.bind(n,73086));return await i.init({...e,disableProviderPing:!0,optionalChains:t,projectId:e.projectId,rpcMap:Object.fromEntries(r.chains.map(e=>{let[t]=(0,a.R)({chain:e,transports:r.transports});return[e.id,t]})),showQrModal:e.showQrModal??!0})}return t||(d||(d=s()),t=await d,t?.events.setMaxListeners(Number.POSITIVE_INFINITY)),i&&await this.switchChain?.({chainId:i}),t},async getChainId(){return(await this.getProvider()).chainId},async isAuthorized(){try{let[e,t]=await Promise.all([this.getAccounts(),this.getProvider()]);if(!e.length)return!1;if(await this.isChainsStale()&&t.session)return await t.disconnect().catch(()=>{}),!1;return!0}catch{return!1}},async switchChain({addEthereumChainParameter:e,chainId:t}){let n=await this.getProvider();if(!n)throw new i.N;let a=r.chains.find(e=>e.id===t);if(!a)throw new u.ch(new s.nk);try{await Promise.all([new Promise(e=>{let n=({chainId:i})=>{i===t&&(r.emitter.off("change",n),e())};r.emitter.on("change",n)}),n.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,c.cK)(t)}]})]);let e=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...e,t]),a}catch(r){if(/(user rejected)/i.test(r.message))throw new u.vx(r);try{let r,i;r=e?.blockExplorerUrls?e.blockExplorerUrls:a.blockExplorers?.default.url?[a.blockExplorers?.default.url]:[],i=e?.rpcUrls?.length?e.rpcUrls:[...a.rpcUrls.default.http];let s={blockExplorerUrls:r,chainId:(0,c.cK)(t),chainName:e?.chainName??a.name,iconUrls:e?.iconUrls,nativeCurrency:e?.nativeCurrency??a.nativeCurrency,rpcUrls:i};await n.request({method:"wallet_addEthereumChain",params:[s]});let o=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...o,t]),a}catch(e){throw new u.vx(e)}}},onAccountsChanged(e){0===e.length?this.onDisconnect():r.emitter.emit("change",{accounts:e.map(e=>(0,o.b)(e))})},onChainChanged(e){let t=Number(e);r.emitter.emit("change",{chainId:t})},async onConnect(e){let t=Number(e.chainId),n=await this.getAccounts();r.emitter.emit("connect",{accounts:n,chainId:t})},async onDisconnect(e){this.setRequestedChainsIds([]),r.emitter.emit("disconnect");let t=await this.getProvider();h&&(t.removeListener("accountsChanged",h),h=void 0),f&&(t.removeListener("chainChanged",f),f=void 0),m&&(t.removeListener("disconnect",m),m=void 0),y&&(t.removeListener("session_delete",y),y=void 0),p||(p=this.onConnect.bind(this),t.on("connect",p))},onDisplayUri(e){r.emitter.emit("message",{type:"display_uri",data:e})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds:()=>t?t.session?.namespaces.eip155?.accounts?.map(e=>Number.parseInt(e.split(":")[1]||""))??[]:[],async getRequestedChainsIds(){return await r.storage?.getItem(this.requestedChainsStorageKey)??[]},async isChainsStale(){if(!w)return!1;let e=r.chains.map(e=>e.id),t=this.getNamespaceChainsIds();if(t.length&&!t.some(t=>e.includes(t)))return!1;let n=await this.getRequestedChainsIds();return!e.every(e=>n.includes(e))},async setRequestedChainsIds(e){await r.storage?.setItem(this.requestedChainsStorageKey,e)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}}))}l.type="walletConnect";var d=n(7623);let h=e=>(0,d.I)(l({showQrModal:!0,qrModalOptions:{themeVariables:{"--wcm-z-index":"3000"}},...e}),"walletConnect","WalletConnect")},74160:(e,t,n)=>{"use strict";function r(e){return btoa(e.match(/.{1,2}/g).map(e=>String.fromCharCode(Number.parseInt(e,16))).join(""))}function i(e){let t=atob(e),n="";for(let e=0;e<t.length;e++){let r=t.charCodeAt(e).toString(16);n+=2===r.length?r:`0${r}`}return n}function a(e){return btoa(String.fromCharCode(...new TextEncoder().encode(e))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function s(e){let t=Array.from(e).map(e=>e.charCodeAt(0).toString(16).padStart(2,"0")).join("");return`0x${t}`}n.d(t,{OG:()=>r,Qf:()=>i,i3:()=>s,lu:()=>a})},74679:e=>{function t(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,n,r){let i=e*this.size+t;this.data[i]=n,r&&(this.reservedBit[i]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,n){this.data[e*this.size+t]^=n},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},75031:(e,t,n)=>{"use strict";function r(e){return"version"in e}n.d(t,{Y:()=>r})},76586:(e,t,n)=>{let r=n(6343),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function a(e){this.mode=r.ALPHANUMERIC,this.data=e}a.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},a.prototype.getLength=function(){return this.data.length},a.prototype.getBitsLength=function(){return a.getBitsLength(this.data.length)},a.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=45*i.indexOf(this.data[t]);n+=i.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(i.indexOf(this.data[t]),6)},e.exports=a},77527:(e,t,n)=>{e.exports=n(41894)("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},80774:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var r=n(10599),i=n(7672);async function a(e,t={}){let{account:n=e.account,chainId:s}=t,o=n?(0,r.J)(n):void 0,u=s?[o?.address,[(0,i.cK)(s)]]:[o?.address],c=await e.request({method:"wallet_getCapabilities",params:u}),l={};for(let[e,t]of Object.entries(c))for(let[n,r]of(l[Number(e)]={},Object.entries(t)))"addSubAccount"===n&&(n="unstable_addSubAccount"),l[Number(e)][n]=r;return"number"==typeof s?l[s]:l}},80994:(e,t,n)=>{"use strict";n.d(t,{nk:()=>i});var r=n(37723);class i extends r.C{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}r.C,r.C,r.C,r.C,r.C,r.C},81214:(e,t,n)=>{let r=n(5041).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,n=r(e),i=145===n?26:2*Math.ceil((n-13)/(2*t-2)),a=[n-7];for(let e=1;e<t-1;e++)a[e]=a[e-1]-i;return a.push(6),a.reverse()},t.getPositions=function(e){let n=[],r=t.getRowColCoords(e),i=r.length;for(let e=0;e<i;e++)for(let t=0;t<i;t++)(0!==e||0!==t)&&(0!==e||t!==i-1)&&(e!==i-1||0!==t)&&n.push([r[e],r[t]]);return n}},85604:(e,t,n)=>{let r=n(5041),i=n(3201),a=n(23066),s=n(6343),o=n(68205),u=r.getBCHDigit(7973);function c(e,t){return s.getCharCountIndicator(e,t)+4}t.from=function(e,t){return o.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,n){if(!o.isValid(e))throw Error("Invalid QR Code version");void 0===n&&(n=s.BYTE);let a=(r.getSymbolTotalCodewords(e)-i.getTotalCodewordsCount(e,t))*8;if(n===s.MIXED)return a;let u=a-c(n,e);switch(n){case s.NUMERIC:return Math.floor(u/10*3);case s.ALPHANUMERIC:return Math.floor(u/11*2);case s.KANJI:return Math.floor(u/13);case s.BYTE:default:return Math.floor(u/8)}},t.getBestVersionForData=function(e,n){let r,i=a.from(n,a.M);if(Array.isArray(e)){if(e.length>1){for(let n=1;n<=40;n++)if(function(e,t){let n=0;return e.forEach(function(e){let r=c(e.mode,t);n+=r+e.getBitsLength()}),n}(e,n)<=t.getCapacity(n,i,s.MIXED))return n;return}if(0===e.length)return 1;r=e[0]}else r=e;return function(e,n,r){for(let i=1;i<=40;i++)if(n<=t.getCapacity(i,r,e))return i}(r.mode,r.getLength(),i)},t.getEncodedBits=function(e){if(!o.isValid(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;r.getBCHDigit(t)-u>=0;)t^=7973<<r.getBCHDigit(t)-u;return e<<12|t}},86116:(e,t)=>{let n=new Uint8Array(512),r=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)n[t]=e,r[e]=t,256&(e<<=1)&&(e^=285);for(let e=255;e<512;e++)n[e]=n[e-255]}(),t.log=function(e){if(e<1)throw Error("log("+e+")");return r[e]},t.exp=function(e){return n[e]},t.mul=function(e,t){return 0===e||0===t?0:n[r[e]+r[t]]}},87737:(e,t,n)=>{"use strict";n.d(t,{G:()=>l});var r=n(40440),i=n(80994),a=n(4377),s=n(59441),o=n(7672);function u(e={}){var t,c;let l,d,h,f,p,g,y,m,w;return"3"===e.version||e.headlessMode?(t=e,(0,r.U)(e=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:u.type,async connect({chainId:e}={}){try{let t=await this.getProvider(),n=(await t.request({method:"eth_requestAccounts"})).map(e=>(0,a.b)(e));h||(h=this.onAccountsChanged.bind(this),t.on("accountsChanged",h)),f||(f=this.onChainChanged.bind(this),t.on("chainChanged",f)),p||(p=this.onDisconnect.bind(this),t.on("disconnect",p));let r=await this.getChainId();if(e&&r!==e){let t=await this.switchChain({chainId:e}).catch(e=>{if(e.code===s.vx.code)throw e;return{id:r}});r=t?.id??r}return{accounts:n,chainId:r}}catch(e){if(/(user closed modal|accounts received is empty|user denied account)/i.test(e.message))throw new s.vx(e);throw e}},async disconnect(){let e=await this.getProvider();h&&(e.removeListener("accountsChanged",h),h=void 0),f&&(e.removeListener("chainChanged",f),f=void 0),p&&(e.removeListener("disconnect",p),p=void 0),e.disconnect(),e.close()},async getAccounts(){let e=await this.getProvider();return(await e.request({method:"eth_accounts"})).map(e=>(0,a.b)(e))},async getChainId(){let e=await this.getProvider();return Number(await e.request({method:"eth_chainId"}))},async getProvider(){if(!d){l=new(await (async()=>{let{default:e}=await Promise.all([n.e(9210),n.e(5953)]).then(n.t.bind(n,79210,19));return"function"!=typeof e&&"function"==typeof e.default?e.default:e})())({...t,reloadOnDisconnect:!1});let r=l.walletExtension?.getChainId(),i=e.chains.find(e=>t.chainId?e.id===t.chainId:e.id===r)||e.chains[0],a=t.chainId||i?.id,s=t.jsonRpcUrl||i?.rpcUrls.default.http[0];d=l.makeWeb3Provider(s,a)}return d},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:n}){let r=e.chains.find(e=>e.id===n);if(!r)throw new s.ch(new i.nk);let a=await this.getProvider();try{return await a.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,o.cK)(r.id)}]}),r}catch(e){if(4902===e.code)try{let e,i;e=t?.blockExplorerUrls?t.blockExplorerUrls:r.blockExplorers?.default.url?[r.blockExplorers?.default.url]:[],i=t?.rpcUrls?.length?t.rpcUrls:[r.rpcUrls.default?.http[0]??""];let s={blockExplorerUrls:e,chainId:(0,o.cK)(n),chainName:t?.chainName??r.name,iconUrls:t?.iconUrls,nativeCurrency:t?.nativeCurrency??r.nativeCurrency,rpcUrls:i};return await a.request({method:"wallet_addEthereumChain",params:[s]}),r}catch(e){throw new s.vx(e)}throw new s.ch(e)}},onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t.map(e=>(0,a.b)(e))})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect");let n=await this.getProvider();h&&(n.removeListener("accountsChanged",h),h=void 0),f&&(n.removeListener("chainChanged",f),f=void 0),p&&(n.removeListener("disconnect",p),p=void 0)}}))):(c=e,(0,r.U)(e=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:u.type,async connect({chainId:e,...t}={}){try{let n=await this.getProvider(),r=(await n.request({method:"eth_requestAccounts",params:"instantOnboarding"in t&&t.instantOnboarding?[{onboarding:"instant"}]:[]})).map(e=>(0,a.b)(e));y||(y=this.onAccountsChanged.bind(this),n.on("accountsChanged",y)),m||(m=this.onChainChanged.bind(this),n.on("chainChanged",m)),w||(w=this.onDisconnect.bind(this),n.on("disconnect",w));let i=await this.getChainId();if(e&&i!==e){let t=await this.switchChain({chainId:e}).catch(e=>{if(e.code===s.vx.code)throw e;return{id:i}});i=t?.id??i}return{accounts:r,chainId:i}}catch(e){if(/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(e.message))throw new s.vx(e);throw e}},async disconnect(){let e=await this.getProvider();y&&(e.removeListener("accountsChanged",y),y=void 0),m&&(e.removeListener("chainChanged",m),m=void 0),w&&(e.removeListener("disconnect",w),w=void 0),e.disconnect(),e.close?.()},async getAccounts(){let e=await this.getProvider();return(await e.request({method:"eth_accounts"})).map(e=>(0,a.b)(e))},async getChainId(){let e=await this.getProvider();return Number(await e.request({method:"eth_chainId"}))},async getProvider(){if(!g){let t="string"==typeof c.preference?{options:c.preference}:{...c.preference,options:c.preference?.options??"all"},{createCoinbaseWalletSDK:r}=await Promise.all([n.e(7330),n.e(3575)]).then(n.bind(n,63575));g=r({...c,appChainIds:e.chains.map(e=>e.id),preference:t}).getProvider()}return g},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:n}){let r=e.chains.find(e=>e.id===n);if(!r)throw new s.ch(new i.nk);let a=await this.getProvider();try{return await a.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,o.cK)(r.id)}]}),r}catch(e){if(4902===e.code)try{let e,i;e=t?.blockExplorerUrls?t.blockExplorerUrls:r.blockExplorers?.default.url?[r.blockExplorers?.default.url]:[],i=t?.rpcUrls?.length?t.rpcUrls:[r.rpcUrls.default?.http[0]??""];let s={blockExplorerUrls:e,chainId:(0,o.cK)(n),chainName:t?.chainName??r.name,iconUrls:t?.iconUrls,nativeCurrency:t?.nativeCurrency??r.nativeCurrency,rpcUrls:i};return await a.request({method:"wallet_addEthereumChain",params:[s]}),r}catch(e){throw new s.vx(e)}throw new s.ch(e)}},onAccountsChanged(t){0===t.length?this.onDisconnect():e.emitter.emit("change",{accounts:t.map(e=>(0,a.b)(e))})},onChainChanged(t){let n=Number(t);e.emitter.emit("change",{chainId:n})},async onDisconnect(t){e.emitter.emit("disconnect");let n=await this.getProvider();y&&(n.removeListener("accountsChanged",y),y=void 0),m&&(n.removeListener("chainChanged",m),m=void 0),w&&(n.removeListener("disconnect",w),w=void 0)}})))}u.type="coinbaseWallet";var c=n(7623);let l=e=>(0,c.I)(u(e),"coinbaseWalletSDK","Coinbase Wallet")},88371:(e,t,n)=>{"use strict";n.d(t,{DE:()=>o,Kl:()=>s,Xl:()=>u});var r=n(16591),i=n(38582),a=n(75031);class s extends r.Ce{async sendTransaction(e,t,n={}){let r=!0;try{if((0,a.Y)(e)){if(!this.supportedTransactionVersions)throw new i.UF("Sending versioned transactions isn't supported by this wallet");if(!this.supportedTransactionVersions.has(e.version))throw new i.UF(`Sending transaction version ${e.version} isn't supported by this wallet`);try{let r=(e=await this.signTransaction(e)).serialize();return await t.sendRawTransaction(r,n)}catch(e){if(e instanceof i.z4)throw r=!1,e;throw new i.UF(e?.message,e)}}try{let{signers:r,...i}=n;e=await this.prepareTransaction(e,t,i),r?.length&&e.partialSign(...r);let a=(e=await this.signTransaction(e)).serialize();return await t.sendRawTransaction(a,i)}catch(e){if(e instanceof i.z4)throw r=!1,e;throw new i.UF(e?.message,e)}}catch(e){throw r&&this.emit("error",e),e}}async signAllTransactions(e){for(let t of e)if((0,a.Y)(t)){if(!this.supportedTransactionVersions)throw new i.z4("Signing versioned transactions isn't supported by this wallet");if(!this.supportedTransactionVersions.has(t.version))throw new i.z4(`Signing transaction version ${t.version} isn't supported by this wallet`)}let t=[];for(let n of e)t.push(await this.signTransaction(n));return t}}class o extends s{}class u extends o{}},95375:(e,t,n)=>{"use strict";n.d(t,{k:()=>u});var r=n(14977),i=n(80001),a=n(64159),s=n(73096),o=n(99995);async function u(e,t){async function n(t){if(t.endsWith(o.vB.slice(2))){let n=(0,i.B)((0,r.iN)(t,-64,-32)),s=(0,r.iN)(t,0,-64).slice(2).match(/.{1,64}/g),u=await Promise.all(s.map(t=>o.BH.slice(2)!==t?e.request({method:"eth_getTransactionReceipt",params:[`0x${t}`]},{dedupe:!0}):void 0)),c=u.some(e=>null===e)?100:u.every(e=>e?.status==="0x1")?200:u.every(e=>e?.status==="0x0")?500:600;return{atomic:!1,chainId:(0,a.ME)(n),receipts:u.filter(Boolean),status:c,version:"2.0.0"}}return e.request({method:"wallet_getCallsStatus",params:[t]})}let{atomic:u=!1,chainId:c,receipts:l,version:d="2.0.0",...h}=await n(t.id),[f,p]=(()=>{let e=h.status;return e>=100&&e<200?["pending",e]:e>=200&&e<300?["success",e]:e>=300&&e<700?["failure",e]:"CONFIRMED"===e?["success",200]:"PENDING"===e?["pending",100]:[void 0,e]})();return{...h,atomic:u,chainId:c?(0,a.ME)(c):void 0,receipts:l?.map(e=>({...e,blockNumber:(0,a.uU)(e.blockNumber),gasUsed:(0,a.uU)(e.gasUsed),status:s.Lj[e.status]}))??[],statusCode:p,status:f,version:d}}},96102:(e,t,n)=>{"use strict";n.d(t,{S:()=>s});var r=n(4398),i=n(56151),a=n(45986);let s=({children:e,endpoint:t,config:n={commitment:"confirmed"}})=>{let s=(0,i.useMemo)(()=>new r.Ng(t,n),[t,n]);return i.createElement(a.E.Provider,{value:{connection:s}},e)}},97312:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var r=n(17058),i=n(30172),a=n(7821);async function s(){i.$.loading=(0,a.h)({chainTypes:[r.I.EVM,r.I.SVM,r.I.UTXO,r.I.MVM]}).then(e=>i.$.setChains(e)).catch(),await i.$.loading}function o(e){let t=function(e){if(!e.integrator)throw Error("Integrator not found. Please see documentation https://docs.li.fi/integrate-li.fi-js-sdk/set-up-the-sdk");let t=i.$.set(e);return e.disableVersionCheck,t}(e);return t.preloadChains&&s(),t}},99995:(e,t,n)=>{"use strict";n.d(t,{BH:()=>f,vB:()=>h,yM:()=>p});var r=n(10599),i=n(46729),a=n(59441),s=n(9908),o=n(86673),u=n(64159),c=n(7672),l=n(82330),d=n(9694);let h="0x5792579257925792579257925792579257925792579257925792579257925792",f=(0,c.cK)(0,{size:32});async function p(e,t){let{account:n=e.account,capabilities:p,chain:g=e.chain,experimental_fallback:y,experimental_fallbackDelay:m=32,forceAtomic:w=!1,id:I,version:M="2.0.0"}=t,E=n?(0,r.J)(n):null,v=t.calls.map(e=>({data:e.abi?(0,s.p)({abi:e.abi,functionName:e.functionName,args:e.args}):e.data,to:e.to,value:e.value?(0,c.cK)(e.value):void 0}));try{let t=await e.request({method:"wallet_sendCalls",params:[{atomicRequired:w,calls:v,capabilities:p,chainId:(0,c.cK)(g.id),from:E?.address,id:I,version:M}]},{retryCount:0});if("string"==typeof t)return{id:t};return t}catch(n){if(y&&("MethodNotFoundRpcError"===n.name||"MethodNotSupportedRpcError"===n.name||n.details.toLowerCase().includes("does not exist / is not available")||n.details.toLowerCase().includes("missing or invalid. request()")||n.details.toLowerCase().includes("did not match any variant of untagged enum"))){if(p&&Object.values(p).some(e=>!e.optional)){let e="non-optional `capabilities` are not supported on fallback to `eth_sendTransaction`.";throw new a.L5(new i.C(e,{details:e}))}if(w&&v.length>1){let e="`forceAtomic` is not supported on fallback to `eth_sendTransaction`.";throw new a.jz(new i.C(e,{details:e}))}let t=[];for(let n of v){let r=(0,d.v)(e,{account:E,chain:g,data:n.data,to:n.to,value:n.value?(0,u.uU)(n.value):void 0});t.push(r),m>0&&await new Promise(e=>setTimeout(e,m))}let n=await Promise.allSettled(t);if(n.every(e=>"rejected"===e.status))throw n[0].reason;let r=n.map(e=>"fulfilled"===e.status?e.value:f);return{id:(0,o.xW)([...r,(0,c.cK)(g.id,{size:32}),h])}}throw(0,l.p)(n,{...t,account:E,chain:t.chain})}}}}]);