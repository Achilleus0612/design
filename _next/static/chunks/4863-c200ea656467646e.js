try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="e2e605fa-686f-4a5d-abab-81bf1333c9b5",e._sentryDebugIdIdentifier="sentry-dbid-e2e605fa-686f-4a5d-abab-81bf1333c9b5")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4863],{63:(e,t,i)=>{"use strict";i.d(t,{W:()=>D});var r=i(41179),s=i(74801),n=i(197),a=i(3046),o=i(1221);function c(e,t){return o.a.getConnectorId(e)===t}var l=i(51605),d=i(91019),h=i(5001),u=i(1711),p=i(95954),f=i(14109),g=i(50209),y=i(75808),m=i(9686),b=i(20641),w=i(77131);let v={bigNumber:e=>new w.A(e?e:0),multiply(e,t){if(void 0===e||void 0===t)return new w.A(0);let i=new w.A(e),r=new w.A(t);return i.times(r)},formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}),parseLocalStringToNumber:e=>void 0===e?0:parseFloat(e.replace(/,/gu,""))},I=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],E=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],_={getERC20Abi:e=>a.o.USDT_CONTRACT_ADDRESSES.includes(e)?E:I};var C=i(58267),A=i(42270),S=i(87367);let N={createBalance(e,t){let i={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:i.name,symbol:i.symbol,chainId:t,address:"native"===e.address?void 0:this.convertAddressToCAIP10Address(e.address,t),value:i.value,price:i.price,quantity:{decimals:i.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:i.decimals})},iconUrl:i.iconUrl}},convertHexToBalance:({hex:e,decimals:t})=>(0,S.J)(BigInt(e),t),convertAddressToCAIP10Address:(e,t)=>`${t}:${e}`,createCAIP2ChainId:(e,t)=>`${t}:${parseInt(e,16)}`,getChainIdHexFromCAIP2ChainId(e){let t=e.split(":");if(t.length<2||!t[1])return"0x0";let i=parseInt(t[1],10);return isNaN(i)?"0x0":`0x${i.toString(16)}`},isWalletGetAssetsResponse(e){return"object"==typeof e&&null!==e&&Object.values(e).every(e=>Array.isArray(e)&&e.every(e=>this.isValidAsset(e)))},isValidAsset:e=>"object"==typeof e&&null!==e&&"string"==typeof e.address&&"string"==typeof e.balance&&("ERC20"===e.type||"NATIVE"===e.type)&&"object"==typeof e.metadata&&null!==e.metadata&&"string"==typeof e.metadata.name&&"string"==typeof e.metadata.symbol&&"number"==typeof e.metadata.decimals&&"number"==typeof e.metadata.price&&"string"==typeof e.metadata.iconUrl},T={async getMyTokensWithBalance(e){let t=u.U.state.address,i=D.state.activeCaipNetwork;if(!t||!i)return[];if("eip155"===i.chainNamespace){let e=await this.getEIP155Balances(t,i);if(e)return this.filterLowQualityTokens(e)}let r=await A.T.getBalance(t,i.caipNetworkId,e);return this.filterLowQualityTokens(r.balances)},async getEIP155Balances(e,t){try{let i=N.getChainIdHexFromCAIP2ChainId(t.caipNetworkId),r=await p.x.getCapabilities(e);if(!r?.[i]?.assetDiscovery?.supported)return null;let s=await p.x.walletGetAssets({account:e,chainFilter:[i]});if(!N.isWalletGetAssetsResponse(s))return null;return(s[i]||[]).map(e=>N.createBalance(e,t.caipNetworkId))}catch(e){return null}},filterLowQualityTokens:e=>e.filter(e=>"0"!==e.quantity.decimals),mapBalancesToSwapTokens:e=>e?.map(e=>({...e,address:e?.address?e.address:D.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]};var x=i(97490);let P=(0,r.BX)({tokenBalances:[],loading:!1}),O={state:P,subscribe:e=>(0,r.B1)(P,()=>e(P)),subscribeKey:(e,t)=>(0,s.u$)(P,e,t),setToken(e){e&&(P.token=(0,r.KR)(e))},setTokenAmount(e){P.sendTokenAmount=e},setReceiverAddress(e){P.receiverAddress=e},setReceiverProfileImageUrl(e){P.receiverProfileImageUrl=e},setReceiverProfileName(e){P.receiverProfileName=e},setGasPrice(e){P.gasPrice=e},setGasPriceInUsd(e){P.gasPriceInUSD=e},setNetworkBalanceInUsd(e){P.networkBalanceInUSD=e},setLoading(e){P.loading=e},sendToken(){switch(D.state.activeCaipNetwork?.chainNamespace){case"eip155":this.sendEvmToken();return;case"solana":this.sendSolanaToken();return;default:throw Error("Unsupported chain")}},sendEvmToken(){this.state.token?.address&&this.state.sendTokenAmount&&this.state.receiverAddress?(f.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.address,amount:this.state.sendTokenAmount,network:D.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendERC20Token({receiverAddress:this.state.receiverAddress,tokenAddress:this.state.token.address,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals})):this.state.receiverAddress&&this.state.sendTokenAmount&&this.state.gasPrice&&this.state.token?.quantity.decimals&&(f.E.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol,amount:this.state.sendTokenAmount,network:D.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendNativeToken({receiverAddress:this.state.receiverAddress,sendTokenAmount:this.state.sendTokenAmount,gasPrice:this.state.gasPrice,decimals:this.state.token.quantity.decimals}))},async fetchTokenBalance(e){P.loading=!0;let t=D.state.activeCaipNetwork?.caipNetworkId,i=D.state.activeCaipNetwork?.chainNamespace,r=D.state.activeCaipAddress,s=r?d.w.getPlainAddress(r):void 0;if(P.lastRetry&&!d.w.isAllowedRetry(P.lastRetry,30*l.oU.ONE_SEC_MS))return P.loading=!1,[];try{if(s&&t&&i){let e=await T.getMyTokensWithBalance();return P.tokenBalances=e,P.lastRetry=void 0,e}}catch(t){P.lastRetry=Date.now(),e?.(t),x.P.showError("Token Balance Unavailable")}finally{P.loading=!1}return[]},fetchNetworkBalance(){if(0===P.tokenBalances.length)return;let e=T.mapBalancesToSwapTokens(P.tokenBalances);if(!e)return;let t=e.find(e=>e.address===D.getActiveNetworkTokenAddress());t&&(P.networkBalanceInUSD=t?v.multiply(t.quantity.numeric,t.price).toString():"0")},isInsufficientNetworkTokenForGas:(e,t)=>!!v.bigNumber(e).eq(0)||v.bigNumber(v.bigNumber(t||"0")).gt(e),hasInsufficientGasFunds(){let e=!0;return u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT?e=!1:P.networkBalanceInUSD&&(e=this.isInsufficientNetworkTokenForGas(P.networkBalanceInUSD,P.gasPriceInUSD)),e},async sendNativeToken(e){b.I.pushTransactionStack({view:"Account",goBack:!1});let t=e.receiverAddress,i=u.U.state.address,r=p.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{await p.x.sendTransaction({chainNamespace:"eip155",to:t,address:i,data:"0x",value:r??BigInt(0),gasPrice:e.gasPrice}),x.P.showSuccess("Transaction started"),f.E.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:D.state.activeCaipNetwork?.caipNetworkId||""}}),this.resetSend()}catch(i){console.error("SendController:sendERC20Token - failed to send native token",i);let t=i instanceof Error?i.message:"Unknown error";f.E.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:t,isSmartAccount:u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:D.state.activeCaipNetwork?.caipNetworkId||""}}),x.P.showError("Something went wrong")}},async sendERC20Token(e){b.I.pushTransactionStack({view:"Account",goBack:!1});let t=p.x.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{if(u.U.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){let i=d.w.getPlainAddress(e.tokenAddress);await p.x.writeContract({fromAddress:u.U.state.address,tokenAddress:i,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:_.getERC20Abi(i),chainNamespace:"eip155"}),x.P.showSuccess("Transaction started"),this.resetSend()}}catch(i){console.error("SendController:sendERC20Token - failed to send erc20 token",i);let t=i instanceof Error?i.message:"Unknown error";f.E.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:t,isSmartAccount:u.U.state.preferredAccountType===C.Vl.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:D.state.activeCaipNetwork?.caipNetworkId||""}}),x.P.showError("Something went wrong")}},sendSolanaToken(){if(!this.state.sendTokenAmount||!this.state.receiverAddress)return void x.P.showError("Please enter a valid amount and receiver address");b.I.pushTransactionStack({view:"Account",goBack:!1}),p.x.sendTransaction({chainNamespace:"solana",to:this.state.receiverAddress,value:this.state.sendTokenAmount}).then(()=>{this.resetSend(),u.U.fetchTokenBalance()}).catch(e=>{x.P.showError("Failed to send transaction. Please try again."),console.error("SendController:sendToken - failed to send solana transaction",e)})},resetSend(){P.token=void 0,P.sendTokenAmount=void 0,P.receiverAddress=void 0,P.receiverProfileImageUrl=void 0,P.receiverProfileName=void 0,P.loading=!1,P.tokenBalances=[]}},M={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},R={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},k=(0,r.BX)({chains:(0,s.zC)(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),D={state:k,subscribe:e=>(0,r.B1)(k,()=>{e(k)}),subscribeKey:(e,t)=>(0,s.u$)(k,e,t),subscribeChainProp(e,t,i){let s;return(0,r.B1)(k.chains,()=>{let r=i||k.activeChain;if(r){let i=k.chains.get(r)?.[e];s!==i&&(s=i,t(i))}})},initialize(e,t,i){let{chainId:s,namespace:n}=h.i.getActiveNetworkProps(),a=t?.find(e=>e.id.toString()===s?.toString()),o=e.find(e=>e?.namespace===n)||e?.[0],c=new Set([...t?.map(e=>e.chainNamespace)??[]]);e?.length!==0&&o||(k.noAdapters=!0),!k.noAdapters&&(k.activeChain=o?.namespace,k.activeCaipNetwork=a,this.setChainNetworkData(o?.namespace,{caipNetwork:a}),k.activeChain&&m.z.set({activeChain:o?.namespace})),c.forEach(e=>{let s=t?.filter(t=>t.chainNamespace===e);D.state.chains.set(e,{namespace:e,networkState:(0,r.BX)({...R,caipNetwork:s?.[0]}),accountState:(0,r.BX)(M),caipNetworks:s??[],...i}),this.setRequestedCaipNetworks(s??[],e)})},removeAdapter(e){if(k.activeChain===e){let t=Array.from(k.chains.entries()).find(([t])=>t!==e);if(t){let e=t[1]?.caipNetworks?.[0];e&&this.setActiveCaipNetwork(e)}}k.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:i},r){k.chains.set(e.namespace,{namespace:e.namespace,networkState:{...R,caipNetwork:r[0]},accountState:M,caipNetworks:r,connectionControllerClient:i,networkControllerClient:t}),this.setRequestedCaipNetworks(r?.filter(t=>t.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){let t=k.chains.get(e.chainNamespace);if(t){let i=[...t.caipNetworks||[]];t.caipNetworks?.find(t=>t.id===e.id)||i.push(e),k.chains.set(e.chainNamespace,{...t,caipNetworks:i}),this.setRequestedCaipNetworks(i,e.chainNamespace)}},removeNetwork(e,t){let i=k.chains.get(e);if(i){let r=k.activeCaipNetwork?.id===t,s=[...i.caipNetworks?.filter(e=>e.id!==t)||[]];r&&i?.caipNetworks?.[0]&&this.setActiveCaipNetwork(i.caipNetworks[0]),k.chains.set(e,{...i,caipNetworks:s}),this.setRequestedCaipNetworks(s||[],e)}},setAdapterNetworkState(e,t){let i=k.chains.get(e);i&&(i.networkState={...i.networkState||R,...t},k.chains.set(e,i))},setChainAccountData(e,t,i=!0){if(!e)throw Error("Chain is required to update chain account data");let r=k.chains.get(e);if(r){let i={...r.accountState||M,...t};k.chains.set(e,{...r,accountState:i}),(1===k.chains.size||k.activeChain===e)&&(t.caipAddress&&(k.activeCaipAddress=t.caipAddress),u.U.replaceState(i))}},setChainNetworkData(e,t){if(!e)return;let i=k.chains.get(e);if(i){let r={...i.networkState||R,...t};k.chains.set(e,{...i,networkState:r})}},setAccountProp(e,t,i,r=!0){this.setChainAccountData(i,{[e]:t},r),"status"===e&&"disconnected"===t&&i&&o.a.removeConnectorId(i)},setActiveNamespace(e){k.activeChain=e;let t=e?k.chains.get(e):void 0,i=t?.networkState?.caipNetwork;i?.id&&e&&(k.activeCaipAddress=t?.accountState?.caipAddress,k.activeCaipNetwork=i,this.setChainNetworkData(e,{caipNetwork:i}),h.i.setActiveCaipNetworkId(i?.caipNetworkId),m.z.set({activeChain:e,selectedNetworkId:i?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;k.activeChain!==e.chainNamespace&&this.setIsSwitchingNamespace(!0);let t=k.chains.get(e.chainNamespace);k.activeChain=e.chainNamespace,k.activeCaipNetwork=e,this.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),t?.accountState?.address?k.activeCaipAddress=`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:k.activeCaipAddress=void 0,this.setAccountProp("caipAddress",k.activeCaipAddress,e.chainNamespace),t&&u.U.replaceState(t.accountState),O.resetSend(),m.z.set({activeChain:k.activeChain,selectedNetworkId:k.activeCaipNetwork?.caipNetworkId}),h.i.setActiveCaipNetworkId(e.caipNetworkId),this.checkIfSupportedNetwork(e.chainNamespace)||!y.H.state.enableNetworkSwitch||y.H.state.allowUnsupportedChain||p.x.state.wcBasic||this.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;let t=k.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;let t=e!==D.state.activeChain,i=D.getNetworkData(e)?.caipNetwork,r=D.getCaipNetworkByNamespace(e,i?.id);t&&r&&await D.switchActiveNetwork(r)},async switchActiveNetwork(e){let t=D.state.chains.get(D.state.activeChain);t?.caipNetworks?.some(e=>e.id===k.activeCaipNetwork?.id)||b.I.goBack();let i=this.getNetworkControllerClient(e.chainNamespace);i&&(await i.switchCaipNetwork(e),f.E.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}}))},getNetworkControllerClient(e){let t=e||k.activeChain,i=k.chains.get(t);if(!i)throw Error("Chain adapter not found");if(!i.networkControllerClient)throw Error("NetworkController client not set");return i.networkControllerClient},getConnectionControllerClient(e){let t=e||k.activeChain;if(!t)throw Error("Chain is required to get connection controller client");let i=k.chains.get(t);if(!i?.connectionControllerClient)throw Error("ConnectionController client not set");return i.connectionControllerClient},getAccountProp(e,t){let i=k.activeChain;if(t&&(i=t),!i)return;let r=k.chains.get(i)?.accountState;if(r)return r[e]},getNetworkProp(e,t){let i=k.chains.get(t)?.networkState;if(i)return i[e]},getRequestedCaipNetworks(e){let t=k.chains.get(e),{approvedCaipNetworkIds:i=[],requestedCaipNetworks:r=[]}=t?.networkState||{};return d.w.sortRequestedNetworks(i,r)},getAllRequestedCaipNetworks(){let e=[];return k.chains.forEach(t=>{let i=this.getRequestedCaipNetworks(t.namespace);e.push(...i)}),e},setRequestedCaipNetworks(e,t){this.setAdapterNetworkState(t,{requestedCaipNetworks:e})},getAllApprovedCaipNetworkIds(){let e=[];return k.chains.forEach(t=>{let i=this.getApprovedCaipNetworkIds(t.namespace);e.push(...i)}),e},getActiveCaipNetwork:()=>k.activeCaipNetwork,getActiveCaipAddress:()=>k.activeCaipAddress,getApprovedCaipNetworkIds(e){let t=k.chains.get(e);return t?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){let t=this.getNetworkControllerClient(),i=await t?.getApprovedCaipNetworksData();this.setAdapterNetworkState(e,{approvedCaipNetworkIds:i?.approvedCaipNetworkIds,supportsAllNetworks:i?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){let i=t||k.activeCaipNetwork,r=this.getRequestedCaipNetworks(e);return!r.length||r?.some(e=>e.id===i?.id)},checkIfSupportedChainId(e){if(!k.activeChain)return!0;let t=this.getRequestedCaipNetworks(k.activeChain);return t?.some(t=>t.id===e)},setSmartAccountEnabledNetworks(e,t){this.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){let e=n.L.caipNetworkIdToNumber(k.activeCaipNetwork?.caipNetworkId),t=k.activeChain;if(!t||!e)return!1;let i=this.getNetworkProp("smartAccountEnabledNetworks",t);return!!i?.includes(Number(e))},getActiveNetworkTokenAddress(){let e=k.activeCaipNetwork?.chainNamespace||"eip155",t=k.activeCaipNetwork?.id||1,i=l.oU.NATIVE_TOKEN_ADDRESS[e];return`${e}:${t}:${i}`},showUnsupportedChainUI(){g.W.open({view:"UnsupportedChain"})},checkIfNamesSupported(){let e=k.activeCaipNetwork;return!!(e?.chainNamespace&&l.oU.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){this.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(e){if(!e)throw Error("Chain is required to set account prop");k.activeCaipAddress=void 0,this.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),o.a.removeConnectorId(e)},async disconnect(e){let t=function(e){let t=Array.from(D.state.chains.keys()),i=[];return e?(i.push([e,D.state.chains.get(e)]),c(e,a.o.CONNECTOR_ID.WALLET_CONNECT)?t.forEach(t=>{t!==e&&c(t,a.o.CONNECTOR_ID.WALLET_CONNECT)&&i.push([t,D.state.chains.get(t)])}):c(e,a.o.CONNECTOR_ID.AUTH)&&t.forEach(t=>{t!==e&&c(t,a.o.CONNECTOR_ID.AUTH)&&i.push([t,D.state.chains.get(t)])})):i=Array.from(D.state.chains.entries()),i}(e);try{O.resetSend();let i=await Promise.allSettled(t.map(async([e,t])=>{try{let{caipAddress:i}=this.getAccountData(e)||{};i&&t.connectionControllerClient?.disconnect&&await t.connectionControllerClient.disconnect(e),this.resetAccount(e),this.resetNetwork(e)}catch(t){throw Error(`Failed to disconnect chain ${e}: ${t.message}`)}}));p.x.resetWcConnection();let r=i.filter(e=>"rejected"===e.status);if(r.length>0)throw Error(r.map(e=>e.reason.message).join(", "));h.i.deleteConnectedSocialProvider(),e?o.a.removeConnectorId(e):o.a.resetConnectorIds(),f.E.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(e){console.error(e.message||"Failed to disconnect chains"),f.E.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:e.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(e){k.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){let e,t=[];if(k.chains.forEach(e=>{a.o.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>t===e.namespace)&&e.namespace&&t.push(e.namespace)}),t.length>0){let e=t[0];return e?k.chains.get(e)?.caipNetworks?.[0]:void 0}},getAccountData:e=>e?D.state.chains.get(e)?.accountState:u.U.state,getNetworkData(e){let t=e||k.activeChain;if(t)return D.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;let i=D.state.chains.get(e),r=i?.caipNetworks?.find(e=>e.id===t);return r||i?.networkState?.caipNetwork||i?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){let e=o.a.state.filterByNamespace;return(e?[k.chains.get(e)]:Array.from(k.chains.values())).flatMap(e=>e?.caipNetworks||[]).map(e=>e.caipNetworkId)}}},197:(e,t,i)=>{"use strict";i.d(t,{L:()=>r});let r={caipNetworkIdToNumber:e=>e?Number(e.split(":")[1]):void 0,parseEvmChainId(e){return"string"==typeof e?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace:(e,t)=>e?.filter(e=>e.chainNamespace===t)||[],getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]}}},1221:(e,t,i)=>{"use strict";i.d(t,{a:()=>y});var r=i(41179),s=i(74801),n=i(3046),a=i(66038),o=i(63);let c={handleSolanaDeeplinkRedirect(e){if(o.W.state.activeChain===n.o.CHAIN.SOLANA){let t=window.location.href,i=encodeURIComponent(t);if("Phantom"===e&&!("phantom"in window)){let e=t.startsWith("https")?"https":"http",r=t.split("/")[2],s=encodeURIComponent(`${e}://${r}`);window.location.href=`https://phantom.app/ul/browse/${i}?ref=${s}`}"Coinbase Wallet"!==e||"coinbaseSolana"in window||(window.location.href=`https://go.cb-w.com/dapp?cb_url=${i}`)}}};var l=i(5001),d=i(14572),h=i(75808),u=i(20641),p=i(24857);let f={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},g=(0,r.BX)({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...f}}),y={state:g,subscribe:e=>(0,r.B1)(g,()=>{e(g)}),subscribeKey:(e,t)=>(0,s.u$)(g,e,t),initialize(e){e.forEach(e=>{let t=l.i.getConnectedConnectorId(e);t&&this.setConnectorId(t,e)})},setActiveConnector(e){e&&(g.activeConnector=(0,r.KR)(e))},setConnectors(e){e.filter(e=>!g.allConnectors.some(t=>t.id===e.id&&this.getConnectorName(t.name)===this.getConnectorName(e.name)&&t.chain===e.chain)).forEach(e=>{"MULTI_CHAIN"!==e.type&&g.allConnectors.push((0,r.KR)(e))}),g.connectors=this.mergeMultiChainConnectors(g.allConnectors)},removeAdapter(e){g.allConnectors=g.allConnectors.filter(t=>t.chain!==e),g.connectors=this.mergeMultiChainConnectors(g.allConnectors)},mergeMultiChainConnectors(e){let t=this.generateConnectorMapByName(e),i=[];return t.forEach(e=>{let t=e[0],r=t?.id===n.o.CONNECTOR_ID.AUTH;e.length>1&&t?i.push({name:t.name,imageUrl:t.imageUrl,imageId:t.imageId,connectors:[...e],type:r?"AUTH":"MULTI_CHAIN",chain:"eip155",id:t?.id||""}):t&&i.push(t)}),i},generateConnectorMapByName(e){let t=new Map;return e.forEach(e=>{let{name:i}=e,r=this.getConnectorName(i);if(!r)return;let s=t.get(r)||[];s.find(t=>t.chain===e.chain)||s.push(e),t.set(r,s)}),t},getConnectorName:e=>e&&({"Trust Wallet":"Trust"})[e]||e,getUniqueConnectorsByName(e){let t=[];return e.forEach(e=>{t.find(t=>t.chain===e.chain)||t.push(e)}),t},addConnector(e){if(e.id===n.o.CONNECTOR_ID.AUTH){let t=(0,r.P9)(h.H.state),i=p.W.getSnapshot().themeMode,s=p.W.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType}),e?.provider?.syncTheme({themeMode:i,themeVariables:s,w3mThemeVariables:(0,a.o)(s,i)}),this.setConnectors([e])}else this.setConnectors([e])},getAuthConnector(e){let t=e||o.W.state.activeChain,i=g.connectors.find(e=>e.id===n.o.CONNECTOR_ID.AUTH);if(i)return i?.connectors?.length?i.connectors.find(e=>e.chain===t):i},getAnnouncedConnectorRdns:()=>g.connectors.filter(e=>"ANNOUNCED"===e.type).map(e=>e.info?.rdns),getConnectorById:e=>g.allConnectors.find(t=>t.id===e),getConnector:(e,t)=>g.allConnectors.filter(e=>e.chain===o.W.state.activeChain).find(i=>i.explorerId===e||i.info?.rdns===t),syncIfAuthConnector(e){if("ID_AUTH"!==e.id)return;let t=(0,r.P9)(h.H.state),i=p.W.getSnapshot().themeMode,s=p.W.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:i,themeVariables:s,w3mThemeVariables:(0,a.o)(s,i)})},getConnectorsByNamespace(e){let t=g.allConnectors.filter(t=>t.chain===e);return this.mergeMultiChainConnectors(t)},selectWalletConnector(e){let t=y.getConnector(e.id,e.rdns);o.W.state.activeChain===n.o.CHAIN.SOLANA&&c.handleSolanaDeeplinkRedirect(t?.name||e.name||""),t?u.I.push("ConnectingExternal",{connector:t}):u.I.push("ConnectingWalletConnect",{wallet:e})},getConnectors(e){return e?this.getConnectorsByNamespace(e):this.mergeMultiChainConnectors(g.allConnectors)},setFilterByNamespace(e){g.filterByNamespace=e,g.connectors=this.getConnectors(e),d.N.setFilterByNamespace(e)},setConnectorId(e,t){e&&(g.activeConnectorIds={...g.activeConnectorIds,[t]:e},l.i.setConnectedConnectorId(t,e))},removeConnectorId(e){g.activeConnectorIds={...g.activeConnectorIds,[e]:void 0},l.i.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return g.activeConnectorIds[e]},isConnected:e=>e?!!g.activeConnectorIds[e]:Object.values(g.activeConnectorIds).some(e=>!!e),resetConnectorIds(){g.activeConnectorIds={...f}}}},1711:(e,t,i)=>{"use strict";i.d(t,{U:()=>d});var r=i(41179),s=i(51605),n=i(91019),a=i(42270),o=i(63),c=i(97490);let l=(0,r.BX)({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),d={state:l,replaceState(e){e&&Object.assign(l,(0,r.KR)(e))},subscribe:e=>o.W.subscribeChainProp("accountState",t=>{if(t)return e(t)}),subscribeKey(e,t,i){let r;return o.W.subscribeChainProp("accountState",i=>{if(i){let s=i[e];r!==s&&(r=s,t(s))}},i)},setStatus(e,t){o.W.setAccountProp("status",e,t)},getCaipAddress:e=>o.W.getAccountProp("caipAddress",e),setCaipAddress(e,t){let i=e?n.w.getPlainAddress(e):void 0;t===o.W.state.activeChain&&(o.W.state.activeCaipAddress=e),o.W.setAccountProp("caipAddress",e,t),o.W.setAccountProp("address",i,t)},setBalance(e,t,i){o.W.setAccountProp("balance",e,i),o.W.setAccountProp("balanceSymbol",t,i)},setProfileName(e,t){o.W.setAccountProp("profileName",e,t)},setProfileImage(e,t){o.W.setAccountProp("profileImage",e,t)},setUser(e,t){o.W.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){o.W.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){o.W.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){o.W.setAccountProp("currentTab",e,o.W.state.activeChain)},setTokenBalance(e,t){e&&o.W.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){o.W.setAccountProp("shouldUpdateToAddress",e,t)},setAllAccounts(e,t){o.W.setAccountProp("allAccounts",e,t)},addAddressLabel(e,t,i){let r=o.W.getAccountProp("addressLabels",i)||new Map;r.set(e,t),o.W.setAccountProp("addressLabels",r,i)},removeAddressLabel(e,t){let i=o.W.getAccountProp("addressLabels",t)||new Map;i.delete(e),o.W.setAccountProp("addressLabels",i,t)},setConnectedWalletInfo(e,t){o.W.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){o.W.setAccountProp("preferredAccountType",e,t)},setSocialProvider(e,t){e&&o.W.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){o.W.setAccountProp("socialWindow",e?(0,r.KR)(e):void 0,t)},setFarcasterUrl(e,t){o.W.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){l.balanceLoading=!0;let t=o.W.state.activeCaipNetwork?.caipNetworkId,i=o.W.state.activeCaipNetwork?.chainNamespace,r=o.W.state.activeCaipAddress,d=r?n.w.getPlainAddress(r):void 0;if(l.lastRetry&&!n.w.isAllowedRetry(l.lastRetry,30*s.oU.ONE_SEC_MS))return l.balanceLoading=!1,[];try{if(d&&t&&i){let e=(await a.T.getBalance(d,t)).balances.filter(e=>"0"!==e.quantity.decimals);return this.setTokenBalance(e,i),l.lastRetry=void 0,l.balanceLoading=!1,e}}catch(t){l.lastRetry=Date.now(),e?.(t),c.P.showError("Token Balance Unavailable")}finally{l.balanceLoading=!1}return[]},resetAccount(e){o.W.resetAccount(e)}}},2010:(e,t,i)=>{"use strict";i.d(t,{A:()=>d});var r=i(75808),s=i(1221),n=i(5001),a=i(91019),o=i(14572),c=i(64606),l=i(77575);let d={filterOutDuplicatesByRDNS(e){let t=r.H.state.enableEIP6963?s.a.state.connectors:[],i=n.i.getRecentWallets(),o=t.map(e=>e.info?.rdns).filter(Boolean),c=i.map(e=>e.rdns).filter(Boolean),l=o.concat(c);if(l.includes("io.metamask.mobile")&&a.w.isMobile()){let e=l.indexOf("io.metamask.mobile");l[e]="io.metamask"}return e.filter(e=>!l.includes(String(e?.rdns)))},filterOutDuplicatesByIds(e){let t=s.a.state.connectors.filter(e=>"ANNOUNCED"===e.type||"INJECTED"===e.type),i=n.i.getRecentWallets(),r=t.map(e=>e.explorerId),a=i.map(e=>e.id),o=r.concat(a);return e.filter(e=>!o.includes(e?.id))},filterOutDuplicateWallets(e){let t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){let{connectors:t}=s.a.state,i=t.filter(e=>"ANNOUNCED"===e.type).reduce((e,t)=>(t.info?.rdns&&(e[t.info.rdns]=!0),e),{});return e.map(e=>({...e,installed:!!e.rdns&&!!i[e.rdns??""]})).sort((e,t)=>Number(t.installed)-Number(e.installed))},getConnectOrderMethod(e,t){let i=e?.connectMethodsOrder||r.H.state.features?.connectMethodsOrder,n=t||s.a.state.connectors;if(i)return i;let{injected:a,announced:d}=c.g.getConnectorsByType(n,o.N.state.recommended,o.N.state.featured),h=a.filter(c.g.showConnector),u=d.filter(c.g.showConnector);return h.length||u.length?["wallet","email","social"]:l.o.DEFAULT_CONNECT_METHOD_ORDER}}},2289:(e,t,i)=>{"use strict";var r=i(18835),s=i(66560),n=i(38311);t.assert=s,t.toArray=n.toArray,t.zero2=n.zero2,t.toHex=n.toHex,t.encode=n.encode,t.getNAF=function(e,t,i){var r=Array(Math.max(e.bitLength(),i)+1);for(a=0;a<r.length;a+=1)r[a]=0;var s=1<<t+1,n=e.clone();for(a=0;a<r.length;a++){var a,o,c=n.andln(s-1);n.isOdd()?(o=c>(s>>1)-1?(s>>1)-c:c,n.isubn(o)):o=0,r[a]=o,n.iushrn(1)}return r},t.getJSF=function(e,t){var i=[[],[]];e=e.clone(),t=t.clone();for(var r=0,s=0;e.cmpn(-r)>0||t.cmpn(-s)>0;){var n,a,o,c=e.andln(3)+r&3,l=t.andln(3)+s&3;3===c&&(c=-1),3===l&&(l=-1),a=(1&c)==0?0:(3==(n=e.andln(7)+r&7)||5===n)&&2===l?-c:c,i[0].push(a),o=(1&l)==0?0:(3==(n=t.andln(7)+s&7)||5===n)&&2===c?-l:l,i[1].push(o),2*r===a+1&&(r=1-r),2*s===o+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return i},t.cachedProperty=function(e,t,i){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=i.call(this)}},t.parseBytes=function(e){return"string"==typeof e?t.toArray(e,"hex"):e},t.intFromLE=function(e){return new r(e,"hex","le")}},3046:(e,t,i)=>{"use strict";i.d(t,{o:()=>r});let r={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network"}},4645:(e,t,i)=>{"use strict";var r=i(56825),s=i(66560);function n(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=n,n.prototype.update=function(e,t){if(e=r.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var i=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-i,e.length),0===this.pending.length&&(this.pending=null),e=r.join32(e,0,e.length-i,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this},n.prototype.digest=function(e){return this.update(this._pad()),s(null===this.pending),this._digest(e)},n.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,r=Array(i+this.padLength);r[0]=128;for(var s=1;s<i;s++)r[s]=0;if(e<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)r[s++]=0;r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=e>>>24&255,r[s++]=e>>>16&255,r[s++]=e>>>8&255,r[s++]=255&e}else for(n=8,r[s++]=255&e,r[s++]=e>>>8&255,r[s++]=e>>>16&255,r[s++]=e>>>24&255,r[s++]=0,r[s++]=0,r[s++]=0,r[s++]=0;n<this.padLength;n++)r[s++]=0;return r}},5001:(e,t,i)=>{"use strict";i.d(t,{i:()=>s});var r=i(13592);let s={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired:(e,t)=>Date.now()-e>t,getActiveNetworkProps(){let e=s.getActiveNamespace(),t=s.getActiveCaipNetworkId(),i=t?t.split(":")[1]:void 0;return{namespace:e,caipNetworkId:t,chainId:i?isNaN(Number(i))?i:Number(i):void 0}},setWalletConnectDeepLink({name:e,href:t}){try{r.Ud.setItem(r.Ws.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{let e=r.Ud.getItem(r.Ws.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{r.Ud.removeItem(r.Ws.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{r.Ud.setItem(r.Ws.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{r.Ud.setItem(r.Ws.ACTIVE_CAIP_NETWORK_ID,e),s.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return r.Ud.getItem(r.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{r.Ud.removeItem(r.Ws.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{let t=(0,r.T8)(e);r.Ud.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{let t=s.getRecentWallets();t.find(t=>t.id===e.id)||(t.unshift(e),t.length>2&&t.pop(),r.Ud.setItem(r.Ws.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{let e=r.Ud.getItem(r.Ws.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{let i=(0,r.T8)(e);r.Ud.setItem(i,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return r.Ud.getItem(r.Ws.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{let t=(0,r.T8)(e);return r.Ud.getItem(t)}catch(t){console.info("Unable to get connected connector id in namespace ",e)}},setConnectedSocialProvider(e){try{r.Ud.setItem(r.Ws.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return r.Ud.getItem(r.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{r.Ud.removeItem(r.Ws.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return r.Ud.getItem(r.Ws.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){let e=r.Ud.getItem(r.Ws.ACTIVE_CAIP_NETWORK_ID);return e?.split(":")?.[1]},setConnectionStatus(e){try{r.Ud.setItem(r.Ws.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return r.Ud.getItem(r.Ws.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{let e=r.Ud.getItem(r.Ws.CONNECTED_NAMESPACES);if(!e?.length)return[];return e.split(",")}catch{return[]}},setConnectedNamespaces(e){try{let t=Array.from(new Set(e));r.Ud.setItem(r.Ws.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{let t=s.getConnectedNamespaces();t.includes(e)||(t.push(e),s.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{let t=s.getConnectedNamespaces(),i=t.indexOf(e);i>-1&&(t.splice(i,1),s.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return r.Ud.getItem(r.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{r.Ud.setItem(r.Ws.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{r.Ud.removeItem(r.Ws.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{let t=r.Ud.getItem(r.Ws.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{let t=s.getBalanceCache();r.Ud.setItem(r.Ws.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{let t=s.getBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{let t=s.getBalanceCache();t[e.caipAddress]=e,r.Ud.setItem(r.Ws.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{let t=r.Ud.getItem(r.Ws.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{let t=s.getBalanceCache();r.Ud.setItem(r.Ws.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{let t=s.getNativeBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",e),s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{let t=s.getNativeBalanceCache();t[e.caipAddress]=e,r.Ud.setItem(r.Ws.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{let t=r.Ud.getItem(r.Ws.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{let t=s.getEnsCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;s.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{let t=s.getEnsCache();t[e.address]=e,r.Ud.setItem(r.Ws.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{let t=s.getEnsCache();r.Ud.setItem(r.Ws.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{let t=r.Ud.getItem(r.Ws.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{let t=s.getIdentityCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;s.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{let t=s.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},r.Ud.setItem(r.Ws.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{let t=s.getIdentityCache();r.Ud.setItem(r.Ws.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{r.Ud.removeItem(r.Ws.PORTFOLIO_CACHE),r.Ud.removeItem(r.Ws.NATIVE_BALANCE_CACHE),r.Ud.removeItem(r.Ws.ENS_CACHE),r.Ud.removeItem(r.Ws.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}}}},6267:(e,t,i)=>{"use strict";function r(e){return function(t){return"function"==typeof t?(customElements.get(e)||customElements.define(e,t),t):function(e,t){let{kind:i,elements:r}=t;return{kind:i,elements:r,finisher(t){customElements.get(e)||customElements.define(e,t)}}}(e,t)}}i.d(t,{E:()=>r})},8145:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});let r={getSpacingStyles:(e,t)=>Array.isArray(e)?e[t]?`var(--wui-spacing-${e[t]})`:void 0:"string"==typeof e?`var(--wui-spacing-${e})`:void 0,getFormattedDate:e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e),getHostName(e){try{return new URL(e).hostname}catch(e){return""}},getTruncateString:({string:e,charsStart:t,charsEnd:i,truncate:r})=>e.length<=t+i?e:"end"===r?`${e.substring(0,t)}...`:"start"===r?`...${e.substring(e.length-i)}`:`${e.substring(0,Math.floor(t))}...${e.substring(e.length-Math.floor(i))}`,generateAvatarColors(e){let t=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),i=this.hexToRgb(t),r=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),s=100-3*Number(r?.replace("px","")),n=`${s}% ${s}% at 65% 40%`,a=[];for(let e=0;e<5;e+=1){let t=this.tintColor(i,.15*e);a.push(`rgb(${t[0]}, ${t[1]}, ${t[2]})`)}return`
    --local-color-1: ${a[0]};
    --local-color-2: ${a[1]};
    --local-color-3: ${a[2]};
    --local-color-4: ${a[3]};
    --local-color-5: ${a[4]};
    --local-radial-circle: ${n}
   `},hexToRgb(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},tintColor(e,t){let[i,r,s]=e;return[Math.round(i+(255-i)*t),Math.round(r+(255-r)*t),Math.round(s+(255-s)*t)]},isNumber:e=>/^[0-9]+$/u.test(e),getColorTheme:e=>e?e:"undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark",splitBalance(e){let t=e.split(".");return 2===t.length?[t[0],t[1]]:["0","00"]},roundNumber:(e,t,i)=>e.toString().length>=t?Number(e).toFixed(i):e,formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})}},9360:(e,t,i)=>{"use strict";var r,s=i(55775),n=i(15768),a=i(2289).assert;function o(e){"short"===e.type?this.curve=new n.short(e):"edwards"===e.type?this.curve=new n.edwards(e):this.curve=new n.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,i){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){var r=new o(i);return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:r}),r}})}t.PresetCurve=o,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=i(79033)}catch(e){r=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})},9686:(e,t,i)=>{"use strict";i.d(t,{z:()=>n});var r=i(41179);let s=(0,r.BX)({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),n={state:s,subscribe:e=>(0,r.B1)(s,()=>e(s)),set(e){Object.assign(s,{...s,...e})}}},10974:(e,t,i)=>{"use strict";var r=i(56825).rotr32;function s(e,t,i){return e&t^e&i^t&i}t.ft_1=function(e,t,i,r){var n;return 0===e?(n=t)&i^~n&r:1===e||3===e?t^i^r:2===e?s(t,i,r):void 0},t.ch32=function(e,t,i){return e&t^~e&i},t.maj32=s,t.p32=function(e,t,i){return e^t^i},t.s0_256=function(e){return r(e,2)^r(e,13)^r(e,22)},t.s1_256=function(e){return r(e,6)^r(e,11)^r(e,25)},t.g0_256=function(e){return r(e,7)^r(e,18)^e>>>3},t.g1_256=function(e){return r(e,17)^r(e,19)^e>>>10}},12059:(e,t,i)=>{"use strict";var r=i(18835),s=i(34889),n=i(2289),a=i(9360),o=i(35364),c=n.assert,l=i(60564),d=i(88253);function h(e){if(!(this instanceof h))return new h(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(a,e),"Unknown curve "+e),e=a[e]),e instanceof a.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=h,h.prototype.keyPair=function(e){return new l(this,e)},h.prototype.keyFromPrivate=function(e,t){return l.fromPrivate(this,e,t)},h.prototype.keyFromPublic=function(e,t){return l.fromPublic(this,e,t)},h.prototype.genKeyPair=function(e){e||(e={});for(var t=new s({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||o(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new r(2));;){var a=new r(t.generate(i));if(!(a.cmp(n)>0))return a.iaddn(1),this.keyFromPrivate(a)}},h.prototype._truncateToN=function(e,t,i){if(r.isBN(e)||"number"==typeof e)s=(e=new r(e,16)).byteLength();else if("object"==typeof e)s=e.length,e=new r(e,16);else{var s,n=e.toString();s=n.length+1>>>1,e=new r(n,16)}"number"!=typeof i&&(i=8*s);var a=i-this.n.bitLength();return(a>0&&(e=e.ushrn(a)),!t&&e.cmp(this.n)>=0)?e.sub(this.n):e},h.prototype.sign=function(e,t,i,n){if("object"==typeof i&&(n=i,i=null),n||(n={}),"string"!=typeof e&&"number"!=typeof e&&!r.isBN(e)){c("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),c(e.length>>>0===e.length);for(var a=0;a<e.length;a++)c((255&e[a])===e[a])}t=this.keyFromPrivate(t,i),c(!(e=this._truncateToN(e,!1,n.msgBitLength)).isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),l=t.getPrivate().toArray("be",o),h=e.toArray("be",o);c(new r(h).eq(e),"Can not sign message");for(var u=new s({hash:this.hash,entropy:l,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),p=this.n.sub(new r(1)),f=0;;f++){var g=n.k?n.k(f):new r(u.generate(this.n.byteLength()));if(0>=(g=this._truncateToN(g,!0)).cmpn(1)||g.cmp(p)>=0)continue;var y=this.g.mul(g);if(!y.isInfinity()){var m=y.getX(),b=m.umod(this.n);if(0!==b.cmpn(0)){var w=g.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(w=w.umod(this.n)).cmpn(0)){var v=!!y.getY().isOdd()|2*(0!==m.cmp(b));return n.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),v^=1),new d({r:b,s:w,recoveryParam:v})}}}}},h.prototype.verify=function(e,t,i,r,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,r);var n,a=(t=new d(t,"hex")).r,o=t.s;if(0>a.cmpn(1)||a.cmp(this.n)>=0||0>o.cmpn(1)||o.cmp(this.n)>=0)return!1;var c=o.invm(this.n),l=c.mul(e).umod(this.n),h=c.mul(a).umod(this.n);return this.curve._maxwellTrick?!(n=this.g.jmulAdd(l,i.getPublic(),h)).isInfinity()&&n.eqXToP(a):!(n=this.g.mulAdd(l,i.getPublic(),h)).isInfinity()&&0===n.getX().umod(this.n).cmp(a)},h.prototype.recoverPubKey=function(e,t,i,s){c((3&i)===i,"The recovery param is more than two bits"),t=new d(t,s);var n=this.n,a=new r(e),o=t.r,l=t.s,h=1&i,u=i>>1;if(o.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw Error("Unable to find sencond key candinate");o=u?this.curve.pointFromX(o.add(this.curve.n),h):this.curve.pointFromX(o,h);var p=t.r.invm(n),f=n.sub(a).mul(p).umod(n),g=l.mul(p).umod(n);return this.g.mulAdd(f,o,g)},h.prototype.getKeyRecoveryParam=function(e,t,i,r){if(null!==(t=new d(t,r)).recoveryParam)return t.recoveryParam;for(var s,n=0;n<4;n++){try{s=this.recoverPubKey(e,t,n)}catch(e){continue}if(s.eq(i))return n}throw Error("Unable to find valid recovery factor")}},13015:(e,t,i)=>{"use strict";i.d(t,{U:()=>g}),i(35597);var r=i(3046),s=i(58267),n=i(1711),a=i(63),o=i(95954),c=i(1221),l=i(14109),d=i(50209),h=i(75808),u=i(20641),p=i(97490),f=i(91019);let g={getSIWX:()=>h.H.state.siwx,async initializeIfEnabled(){let e=h.H.state.siwx,t=a.W.getActiveCaipAddress();if(!(e&&t))return;let[i,r,s]=t.split(":");if(a.W.checkIfSupportedNetwork(i))try{if((await e.getSessions(`${i}:${r}`,s)).length)return;await d.W.open({view:"SIWXSignMessage"})}catch(e){console.error("SIWXUtil:initializeIfEnabled",e),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await o.x._getClient()?.disconnect().catch(console.error),u.I.reset("Connect"),p.P.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let e=h.H.state.siwx,t=f.w.getPlainAddress(a.W.getActiveCaipAddress()),i=a.W.getActiveCaipNetwork(),s=o.x._getClient();if(!e)throw Error("SIWX is not enabled");if(!t)throw Error("No ActiveCaipAddress found");if(!i)throw Error("No ActiveCaipNetwork or client found");if(!s)throw Error("No ConnectionController client found");try{let n=await e.createMessage({chainId:i.caipNetworkId,accountAddress:t}),a=n.toString();c.a.getConnectorId(i.chainNamespace)===r.o.CONNECTOR_ID.AUTH&&u.I.pushTransactionStack({view:null,goBack:!1,replace:!0});let o=await s.signMessage(a);await e.addSession({data:n,message:a,signature:o}),d.W.close(),l.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(t){let e=this.getSIWXEventProperties();d.W.state.open&&"ApproveTransaction"!==u.I.state.view||await d.W.open({view:"SIWXSignMessage"}),e.isSmartAccount?p.P.showError("This application might not support Smart Accounts"):p.P.showError("Signature declined"),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:e}),console.error("SWIXUtil:requestSignMessage",t)}},async cancelSignMessage(){try{let e=this.getSIWX();e?.getRequired?.()?await o.x.disconnect():d.W.close(),u.I.reset("Connect"),l.E.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){let e=h.H.state.siwx,t=f.w.getPlainAddress(a.W.getActiveCaipAddress()),i=a.W.getActiveCaipNetwork();return e&&t&&i?e.getSessions(i.caipNetworkId,t):[]},async isSIWXCloseDisabled(){let e=this.getSIWX();if(e){let t="ApproveTransaction"===u.I.state.view,i="SIWXSignMessage"===u.I.state.view;if(t||i)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:i}){let r=g.getSIWX(),s=new Set(t.map(e=>e.split(":")[0]));if(!r||1!==s.size||!s.has("eip155"))return!1;let o=await r.createMessage({chainId:a.W.getActiveCaipNetwork()?.caipNetworkId||"",accountAddress:""}),c=await e.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:i,chains:[o.chainId,...t.filter(e=>e!==o.chainId)]});if(p.P.showLoading("Authenticating...",{autoClose:!1}),n.U.setConnectedWalletInfo({...c.session.peer.metadata,name:c.session.peer.metadata.name,icon:c.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),c?.auths?.length){let t=c.auths.map(t=>{let i=e.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||o.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:i,signature:t.s.s,cacao:t}});try{await r.setSessions(t),l.E.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:g.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),l.E.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:g.getSIWXEventProperties()}),await e.disconnect().catch(console.error),t}finally{p.P.hide()}}return!0},getSIWXEventProperties:()=>({network:a.W.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:n.U.state.preferredAccountType===s.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}),async clearSessions(){let e=this.getSIWX();e&&await e.setSessions([])}}},13592:(e,t,i)=>{"use strict";i.d(t,{IP:()=>a,T8:()=>s,Ud:()=>n,Ws:()=>r});let r={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache"};function s(e){if(!e)throw Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}let n={setItem(e,t){a()&&void 0!==t&&localStorage.setItem(e,t)},getItem(e){if(a())return localStorage.getItem(e)||void 0},removeItem(e){a()&&localStorage.removeItem(e)},clear(){a()&&localStorage.clear()}};function a(){return"undefined"!=typeof window&&"undefined"!=typeof localStorage}},14109:(e,t,i)=>{"use strict";i.d(t,{E:()=>g});var r=i(41179),s=i(3046),n=i(13592),a=i(91019),o=i(41572),c=i(1711),l=i(69386),d=i(75808);let h=a.w.getAnalyticsUrl(),u=new o.Z({baseUrl:h,clientId:null}),p=["MODAL_CREATED"],f=(0,r.BX)({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),g={state:f,subscribe:e=>(0,r.B1)(f,()=>e(f)),getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:i}=d.H.state;return{projectId:e,st:t,sv:i||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{let t=c.U.state.address;if(p.includes(e.data.event)||"undefined"==typeof window)return;await u.post({path:"/e",params:g.getSdkProperties(),body:{eventId:a.w.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),f.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===s.o.HTTP_STATUS_CODES.FORBIDDEN&&!f.reportedErrors.FORBIDDEN&&(l.h.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${(0,n.IP)()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),f.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){f.timestamp=Date.now(),f.data=e,d.H.state.features?.analytics&&g._sendAnalyticsEvent(f)}}},14572:(e,t,i)=>{"use strict";i.d(t,{N:()=>m});var r=i(41179),s=i(74801),n=i(18756),a=i(91019),o=i(41572),c=i(5001),l=i(41036),d=i(63),h=i(1221),u=i(14109),p=i(75808);let f=a.w.getApiUrl(),g=new o.Z({baseUrl:f,clientId:null}),y=(0,r.BX)({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),m={state:y,subscribeKey:(e,t)=>(0,s.u$)(y,e,t),_getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:i}=p.H.state;return{projectId:e,st:t||"appkit",sv:i||"html-wagmi-4.2.2"}},_filterOutExtensions:e=>p.H.state.isUniversalProvider?e.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):e,async _fetchWalletImage(e){let t=`${g.baseUrl}/getWalletImage/${e}`,i=await g.getBlob({path:t,params:m._getSdkProperties()});l.j.setWalletImage(e,URL.createObjectURL(i))},async _fetchNetworkImage(e){let t=`${g.baseUrl}/public/getAssetImage/${e}`,i=await g.getBlob({path:t,params:m._getSdkProperties()});l.j.setNetworkImage(e,URL.createObjectURL(i))},async _fetchConnectorImage(e){let t=`${g.baseUrl}/public/getAssetImage/${e}`,i=await g.getBlob({path:t,params:m._getSdkProperties()});l.j.setConnectorImage(e,URL.createObjectURL(i))},async _fetchCurrencyImage(e){let t=`${g.baseUrl}/public/getCurrencyImage/${e}`,i=await g.getBlob({path:t,params:m._getSdkProperties()});l.j.setCurrencyImage(e,URL.createObjectURL(i))},async _fetchTokenImage(e){let t=`${g.baseUrl}/public/getTokenImage/${e}`,i=await g.getBlob({path:t,params:m._getSdkProperties()});l.j.setTokenImage(e,URL.createObjectURL(i))},async fetchNetworkImages(){let e=d.W.getAllRequestedCaipNetworks(),t=e?.map(({assets:e})=>e?.imageId).filter(Boolean).filter(e=>!n.$.getNetworkImageById(e));t&&await Promise.allSettled(t.map(e=>m._fetchNetworkImage(e)))},async fetchConnectorImages(){let{connectors:e}=h.a.state,t=e.map(({imageId:e})=>e).filter(Boolean);await Promise.allSettled(t.map(e=>m._fetchConnectorImage(e)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(e=>m._fetchCurrencyImage(e)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(e=>m._fetchTokenImage(e)))},async fetchFeaturedWallets(){let{featuredWalletIds:e}=p.H.state;if(e?.length){let{data:t}=await g.get({path:"/getWallets",params:{...m._getSdkProperties(),page:"1",entries:e?.length?String(e.length):"4",include:e?.join(",")}});t.sort((t,i)=>e.indexOf(t.id)-e.indexOf(i.id));let i=t.map(e=>e.image_id).filter(Boolean);await Promise.allSettled(i.map(e=>m._fetchWalletImage(e))),y.featured=t,y.allFeatured=t}},async fetchRecommendedWallets(){try{y.isFetchingRecommendedWallets=!0;let{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:i}=p.H.state,r=[...t??[],...i??[]].filter(Boolean),s=d.W.getRequestedCaipNetworkIds().join(","),{data:n,count:a}=await g.get({path:"/getWallets",params:{...m._getSdkProperties(),page:"1",chains:s,entries:"4",include:e?.join(","),exclude:r?.join(",")}}),o=c.i.getRecentWallets(),l=n.map(e=>e.image_id).filter(Boolean),h=o.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...l,...h].map(e=>m._fetchWalletImage(e))),y.recommended=n,y.allRecommended=n,y.count=a??0}catch{}finally{y.isFetchingRecommendedWallets=!1}},async fetchWallets({page:e}){let{includeWalletIds:t,excludeWalletIds:i,featuredWalletIds:r}=p.H.state,s=d.W.getRequestedCaipNetworkIds().join(","),n=[...y.recommended.map(({id:e})=>e),...i??[],...r??[]].filter(Boolean),{data:o,count:c}=await g.get({path:"/getWallets",params:{...m._getSdkProperties(),page:String(e),entries:"40",chains:s,include:t?.join(","),exclude:n.join(",")}}),l=o.slice(0,20).map(e=>e.image_id).filter(Boolean);await Promise.allSettled(l.map(e=>m._fetchWalletImage(e))),y.wallets=a.w.uniqueBy([...y.wallets,...m._filterOutExtensions(o)],"id"),y.count=c>y.count?c:y.count,y.page=e},async initializeExcludedWallets({ids:e}){let t=d.W.getRequestedCaipNetworkIds().join(","),{data:i}=await g.get({path:"/getWallets",params:{...m._getSdkProperties(),page:"1",entries:String(e.length),chains:t,include:e?.join(",")}});i&&i.forEach(e=>{e?.rdns&&y.excludedWallets.push({rdns:e.rdns,name:e.name})})},async searchWallet({search:e,badge:t}){let{includeWalletIds:i,excludeWalletIds:r}=p.H.state;y.search=[];let s=d.W.getRequestedCaipNetworkIds().join(","),{data:n}=await g.get({path:"/getWallets",params:{...m._getSdkProperties(),page:"1",entries:"100",search:e?.trim(),badge_type:t,chains:s,include:i?.join(","),exclude:r?.join(",")}});u.E.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});let o=n.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...o.map(e=>m._fetchWalletImage(e)),a.w.wait(300)]),y.search=m._filterOutExtensions(n)},initPromise(e,t){let i=y.promises[e];return i||(y.promises[e]=t())},prefetch:({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:i=!0,fetchNetworkImages:r=!0}={})=>Promise.allSettled([e&&m.initPromise("connectorImages",m.fetchConnectorImages),t&&m.initPromise("featuredWallets",m.fetchFeaturedWallets),i&&m.initPromise("recommendedWallets",m.fetchRecommendedWallets),r&&m.initPromise("networkImages",m.fetchNetworkImages)].filter(Boolean)),prefetchAnalyticsConfig(){p.H.state.features?.analytics&&m.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{let{isAnalyticsEnabled:e}=await g.get({path:"/getAnalyticsConfig",params:m._getSdkProperties()});p.H.setFeatures({analytics:e})}catch(e){p.H.setFeatures({analytics:!1})}},setFilterByNamespace(e){if(!e){y.featured=y.allFeatured,y.recommended=y.allRecommended;return}let t=d.W.getRequestedCaipNetworkIds().join(",");y.featured=y.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),y.recommended=y.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e)))}}},15768:(e,t,i)=>{"use strict";t.base=i(33589),t.short=i(93730),t.mont=i(76626),t.edwards=i(44488)},17232:(e,t,i)=>{"use strict";let r,s,n;i.d(t,{JX:()=>l,RF:()=>c,W5:()=>u,ck:()=>f,ds:()=>d,fD:()=>p});var a=i(30926),o=i(66038);function c(e,t){r=document.createElement("style"),s=document.createElement("style"),n=document.createElement("style"),r.textContent=h(e).core.cssText,s.textContent=h(e).dark.cssText,n.textContent=h(e).light.cssText,document.head.appendChild(r),document.head.appendChild(s),document.head.appendChild(n),l(t)}function l(e){s&&n&&("light"===e?(s.removeAttribute("media"),n.media="enabled"):(n.removeAttribute("media"),s.media="enabled"))}function d(e){r&&s&&n&&(r.textContent=h(e).core.cssText,s.textContent=h(e).dark.cssText,n.textContent=h(e).light.cssText)}function h(e){return{core:(0,a.AH)`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${(0,a.iz)(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${(0,a.iz)(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${(0,a.iz)(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${(0,a.iz)(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${(0,a.iz)(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:(0,a.AH)`
      :root {
        --w3m-color-mix: ${(0,a.iz)(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${(0,a.iz)((0,o.o)(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${(0,a.iz)((0,o.o)(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:(0,a.AH)`
      :root {
        --w3m-color-mix: ${(0,a.iz)(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${(0,a.iz)((0,o.o)(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${(0,a.iz)((0,o.o)(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}let u=(0,a.AH)`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,p=(0,a.AH)`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,f=(0,a.AH)`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`},17748:(e,t,i)=>{"use strict";var r=i(55775),s=i(9360),n=i(2289),a=n.assert,o=n.parseBytes,c=i(88055),l=i(29018);function d(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof d))return new d(e);e=s[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=r.sha512}e.exports=d,d.prototype.sign=function(e,t){e=o(e);var i=this.keyFromSecret(t),r=this.hashInt(i.messagePrefix(),e),s=this.g.mul(r),n=this.encodePoint(s),a=this.hashInt(n,i.pubBytes(),e).mul(i.priv()),c=r.add(a).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:n})},d.prototype.verify=function(e,t,i){if(e=o(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var r=this.keyFromPublic(i),s=this.hashInt(t.Rencoded(),r.pubBytes(),e),n=this.g.mul(t.S());return t.R().add(r.pub().mul(s)).eq(n)},d.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return n.intFromLE(e.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},d.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},d.prototype.makeSignature=function(e){return e instanceof l?e:new l(this,e)},d.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=128*!!e.getX().isOdd(),t},d.prototype.decodePoint=function(e){var t=(e=n.parseBytes(e)).length-1,i=e.slice(0,t).concat(-129&e[t]),r=(128&e[t])!=0,s=n.intFromLE(i);return this.curve.pointFromY(s,r)},d.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(e){return n.intFromLE(e)},d.prototype.isPoint=function(e){return e instanceof this.pointClass}},18756:(e,t,i)=>{"use strict";i.d(t,{$:()=>c});var r=i(41179),s=i(14572),n=i(41036);let a={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00"},o=(0,r.BX)({networkImagePromises:{}}),c={async fetchWalletImage(e){if(e)return await s.N._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;let t=this.getNetworkImageById(e);return t||(o.networkImagePromises[e]||(o.networkImagePromises[e]=s.N._fetchNetworkImage(e)),await o.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return n.j.state.walletImages[e]},getWalletImage:e=>e?.image_url?e?.image_url:e?.image_id?n.j.state.walletImages[e.image_id]:void 0,getNetworkImage:e=>e?.assets?.imageUrl?e?.assets?.imageUrl:e?.assets?.imageId?n.j.state.networkImages[e.assets.imageId]:void 0,getNetworkImageById(e){if(e)return n.j.state.networkImages[e]},getConnectorImage:e=>e?.imageUrl?e.imageUrl:e?.imageId?n.j.state.connectorImages[e.imageId]:void 0,getChainImage:e=>n.j.state.networkImages[a[e]]}},18835:function(e,t,i){!function(e,t){"use strict";function r(e,t){if(!e)throw Error(t||"Assertion failed")}function s(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function n(e,t,i){if(n.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(i=t,t=10),this._init(e||0,t||10,i||"be"))}"object"==typeof e?e.exports=n:t.BN=n,n.BN=n,n.wordSize=26;try{l="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:i(14656).Buffer}catch(e){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function o(e,t,i){var r=a(e,i);return i-1>=t&&(r|=a(e,i-1)<<4),r}function c(e,t,i,r){for(var s=0,n=Math.min(e.length,i),a=t;a<n;a++){var o=e.charCodeAt(a)-48;s*=r,o>=49?s+=o-49+10:o>=17?s+=o-17+10:s+=o}return s}n.isBN=function(e){return e instanceof n||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return e.cmp(t)>0?e:t},n.min=function(e,t){return 0>e.cmp(t)?e:t},n.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var s=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(s++,this.negative=1),s<e.length&&(16===t?this._parseHex(e,s,i):(this._parseBase(e,t,s),"le"===i&&this._initArray(this.toArray(),t,i)))},n.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<0x4000000?(this.words=[0x3ffffff&e],this.length=1):e<0x10000000000000?(this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff],this.length=2):(r(e<0x20000000000000),this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},n.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var s,n,a=0;a<this.length;a++)this.words[a]=0;var o=0;if("be"===i)for(a=e.length-1,s=0;a>=0;a-=3)n=e[a]|e[a-1]<<8|e[a-2]<<16,this.words[s]|=n<<o&0x3ffffff,this.words[s+1]=n>>>26-o&0x3ffffff,(o+=24)>=26&&(o-=26,s++);else if("le"===i)for(a=0,s=0;a<e.length;a+=3)n=e[a]|e[a+1]<<8|e[a+2]<<16,this.words[s]|=n<<o&0x3ffffff,this.words[s+1]=n>>>26-o&0x3ffffff,(o+=24)>=26&&(o-=26,s++);return this.strip()},n.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var r,s=0;s<this.length;s++)this.words[s]=0;var n=0,a=0;if("be"===i)for(s=e.length-1;s>=t;s-=2)r=o(e,t,s)<<n,this.words[a]|=0x3ffffff&r,n>=18?(n-=18,a+=1,this.words[a]|=r>>>26):n+=8;else for(s=(e.length-t)%2==0?t+1:t;s<e.length;s+=2)r=o(e,t,s)<<n,this.words[a]|=0x3ffffff&r,n>=18?(n-=18,a+=1,this.words[a]|=r>>>26):n+=8;this.strip()},n.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var r=0,s=1;s<=0x3ffffff;s*=t)r++;r--,s=s/t|0;for(var n=e.length-i,a=n%r,o=Math.min(n,n-a)+i,l=0,d=i;d<o;d+=r)l=c(e,d,d+r,t),this.imuln(s),this.words[0]+l<0x4000000?this.words[0]+=l:this._iaddn(l);if(0!==a){var h=1;for(l=c(e,d,e.length,t),d=0;d<a;d++)h*=t;this.imuln(h),this.words[0]+l<0x4000000?this.words[0]+=l:this._iaddn(l)}this.strip()},n.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l,d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],u=[0,0,0x2000000,0x290d741,0x1000000,0x2e90edd,0x39aa400,0x267bf47,0x1000000,0x290d741,1e7,0x12959c3,0x222c000,0x3bd7765,7529536,0xadcea1,0x1000000,0x1704f61,0x206fc40,0x2cddcf9,64e6,4084101,5153632,6436343,7962624,9765625,0xb54ba0,0xdaf26b,0x1069c00,0x138f9ad,243e5,0x1b4d89f,0x2000000,0x25528a1,0x2b54a20,0x3216b93,0x39aa400];function p(e,t,i){i.negative=t.negative^e.negative;var r=e.length+t.length|0;i.length=r,r=r-1|0;var s=0|e.words[0],n=0|t.words[0],a=s*n,o=0x3ffffff&a,c=a/0x4000000|0;i.words[0]=o;for(var l=1;l<r;l++){for(var d=c>>>26,h=0x3ffffff&c,u=Math.min(l,t.length-1),p=Math.max(0,l-e.length+1);p<=u;p++){var f=l-p|0;d+=(a=(s=0|e.words[f])*(n=0|t.words[p])+h)/0x4000000|0,h=0x3ffffff&a}i.words[l]=0|h,c=0|d}return 0!==c?i.words[l]=0|c:i.length--,i.strip()}n.prototype.toString=function(e,t){if(t=0|t||1,16===(e=e||10)||"hex"===e){for(var i="",s=0,n=0,a=0;a<this.length;a++){var o=this.words[a],c=((o<<s|n)&0xffffff).toString(16);n=o>>>24-s&0xffffff,(s+=2)>=26&&(s-=26,a--),i=0!==n||a!==this.length-1?d[6-c.length]+c+i:c+i}for(0!==n&&(i=n.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var l=h[e],p=u[e];i="";var f=this.clone();for(f.negative=0;!f.isZero();){var g=f.modn(p).toString(e);i=(f=f.idivn(p)).isZero()?g+i:d[l-g.length]+g+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=0x4000000*this.words[1]:3===this.length&&1===this.words[2]?e+=0x10000000000000+0x4000000*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(e,t){return r(void 0!==l),this.toArrayLike(l,e,t)},n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},n.prototype.toArrayLike=function(e,t,i){var s,n,a=this.byteLength(),o=i||Math.max(1,a);r(a<=o,"byte array longer than desired length"),r(o>0,"Requested array length <= 0"),this.strip();var c=new e(o),l=this.clone();if("le"===t){for(n=0;!l.isZero();n++)s=l.andln(255),l.iushrn(8),c[n]=s;for(;n<o;n++)c[n]=0}else{for(n=0;n<o-a;n++)c[n]=0;for(n=0;!l.isZero();n++)s=l.andln(255),l.iushrn(8),c[o-n-1]=s}return c},Math.clz32?n.prototype._countBits=function(e){return 32-Math.clz32(e)}:n.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},n.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return(8191&t)==0&&(i+=13,t>>>=13),(127&t)==0&&(i+=7,t>>>=7),(15&t)==0&&(i+=4,t>>>=4),(3&t)==0&&(i+=2,t>>>=2),(1&t)==0&&i++,i},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return(this.length-1)*26+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},n.prototype.ior=function(e){return r((this.negative|e.negative)==0),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},n.prototype.iand=function(e){return r((this.negative|e.negative)==0),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){this.length>e.length?(t=this,i=e):(t=e,i=this);for(var t,i,r=0;r<i.length;r++)this.words[r]=t.words[r]^i.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},n.prototype.ixor=function(e){return r((this.negative|e.negative)==0),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var s=0;s<t;s++)this.words[s]=0x3ffffff&~this.words[s];return i>0&&(this.words[s]=~this.words[s]&0x3ffffff>>26-i),this.strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,s=e%26;return this._expand(i+1),t?this.words[i]=this.words[i]|1<<s:this.words[i]=this.words[i]&~(1<<s),this.strip()},n.prototype.iadd=function(e){if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,r=e):(i=e,r=this);for(var t,i,r,s=0,n=0;n<r.length;n++)t=(0|i.words[n])+(0|r.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;for(;0!==s&&n<i.length;n++)t=(0|i.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;if(this.length=i.length,0!==s)this.words[this.length]=s,this.length++;else if(i!==this)for(;n<i.length;n++)this.words[n]=i.words[n];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t,i,r=this.iadd(e);return e.negative=1,r._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s=this.cmp(e);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(t=this,i=e):(t=e,i=this);for(var n=0,a=0;a<i.length;a++)n=(r=(0|t.words[a])-(0|i.words[a])+n)>>26,this.words[a]=0x3ffffff&r;for(;0!==n&&a<t.length;a++)n=(r=(0|t.words[a])+n)>>26,this.words[a]=0x3ffffff&r;if(0===n&&a<t.length&&t!==this)for(;a<t.length;a++)this.words[a]=t.words[a];return this.length=Math.max(this.length,a),t!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,i){var r,s,n,a=e.words,o=t.words,c=i.words,l=0,d=0|a[0],h=8191&d,u=d>>>13,p=0|a[1],f=8191&p,g=p>>>13,y=0|a[2],m=8191&y,b=y>>>13,w=0|a[3],v=8191&w,I=w>>>13,E=0|a[4],_=8191&E,C=E>>>13,A=0|a[5],S=8191&A,N=A>>>13,T=0|a[6],x=8191&T,P=T>>>13,O=0|a[7],M=8191&O,R=O>>>13,k=0|a[8],D=8191&k,U=k>>>13,L=0|a[9],q=8191&L,j=L>>>13,$=0|o[0],z=8191&$,B=$>>>13,H=0|o[1],W=8191&H,F=H>>>13,V=0|o[2],K=8191&V,G=V>>>13,J=0|o[3],Y=8191&J,Q=J>>>13,X=0|o[4],Z=8191&X,ee=X>>>13,et=0|o[5],ei=8191&et,er=et>>>13,es=0|o[6],en=8191&es,ea=es>>>13,eo=0|o[7],ec=8191&eo,el=eo>>>13,ed=0|o[8],eh=8191&ed,eu=ed>>>13,ep=0|o[9],ef=8191&ep,eg=ep>>>13;i.negative=e.negative^t.negative,i.length=19,r=Math.imul(h,z);var ey=(l+r|0)+((8191&(s=(s=Math.imul(h,B))+Math.imul(u,z)|0))<<13)|0;l=((n=Math.imul(u,B))+(s>>>13)|0)+(ey>>>26)|0,ey&=0x3ffffff,r=Math.imul(f,z),s=(s=Math.imul(f,B))+Math.imul(g,z)|0,n=Math.imul(g,B),r=r+Math.imul(h,W)|0;var em=(l+r|0)+((8191&(s=(s=s+Math.imul(h,F)|0)+Math.imul(u,W)|0))<<13)|0;l=((n=n+Math.imul(u,F)|0)+(s>>>13)|0)+(em>>>26)|0,em&=0x3ffffff,r=Math.imul(m,z),s=(s=Math.imul(m,B))+Math.imul(b,z)|0,n=Math.imul(b,B),r=r+Math.imul(f,W)|0,s=(s=s+Math.imul(f,F)|0)+Math.imul(g,W)|0,n=n+Math.imul(g,F)|0,r=r+Math.imul(h,K)|0;var eb=(l+r|0)+((8191&(s=(s=s+Math.imul(h,G)|0)+Math.imul(u,K)|0))<<13)|0;l=((n=n+Math.imul(u,G)|0)+(s>>>13)|0)+(eb>>>26)|0,eb&=0x3ffffff,r=Math.imul(v,z),s=(s=Math.imul(v,B))+Math.imul(I,z)|0,n=Math.imul(I,B),r=r+Math.imul(m,W)|0,s=(s=s+Math.imul(m,F)|0)+Math.imul(b,W)|0,n=n+Math.imul(b,F)|0,r=r+Math.imul(f,K)|0,s=(s=s+Math.imul(f,G)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,G)|0,r=r+Math.imul(h,Y)|0;var ew=(l+r|0)+((8191&(s=(s=s+Math.imul(h,Q)|0)+Math.imul(u,Y)|0))<<13)|0;l=((n=n+Math.imul(u,Q)|0)+(s>>>13)|0)+(ew>>>26)|0,ew&=0x3ffffff,r=Math.imul(_,z),s=(s=Math.imul(_,B))+Math.imul(C,z)|0,n=Math.imul(C,B),r=r+Math.imul(v,W)|0,s=(s=s+Math.imul(v,F)|0)+Math.imul(I,W)|0,n=n+Math.imul(I,F)|0,r=r+Math.imul(m,K)|0,s=(s=s+Math.imul(m,G)|0)+Math.imul(b,K)|0,n=n+Math.imul(b,G)|0,r=r+Math.imul(f,Y)|0,s=(s=s+Math.imul(f,Q)|0)+Math.imul(g,Y)|0,n=n+Math.imul(g,Q)|0,r=r+Math.imul(h,Z)|0;var ev=(l+r|0)+((8191&(s=(s=s+Math.imul(h,ee)|0)+Math.imul(u,Z)|0))<<13)|0;l=((n=n+Math.imul(u,ee)|0)+(s>>>13)|0)+(ev>>>26)|0,ev&=0x3ffffff,r=Math.imul(S,z),s=(s=Math.imul(S,B))+Math.imul(N,z)|0,n=Math.imul(N,B),r=r+Math.imul(_,W)|0,s=(s=s+Math.imul(_,F)|0)+Math.imul(C,W)|0,n=n+Math.imul(C,F)|0,r=r+Math.imul(v,K)|0,s=(s=s+Math.imul(v,G)|0)+Math.imul(I,K)|0,n=n+Math.imul(I,G)|0,r=r+Math.imul(m,Y)|0,s=(s=s+Math.imul(m,Q)|0)+Math.imul(b,Y)|0,n=n+Math.imul(b,Q)|0,r=r+Math.imul(f,Z)|0,s=(s=s+Math.imul(f,ee)|0)+Math.imul(g,Z)|0,n=n+Math.imul(g,ee)|0,r=r+Math.imul(h,ei)|0;var eI=(l+r|0)+((8191&(s=(s=s+Math.imul(h,er)|0)+Math.imul(u,ei)|0))<<13)|0;l=((n=n+Math.imul(u,er)|0)+(s>>>13)|0)+(eI>>>26)|0,eI&=0x3ffffff,r=Math.imul(x,z),s=(s=Math.imul(x,B))+Math.imul(P,z)|0,n=Math.imul(P,B),r=r+Math.imul(S,W)|0,s=(s=s+Math.imul(S,F)|0)+Math.imul(N,W)|0,n=n+Math.imul(N,F)|0,r=r+Math.imul(_,K)|0,s=(s=s+Math.imul(_,G)|0)+Math.imul(C,K)|0,n=n+Math.imul(C,G)|0,r=r+Math.imul(v,Y)|0,s=(s=s+Math.imul(v,Q)|0)+Math.imul(I,Y)|0,n=n+Math.imul(I,Q)|0,r=r+Math.imul(m,Z)|0,s=(s=s+Math.imul(m,ee)|0)+Math.imul(b,Z)|0,n=n+Math.imul(b,ee)|0,r=r+Math.imul(f,ei)|0,s=(s=s+Math.imul(f,er)|0)+Math.imul(g,ei)|0,n=n+Math.imul(g,er)|0,r=r+Math.imul(h,en)|0;var eE=(l+r|0)+((8191&(s=(s=s+Math.imul(h,ea)|0)+Math.imul(u,en)|0))<<13)|0;l=((n=n+Math.imul(u,ea)|0)+(s>>>13)|0)+(eE>>>26)|0,eE&=0x3ffffff,r=Math.imul(M,z),s=(s=Math.imul(M,B))+Math.imul(R,z)|0,n=Math.imul(R,B),r=r+Math.imul(x,W)|0,s=(s=s+Math.imul(x,F)|0)+Math.imul(P,W)|0,n=n+Math.imul(P,F)|0,r=r+Math.imul(S,K)|0,s=(s=s+Math.imul(S,G)|0)+Math.imul(N,K)|0,n=n+Math.imul(N,G)|0,r=r+Math.imul(_,Y)|0,s=(s=s+Math.imul(_,Q)|0)+Math.imul(C,Y)|0,n=n+Math.imul(C,Q)|0,r=r+Math.imul(v,Z)|0,s=(s=s+Math.imul(v,ee)|0)+Math.imul(I,Z)|0,n=n+Math.imul(I,ee)|0,r=r+Math.imul(m,ei)|0,s=(s=s+Math.imul(m,er)|0)+Math.imul(b,ei)|0,n=n+Math.imul(b,er)|0,r=r+Math.imul(f,en)|0,s=(s=s+Math.imul(f,ea)|0)+Math.imul(g,en)|0,n=n+Math.imul(g,ea)|0,r=r+Math.imul(h,ec)|0;var e_=(l+r|0)+((8191&(s=(s=s+Math.imul(h,el)|0)+Math.imul(u,ec)|0))<<13)|0;l=((n=n+Math.imul(u,el)|0)+(s>>>13)|0)+(e_>>>26)|0,e_&=0x3ffffff,r=Math.imul(D,z),s=(s=Math.imul(D,B))+Math.imul(U,z)|0,n=Math.imul(U,B),r=r+Math.imul(M,W)|0,s=(s=s+Math.imul(M,F)|0)+Math.imul(R,W)|0,n=n+Math.imul(R,F)|0,r=r+Math.imul(x,K)|0,s=(s=s+Math.imul(x,G)|0)+Math.imul(P,K)|0,n=n+Math.imul(P,G)|0,r=r+Math.imul(S,Y)|0,s=(s=s+Math.imul(S,Q)|0)+Math.imul(N,Y)|0,n=n+Math.imul(N,Q)|0,r=r+Math.imul(_,Z)|0,s=(s=s+Math.imul(_,ee)|0)+Math.imul(C,Z)|0,n=n+Math.imul(C,ee)|0,r=r+Math.imul(v,ei)|0,s=(s=s+Math.imul(v,er)|0)+Math.imul(I,ei)|0,n=n+Math.imul(I,er)|0,r=r+Math.imul(m,en)|0,s=(s=s+Math.imul(m,ea)|0)+Math.imul(b,en)|0,n=n+Math.imul(b,ea)|0,r=r+Math.imul(f,ec)|0,s=(s=s+Math.imul(f,el)|0)+Math.imul(g,ec)|0,n=n+Math.imul(g,el)|0,r=r+Math.imul(h,eh)|0;var eC=(l+r|0)+((8191&(s=(s=s+Math.imul(h,eu)|0)+Math.imul(u,eh)|0))<<13)|0;l=((n=n+Math.imul(u,eu)|0)+(s>>>13)|0)+(eC>>>26)|0,eC&=0x3ffffff,r=Math.imul(q,z),s=(s=Math.imul(q,B))+Math.imul(j,z)|0,n=Math.imul(j,B),r=r+Math.imul(D,W)|0,s=(s=s+Math.imul(D,F)|0)+Math.imul(U,W)|0,n=n+Math.imul(U,F)|0,r=r+Math.imul(M,K)|0,s=(s=s+Math.imul(M,G)|0)+Math.imul(R,K)|0,n=n+Math.imul(R,G)|0,r=r+Math.imul(x,Y)|0,s=(s=s+Math.imul(x,Q)|0)+Math.imul(P,Y)|0,n=n+Math.imul(P,Q)|0,r=r+Math.imul(S,Z)|0,s=(s=s+Math.imul(S,ee)|0)+Math.imul(N,Z)|0,n=n+Math.imul(N,ee)|0,r=r+Math.imul(_,ei)|0,s=(s=s+Math.imul(_,er)|0)+Math.imul(C,ei)|0,n=n+Math.imul(C,er)|0,r=r+Math.imul(v,en)|0,s=(s=s+Math.imul(v,ea)|0)+Math.imul(I,en)|0,n=n+Math.imul(I,ea)|0,r=r+Math.imul(m,ec)|0,s=(s=s+Math.imul(m,el)|0)+Math.imul(b,ec)|0,n=n+Math.imul(b,el)|0,r=r+Math.imul(f,eh)|0,s=(s=s+Math.imul(f,eu)|0)+Math.imul(g,eh)|0,n=n+Math.imul(g,eu)|0,r=r+Math.imul(h,ef)|0;var eA=(l+r|0)+((8191&(s=(s=s+Math.imul(h,eg)|0)+Math.imul(u,ef)|0))<<13)|0;l=((n=n+Math.imul(u,eg)|0)+(s>>>13)|0)+(eA>>>26)|0,eA&=0x3ffffff,r=Math.imul(q,W),s=(s=Math.imul(q,F))+Math.imul(j,W)|0,n=Math.imul(j,F),r=r+Math.imul(D,K)|0,s=(s=s+Math.imul(D,G)|0)+Math.imul(U,K)|0,n=n+Math.imul(U,G)|0,r=r+Math.imul(M,Y)|0,s=(s=s+Math.imul(M,Q)|0)+Math.imul(R,Y)|0,n=n+Math.imul(R,Q)|0,r=r+Math.imul(x,Z)|0,s=(s=s+Math.imul(x,ee)|0)+Math.imul(P,Z)|0,n=n+Math.imul(P,ee)|0,r=r+Math.imul(S,ei)|0,s=(s=s+Math.imul(S,er)|0)+Math.imul(N,ei)|0,n=n+Math.imul(N,er)|0,r=r+Math.imul(_,en)|0,s=(s=s+Math.imul(_,ea)|0)+Math.imul(C,en)|0,n=n+Math.imul(C,ea)|0,r=r+Math.imul(v,ec)|0,s=(s=s+Math.imul(v,el)|0)+Math.imul(I,ec)|0,n=n+Math.imul(I,el)|0,r=r+Math.imul(m,eh)|0,s=(s=s+Math.imul(m,eu)|0)+Math.imul(b,eh)|0,n=n+Math.imul(b,eu)|0,r=r+Math.imul(f,ef)|0;var eS=(l+r|0)+((8191&(s=(s=s+Math.imul(f,eg)|0)+Math.imul(g,ef)|0))<<13)|0;l=((n=n+Math.imul(g,eg)|0)+(s>>>13)|0)+(eS>>>26)|0,eS&=0x3ffffff,r=Math.imul(q,K),s=(s=Math.imul(q,G))+Math.imul(j,K)|0,n=Math.imul(j,G),r=r+Math.imul(D,Y)|0,s=(s=s+Math.imul(D,Q)|0)+Math.imul(U,Y)|0,n=n+Math.imul(U,Q)|0,r=r+Math.imul(M,Z)|0,s=(s=s+Math.imul(M,ee)|0)+Math.imul(R,Z)|0,n=n+Math.imul(R,ee)|0,r=r+Math.imul(x,ei)|0,s=(s=s+Math.imul(x,er)|0)+Math.imul(P,ei)|0,n=n+Math.imul(P,er)|0,r=r+Math.imul(S,en)|0,s=(s=s+Math.imul(S,ea)|0)+Math.imul(N,en)|0,n=n+Math.imul(N,ea)|0,r=r+Math.imul(_,ec)|0,s=(s=s+Math.imul(_,el)|0)+Math.imul(C,ec)|0,n=n+Math.imul(C,el)|0,r=r+Math.imul(v,eh)|0,s=(s=s+Math.imul(v,eu)|0)+Math.imul(I,eh)|0,n=n+Math.imul(I,eu)|0,r=r+Math.imul(m,ef)|0;var eN=(l+r|0)+((8191&(s=(s=s+Math.imul(m,eg)|0)+Math.imul(b,ef)|0))<<13)|0;l=((n=n+Math.imul(b,eg)|0)+(s>>>13)|0)+(eN>>>26)|0,eN&=0x3ffffff,r=Math.imul(q,Y),s=(s=Math.imul(q,Q))+Math.imul(j,Y)|0,n=Math.imul(j,Q),r=r+Math.imul(D,Z)|0,s=(s=s+Math.imul(D,ee)|0)+Math.imul(U,Z)|0,n=n+Math.imul(U,ee)|0,r=r+Math.imul(M,ei)|0,s=(s=s+Math.imul(M,er)|0)+Math.imul(R,ei)|0,n=n+Math.imul(R,er)|0,r=r+Math.imul(x,en)|0,s=(s=s+Math.imul(x,ea)|0)+Math.imul(P,en)|0,n=n+Math.imul(P,ea)|0,r=r+Math.imul(S,ec)|0,s=(s=s+Math.imul(S,el)|0)+Math.imul(N,ec)|0,n=n+Math.imul(N,el)|0,r=r+Math.imul(_,eh)|0,s=(s=s+Math.imul(_,eu)|0)+Math.imul(C,eh)|0,n=n+Math.imul(C,eu)|0,r=r+Math.imul(v,ef)|0;var eT=(l+r|0)+((8191&(s=(s=s+Math.imul(v,eg)|0)+Math.imul(I,ef)|0))<<13)|0;l=((n=n+Math.imul(I,eg)|0)+(s>>>13)|0)+(eT>>>26)|0,eT&=0x3ffffff,r=Math.imul(q,Z),s=(s=Math.imul(q,ee))+Math.imul(j,Z)|0,n=Math.imul(j,ee),r=r+Math.imul(D,ei)|0,s=(s=s+Math.imul(D,er)|0)+Math.imul(U,ei)|0,n=n+Math.imul(U,er)|0,r=r+Math.imul(M,en)|0,s=(s=s+Math.imul(M,ea)|0)+Math.imul(R,en)|0,n=n+Math.imul(R,ea)|0,r=r+Math.imul(x,ec)|0,s=(s=s+Math.imul(x,el)|0)+Math.imul(P,ec)|0,n=n+Math.imul(P,el)|0,r=r+Math.imul(S,eh)|0,s=(s=s+Math.imul(S,eu)|0)+Math.imul(N,eh)|0,n=n+Math.imul(N,eu)|0,r=r+Math.imul(_,ef)|0;var ex=(l+r|0)+((8191&(s=(s=s+Math.imul(_,eg)|0)+Math.imul(C,ef)|0))<<13)|0;l=((n=n+Math.imul(C,eg)|0)+(s>>>13)|0)+(ex>>>26)|0,ex&=0x3ffffff,r=Math.imul(q,ei),s=(s=Math.imul(q,er))+Math.imul(j,ei)|0,n=Math.imul(j,er),r=r+Math.imul(D,en)|0,s=(s=s+Math.imul(D,ea)|0)+Math.imul(U,en)|0,n=n+Math.imul(U,ea)|0,r=r+Math.imul(M,ec)|0,s=(s=s+Math.imul(M,el)|0)+Math.imul(R,ec)|0,n=n+Math.imul(R,el)|0,r=r+Math.imul(x,eh)|0,s=(s=s+Math.imul(x,eu)|0)+Math.imul(P,eh)|0,n=n+Math.imul(P,eu)|0,r=r+Math.imul(S,ef)|0;var eP=(l+r|0)+((8191&(s=(s=s+Math.imul(S,eg)|0)+Math.imul(N,ef)|0))<<13)|0;l=((n=n+Math.imul(N,eg)|0)+(s>>>13)|0)+(eP>>>26)|0,eP&=0x3ffffff,r=Math.imul(q,en),s=(s=Math.imul(q,ea))+Math.imul(j,en)|0,n=Math.imul(j,ea),r=r+Math.imul(D,ec)|0,s=(s=s+Math.imul(D,el)|0)+Math.imul(U,ec)|0,n=n+Math.imul(U,el)|0,r=r+Math.imul(M,eh)|0,s=(s=s+Math.imul(M,eu)|0)+Math.imul(R,eh)|0,n=n+Math.imul(R,eu)|0,r=r+Math.imul(x,ef)|0;var eO=(l+r|0)+((8191&(s=(s=s+Math.imul(x,eg)|0)+Math.imul(P,ef)|0))<<13)|0;l=((n=n+Math.imul(P,eg)|0)+(s>>>13)|0)+(eO>>>26)|0,eO&=0x3ffffff,r=Math.imul(q,ec),s=(s=Math.imul(q,el))+Math.imul(j,ec)|0,n=Math.imul(j,el),r=r+Math.imul(D,eh)|0,s=(s=s+Math.imul(D,eu)|0)+Math.imul(U,eh)|0,n=n+Math.imul(U,eu)|0,r=r+Math.imul(M,ef)|0;var eM=(l+r|0)+((8191&(s=(s=s+Math.imul(M,eg)|0)+Math.imul(R,ef)|0))<<13)|0;l=((n=n+Math.imul(R,eg)|0)+(s>>>13)|0)+(eM>>>26)|0,eM&=0x3ffffff,r=Math.imul(q,eh),s=(s=Math.imul(q,eu))+Math.imul(j,eh)|0,n=Math.imul(j,eu),r=r+Math.imul(D,ef)|0;var eR=(l+r|0)+((8191&(s=(s=s+Math.imul(D,eg)|0)+Math.imul(U,ef)|0))<<13)|0;l=((n=n+Math.imul(U,eg)|0)+(s>>>13)|0)+(eR>>>26)|0,eR&=0x3ffffff,r=Math.imul(q,ef);var ek=(l+r|0)+((8191&(s=(s=Math.imul(q,eg))+Math.imul(j,ef)|0))<<13)|0;return l=((n=Math.imul(j,eg))+(s>>>13)|0)+(ek>>>26)|0,ek&=0x3ffffff,c[0]=ey,c[1]=em,c[2]=eb,c[3]=ew,c[4]=ev,c[5]=eI,c[6]=eE,c[7]=e_,c[8]=eC,c[9]=eA,c[10]=eS,c[11]=eN,c[12]=eT,c[13]=ex,c[14]=eP,c[15]=eO,c[16]=eM,c[17]=eR,c[18]=ek,0!==l&&(c[19]=l,i.length++),i};function g(e,t,i){return new y().mulp(e,t,i)}function y(e,t){this.x=e,this.y=t}Math.imul||(f=p),n.prototype.mulTo=function(e,t){var i,r=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):r<63?p(this,e,t):r<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var r=0,s=0,n=0;n<i.length-1;n++){var a=s;s=0;for(var o=0x3ffffff&r,c=Math.min(n,t.length-1),l=Math.max(0,n-e.length+1);l<=c;l++){var d=n-l,h=(0|e.words[d])*(0|t.words[l]),u=0x3ffffff&h;a=a+(h/0x4000000|0)|0,o=0x3ffffff&(u=u+o|0),s+=(a=a+(u>>>26)|0)>>>26,a&=0x3ffffff}i.words[n]=o,r=a,a=s}return 0!==r?i.words[n]=r:i.length--,i.strip()}(this,e,t):g(this,e,t)},y.prototype.makeRBT=function(e){for(var t=Array(e),i=n.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,i,e);return t},y.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var r=0,s=0;s<t;s++)r|=(1&e)<<t-s-1,e>>=1;return r},y.prototype.permute=function(e,t,i,r,s,n){for(var a=0;a<n;a++)r[a]=t[e[a]],s[a]=i[e[a]]},y.prototype.transform=function(e,t,i,r,s,n){this.permute(n,e,t,i,r,s);for(var a=1;a<s;a<<=1)for(var o=a<<1,c=Math.cos(2*Math.PI/o),l=Math.sin(2*Math.PI/o),d=0;d<s;d+=o)for(var h=c,u=l,p=0;p<a;p++){var f=i[d+p],g=r[d+p],y=i[d+p+a],m=r[d+p+a],b=h*y-u*m;m=h*m+u*y,y=b,i[d+p]=f+y,r[d+p]=g+m,i[d+p+a]=f-y,r[d+p+a]=g-m,p!==o&&(b=c*h-l*u,u=c*u+l*h,h=b)}},y.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),r=1&i,s=0;for(i=i/2|0;i;i>>>=1)s++;return 1<<s+1+r},y.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var r=0;r<i/2;r++){var s=e[r];e[r]=e[i-r-1],e[i-r-1]=s,s=t[r],t[r]=-t[i-r-1],t[i-r-1]=-s}},y.prototype.normalize13b=function(e,t){for(var i=0,r=0;r<t/2;r++){var s=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+i;e[r]=0x3ffffff&s,i=s<0x4000000?0:s/0x4000000|0}return e},y.prototype.convert13b=function(e,t,i,s){for(var n=0,a=0;a<t;a++)n+=0|e[a],i[2*a]=8191&n,n>>>=13,i[2*a+1]=8191&n,n>>>=13;for(a=2*t;a<s;++a)i[a]=0;r(0===n),r((-8192&n)==0)},y.prototype.stub=function(e){for(var t=Array(e),i=0;i<e;i++)t[i]=0;return t},y.prototype.mulp=function(e,t,i){var r=2*this.guessLen13b(e.length,t.length),s=this.makeRBT(r),n=this.stub(r),a=Array(r),o=Array(r),c=Array(r),l=Array(r),d=Array(r),h=Array(r),u=i.words;u.length=r,this.convert13b(e.words,e.length,a,r),this.convert13b(t.words,t.length,l,r),this.transform(a,n,o,c,r,s),this.transform(l,n,d,h,r,s);for(var p=0;p<r;p++){var f=o[p]*d[p]-c[p]*h[p];c[p]=o[p]*h[p]+c[p]*d[p],o[p]=f}return this.conjugate(o,c,r),this.transform(o,c,u,n,r,s),this.conjugate(u,n,r),this.normalize13b(u,r),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=Array(this.length+e.length),g(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){r("number"==typeof e),r(e<0x4000000);for(var t=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,n=(0x3ffffff&s)+(0x3ffffff&t);t>>=26,t+=(s/0x4000000|0)+(n>>>26),this.words[i]=0x3ffffff&n}return 0!==t&&(this.words[i]=t,this.length++),this.length=0===e?1:this.length,this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),i=0;i<t.length;i++){var r=i/26|0,s=i%26;t[i]=(e.words[r]&1<<s)>>>s}return t}(e);if(0===t.length)return new n(1);for(var i=this,r=0;r<t.length&&0===t[r];r++,i=i.sqr());if(++r<t.length)for(var s=i.sqr();r<t.length;r++,s=s.sqr())0!==t[r]&&(i=i.mul(s));return i},n.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,s=(e-i)/26,n=0x3ffffff>>>26-i<<26-i;if(0!==i){var a=0;for(t=0;t<this.length;t++){var o=this.words[t]&n,c=(0|this.words[t])-o<<i;this.words[t]=c|a,a=o>>>26-i}a&&(this.words[t]=a,this.length++)}if(0!==s){for(t=this.length-1;t>=0;t--)this.words[t+s]=this.words[t];for(t=0;t<s;t++)this.words[t]=0;this.length+=s}return this.strip()},n.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,i){r("number"==typeof e&&e>=0);var s=t?(t-t%26)/26:0,n=e%26,a=Math.min((e-n)/26,this.length),o=0x3ffffff^0x3ffffff>>>n<<n;if(s-=a,s=Math.max(0,s),i){for(var c=0;c<a;c++)i.words[c]=this.words[c];i.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=s);c--){var d=0|this.words[c];this.words[c]=l<<26-n|d>>>n,l=d&o}return i&&0!==l&&(i.words[i.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return!(this.length<=i)&&!!(this.words[i]&1<<t)},n.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)?this:(0!==t&&i++,this.length=Math.min(i,this.length),0!==t&&(this.words[this.length-1]&=0x3ffffff^0x3ffffff>>>t<<t),this.strip())},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return(r("number"==typeof e),r(e<0x4000000),e<0)?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=0x4000000;t++)this.words[t]-=0x4000000,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},n.prototype.isubn=function(e){if(r("number"==typeof e),r(e<0x4000000),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=0x4000000,this.words[t+1]-=1;return this.strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,i){var s,n,a=e.length+i;this._expand(a);var o=0;for(s=0;s<e.length;s++){n=(0|this.words[s+i])+o;var c=(0|e.words[s])*t;n-=0x3ffffff&c,o=(n>>26)-(c/0x4000000|0),this.words[s+i]=0x3ffffff&n}for(;s<this.length-i;s++)o=(n=(0|this.words[s+i])+o)>>26,this.words[s+i]=0x3ffffff&n;if(0===o)return this.strip();for(r(-1===o),o=0,s=0;s<this.length;s++)o=(n=-(0|this.words[s])+o)>>26,this.words[s]=0x3ffffff&n;return this.negative=1,this.strip()},n.prototype._wordDiv=function(e,t){var i,r=this.length-e.length,s=this.clone(),a=e,o=0|a.words[a.length-1];0!=(r=26-this._countBits(o))&&(a=a.ushln(r),s.iushln(r),o=0|a.words[a.length-1]);var c=s.length-a.length;if("mod"!==t){(i=new n(null)).length=c+1,i.words=Array(i.length);for(var l=0;l<i.length;l++)i.words[l]=0}var d=s.clone()._ishlnsubmul(a,1,c);0===d.negative&&(s=d,i&&(i.words[c]=1));for(var h=c-1;h>=0;h--){var u=(0|s.words[a.length+h])*0x4000000+(0|s.words[a.length+h-1]);for(u=Math.min(u/o|0,0x3ffffff),s._ishlnsubmul(a,u,h);0!==s.negative;)u--,s.negative=0,s._ishlnsubmul(a,1,h),s.isZero()||(s.negative^=1);i&&(i.words[h]=u)}return i&&i.strip(),s.strip(),"div"!==t&&0!==r&&s.iushrn(r),{div:i||null,mod:s}},n.prototype.divmod=function(e,t,i){var s,a,o;return(r(!e.isZero()),this.isZero())?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===e.negative?(o=this.neg().divmod(e,t),"mod"!==t&&(s=o.div.neg()),"div"!==t&&(a=o.mod.neg(),i&&0!==a.negative&&a.iadd(e)),{div:s,mod:a}):0===this.negative&&0!==e.negative?(o=this.divmod(e.neg(),t),"mod"!==t&&(s=o.div.neg()),{div:s,mod:o.mod}):(this.negative&e.negative)!=0?(o=this.neg().divmod(e.neg(),t),"div"!==t&&(a=o.mod.neg(),i&&0!==a.negative&&a.isub(e)),{div:o.div,mod:a}):e.length>this.length||0>this.cmp(e)?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modn(e.words[0]))}:this._wordDiv(e,t)},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),s=e.andln(1),n=i.cmp(r);return n<0||1===s&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},n.prototype.modn=function(e){r(e<=0x3ffffff);for(var t=0x4000000%e,i=0,s=this.length-1;s>=0;s--)i=(t*i+(0|this.words[s]))%e;return i},n.prototype.idivn=function(e){r(e<=0x3ffffff);for(var t=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+0x4000000*t;this.words[i]=s/e|0,t=s%e}return this.strip()},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s=new n(1),a=new n(0),o=new n(0),c=new n(1),l=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++l;for(var d=i.clone(),h=t.clone();!t.isZero();){for(var u=0,p=1;(t.words[0]&p)==0&&u<26;++u,p<<=1);if(u>0)for(t.iushrn(u);u-- >0;)(s.isOdd()||a.isOdd())&&(s.iadd(d),a.isub(h)),s.iushrn(1),a.iushrn(1);for(var f=0,g=1;(i.words[0]&g)==0&&f<26;++f,g<<=1);if(f>0)for(i.iushrn(f);f-- >0;)(o.isOdd()||c.isOdd())&&(o.iadd(d),c.isub(h)),o.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(o),a.isub(c)):(i.isub(t),o.isub(s),c.isub(a))}return{a:o,b:c,gcd:i.iushln(l)}},n.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t,i=this,s=e.clone();i=0!==i.negative?i.umod(e):i.clone();for(var a=new n(1),o=new n(0),c=s.clone();i.cmpn(1)>0&&s.cmpn(1)>0;){for(var l=0,d=1;(i.words[0]&d)==0&&l<26;++l,d<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);for(var h=0,u=1;(s.words[0]&u)==0&&h<26;++h,u<<=1);if(h>0)for(s.iushrn(h);h-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);i.cmp(s)>=0?(i.isub(s),a.isub(o)):(s.isub(i),o.isub(a))}return 0>(t=0===i.cmpn(1)?a:o).cmpn(0)&&t.iadd(e),t},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var r=0;t.isEven()&&i.isEven();r++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var s=t.cmp(i);if(s<0){var n=t;t=i,i=n}else if(0===s||0===i.cmpn(1))break;t.isub(i)}return i.iushln(r)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return(1&this.words[0])==0},n.prototype.isOdd=function(){return(1&this.words[0])==1},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,s=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=s,this;for(var n=s,a=i;0!==n&&a<this.length;a++){var o=0|this.words[a];o+=n,n=o>>>26,o&=0x3ffffff,this.words[a]=o}return 0!==n&&(this.words[a]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return -1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=0x3ffffff,"Number is too big");var s=0|this.words[0];t=s===e?0:s<e?-1:1}return 0!==this.negative?0|-t:t},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,i=this.length-1;i>=0;i--){var r=0|this.words[i],s=0|e.words[i];if(r!==s){r<s?t=-1:r>s&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return this.cmpn(e)>=0},n.prototype.gte=function(e){return this.cmp(e)>=0},n.prototype.ltn=function(e){return -1===this.cmpn(e)},n.prototype.lt=function(e){return -1===this.cmp(e)},n.prototype.lten=function(e){return 0>=this.cmpn(e)},n.prototype.lte=function(e){return 0>=this.cmp(e)},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new _(e)},n.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var m={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function I(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function C(e){_.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new n(null);return e.words=Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){var t,i=e;do this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength();while(t>this.n);var r=t<this.n?-1:i.ucmp(this.p);return 0===r?(i.words[0]=0,i.length=1):r>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},s(w,b),w.prototype.split=function(e,t){for(var i=Math.min(e.length,9),r=0;r<i;r++)t.words[r]=e.words[r];if(t.length=i,e.length<=9){e.words[0]=0,e.length=1;return}var s=e.words[9];for(r=10,t.words[t.length++]=4194303&s;r<e.length;r++){var n=0|e.words[r];e.words[r-10]=(4194303&n)<<4|s>>>22,s=n}s>>>=22,e.words[r-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var r=0|e.words[i];t+=977*r,e.words[i]=0x3ffffff&t,t=64*r+(t/0x4000000|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},s(v,b),s(I,b),s(E,b),E.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var r=(0|e.words[i])*19+t,s=0x3ffffff&r;r>>>=26,e.words[i]=s,t=r}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function(e){var t;if(m[e])return m[e];if("k256"===e)t=new w;else if("p224"===e)t=new v;else if("p192"===e)t=new I;else if("p25519"===e)t=new E;else throw Error("Unknown prime "+e);return m[e]=t,t},_.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},_.prototype._verify2=function(e,t){r((e.negative|t.negative)==0,"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},_.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},_.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},_.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},_.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},_.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return 0>i.cmpn(0)&&i.iadd(this.m),i._forceRed(this)},_.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return 0>i.cmpn(0)&&i.iadd(this.m),i},_.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},_.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},_.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},_.prototype.isqr=function(e){return this.imul(e,e.clone())},_.prototype.sqr=function(e){return this.mul(e,e)},_.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new n(1)).iushrn(2);return this.pow(e,i)}for(var s=this.m.subn(1),a=0;!s.isZero()&&0===s.andln(1);)a++,s.iushrn(1);r(!s.isZero());var o=new n(1).toRed(this),c=o.redNeg(),l=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new n(2*d*d).toRed(this);0!==this.pow(d,l).cmp(c);)d.redIAdd(c);for(var h=this.pow(d,s),u=this.pow(e,s.addn(1).iushrn(1)),p=this.pow(e,s),f=a;0!==p.cmp(o);){for(var g=p,y=0;0!==g.cmp(o);y++)g=g.redSqr();r(y<f);var m=this.pow(h,new n(1).iushln(f-y-1));u=u.redMul(m),h=m.redSqr(),p=p.redMul(h),f=y}return u},_.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},_.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=Array(16);i[0]=new n(1).toRed(this),i[1]=e;for(var r=2;r<i.length;r++)i[r]=this.mul(i[r-1],e);var s=i[0],a=0,o=0,c=t.bitLength()%26;for(0===c&&(c=26),r=t.length-1;r>=0;r--){for(var l=t.words[r],d=c-1;d>=0;d--){var h=l>>d&1;if(s!==i[0]&&(s=this.sqr(s)),0===h&&0===a){o=0;continue}a<<=1,a|=h,(4==++o||0===r&&0===d)&&(s=this.mul(s,i[a]),o=0,a=0)}c=26}return s},_.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},_.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new C(e)},s(C,_),C.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},C.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},C.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(r).iushrn(this.shift),n=s;return s.cmp(this.m)>=0?n=s.isub(this.m):0>s.cmpn(0)&&(n=s.iadd(this.m)),n._forceRed(this)},C.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new n(0)._forceRed(this);var i=e.mul(t),r=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=i.isub(r).iushrn(this.shift),a=s;return s.cmp(this.m)>=0?a=s.isub(this.m):0>s.cmpn(0)&&(a=s.iadd(this.m)),a._forceRed(this)},C.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=i.nmd(e),this)},20641:(e,t,i)=>{"use strict";i.d(t,{I:()=>h});var r=i(41179),s=i(74801),n=i(1711),a=i(63),o=i(1221),c=i(50209),l=i(75808);let d=(0,r.BX)({view:"Connect",history:["Connect"],transactionStack:[]}),h={state:d,subscribeKey:(e,t)=>(0,s.u$)(d,e,t),pushTransactionStack(e){d.transactionStack.push(e)},popTransactionStack(e){let t=d.transactionStack.pop();if(t)if(e)this.goBack(),t?.onCancel?.();else{if(t.goBack)this.goBack();else if(t.replace){let e=d.history.indexOf("ConnectingSiwe");e>0?this.goBackToIndex(e-1):(c.W.close(),d.history=[])}else t.view&&this.reset(t.view);t?.onSuccess?.()}},push(e,t){e!==d.view&&(d.view=e,d.history.push(e),d.data=t)},reset(e,t){d.view=e,d.history=[e],d.data=t},replace(e,t){d.history.at(-1)!==e&&(d.view=e,d.history[d.history.length-1]=e,d.data=t)},goBack(){let e=!a.W.state.activeCaipAddress&&"ConnectingFarcaster"===this.state.view;if(d.history.length>1&&!d.history.includes("UnsupportedChain")){d.history.pop();let[e]=d.history.slice(-1);e&&(d.view=e)}else c.W.close();d.data?.wallet&&(d.data.wallet=void 0),setTimeout(()=>{if(e){n.U.setFarcasterUrl(void 0,a.W.state.activeChain);let e=o.a.getAuthConnector();e?.provider?.reload();let t=(0,r.P9)(l.H.state);e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType})}},100)},goBackToIndex(e){if(d.history.length>1){d.history=d.history.slice(0,e+1);let[t]=d.history.slice(-1);t&&(d.view=t)}}}},21415:(e,t,i)=>{"use strict";t.version=i(64112).rE,t.utils=i(2289),t.rand=i(35364),t.curve=i(15768),t.curves=i(9360),t.ec=i(12059),t.eddsa=i(17748)},24857:(e,t,i)=>{"use strict";i.d(t,{W:()=>o});var r=i(41179),s=i(66038),n=i(1221);let a=(0,r.BX)({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),o={state:a,subscribe:e=>(0,r.B1)(a,()=>e(a)),setThemeMode(e){a.themeMode=e;try{let t=n.a.getAuthConnector();if(t){let i=o.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:i,w3mThemeVariables:(0,s.o)(i,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){a.themeVariables={...a.themeVariables,...e};try{let e=n.a.getAuthConnector();if(e){let t=o.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:(0,s.o)(a.themeVariables,a.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot:()=>(0,r.P9)(a)}},29018:(e,t,i)=>{"use strict";var r=i(18835),s=i(2289),n=s.assert,a=s.cachedProperty,o=s.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=o(t)),Array.isArray(t)&&(n(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),n(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof r&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}a(c,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),a(c,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),a(c,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),a(c,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},30926:(e,t,i)=>{"use strict";i.d(t,{AH:()=>r.AH,JW:()=>r.JW,WF:()=>r.WF,iz:()=>r.iz,qy:()=>r.qy}),i(8325),i(72071);var r=i(81900)},33589:(e,t,i)=>{"use strict";var r=i(18835),s=i(2289),n=s.getNAF,a=s.getJSF,o=s.assert;function c(e,t){this.type=e,this.p=new r(t.p,16),this.red=t.prime?r.red(t.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=t.n&&new r(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,],this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function l(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw Error("Not implemented")},c.prototype.validate=function(){throw Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){o(e.precomputed);var i,r,s=e._getDoubles(),a=n(t,1,this._bitLength),c=(1<<s.step+1)-(s.step%2==0?2:1);c/=3;var l=[];for(i=0;i<a.length;i+=s.step){r=0;for(var d=i+s.step-1;d>=i;d--)r=(r<<1)+a[d];l.push(r)}for(var h=this.jpoint(null,null,null),u=this.jpoint(null,null,null),p=c;p>0;p--){for(i=0;i<l.length;i++)(r=l[i])===p?u=u.mixedAdd(s.points[i]):r===-p&&(u=u.mixedAdd(s.points[i].neg()));h=h.add(u)}return h.toP()},c.prototype._wnafMul=function(e,t){var i=4,r=e._getNAFPoints(i);i=r.wnd;for(var s=r.points,a=n(t,i,this._bitLength),c=this.jpoint(null,null,null),l=a.length-1;l>=0;l--){for(var d=0;l>=0&&0===a[l];l--)d++;if(l>=0&&d++,c=c.dblp(d),l<0)break;var h=a[l];o(0!==h),c="affine"===e.type?h>0?c.mixedAdd(s[h-1>>1]):c.mixedAdd(s[-h-1>>1].neg()):h>0?c.add(s[h-1>>1]):c.add(s[-h-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,i,r,s){var o,c,l,d=this._wnafT1,h=this._wnafT2,u=this._wnafT3,p=0;for(o=0;o<r;o++){var f=(l=t[o])._getNAFPoints(e);d[o]=f.wnd,h[o]=f.points}for(o=r-1;o>=1;o-=2){var g=o-1,y=o;if(1!==d[g]||1!==d[y]){u[g]=n(i[g],d[g],this._bitLength),u[y]=n(i[y],d[y],this._bitLength),p=Math.max(u[g].length,p),p=Math.max(u[y].length,p);continue}var m=[t[g],null,null,t[y]];0===t[g].y.cmp(t[y].y)?(m[1]=t[g].add(t[y]),m[2]=t[g].toJ().mixedAdd(t[y].neg())):0===t[g].y.cmp(t[y].y.redNeg())?(m[1]=t[g].toJ().mixedAdd(t[y]),m[2]=t[g].add(t[y].neg())):(m[1]=t[g].toJ().mixedAdd(t[y]),m[2]=t[g].toJ().mixedAdd(t[y].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],w=a(i[g],i[y]);for(c=0,p=Math.max(w[0].length,p),u[g]=Array(p),u[y]=Array(p);c<p;c++){var v=0|w[0][c],I=0|w[1][c];u[g][c]=b[(v+1)*3+(I+1)],u[y][c]=0,h[g]=m}}var E=this.jpoint(null,null,null),_=this._wnafT4;for(o=p;o>=0;o--){for(var C=0;o>=0;){var A=!0;for(c=0;c<r;c++)_[c]=0|u[c][o],0!==_[c]&&(A=!1);if(!A)break;C++,o--}if(o>=0&&C++,E=E.dblp(C),o<0)break;for(c=0;c<r;c++){var S=_[c];0!==S&&(S>0?l=h[c][S-1>>1]:S<0&&(l=h[c][-S-1>>1].neg()),E="affine"===l.type?E.mixedAdd(l):E.add(l))}}for(o=0;o<r;o++)h[o]=null;return s?E:E.toP()},c.BasePoint=l,l.prototype.eq=function(){throw Error("Not implemented")},l.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=s.toArray(e,t);var i=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*i)return 6===e[0]?o(e[e.length-1]%2==0):7===e[0]&&o(e[e.length-1]%2==1),this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));if((2===e[0]||3===e[0])&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),3===e[0]);throw Error("Unknown point format")},l.prototype.encodeCompressed=function(e){return this.encode(e,!0)},l.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))},l.prototype.encode=function(e,t){return s.encode(this._encode(t),e)},l.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},l.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},l.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],r=this,s=0;s<t;s+=e){for(var n=0;n<e;n++)r=r.dbl();i.push(r)}return{step:e,points:i}},l.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,r=1===i?null:this.dbl(),s=1;s<i;s++)t[s]=t[s-1].add(r);return{wnd:e,points:t}},l.prototype._getBeta=function(){return null},l.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}},34889:(e,t,i)=>{"use strict";var r=i(55775),s=i(38311),n=i(66560);function a(e){if(!(this instanceof a))return new a(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=s.toArray(e.entropy,e.entropyEnc||"hex"),i=s.toArray(e.nonce,e.nonceEnc||"hex"),r=s.toArray(e.pers,e.persEnc||"hex");n(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,i,r)}e.exports=a,a.prototype._init=function(e,t,i){var r=e.concat(t).concat(i);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(r),this._reseed=1,this.reseedInterval=0x1000000000000},a.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},a.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(e,t,i,r){"string"!=typeof t&&(r=i,i=t,t=null),e=s.toArray(e,t),i=s.toArray(i,r),n(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},a.prototype.generate=function(e,t,i,r){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");"string"!=typeof t&&(r=i,i=t,t=null),i&&(i=s.toArray(i,r||"hex"),this._update(i));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var a=n.slice(0,e);return this._update(i),this._reseed++,s.encode(a,t)}},35364:(e,t,i)=>{var r;function s(e){this.rand=e}if(e.exports=function(e){return r||(r=new s(null)),r.generate(e)},e.exports.Rand=s,s.prototype.generate=function(e){return this._rand(e)},s.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(s.prototype._rand=function(){throw Error("Not implemented yet")});else try{var n=i(89780);if("function"!=typeof n.randomBytes)throw Error("Not supported");s.prototype._rand=function(e){return n.randomBytes(e)}}catch(e){}},35597:(e,t,i)=>{"use strict";i.d(t,{A:()=>cm});var r=i(97709),s=i.n(r),n=i(76460),a=i(34691),o=i(23430),c=i(4886),l=Object.defineProperty,d=(e,t,i)=>t in e?l(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,h=(e,t,i)=>d(e,"symbol"!=typeof t?t+"":t,i);class u extends c.H{constructor(e){super(),this.opts=e,h(this,"protocol","wc"),h(this,"version",2)}}var p=Object.defineProperty,f=(e,t,i)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,g=(e,t,i)=>f(e,"symbol"!=typeof t?t+"":t,i);class y extends c.H{constructor(e,t){super(),this.core=e,this.logger=t,g(this,"records",new Map)}}class m{constructor(e,t){this.logger=e,this.core=t}}class b extends c.H{constructor(e,t){super(),this.relayer=e,this.logger=t}}class w extends c.H{constructor(e){super()}}class v{constructor(e,t,i,r){this.core=e,this.logger=t,this.name=i}}var I=Object.defineProperty;class E extends c.H{constructor(e,t){super(),this.relayer=e,this.logger=t}}class _ extends c.H{constructor(e,t){super(),this.core=e,this.logger=t}}class C{constructor(e,t,i){this.core=e,this.logger=t,this.store=i}}class A{constructor(e,t){this.projectId=e,this.logger=t}}class S{constructor(e,t,i){this.core=e,this.logger=t,this.telemetryEnabled=i}}var N=Object.defineProperty,T=(e,t,i)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,x=(e,t,i)=>T(e,"symbol"!=typeof t?t+"":t,i);s();class P{constructor(e){this.opts=e,x(this,"protocol","wc"),x(this,"version",2)}}r.EventEmitter;class O{constructor(e){this.client=e}}var M=i(14421),R=i(29220),k=i(74711),D=i(54969),U=i(92064),L=i(31718),q=i(82336),j=i(89745),$=i(30505),z=i(21415),B=i(99370),H=i(55036),W=i(29155).Buffer;function F(e){let[t,i]=e.split(":");return{namespace:t,reference:i}}function V(e){let[t,i,r]=e.split(":");return{namespace:t,reference:i,address:r}}function K(e,t){return e.includes(":")?[e]:t.chains||[]}let G={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function J(){return"u">typeof H&&"u">typeof H.versions&&"u">typeof H.versions.node}function Y(){return!(0,U.getDocument)()&&!!(0,U.getNavigator)()&&"ReactNative"===navigator.product}function Q(){return!J()&&!!(0,U.getNavigator)()&&!!(0,U.getDocument)()}function X(){return Y()?G.reactNative:J()?G.node:Q()?G.browser:G.unknown}function Z(){var e;try{return Y()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Application)?null==(e=i.g.Application)?void 0:e.applicationId:void 0}catch{return}}function ee(){return(0,L.g)()||{name:"",description:"",url:"",icons:[""]}}function et(e,t,r){let s=function(){if(X()===G.reactNative&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)){let{OS:e,Version:t}=i.g.Platform;return[e,t].join("-")}let e=(0,D.o0)();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),n=function(){var e;let t=X();return t===G.browser?[t,(null==(e=(0,U.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",r].join("-"),s,n].join("/")}function ei(e,t){return e.filter(e=>t.includes(e)).length===e.length}function er(e){return Object.fromEntries(e.entries())}function es(e){return new Map(Object.entries(e))}function en(e=M.FIVE_MINUTES,t){let i,r,s,n,a=(0,M.toMiliseconds)(e||M.FIVE_MINUTES);return{resolve:e=>{s&&i&&(clearTimeout(s),i(e),n=Promise.resolve(e))},reject:e=>{s&&r&&(clearTimeout(s),r(e))},done:()=>new Promise((e,o)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),o(e)},a),i=e,r=o})}}function ea(e,t,i){return new Promise(async(r,s)=>{let n=setTimeout(()=>s(Error(i)),t);try{let t=await e;r(t)}catch(e){s(e)}clearTimeout(n)})}function eo(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function ec(e){let[t,i]=e.split(":"),r={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof i)r.topic=i;else if("id"===t&&Number.isInteger(Number(i)))r.id=Number(i);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${i}`);return r}function el(e,t){return(0,M.fromMiliseconds)((t||Date.now())+(0,M.toMiliseconds)(e))}function ed(e){return Date.now()>=(0,M.toMiliseconds)(e)}function eh(e,t){return`${e}${t?`:${t}`:""}`}function eu(e=[],t=[]){return[...new Set([...e,...t])]}async function ep({id:e,topic:t,wcDeepLink:r}){var s,n;try{if(!r)return;let a="string"==typeof r?JSON.parse(r):r,o=a?.href;if("string"!=typeof o)return;let c=function(e,t,i){let r=`requestId=${t}&sessionTopic=${i}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let i=W.from(e).toString("base64");return t?i.replace(/[=]/g,""):i}(r,!0)}`}else s=`${s}/wc?${r}`;return s}(o,e,t),l=X();if(l===G.browser){let e;if(!(null!=(s=(0,U.getDocument)())&&s.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");n=c,e="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?("u">typeof window&&(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto)||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"):e="_top",window.open(n,e,"noreferrer noopener")}else l===G.reactNative&&"u">typeof(null==i.g?void 0:i.g.Linking)&&await i.g.Linking.openURL(c)}catch(e){console.error(e)}}async function ef(e,t){let i="";try{if(Q()&&(i=localStorage.getItem(t)))return i;i=await e.getItem(t)}catch(e){console.error(e)}return i}function eg(e,t){if(!e.includes(t))return null;let i=e.split(/([&,?,=])/),r=i.indexOf(t);return i[r+2]}function ey(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function em(){return"u">typeof H&&"true"===H.env.IS_VITEST}function eb(e){return W.from(e,"base64").toString("utf-8")}function ew(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function ev(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function eI(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");ew(e.outputLen),ew(e.blockLen)}function eE(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function e_(e,t){ev(e);let i=t.outputLen;if(e.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}let eC=BigInt(0x100000000-1),eA=BigInt(32),eS=(e,t,i)=>e<<i|t>>>32-i,eN=(e,t,i)=>t<<i|e>>>32-i,eT=(e,t,i)=>t<<i-32|e>>>64-i,ex=(e,t,i)=>e<<i-32|t>>>64-i,eP="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function eO(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function eM(e,t){return e<<32-t|e>>>t}let eR=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function ek(e){for(let i=0;i<e.length;i++){var t;e[i]=(t=e[i])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}}function eD(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),ev(e),e}class eU{clone(){return this._cloneInto()}}function eL(e){let t=t=>e().update(eD(t)).digest(),i=e();return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=()=>e(),t}function eq(e=32){if(eP&&"function"==typeof eP.getRandomValues)return eP.getRandomValues(new Uint8Array(e));if(eP&&"function"==typeof eP.randomBytes)return eP.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let ej=[],e$=[],ez=[],eB=BigInt(0),eH=BigInt(1),eW=BigInt(2),eF=BigInt(7),eV=BigInt(256),eK=BigInt(113);for(let e=0,t=eH,i=1,r=0;e<24;e++){[i,r]=[r,(2*i+3*r)%5],ej.push(2*(5*r+i)),e$.push((e+1)*(e+2)/2%64);let s=eB;for(let e=0;e<7;e++)(t=(t<<eH^(t>>eF)*eK)%eV)&eW&&(s^=eH<<(eH<<BigInt(e))-eH);ez.push(s)}let[eG,eJ]=function(e,t=!1){let i=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:a}=function(e,t=!1){return t?{h:Number(e&eC),l:Number(e>>eA&eC)}:{h:0|Number(e>>eA&eC),l:0|Number(e&eC)}}(e[s],t);[i[s],r[s]]=[n,a]}return[i,r]}(ez,!0),eY=(e,t,i)=>i>32?eT(e,t,i):eS(e,t,i),eQ=(e,t,i)=>i>32?ex(e,t,i):eN(e,t,i);class eX extends eU{constructor(e,t,i,r=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=i,this.enableXOF=r,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ew(i),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(this.state)}keccak(){eR||ek(this.state32),function(e,t=24){let i=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)i[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let r=(t+8)%10,s=(t+2)%10,n=i[s],a=i[s+1],o=eY(n,a,1)^i[r],c=eQ(n,a,1)^i[r+1];for(let i=0;i<50;i+=10)e[t+i]^=o,e[t+i+1]^=c}let t=e[2],s=e[3];for(let i=0;i<24;i++){let r=e$[i],n=eY(t,s,r),a=eQ(t,s,r),o=ej[i];t=e[o],s=e[o+1],e[o]=n,e[o+1]=a}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)i[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~i[(r+2)%10]&i[(r+4)%10]}e[0]^=eG[r],e[1]^=eJ[r]}i.fill(0)}(this.state32,this.rounds),eR||ek(this.state32),this.posOut=0,this.pos=0}update(e){eE(this);let{blockLen:t,state:i}=this,r=(e=eD(e)).length;for(let s=0;s<r;){let n=Math.min(t-this.pos,r-s);for(let t=0;t<n;t++)i[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:i,blockLen:r}=this;e[i]^=t,(128&t)!=0&&i===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){eE(this,!1),ev(e),this.finish();let t=this.state,{blockLen:i}=this;for(let r=0,s=e.length;r<s;){this.posOut>=i&&this.keccak();let n=Math.min(i-this.posOut,s-r);e.set(t.subarray(this.posOut,this.posOut+n),r),this.posOut+=n,r+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ew(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(e_(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:i,outputLen:r,rounds:s,enableXOF:n}=this;return e||(e=new eX(t,i,r,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=r,e.enableXOF=n,e.destroyed=this.destroyed,e}}let eZ=eL(()=>new eX(136,1,32));function e0(e){let t=`Ethereum Signed Message:
${e.length}`,i=new TextEncoder().encode(t+e);return"0x"+W.from(eZ(i)).toString("hex")}async function e1(e,t,i,r,s,n){switch(i.t){case"eip191":return await e2(e,t,i.s);case"eip1271":return await e5(e,t,i.s,r,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${i.t}`)}}async function e2(e,t,i){return(await (0,q.x)({hash:e0(t),signature:i})).toLowerCase()===e.toLowerCase()}async function e5(e,t,i,r,s,n){let a=F(r);if(!a.namespace||!a.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{let a="0x1626ba7e",o=i.substring(2),c=e0(t).substring(2),l=a+c+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+o,d=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${r}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:l},"latest"]})}),{result:h}=await d.json();return!!h&&h.slice(0,a.length).toLowerCase()===a.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var e3=Object.defineProperty,e6=Object.defineProperties,e4=Object.getOwnPropertyDescriptors,e8=Object.getOwnPropertySymbols,e9=Object.prototype.hasOwnProperty,e7=Object.prototype.propertyIsEnumerable,te=(e,t,i)=>t in e?e3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,tt=(e,t)=>{for(var i in t||(t={}))e9.call(t,i)&&te(e,i,t[i]);if(e8)for(var i of e8(t))e7.call(t,i)&&te(e,i,t[i]);return e},ti=(e,t)=>e6(e,e4(t));let tr=e=>e?.split(":"),ts=e=>{let t=e&&tr(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},tn=e=>{let t=e&&tr(e);if(t)return t[2]+":"+t[3]},ta=e=>{let t=e&&tr(e);if(t)return t.pop()};async function to(e){let{cacao:t,projectId:i}=e,{s:r,p:s}=t,n=tc(s,s.iss),a=ta(s.iss);return await e1(a,n,r,tn(s.iss),i)}let tc=(e,t)=>{let i=`${e.domain} wants you to sign in with your Ethereum account:`,r=ta(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,o=`Chain ID: ${ts(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,d=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,u=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,f=tf(e.resources);return f&&(s=function(e="",t){tl(t);let i="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(i))return e;let r=[],s=0;Object.keys(t.att).forEach(e=>{let i=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));i.sort((e,t)=>e.action.localeCompare(t.action));let n={};i.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let a=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));r.push(a.join(", ").replace(".,","."))});let n=r.join(" "),a=`${i}${n}`;return`${e?e+" ":""}${a}`}(s,th(f))),[i,r,"",s,"",n,a,o,c,l,d,h,u,p].filter(e=>null!=e).join(`
`)};function tl(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let i=e.att[t];if(Array.isArray(i)||"object"!=typeof i)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(i).length)throw Error(`Resource object is empty: ${t}`);Object.keys(i).forEach(e=>{let t=i[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function td(e){return tl(e),`urn:recap:${W.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function th(e){var t;let i=(t=e.replace("urn:recap:",""),JSON.parse(W.from(t,"base64").toString("utf-8")));return tl(i),i}function tu(e){var t;let i=th(e);tl(i);let r=null==(t=i.att)?void 0:t.eip155;return r?Object.keys(r).map(e=>e.split("/")[1]):[]}function tp(e){let t=th(e);tl(t);let i=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&i.push(e[0].chains)})}),[...new Set(i.flat())]}function tf(e){var t;if(!e)return;let i=e?.[e.length-1];return(t=i)&&t.includes("urn:recap:")?i:void 0}function tg(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function ty(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function tm(e,...t){if(!ty(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function tb(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function tw(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}let tv=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),tI=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function tE(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(ty(e))e=tA(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function t_(e,t,i=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(i&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function tC(e,t,i,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,i,r);let s=BigInt(32),n=BigInt(0xffffffff),a=Number(i>>s&n),o=Number(i&n),c=4*!!r,l=4*!r;e.setUint32(t+c,a,r),e.setUint32(t+l,o,r)}function tA(e){return Uint8Array.from(e)}function tS(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let tN=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),tT=tN("expand 16-byte k"),tx=tN("expand 32-byte k"),tP=tv(tT),tO=tv(tx);function tM(e,t){return e<<t|e>>>32-t}function tR(e){return e.byteOffset%4==0}let tk=0x100000000-1,tD=new Uint32Array,tU=(e,t)=>255&e[t++]|(255&e[t++])<<8;class tL{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tm(e=tE(e),32);let t=tU(e,0),i=tU(e,2),r=tU(e,4),s=tU(e,6),n=tU(e,8),a=tU(e,10),o=tU(e,12),c=tU(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|i<<3)&8191,this.r[2]=(i>>>10|r<<6)&7939,this.r[3]=(r>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=tU(e,16+2*t)}process(e,t,i=!1){let{h:r,r:s}=this,n=s[0],a=s[1],o=s[2],c=s[3],l=s[4],d=s[5],h=s[6],u=s[7],p=s[8],f=s[9],g=tU(e,t+0),y=tU(e,t+2),m=tU(e,t+4),b=tU(e,t+6),w=tU(e,t+8),v=tU(e,t+10),I=tU(e,t+12),E=tU(e,t+14),_=r[0]+(8191&g),C=r[1]+((g>>>13|y<<3)&8191),A=r[2]+((y>>>10|m<<6)&8191),S=r[3]+((m>>>7|b<<9)&8191),N=r[4]+((b>>>4|w<<12)&8191),T=r[5]+(w>>>1&8191),x=r[6]+((w>>>14|v<<2)&8191),P=r[7]+((v>>>11|I<<5)&8191),O=r[8]+((I>>>8|E<<8)&8191),M=r[9]+(E>>>5|2048*!i),R=0,k=0+_*n+5*f*C+5*p*A+5*u*S+5*h*N;R=k>>>13,k&=8191,k+=5*d*T+5*l*x+5*c*P+5*o*O+5*a*M,R+=k>>>13,k&=8191;let D=R+_*a+C*n+5*f*A+5*p*S+5*u*N;R=D>>>13,D&=8191,D+=5*h*T+5*d*x+5*l*P+5*c*O+5*o*M,R+=D>>>13,D&=8191;let U=R+_*o+C*a+A*n+5*f*S+5*p*N;R=U>>>13,U&=8191,U+=5*u*T+5*h*x+5*d*P+5*l*O+5*c*M,R+=U>>>13,U&=8191;let L=R+_*c+C*o+A*a+S*n+5*f*N;R=L>>>13,L&=8191,L+=5*p*T+5*u*x+5*h*P+5*d*O+5*l*M,R+=L>>>13,L&=8191;let q=R+_*l+C*c+A*o+S*a+N*n;R=q>>>13,q&=8191,q+=5*f*T+5*p*x+5*u*P+5*h*O+5*d*M,R+=q>>>13,q&=8191;let j=R+_*d+C*l+A*c+S*o+N*a;R=j>>>13,j&=8191,j+=T*n+5*f*x+5*p*P+5*u*O+5*h*M,R+=j>>>13,j&=8191;let $=R+_*h+C*d+A*l+S*c+N*o;R=$>>>13,$&=8191,$+=T*a+x*n+5*f*P+5*p*O+5*u*M,R+=$>>>13,$&=8191;let z=R+_*u+C*h+A*d+S*l+N*c;R=z>>>13,z&=8191,z+=T*o+x*a+P*n+5*f*O+5*p*M,R+=z>>>13,z&=8191;let B=R+_*p+C*u+A*h+S*d+N*l;R=B>>>13,B&=8191,B+=T*c+x*o+P*a+O*n+5*f*M,R+=B>>>13,B&=8191;let H=R+_*f+C*p+A*u+S*h+N*d;R=H>>>13,H&=8191,H+=T*l+x*c+P*o+O*a+M*n,R+=H>>>13,H&=8191,k=8191&(R=(R=(R<<2)+R|0)+k|0),R>>>=13,D+=R,r[0]=k,r[1]=D,r[2]=U,r[3]=L,r[4]=q,r[5]=j,r[6]=$,r[7]=z,r[8]=B,r[9]=H}finalize(){let{h:e,pad:t}=this,i=new Uint16Array(10),r=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=r,r=e[t]>>>13,e[t]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,i[0]=e[0]+5,r=i[0]>>>13,i[0]&=8191;for(let t=1;t<10;t++)i[t]=e[t]+r,r=i[t]>>>13,i[t]&=8191;i[9]-=8192;let s=(1^r)-1;for(let e=0;e<10;e++)i[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|i[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let i=1;i<8;i++)n=(e[i]+t[i]|0)+(n>>>16)|0,e[i]=65535&n;tS(i)}update(e){tb(this);let{buffer:t,blockLen:i}=this,r=(e=tE(e)).length;for(let s=0;s<r;){let n=Math.min(i-this.pos,r-s);if(n===i){for(;i<=r-s;s+=i)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===i&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){tS(this.h,this.r,this.buffer,this.pad)}digestInto(e){tb(this),function(e,t){tm(e);let i=t.outputLen;if(e.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}(e,this),this.finished=!0;let{buffer:t,h:i}=this,{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=i[t]>>>0,e[s++]=i[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}}let tq=function(e){let t=(t,i)=>e(i).update(tE(t)).digest(),i=e(new Uint8Array(32));return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=t=>e(t),t}(e=>new tL(e)),tj=function(e,t){let{allowShortKeys:i,extendNonceFn:r,counterLength:s,counterRight:n,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return tg(s),tg(a),tw(n),tw(i),(t,o,c,l,d=0)=>{tm(t),tm(o),tm(c);let h=c.length;if(void 0===l&&(l=new Uint8Array(h)),tm(l),tg(d),d<0||d>=tk)throw Error("arx: counter overflow");if(l.length<h)throw Error(`arx: output (${l.length}) is shorter than data (${h})`);let u=[],p=t.length,f,g;if(32===p)u.push(f=tA(t)),g=tO;else if(16===p&&i)(f=new Uint8Array(32)).set(t),f.set(t,16),g=tP,u.push(f);else throw Error(`arx: invalid 32-byte key, got length=${p}`);tR(o)||u.push(o=tA(o));let y=tv(f);if(r){if(24!==o.length)throw Error("arx: extended nonce must be 24 bytes");r(g,y,tv(o.subarray(0,16)),y),o=o.subarray(16)}let m=16-s;if(m!==o.length)throw Error(`arx: nonce must be ${m} or 16 bytes`);if(12!==m){let e=new Uint8Array(12);e.set(o,n?0:12-o.length),o=e,u.push(o)}return function(e,t,i,r,s,n,a,o){let c=s.length,l=new Uint8Array(64),d=tv(l),h=tR(s)&&tR(n),u=h?tv(s):tD,p=h?tv(n):tD;for(let f=0;f<c;a++){if(e(t,i,r,d,a,o),a>=tk)throw Error("arx: counter overflow");let g=Math.min(64,c-f);if(h&&64===g){let e=f/4;if(f%4!=0)throw Error("arx: invalid block position");for(let t=0,i;t<16;t++)p[i=e+t]=u[i]^d[t];f+=64;continue}for(let e=0,t;e<g;e++)n[t=f+e]=s[t]^l[e];f+=g}}(e,g,y,tv(o),c,l,d,a),tS(...u),l}}(function(e,t,i,r,s,n=20){let a=e[0],o=e[1],c=e[2],l=e[3],d=t[0],h=t[1],u=t[2],p=t[3],f=t[4],g=t[5],y=t[6],m=t[7],b=i[0],w=i[1],v=i[2],I=a,E=o,_=c,C=l,A=d,S=h,N=u,T=p,x=f,P=g,O=y,M=m,R=s,k=b,D=w,U=v;for(let e=0;e<n;e+=2)x=x+(R=tM(R^(I=I+A|0),16))|0,I=I+(A=tM(A^x,12))|0,x=x+(R=tM(R^I,8))|0,A=tM(A^x,7),P=P+(k=tM(k^(E=E+S|0),16))|0,E=E+(S=tM(S^P,12))|0,P=P+(k=tM(k^E,8))|0,S=tM(S^P,7),O=O+(D=tM(D^(_=_+N|0),16))|0,_=_+(N=tM(N^O,12))|0,O=O+(D=tM(D^_,8))|0,N=tM(N^O,7),M=M+(U=tM(U^(C=C+T|0),16))|0,C=C+(T=tM(T^M,12))|0,M=M+(U=tM(U^C,8))|0,T=tM(T^M,7),O=O+(U=tM(U^(I=I+S|0),16))|0,I=I+(S=tM(S^O,12))|0,O=O+(U=tM(U^I,8))|0,S=tM(S^O,7),M=M+(R=tM(R^(E=E+N|0),16))|0,E=E+(N=tM(N^M,12))|0,M=M+(R=tM(R^E,8))|0,N=tM(N^M,7),x=x+(k=tM(k^(_=_+T|0),16))|0,_=_+(T=tM(T^x,12))|0,x=x+(k=tM(k^_,8))|0,T=tM(T^x,7),P=P+(D=tM(D^(C=C+A|0),16))|0,C=C+(A=tM(A^P,12))|0,P=P+(D=tM(D^C,8))|0,A=tM(A^P,7);let L=0;r[L++]=a+I|0,r[L++]=o+E|0,r[L++]=c+_|0,r[L++]=l+C|0,r[L++]=d+A|0,r[L++]=h+S|0,r[L++]=u+N|0,r[L++]=p+T|0,r[L++]=f+x|0,r[L++]=g+P|0,r[L++]=y+O|0,r[L++]=m+M|0,r[L++]=s+R|0,r[L++]=b+k|0,r[L++]=w+D|0,r[L++]=v+U|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),t$=new Uint8Array(16),tz=(e,t)=>{e.update(t);let i=t.length%16;i&&e.update(t$.subarray(i))},tB=new Uint8Array(32);function tH(e,t,i,r,s){let n=e(t,i,tB),a=tq.create(n);s&&tz(a,s),tz(a,r);let o=new Uint8Array(16),c=tI(o);tC(c,0,BigInt(s?s.length:0),!0),tC(c,8,BigInt(r.length),!0),a.update(o);let l=a.digest();return tS(n,o),l}let tW=((e,t)=>{function i(r,...s){if(tm(r),void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?tm(t):tm(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&tm(s[1]);let a=t(r,...s),o=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");tm(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,tm(e),o(a.encrypt.length,t),a.encrypt(e,t)},decrypt(e,t){if(tm(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return o(a.decrypt.length,t),a.decrypt(e,t)}}}return Object.assign(i,e),i})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,i,r)=>({encrypt(s,n){let a=s.length;(n=t_(a+16,n,!1)).set(s);let o=n.subarray(0,-16);e(t,i,o,o,1);let c=tH(e,t,i,o,r);return n.set(c,a),tS(c),n},decrypt(s,n){n=t_(s.length-16,n,!1);let a=s.subarray(0,-16),o=s.subarray(-16),c=tH(e,t,i,a,r);if(!function(e,t){if(e.length!==t.length)return!1;let i=0;for(let r=0;r<e.length;r++)i|=e[r]^t[r];return 0===i}(o,c))throw Error("invalid tag");return n.set(s.subarray(0,-16)),e(t,i,n,n,1),tS(c),n}}))(tj));class tF extends eU{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,eI(e);let i=eD(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let r=this.blockLen,s=new Uint8Array(r);s.set(i.length>r?e.create().update(i).digest():i);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return eE(this),this.iHash.update(e),this}digestInto(e){eE(this),ev(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:i,finished:r,destroyed:s,blockLen:n,outputLen:a}=this;return e.finished=r,e.destroyed=s,e.blockLen=n,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let tV=(e,t,i)=>new tF(e,t).update(i).digest();tV.create=(e,t)=>new tF(e,t);let tK=new Uint8Array([0]),tG=new Uint8Array,tJ=(e,t,i,r,s)=>(function(e,t,i,r=32){if(eI(e),ew(r),r>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(r/e.outputLen);void 0===i&&(i=tG);let n=new Uint8Array(s*e.outputLen),a=tV.create(e,t),o=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let t=0;t<s;t++)tK[0]=t+1,o.update(0===t?tG:c).update(i).update(tK).digestInto(c),n.set(c,e.outputLen*t),a._cloneInto(o);return a.destroy(),o.destroy(),c.fill(0),tK.fill(0),n.slice(0,r)})(e,function(e,t,i){return eI(e),void 0===i&&(i=new Uint8Array(e.outputLen)),tV(e,eD(i),eD(t))}(e,t,i),r,s);class tY extends eU{constructor(e,t,i,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=i,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=eO(this.buffer)}update(e){eE(this);let{view:t,buffer:i,blockLen:r}=this,s=(e=eD(e)).length;for(let n=0;n<s;){let a=Math.min(r-this.pos,s-n);if(a===r){let t=eO(e);for(;r<=s-n;n+=r)this.process(t,n);continue}i.set(e.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){eE(this),e_(e,this),this.finished=!0;let{buffer:t,view:i,blockLen:r,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>r-n&&(this.process(i,0),n=0);for(let e=n;e<r;e++)t[e]=0;(function(e,t,i,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,i,r);let s=BigInt(32),n=BigInt(0xffffffff),a=Number(i>>s&n),o=Number(i&n),c=4*!!r,l=4*!r;e.setUint32(t+c,a,r),e.setUint32(t+l,o,r)})(i,r-8,BigInt(8*this.length),s),this.process(i,0);let a=eO(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=o/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:i,length:r,finished:s,destroyed:n,pos:a}=this;return e.length=r,e.pos=a,e.finished=s,e.destroyed=n,r%t&&e.buffer.set(i),e}}let tQ=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),tX=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),tZ=new Uint32Array(64);class t0 extends tY{constructor(){super(64,32,8,!1),this.A=0|tX[0],this.B=0|tX[1],this.C=0|tX[2],this.D=0|tX[3],this.E=0|tX[4],this.F=0|tX[5],this.G=0|tX[6],this.H=0|tX[7]}get(){let{A:e,B:t,C:i,D:r,E:s,F:n,G:a,H:o}=this;return[e,t,i,r,s,n,a,o]}set(e,t,i,r,s,n,a,o){this.A=0|e,this.B=0|t,this.C=0|i,this.D=0|r,this.E=0|s,this.F=0|n,this.G=0|a,this.H=0|o}process(e,t){for(let i=0;i<16;i++,t+=4)tZ[i]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=tZ[e-15],i=tZ[e-2],r=eM(t,7)^eM(t,18)^t>>>3,s=eM(i,17)^eM(i,19)^i>>>10;tZ[e]=s+tZ[e-7]+r+tZ[e-16]|0}let{A:i,B:r,C:s,D:n,E:a,F:o,G:c,H:l}=this;for(let e=0;e<64;e++){var d,h,u,p;let t=l+(eM(a,6)^eM(a,11)^eM(a,25))+((d=a)&o^~d&c)+tQ[e]+tZ[e]|0,f=(eM(i,2)^eM(i,13)^eM(i,22))+((h=i)&(u=r)^h&(p=s)^u&p)|0;l=c,c=o,o=a,a=n+t|0,n=s,s=r,r=i,i=t+f|0}i=i+this.A|0,r=r+this.B|0,s=s+this.C|0,n=n+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(i,r,s,n,a,o,c,l)}roundClean(){tZ.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let t1=eL(()=>new t0),t2=BigInt(0);function t5(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function t3(e){if(!t5(e))throw Error("Uint8Array expected")}let t6=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),t4={_0:48,_9:57,A:65,F:70,a:97,f:102};function t8(e){return e>=t4._0&&e<=t4._9?e-t4._0:e>=t4.A&&e<=t4.F?e-(t4.A-10):e>=t4.a&&e<=t4.f?e-(t4.a-10):void 0}function t9(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,i=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(i);for(let t=0,s=0;t<i;t++,s+=2){let i=t8(e.charCodeAt(s)),n=t8(e.charCodeAt(s+1));if(void 0===i||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);r[t]=16*i+n}return r}function t7(e){return t3(e),function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?t2:BigInt("0x"+e)}(function(e){t3(e);let t="";for(let i=0;i<e.length;i++)t+=t6[e[i]];return t}(Uint8Array.from(e).reverse()))}function ie(e,t,i){let r;if("string"==typeof t)try{r=t9(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(t5(t))r=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=r.length;if("number"==typeof i&&s!==i)throw Error(e+" of length "+i+" expected, got "+s);return r}let it=e=>"bigint"==typeof e&&t2<=e;function ii(e,t,i,r){if(!(it(t)&&it(i)&&it(r))||!(i<=t)||!(t<r))throw Error("expected valid "+e+": "+i+" <= n < "+r+", got "+t)}let ir={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||t5(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)},is=BigInt(0),ia=BigInt(1);function io(e,t){let i=e%t;return i>=is?i:t+i}function ic(e,t,i){let r=e;for(;t-- >is;)r*=r,r%=i;return r}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);let il=BigInt(0),id=BigInt(1),ih=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let iu=BigInt(1),ip=BigInt(2),ig=BigInt(3),iy=BigInt(5);BigInt(8);let im=function(e){let t=(function(e,t,i={}){let r=(t,i,r)=>{let s=ir[i];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(r&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+i+", got "+n)};for(let[e,i]of Object.entries(t))r(e,i,!1);for(let[e,t]of Object.entries(i))r(e,t,!0)}(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:i}=t,r=e=>io(e,i),s=t.montgomeryBits,n=Math.ceil(s/8),a=t.nByteLength,o=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>(function(e,t,i){if(t<is)throw Error("invalid exponent, negatives unsupported");if(i<=is)throw Error("invalid modulus");if(i===ia)return is;let r=ia;for(;t>is;)t&ia&&(r=r*e%i),e=e*e%i,t>>=ia;return r})(e,i-BigInt(2),i));function l(e,t,i){let s=r(e*(t-i));return[t=r(t-s),i=r(i+s)]}let d=(t.a-BigInt(2))/BigInt(4);function h(e){var t;return t=r(e),t9(t.toString(16).padStart(2*n,"0")).reverse()}function u(e,t){let u=function(e,t){ii("u",e,il,i),ii("scalar",t,il,i);let n=id,a=il,o=e,h=id,u=il,p;for(let i=BigInt(s-1);i>=il;i--){let s=t>>i&id;u^=s,n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,h))[0],h=p[1],u=s;let c=n+a,f=r(c*c),g=n-a,y=r(g*g),m=f-y,b=o+h,w=r((o-h)*c),v=r(b*g),I=w+v,E=w-v;o=r(I*I),h=r(e*r(E*E)),n=r(f*y),a=r(m*(f+r(d*m)))}return n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,h))[0],h=p[1],r(n*c(a))}(function(e){let t=ie("u coordinate",e,n);return 32===a&&(t[31]&=127),t7(t)}(t),function(e){let t=ie("scalar",e),i=t.length;if(i!==n&&i!==a)throw Error("invalid scalar, expected "+(""+n+" or ")+a+" bytes, got "+i);return t7(o(t))}(e));if(u===il)throw Error("invalid private or public key received");return h(u)}let p=h(t.Gu);function f(e){return u(e,p)}return{scalarMult:u,scalarMultBase:f,getSharedSecret:(e,t)=>u(e,t),getPublicKey:e=>f(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:p}}({P:ih,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:i}=function(e){let t=BigInt(10),i=BigInt(20),r=BigInt(40),s=BigInt(80),n=e*e%ih*e%ih,a=ic(n,ip,ih)*n%ih,o=ic(a,iu,ih)*e%ih,c=ic(o,iy,ih)*o%ih,l=ic(c,t,ih)*c%ih,d=ic(l,i,ih)*l%ih,h=ic(d,r,ih)*d%ih,u=ic(h,s,ih)*h%ih,p=ic(u,s,ih)*h%ih,f=ic(p,t,ih)*c%ih;return{pow_p_5_8:ic(f,ip,ih)*e%ih,b2:n}}(e);return io(ic(t,ig,ih)*i,ih)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:eq}),ib="base10",iw="base16",iv="base64pad",iI="base64url",iE="utf8";function i_(){let e=eq(32);return(0,$.dI)(e,iw)}function iC(e){let t=t1((0,$.sH)(e,iw));return(0,$.dI)(t,iw)}function iA(e){let t=t1((0,$.sH)(e,iE));return(0,$.dI)(t,iw)}function iS(e){return(0,$.sH)(`${e}`,ib)}function iN(e){return Number((0,$.dI)(e,ib))}function iT(e){let{encoding:t=iv}=e;if(2===iN(e.type))return(0,$.dI)((0,$.xW)([e.type,e.sealed]),t);if(1===iN(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,$.dI)((0,$.xW)([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return(0,$.dI)((0,$.xW)([e.type,e.iv,e.sealed]),t)}function ix(e){let{encoded:t,encoding:i=iv}=e,r=(0,$.sH)(t,i),s=r.slice(0,1);if(1===iN(s)){let e=r.slice(1,33),t=r.slice(33,45);return{type:s,sealed:r.slice(45),iv:t,senderPublicKey:e}}if(2===iN(s))return{type:s,sealed:r.slice(1),iv:eq(12)};let n=r.slice(1,13);return{type:s,sealed:r.slice(13),iv:n}}function iP(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function iO(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function iM(e){return e?.relay||{protocol:"irn"}}function iR(e){let t=B.CG[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}function ik(e){var t;if(!e.includes("wc:")){let t=eb(e);null!=t&&t.includes("wc:")&&(e=t)}let i=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,i),n=e.substring(i+1,r).split("@"),a=new URLSearchParams("u">typeof r?e.substring(r):""),o={};a.forEach((e,t)=>{o[t]=e});let c="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:o.symKey,relay:function(e,t="-"){let i={},r="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(r)){let s=t.replace(r,""),n=e[t];i[s]=n}}),i}(o),methods:c,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function iD(e){let t=new URLSearchParams,i=function(e,t="-"){let i={};return Object.keys(e).forEach(r=>{e[r]&&(i["relay"+t+r]=e[r])}),i}(e.relay);Object.keys(i).sort().forEach(e=>{t.set(e,i[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));let r=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${r}`}function iU(e,t,i){return`${e}?wc_ev=${i}&topic=${t}`}var iL=Object.defineProperty,iq=Object.defineProperties,ij=Object.getOwnPropertyDescriptors,i$=Object.getOwnPropertySymbols,iz=Object.prototype.hasOwnProperty,iB=Object.prototype.propertyIsEnumerable,iH=(e,t,i)=>t in e?iL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,iW=(e,t)=>{for(var i in t||(t={}))iz.call(t,i)&&iH(e,i,t[i]);if(i$)for(var i of i$(t))iB.call(t,i)&&iH(e,i,t[i]);return e},iF=(e,t)=>iq(e,ij(t));function iV(e){let t=[];return e.forEach(e=>{let[i,r]=e.split(":");t.push(`${i}:${r}`)}),t}function iK(e){return e.includes(":")}function iG(e){return iK(e)?e.split(":")[0]:e}function iJ(e,t){let i=function(e){let t={};return e?.forEach(e=>{var i;let[r,s]=e.split(":");t[r]||(t[r]={accounts:[],chains:[],events:[],methods:[]}),t[r].accounts.push(e),null==(i=t[r].chains)||i.push(`${r}:${s}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,r]of Object.entries(i))r.methods?r.methods=eu(r.methods,e):r.methods=e,r.events=["chainChanged","accountsChanged"];return i}let iY={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},iQ={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function iX(e,t){let{message:i,code:r}=iQ[e];return{message:t?`${i} ${t}`:i,code:r}}function iZ(e,t){let{message:i,code:r}=iY[e];return{message:t?`${i} ${t}`:i,code:r}}function i0(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function i1(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function i2(e){return typeof e>"u"}function i5(e,t){return!!(t&&i2(e))||"string"==typeof e&&!!e.trim().length}function i3(e,t){return!!(t&&i2(e))||"number"==typeof e&&!isNaN(e)}function i6(e){return!!(i5(e,!1)&&e.includes(":"))&&2===e.split(":").length}function i4(e){let t=!0;return i0(e)?e.length&&(t=e.every(e=>i5(e,!1))):t=!1,t}function i8(e,t){let i=null;return Object.values(e).forEach(e=>{var r;let s;if(i)return;let n=(r=`${t}, namespace`,s=null,i4(e?.methods)?i4(e?.events)||(s=iZ("UNSUPPORTED_EVENTS",`${r}, events should be an array of strings or empty array for no events`)):s=iZ("UNSUPPORTED_METHODS",`${r}, methods should be an array of strings or empty array for no methods`),s);n&&(i=n)}),i}function i9(e,t){let i=null;if(e&&i1(e)){let r,s=i8(e,t);s&&(i=s);let n=(r=null,Object.values(e).forEach(e=>{var i,s;let n;if(r)return;let a=(i=e?.accounts,s=`${t} namespace`,n=null,i0(i)?i.forEach(e=>{n||function(e){if(i5(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&i6(e)}}return!1}(e)||(n=iZ("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=iZ("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);a&&(r=a)}),r);n&&(i=n)}else i=iX("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return i}function i7(e){return i5(e.protocol,!0)}function re(e){return"u">typeof e}function rt(e,t){return!(!i6(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...iV(e.accounts))}),t})(e).includes(t))}function ri(e,t,i){let r=null,s=function(e){let t={};return Object.keys(e).forEach(i=>{var r;i.includes(":")?t[i]=e[i]:null==(r=e[i].chains)||r.forEach(r=>{t[r]={methods:e[i].methods,events:e[i].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(i=>{if(i.includes(":"))t[i]=e[i];else{let r=iV(e[i].accounts);r?.forEach(r=>{t[r]={accounts:e[i].accounts.filter(e=>e.includes(`${r}:`)),methods:e[i].methods,events:e[i].events}})}}),t}(t),a=Object.keys(s),o=Object.keys(n),c=rr(Object.keys(e)),l=rr(Object.keys(t)),d=c.filter(e=>!l.includes(e));return d.length&&(r=iX("NON_CONFORMING_NAMESPACES",`${i} namespaces keys don't satisfy requiredNamespaces.
      Required: ${d.toString()}
      Received: ${Object.keys(t).toString()}`)),ei(a,o)||(r=iX("NON_CONFORMING_NAMESPACES",`${i} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${o.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||r)return;let s=iV(t[e].accounts);s.includes(e)||(r=iX("NON_CONFORMING_NAMESPACES",`${i} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),a.forEach(e=>{r||(ei(s[e].methods,n[e].methods)?ei(s[e].events,n[e].events)||(r=iX("NON_CONFORMING_NAMESPACES",`${i} namespaces events don't satisfy namespace events for ${e}`)):r=iX("NON_CONFORMING_NAMESPACES",`${i} namespaces methods don't satisfy namespace methods for ${e}`))}),r}function rr(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function rs(){let e=X();return new Promise(t=>{switch(e){case G.browser:t(Q()&&navigator?.onLine);break;case G.reactNative:t(rn());break;case G.node:default:t(!0)}})}async function rn(){if(Y()&&"u">typeof i.g&&null!=i.g&&i.g.NetInfo){let e=await (null==i.g?void 0:i.g.NetInfo.fetch());return e?.isConnected}return!0}let ra={};class ro{static get(e){return ra[e]}static set(e,t){ra[e]=t}static delete(e){delete ra[e]}}var rc=i(41737),rl=i(13990),rd=i(77185),rh=i(29155).Buffer;let ru="core",rp=`wc@2:${ru}:`,rf={logger:"error"},rg={database:":memory:"},ry="client_ed25519_seed",rm=M.ONE_DAY,rb=M.SIX_HOURS,rw="wss://relay.walletconnect.org",rv={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},rI={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},rE="2.19.1",r_={link_mode:"link_mode",relay:"relay"},rC={inbound:"inbound",outbound:"outbound"},rA="WALLETCONNECT_LINK_MODE_APPS",rS={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},rN=(M.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:M.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:M.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:M.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:M.ONE_DAY,prompt:!1,tag:0},res:{ttl:M.ONE_DAY,prompt:!1,tag:0}}}),rT={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},rx={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},rP={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},rO="https://verify.walletconnect.org",rM=`${rO}/v3`,rR=["https://verify.walletconnect.com",rO],rk={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},rD={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},rU={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},rL={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},rq={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},rj={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var r$=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var i=new Uint8Array(256),r=0;r<i.length;r++)i[r]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),a=n.charCodeAt(0);if(255!==i[a])throw TypeError(n+" is ambiguous");i[a]=s}var o=e.length,c=e.charAt(0),l=Math.log(o)/Math.log(256),d=Math.log(256)/Math.log(o);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var r=0,s=0;e[t]===c;)r++,t++;for(var n=(e.length-t)*l+1>>>0,a=new Uint8Array(n);e[t];){var d=i[e.charCodeAt(t)];if(255===d)return;for(var h=0,u=n-1;(0!==d||h<s)&&-1!==u;u--,h++)d+=o*a[u]>>>0,a[u]=d%256>>>0,d=d/256>>>0;if(0!==d)throw Error("Non-zero carry");s=h,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===a[p];)p++;for(var f=new Uint8Array(r+(n-p)),g=r;p!==n;)f[g++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var i=0,r=0,s=0,n=t.length;s!==n&&0===t[s];)s++,i++;for(var a=(n-s)*d+1>>>0,l=new Uint8Array(a);s!==n;){for(var h=t[s],u=0,p=a-1;(0!==h||u<r)&&-1!==p;p--,u++)h+=256*l[p]>>>0,l[p]=h%o>>>0,h=h/o>>>0;if(0!==h)throw Error("Non-zero carry");r=u,s++}for(var f=a-r;f!==a&&0===l[f];)f++;for(var g=c.repeat(i);f<a;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:h,decode:function(e){var i=h(e);if(i)return i;throw Error(`Non-${t} character`)}}};let rz=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},rB=e=>new TextEncoder().encode(e),rH=e=>new TextDecoder().decode(e);class rW{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class rF{constructor(e,t,i){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return rK(this,e)}}class rV{constructor(e){this.decoders=e}or(e){return rK(this,e)}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let rK=(e,t)=>new rV({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class rG{constructor(e,t,i,r){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=r,this.encoder=new rW(e,t,i),this.decoder=new rF(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let rJ=({name:e,prefix:t,encode:i,decode:r})=>new rG(e,t,i,r),rY=({prefix:e,name:t,alphabet:i})=>{let{encode:r,decode:s}=r$(i,t);return rJ({prefix:e,name:t,encode:r,decode:e=>rz(s(e))})},rQ=(e,t,i,r)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let a=new Uint8Array(n*i/8|0),o=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${r} character`);c=c<<i|n,(o+=i)>=8&&(o-=8,a[l++]=255&c>>o)}if(o>=i||255&c<<8-o)throw SyntaxError("Unexpected end of data");return a},rX=(e,t,i)=>{let r="="===t[t.length-1],s=(1<<i)-1,n="",a=0,o=0;for(let r=0;r<e.length;++r)for(o=o<<8|e[r],a+=8;a>i;)a-=i,n+=t[s&o>>a];if(a&&(n+=t[s&o<<i-a]),r)for(;n.length*i&7;)n+="=";return n},rZ=({name:e,prefix:t,bitsPerChar:i,alphabet:r})=>rJ({prefix:t,name:e,encode:e=>rX(e,r,i),decode:t=>rQ(t,r,i,e)});var r0=Object.freeze({__proto__:null,identity:rJ({prefix:"\0",name:"identity",encode:e=>rH(e),decode:e=>rB(e)})}),r1=Object.freeze({__proto__:null,base2:rZ({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),r2=Object.freeze({__proto__:null,base8:rZ({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),r5=Object.freeze({__proto__:null,base10:rY({prefix:"9",name:"base10",alphabet:"0123456789"})}),r3=Object.freeze({__proto__:null,base16:rZ({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:rZ({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let r6=rZ({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),r4=rZ({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),r8=rZ({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),r9=rZ({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),r7=rZ({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),se=rZ({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),st=rZ({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var si=Object.freeze({__proto__:null,base32:r6,base32upper:r4,base32pad:r8,base32padupper:r9,base32hex:r7,base32hexupper:se,base32hexpad:st,base32hexpadupper:rZ({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:rZ({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),sr=Object.freeze({__proto__:null,base36:rY({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:rY({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),ss=Object.freeze({__proto__:null,base58btc:rY({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:rY({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let sn=rZ({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sa=rZ({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var so=Object.freeze({__proto__:null,base64:sn,base64pad:sa,base64url:rZ({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:rZ({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let sc=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),sl=sc.reduce((e,t,i)=>(e[i]=t,e),[]),sd=sc.reduce((e,t,i)=>(e[t.codePointAt(0)]=i,e),[]);var sh=Object.freeze({__proto__:null,base256emoji:rJ({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=sl[t],"")},decode:function(e){let t=[];for(let i of e){let e=sd[i.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${i}`);t.push(e)}return new Uint8Array(t)}})});function su(e,t,i){t=t||[],i=i||0;for(var r=i;e>=0x80000000;)t[i++]=255&e|128,e/=128;for(;-128&e;)t[i++]=255&e|128,e>>>=7;return t[i]=0|e,su.bytes=i-r+1,t}function sp(e,t){var i,r=0,t=t||0,s=0,n=t,a=e.length;do{if(n>=a)throw sp.bytes=0,RangeError("Could not decode varint");i=e[n++],r+=s<28?(127&i)<<s:(127&i)*Math.pow(2,s),s+=7}while(i>=128);return sp.bytes=n-t,r}var sf={encode:su,encodingLength:function(e){return e<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:e<0x800000000?5:e<0x40000000000?6:e<0x2000000000000?7:e<0x100000000000000?8:e<0x8000000000000000?9:10}};let sg=(e,t,i=0)=>(sf.encode(e,t,i),t),sy=e=>sf.encodingLength(e),sm=(e,t)=>{let i=t.byteLength,r=sy(e),s=r+sy(i),n=new Uint8Array(s+i);return sg(e,n,0),sg(i,n,r),n.set(t,s),new sb(e,i,t,n)};class sb{constructor(e,t,i,r){this.code=e,this.size=t,this.digest=i,this.bytes=r}}let sw=({name:e,code:t,encode:i})=>new sv(e,t,i);class sv{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?sm(this.code,t):t.then(e=>sm(this.code,e))}throw Error("Unknown type, must be binary type")}}let sI=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var sE=Object.freeze({__proto__:null,sha256:sw({name:"sha2-256",code:18,encode:sI("SHA-256")}),sha512:sw({name:"sha2-512",code:19,encode:sI("SHA-512")})}),s_=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:rz,digest:e=>sm(0,rz(e))}});new TextEncoder,new TextDecoder;let sC={...r0,...r1,...r2,...r5,...r3,...si,...sr,...ss,...so,...sh};function sA(e,t,i,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:i},decoder:{decode:r}}}({...sE,...s_});let sS=sA("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),sN=sA("ascii","a",e=>{let t="a";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}),sT={utf8:sS,"utf-8":sS,hex:sC.base16,latin1:sN,ascii:sN,binary:sN,...sC};var sx=Object.defineProperty,sP=(e,t,i)=>t in e?sx(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sO=(e,t,i)=>sP(e,"symbol"!=typeof t?t+"":t,i);class sM{constructor(e,t){this.core=e,this.logger=t,sO(this,"keychain",new Map),sO(this,"name","keychain"),sO(this,"version","0.3"),sO(this,"initialized",!1),sO(this,"storagePrefix",rp),sO(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),sO(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),sO(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),sO(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=iX("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),sO(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,o.U5)(t,this.name)}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,er(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?es(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var sR=Object.defineProperty,sk=(e,t,i)=>t in e?sR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sD=(e,t,i)=>sk(e,"symbol"!=typeof t?t+"":t,i);class sU{constructor(e,t,i){this.core=e,this.logger=t,sD(this,"name","crypto"),sD(this,"keychain"),sD(this,"randomSessionIdentifier",i_()),sD(this,"initialized",!1),sD(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),sD(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),sD(this,"getClientId",async()=>{this.isInitialized();let e=await this.getClientSeed(),t=k.TZ(e);return k.UF(t.publicKey)}),sD(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=im.utils.randomPrivateKey(),t=im.getPublicKey(e);return{privateKey:(0,$.dI)(e,iw),publicKey:(0,$.dI)(t,iw)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),sD(this,"signJWT",async e=>{this.isInitialized();let t=await this.getClientSeed(),i=k.TZ(t),r=this.randomSessionIdentifier;return await k.FA(r,e,rm,i)}),sD(this,"generateSharedKey",(e,t,i)=>{this.isInitialized();let r=function(e,t){let i=tJ(t1,im.getSharedSecret((0,$.sH)(e,iw),(0,$.sH)(t,iw)),void 0,void 0,32);return(0,$.dI)(i,iw)}(this.getPrivateKey(e),t);return this.setSymKey(r,i)}),sD(this,"setSymKey",async(e,t)=>{this.isInitialized();let i=t||iC(e);return await this.keychain.set(i,e),i}),sD(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),sD(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),sD(this,"encode",async(e,t,i)=>{this.isInitialized();let r=iP(i),s=(0,R.h)(t);if(2===r.type)return function(e,t){let i=iS(2),r=eq(12);return iT({type:i,sealed:(0,$.sH)(e,iE),iv:r,encoding:t})}(s,i?.encoding);if(iO(r)){let t=r.senderPublicKey,i=r.receiverPublicKey;e=await this.generateSharedKey(t,i)}let n=this.getSymKey(e),{type:a,senderPublicKey:o}=r;return function(e){let t=iS("u">typeof e.type?e.type:0);if(1===iN(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let i="u">typeof e.senderPublicKey?(0,$.sH)(e.senderPublicKey,iw):void 0,r="u">typeof e.iv?(0,$.sH)(e.iv,iw):eq(12);return iT({type:t,sealed:tW((0,$.sH)(e.symKey,iw),r).encrypt((0,$.sH)(e.message,iE)),iv:r,senderPublicKey:i,encoding:e.encoding})}({type:a,symKey:n,message:s,senderPublicKey:o,encoding:i?.encoding})}),sD(this,"decode",async(e,t,i)=>{this.isInitialized();let r=function(e,t){let i=ix({encoded:e,encoding:t?.encoding});return iP({type:iN(i.type),senderPublicKey:"u">typeof i.senderPublicKey?(0,$.dI)(i.senderPublicKey,iw):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,i);if(2===r.type){let e=function(e,t){let{sealed:i}=ix({encoded:e,encoding:t});return(0,$.dI)(i,iE)}(t,i?.encoding);return(0,R.j)(e)}if(iO(r)){let t=r.receiverPublicKey,i=r.senderPublicKey;e=await this.generateSharedKey(t,i)}try{let r=this.getSymKey(e),s=function(e){let t=(0,$.sH)(e.symKey,iw),{sealed:i,iv:r}=ix(e),s=tW(t,r).decrypt(i);if(null===s)throw Error("Failed to decrypt");return(0,$.dI)(s,iE)}({symKey:r,encoded:t,encoding:i?.encoding});return(0,R.j)(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),sD(this,"getPayloadType",(e,t=iv)=>iN(ix({encoded:e,encoding:t}).type)),sD(this,"getPayloadSenderPublicKey",(e,t=iv)=>{let i=ix({encoded:e,encoding:t});return i.senderPublicKey?(0,$.dI)(i.senderPublicKey,iw):void 0}),this.core=e,this.logger=(0,o.U5)(t,this.name),this.keychain=i||new sM(this.core,this.logger)}get context(){return(0,o.oI)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(ry)}catch{e=i_(),await this.keychain.set(ry,e)}return function(e,t="utf8"){let i=sT[t];if(!i)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):i.decoder.decode(`${i.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var sL=Object.defineProperty,sq=Object.defineProperties,sj=Object.getOwnPropertyDescriptors,s$=Object.getOwnPropertySymbols,sz=Object.prototype.hasOwnProperty,sB=Object.prototype.propertyIsEnumerable,sH=(e,t,i)=>t in e?sL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sW=(e,t)=>{for(var i in t||(t={}))sz.call(t,i)&&sH(e,i,t[i]);if(s$)for(var i of s$(t))sB.call(t,i)&&sH(e,i,t[i]);return e},sF=(e,t)=>sq(e,sj(t)),sV=(e,t,i)=>sH(e,"symbol"!=typeof t?t+"":t,i);class sK extends m{constructor(e,t){super(e,t),this.logger=e,this.core=t,sV(this,"messages",new Map),sV(this,"messagesWithoutClientAck",new Map),sV(this,"name","messages"),sV(this,"version","0.3"),sV(this,"initialized",!1),sV(this,"storagePrefix",rp),sV(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),sV(this,"set",async(e,t,i)=>{this.isInitialized();let r=iA(t),s=this.messages.get(e);if(typeof s>"u"&&(s={}),"u">typeof s[r])return r;if(s[r]=t,this.messages.set(e,s),i===rC.inbound){let i=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,sF(sW({},i),{[r]:t}))}return await this.persist(),r}),sV(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),sV(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let i of e){let e=this.messagesWithoutClientAck.get(i)||{};t[i]=Object.values(e)}return t}),sV(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[iA(t)])),sV(this,"ack",async(e,t)=>{this.isInitialized();let i=this.messagesWithoutClientAck.get(e);if(typeof i>"u")return;let r=iA(t);delete i[r],0===Object.keys(i).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,i),await this.persist()}),sV(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=(0,o.U5)(e,this.name),this.core=t}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,er(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,er(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?es(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?es(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var sG=Object.defineProperty,sJ=Object.defineProperties,sY=Object.getOwnPropertyDescriptors,sQ=Object.getOwnPropertySymbols,sX=Object.prototype.hasOwnProperty,sZ=Object.prototype.propertyIsEnumerable,s0=(e,t,i)=>t in e?sG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,s1=(e,t)=>{for(var i in t||(t={}))sX.call(t,i)&&s0(e,i,t[i]);if(sQ)for(var i of sQ(t))sZ.call(t,i)&&s0(e,i,t[i]);return e},s2=(e,t)=>sJ(e,sY(t)),s5=(e,t,i)=>s0(e,"symbol"!=typeof t?t+"":t,i);class s3 extends b{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,s5(this,"events",new r.EventEmitter),s5(this,"name","publisher"),s5(this,"queue",new Map),s5(this,"publishTimeout",(0,M.toMiliseconds)(M.ONE_MINUTE)),s5(this,"initialPublishTimeout",(0,M.toMiliseconds)(15*M.ONE_SECOND)),s5(this,"needsTransportRestart",!1),s5(this,"publish",async(e,t,i)=>{var r;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:i}});let s=i?.ttl||rb,n=iM(i),a=i?.prompt||!1,o=i?.tag||0,c=i?.id||(0,rl.getBigIntRpcId)().toString(),l={topic:e,message:t,opts:{ttl:s,relay:n,prompt:a,tag:o,id:c,attestation:i?.attestation,tvf:i?.tvf}},d=`Failed to publish payload, please try again. id:${c} tag:${o}`;try{let r=new Promise(async r=>{let n=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(rv.publish,n),r(l))};this.relayer.events.on(rv.publish,n);let d=ea(new Promise((r,n)=>{this.rpcPublish({topic:e,message:t,ttl:s,prompt:a,tag:o,id:c,attestation:i?.attestation,tvf:i?.tvf}).then(r).catch(e=>{this.logger.warn(e,e?.message),n(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${o}`);try{await d,this.events.removeListener(rv.publish,n)}catch(e){this.queue.set(c,s2(s1({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:i}}),await ea(r,this.publishTimeout,d)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(r=i?.internal)&&r.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),s5(this,"on",(e,t)=>{this.events.on(e,t)}),s5(this,"once",(e,t)=>{this.events.once(e,t)}),s5(this,"off",(e,t)=>{this.events.off(e,t)}),s5(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,o.U5)(t,this.name),this.registerEventListeners()}get context(){return(0,o.oI)(this.logger)}async rpcPublish(e){var t,i,r,s;let{topic:n,message:a,ttl:o=rb,prompt:c,tag:l,id:d,attestation:h,tvf:u}=e,p={method:iR(iM().protocol).publish,params:s1({topic:n,message:a,ttl:o,prompt:c,tag:l,attestation:h},u),id:d};i2(null==(t=p.params)?void 0:t.prompt)&&(null==(i=p.params)||delete i.prompt),i2(null==(r=p.params)?void 0:r.tag)&&(null==(s=p.params)||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});let f=await this.relayer.request(p);return this.relayer.events.emit(rv.publish,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{let i=e.attempt+1;this.queue.set(t,s2(s1({},e),{attempt:i}));let{topic:r,message:s,opts:n,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish(s2(s1({},e),{topic:r,message:s,ttl:n.ttl,prompt:n.prompt,tag:n.tag,id:n.id,attestation:a,tvf:n.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(n.li.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(rv.connection_stalled);return}this.checkQueue()}),this.relayer.on(rv.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var s6=Object.defineProperty,s4=(e,t,i)=>t in e?s6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,s8=(e,t,i)=>s4(e,"symbol"!=typeof t?t+"":t,i);class s9{constructor(){s8(this,"map",new Map),s8(this,"set",(e,t)=>{let i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])}),s8(this,"get",e=>this.map.get(e)||[]),s8(this,"exists",(e,t)=>this.get(e).includes(t)),s8(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;let i=this.get(e);if(!this.exists(e,t))return;let r=i.filter(e=>e!==t);if(!r.length)return void this.map.delete(e);this.map.set(e,r)}),s8(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var s7=Object.defineProperty,ne=Object.defineProperties,nt=Object.getOwnPropertyDescriptors,ni=Object.getOwnPropertySymbols,nr=Object.prototype.hasOwnProperty,ns=Object.prototype.propertyIsEnumerable,nn=(e,t,i)=>t in e?s7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,na=(e,t)=>{for(var i in t||(t={}))nr.call(t,i)&&nn(e,i,t[i]);if(ni)for(var i of ni(t))ns.call(t,i)&&nn(e,i,t[i]);return e},no=(e,t)=>ne(e,nt(t)),nc=(e,t,i)=>nn(e,"symbol"!=typeof t?t+"":t,i);class nl extends E{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,nc(this,"subscriptions",new Map),nc(this,"topicMap",new s9),nc(this,"events",new r.EventEmitter),nc(this,"name","subscription"),nc(this,"version","0.3"),nc(this,"pending",new Map),nc(this,"cached",[]),nc(this,"initialized",!1),nc(this,"storagePrefix",rp),nc(this,"subscribeTimeout",(0,M.toMiliseconds)(M.ONE_MINUTE)),nc(this,"initialSubscribeTimeout",(0,M.toMiliseconds)(15*M.ONE_SECOND)),nc(this,"clientId"),nc(this,"batchSubscribeTopicsLimit",500),nc(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),nc(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let i=iM(t),r={topic:e,relay:i,transportType:t?.transportType};this.pending.set(e,r);let s=await this.rpcSubscribe(e,i,t);return"string"==typeof s&&(this.onSubscribe(s,r),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),nc(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),nc(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),nc(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),nc(this,"on",(e,t)=>{this.events.on(e,t)}),nc(this,"once",(e,t)=>{this.events.once(e,t)}),nc(this,"off",(e,t)=>{this.events.off(e,t)}),nc(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),nc(this,"start",async()=>{await this.onConnect()}),nc(this,"stop",async()=>{await this.onDisconnect()}),nc(this,"restart",async()=>{await this.restore(),await this.onRestart()}),nc(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),nc(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(n.li.pulse,async()=>{await this.checkPending()}),this.events.on(rS.created,async e=>{let t=rS.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(rS.deleted,async e=>{let t=rS.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,o.U5)(t,this.name),this.clientId=""}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let i=this.topicMap.get(e);await Promise.all(i.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{let r=iM(i);await this.restartToComplete({topic:e,id:t,relay:r}),await this.rpcUnsubscribe(e,t,r);let s=iZ("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,i){var r;i&&i?.transportType!==r_.relay||await this.restartToComplete({topic:e,id:e,relay:t});let s={method:iR(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(r=i?.internal)?void 0:r.throwOnFailedPublish;try{let t=await this.getSubscriptionId(e);if(i?.transportType===r_.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,M.toMiliseconds)(M.ONE_SECOND)),t;let r=new Promise(async t=>{let i=r=>{r.topic===e&&(this.events.removeListener(rS.created,i),t(r.id))};this.events.on(rS.created,i);try{let r=await ea(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(rS.created,i),t(r)}catch{}}),a=await ea(r,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!a&&n)throw Error(`Subscribing to ${e} failed, please try again`);return a?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(rv.connection_stalled),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:iR(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await ea(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(rv.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let i={method:iR(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{t=await await ea(new Promise((e,t)=>{this.relayer.request(i).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(rv.connection_stalled)}return t}rpcUnsubscribe(e,t,i){let r={method:iR(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),this.relayer.request(r)}onSubscribe(e,t){this.setSubscription(e,no(na({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,na({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,na({},t)),this.topicMap.set(t.topic,e),this.events.emit(rS.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=iX("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(rS.deleted,no(na({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(rS.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(rS.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=iX("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>no(na({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let i=await this.rpcBatchFetchMessages(e);i&&i.messages&&(await (t=(0,M.toMiliseconds)(M.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(i.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return iA(e+await this.getClientId())}}var nd=Object.defineProperty,nh=Object.getOwnPropertySymbols,nu=Object.prototype.hasOwnProperty,np=Object.prototype.propertyIsEnumerable,nf=(e,t,i)=>t in e?nd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ng=(e,t)=>{for(var i in t||(t={}))nu.call(t,i)&&nf(e,i,t[i]);if(nh)for(var i of nh(t))np.call(t,i)&&nf(e,i,t[i]);return e},ny=(e,t,i)=>nf(e,"symbol"!=typeof t?t+"":t,i);class nm extends w{constructor(e){super(e),ny(this,"protocol","wc"),ny(this,"version",2),ny(this,"core"),ny(this,"logger"),ny(this,"events",new r.EventEmitter),ny(this,"provider"),ny(this,"messages"),ny(this,"subscriber"),ny(this,"publisher"),ny(this,"name","relayer"),ny(this,"transportExplicitlyClosed",!1),ny(this,"initialized",!1),ny(this,"connectionAttemptInProgress",!1),ny(this,"relayUrl"),ny(this,"projectId"),ny(this,"packageName"),ny(this,"bundleId"),ny(this,"hasExperiencedNetworkDisruption",!1),ny(this,"pingTimeout"),ny(this,"heartBeatTimeout",(0,M.toMiliseconds)(M.THIRTY_SECONDS+M.FIVE_SECONDS)),ny(this,"reconnectTimeout"),ny(this,"connectPromise"),ny(this,"reconnectInProgress",!1),ny(this,"requestsInFlight",[]),ny(this,"connectTimeout",(0,M.toMiliseconds)(15*M.ONE_SECOND)),ny(this,"request",async e=>{var t,i;this.logger.debug("Publishing Request Payload");let r=e.id||(0,rl.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:r,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${r}:${(null==(i=e.params)?void 0:i.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${r}`),e}}),ny(this,"resetPingTimeout",()=>{J()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,i,r;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(r=null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.terminate)||r.call(i)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),ny(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),ny(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(rv.connect)}),ny(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),ny(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(rv.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),ny(this,"registerProviderListeners",()=>{this.provider.on(rI.payload,this.onPayloadHandler),this.provider.on(rI.connect,this.onConnectHandler),this.provider.on(rI.disconnect,this.onDisconnectHandler),this.provider.on(rI.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,o.U5)(e.logger,this.name):(0,o.h6)((0,o.iP)({level:e.logger||"error"})),this.messages=new sK(this.logger,e.core),this.subscriber=new nl(this,this.logger),this.publisher=new s3(this,this.logger),this.relayUrl=e?.relayUrl||rw,this.projectId=e.projectId,Y()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)&&(null==i.g?void 0:i.g.Platform.OS)==="android"?this.packageName=Z():Y()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)&&(null==i.g?void 0:i.g.Platform.OS)==="ios"&&(this.bundleId=Z()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,o.oI)(this.logger)}get connected(){var e,t,i;return(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)===1}get connecting(){var e,t,i;return(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)===0||void 0!==this.connectPromise}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:r_.relay},rC.outbound)}async subscribe(e,t){var i,r,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(i=t?.internal)?void 0:i.throwOnFailedPublish)>"u"||(null==(r=t?.internal)?void 0:r.throwOnFailedPublish),a=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",o,c=t=>{t.topic===e&&(this.subscriber.off(rS.created,c),o())};return await Promise.all([new Promise(e=>{o=e,this.subscriber.on(rS.created,c)}),new Promise(async(i,r)=>{a=await this.subscriber.subscribe(e,ng({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&r(e)})||a,i()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ea(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics)return void this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,i)=>{await this.connect(e).then(t).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await rs())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:i}=e;if(!t.sessionExists){let e=el(M.FIVE_MINUTES);await this.core.pairing.pairings.set(i,{topic:i,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(rv.message,e),await this.recordMessageEvent(e,rC.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(rI.disconnect,i),await ea(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(rI.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,t)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(rI.disconnect,i),await this.subscriber.start().then(e).catch(t).finally(()=>{this.provider.off(rI.disconnect,i)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,M.toMiliseconds)(+t))),t++}}startPingTimeout(){var e,t,i,r,s;if(J())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(s=null==(r=null==(i=this.provider)?void 0:i.connection)?void 0:r.socket)||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new rc.F(new rd.A(function({protocol:e,version:t,relayUrl:i,sdkVersion:r,auth:s,projectId:n,useOnCloseEvent:a,bundleId:o,packageName:c}){let l=i.split("?"),d=et(e,t,r),h=function(e,t){let i=new URLSearchParams(e);for(let e of Object.keys(t).sort())if(t.hasOwnProperty(e)){let r=t[e];void 0!==r&&i.set(e,r)}return i.toString()}(l[1]||"",{auth:s,ua:d,projectId:n,useOnCloseEvent:a||void 0,packageName:c||void 0,bundleId:o||void 0});return l[0]+"?"+h}({sdkVersion:rE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:i,message:r}=e;await this.messages.set(i,r,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:i}=e;if(!i||0===i.length)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let r=this.messages.has(t,i);return r&&this.logger.warn(`Ignoring duplicate message: ${i}`),r}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,rl.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:i,message:r,publishedAt:s,attestation:n}=t.data,a={topic:i,message:r,publishedAt:s,transportType:r_.relay,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(ng({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else(0,rl.isJsonRpcResponse)(e)&&this.events.emit(rv.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,rC.inbound),this.events.emit(rv.message,e))}async acknowledgePayload(e){let t=(0,rl.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(rI.payload,this.onPayloadHandler),this.provider.off(rI.connect,this.onConnectHandler),this.provider.off(rI.disconnect,this.onDisconnectHandler),this.provider.off(rI.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await rs();var t,r,s=async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))};switch(X()){case G.browser:t=s,!Y()&&Q()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)));break;case G.reactNative:r=s,Y()&&"u">typeof i.g&&null!=i.g&&i.g.NetInfo&&i.g?.NetInfo.addEventListener(e=>r(e?.isConnected));case G.node:}}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(rv.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,M.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||await this.connect()}}function nb(){}function nw(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function nv(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function nI(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let nE="[object Arguments]",n_="[object Object]";var nC=Object.defineProperty,nA=Object.getOwnPropertySymbols,nS=Object.prototype.hasOwnProperty,nN=Object.prototype.propertyIsEnumerable,nT=(e,t,i)=>t in e?nC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nx=(e,t)=>{for(var i in t||(t={}))nS.call(t,i)&&nT(e,i,t[i]);if(nA)for(var i of nA(t))nN.call(t,i)&&nT(e,i,t[i]);return e},nP=(e,t,i)=>nT(e,"symbol"!=typeof t?t+"":t,i);class nO extends v{constructor(e,t,i,r=rp,s){super(e,t,i,r),this.core=e,this.logger=t,this.name=i,nP(this,"map",new Map),nP(this,"version","0.3"),nP(this,"cached",[]),nP(this,"initialized",!1),nP(this,"getKey"),nP(this,"storagePrefix",rp),nP(this,"recentlyDeleted",[]),nP(this,"recentlyDeletedLimit",200),nP(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{this.getKey&&null!==e&&!i2(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),nP(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),nP(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),nP(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(i=>{var r;return r=t[i],function e(t,i,r,s,n,a,o){let c=o(t,i,r,s,n,a);if(void 0!==c)return c;if(typeof t==typeof i)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===i;case"number":return t===i||Object.is(t,i)}return function t(i,r,s,n){if(Object.is(i,r))return!0;let a=nI(i),o=nI(r);if(a===nE&&(a=n_),o===nE&&(o=n_),a!==o)return!1;switch(a){case"[object String]":return i.toString()===r.toString();case"[object Number]":{let e=i.valueOf(),t=r.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(i.valueOf(),r.valueOf());case"[object RegExp]":return i.source===r.source&&i.flags===r.flags;case"[object Function]":return i===r}let c=(s=s??new Map).get(i),l=s.get(r);if(null!=c&&null!=l)return c===r;s.set(i,r),s.set(r,i);try{switch(a){case"[object Map]":if(i.size!==r.size)return!1;for(let[t,a]of i.entries())if(!r.has(t)||!e(a,r.get(t),t,i,r,s,n))return!1;return!0;case"[object Set]":{if(i.size!==r.size)return!1;let t=Array.from(i.values()),a=Array.from(r.values());for(let o=0;o<t.length;o++){let c=t[o],l=a.findIndex(t=>e(c,t,void 0,i,r,s,n));if(-1===l)return!1;a.splice(l,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof rh&&rh.isBuffer(i)!==rh.isBuffer(r)||i.length!==r.length)return!1;for(let t=0;t<i.length;t++)if(!e(i[t],r[t],t,i,r,s,n))return!1;return!0;case"[object ArrayBuffer]":return i.byteLength===r.byteLength&&t(new Uint8Array(i),new Uint8Array(r),s,n);case"[object DataView]":return i.byteLength===r.byteLength&&i.byteOffset===r.byteOffset&&t(new Uint8Array(i),new Uint8Array(r),s,n);case"[object Error]":return i.name===r.name&&i.message===r.message;case n_:{if(!(t(i.constructor,r.constructor,s,n)||nw(i)&&nw(r)))return!1;let a=[...Object.keys(i),...nv(i)],o=[...Object.keys(r),...nv(r)];if(a.length!==o.length)return!1;for(let t=0;t<a.length;t++){let o=a[t],c=i[o];if(!Object.hasOwn(r,o))return!1;let l=r[o];if(!e(c,l,o,i,r,s,n))return!1}return!0}default:return!1}}finally{s.delete(i),s.delete(r)}}(t,i,a,o)}(r,e[i],void 0,void 0,void 0,void 0,nb)})):this.values)),nP(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let i=nx(nx({},this.getData(e)),t);this.map.set(e,i),await this.persist()}),nP(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,o.U5)(t,this.name),this.storagePrefix=r,this.getKey=s}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=iX("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=iX("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=iX("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var nM=Object.defineProperty,nR=(e,t,i)=>t in e?nM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nk=(e,t,i)=>nR(e,"symbol"!=typeof t?t+"":t,i);class nD{constructor(e,t){this.core=e,this.logger=t,nk(this,"name","pairing"),nk(this,"version","0.3"),nk(this,"events",new(s())),nk(this,"pairings"),nk(this,"initialized",!1),nk(this,"storagePrefix",rp),nk(this,"ignoredPayloadTypes",[1]),nk(this,"registeredMethods",[]),nk(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),nk(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),nk(this,"create",async e=>{this.isInitialized();let t=i_(),i=await this.core.crypto.setSymKey(t),r=el(M.FIVE_MINUTES),s={protocol:"irn"},n={topic:i,expiry:r,relay:s,active:!1,methods:e?.methods},a=iD({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:t,relay:s,expiryTimestamp:r,methods:e?.methods});return this.events.emit(rT.create,n),this.core.expirer.set(i,r),await this.pairings.set(i,n),await this.core.relayer.subscribe(i,{transportType:e?.transportType}),{topic:i,uri:a}}),nk(this,"pair",async e=>{let t;this.isInitialized();let i=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[rk.pairing_started]}});this.isValidPair(e,i);let{topic:r,symKey:s,relay:n,expiryTimestamp:a,methods:o}=ik(e.uri);if(i.props.properties.topic=r,i.addTrace(rk.pairing_uri_validation_success),i.addTrace(rk.pairing_uri_not_expired),this.pairings.keys.includes(r)){if(t=this.pairings.get(r),i.addTrace(rk.existing_pairing),t.active)throw i.setError(rD.active_pairing_already_exists),Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);i.addTrace(rk.pairing_not_expired)}let c=a||el(M.FIVE_MINUTES),l={topic:r,relay:n,expiry:c,active:!1,methods:o};this.core.expirer.set(r,c),await this.pairings.set(r,l),i.addTrace(rk.store_new_pairing),e.activatePairing&&await this.activate({topic:r}),this.events.emit(rT.create,l),i.addTrace(rk.emit_inactive_pairing),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(s,r),i.addTrace(rk.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(rD.no_internet_connection)}try{await this.core.relayer.subscribe(r,{relay:n})}catch(e){throw i.setError(rD.subscribe_pairing_topic_failure),e}return i.addTrace(rk.subscribe_pairing_topic_success),l}),nk(this,"activate",async({topic:e})=>{this.isInitialized();let t=el(M.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),nk(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:i,resolve:r,reject:s}=en();this.events.once(eh("pairing_ping",e),({error:e})=>{e?s(e):r()}),await i()}}),nk(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),nk(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),nk(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),nk(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",iZ("USER_DISCONNECTED")),await this.deletePairing(t))}),nk(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:i,expiry:r,methods:s}=e,n=this.core.crypto.keychain.get(t);return iD({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:i,expiryTimestamp:r,methods:s})}),nk(this,"sendRequest",async(e,t,i)=>{let r=(0,rl.formatJsonRpcRequest)(t,i),s=await this.core.crypto.encode(e,r),n=rN[t].req;return this.core.history.set(e,r),this.core.relayer.publish(e,s,n),r.id}),nk(this,"sendResult",async(e,t,i)=>{let r=(0,rl.formatJsonRpcResult)(e,i),s=await this.core.crypto.encode(t,r),n=rN[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(r)}),nk(this,"sendError",async(e,t,i)=>{let r=(0,rl.formatJsonRpcError)(e,i),s=await this.core.crypto.encode(t,r),n=(await this.core.history.get(t,e)).request.method,a=rN[n]?rN[n].res:rN.unregistered_method.res;await this.core.relayer.publish(t,s,a),await this.core.history.resolve(r)}),nk(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,iZ("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),nk(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>ed(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),nk(this,"onRelayEventRequest",async e=>{let{topic:t,payload:i}=e;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,i);default:return await this.onUnknownRpcMethodRequest(t,i)}}),nk(this,"onRelayEventResponse",async e=>{let{topic:t,payload:i}=e,r=(await this.core.history.get(t,i.id)).request.method;return"wc_pairingPing"===r?this.onPairingPingResponse(t,i):this.onUnknownRpcMethodResponse(r)}),nk(this,"onPairingPingRequest",async(e,t)=>{let{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult(i,e,!0),this.events.emit(rT.ping,{id:i,topic:e})}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nk(this,"onPairingPingResponse",(e,t)=>{let{id:i}=t;setTimeout(()=>{(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("pairing_ping",i),{}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("pairing_ping",i),{error:t.error})},500)}),nk(this,"onPairingDeleteRequest",async(e,t)=>{let{id:i}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(rT.delete,{id:i,topic:e})}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nk(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:i,method:r}=t;try{if(this.registeredMethods.includes(r))return;let t=iZ("WC_METHOD_UNSUPPORTED",r);await this.sendError(i,e,t),this.logger.error(t)}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nk(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(iZ("WC_METHOD_UNSUPPORTED",e))}),nk(this,"isValidPair",(e,t)=>{var i;if(!re(e)){let{message:i}=iX("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(rD.malformed_pairing_uri),Error(i)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(i5(e,!1)){if(t(e))return!0;let i=eb(e);return t(i)}}catch{}return!1}(e.uri)){let{message:i}=iX("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(rD.malformed_pairing_uri),Error(i)}let r=ik(e?.uri);if(!(null!=(i=r?.relay)&&i.protocol)){let{message:e}=iX("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(rD.malformed_pairing_uri),Error(e)}if(!(null!=r&&r.symKey)){let{message:e}=iX("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(rD.malformed_pairing_uri),Error(e)}if(null!=r&&r.expiryTimestamp&&(0,M.toMiliseconds)(r?.expiryTimestamp)<Date.now()){t.setError(rD.pairing_expired);let{message:e}=iX("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),nk(this,"isValidPing",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nk(this,"isValidDisconnect",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nk(this,"isValidPairingTopic",async e=>{if(!i5(e,!1)){let{message:t}=iX("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=iX("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ed(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=iX("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,o.U5)(t,this.name),this.pairings=new nO(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,o.oI)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(rv.message,async e=>{let{topic:t,message:i,transportType:r}=e;if(this.pairings.keys.includes(t)&&r!==r_.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))try{let e=await this.core.crypto.decode(t,i);(0,rl.isJsonRpcRequest)(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):(0,rl.isJsonRpcResponse)(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,i)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(rP.expired,async e=>{let{topic:t}=ec(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(rT.expire,{topic:t}))})}}var nU=Object.defineProperty,nL=(e,t,i)=>t in e?nU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nq=(e,t,i)=>nL(e,"symbol"!=typeof t?t+"":t,i);class nj extends y{constructor(e,t){super(e,t),this.core=e,this.logger=t,nq(this,"records",new Map),nq(this,"events",new r.EventEmitter),nq(this,"name","history"),nq(this,"version","0.3"),nq(this,"cached",[]),nq(this,"initialized",!1),nq(this,"storagePrefix",rp),nq(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nq(this,"set",(e,t,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:i}),this.records.has(t.id))return;let r={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:i,expiry:el(M.THIRTY_DAYS)};this.records.set(r.id,r),this.persist(),this.events.emit(rx.created,r)}),nq(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,rl.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(rx.updated,t))}),nq(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),nq(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(i=>{i.topic===e&&("u">typeof t&&i.id!==t||(this.records.delete(i.id),this.events.emit(rx.deleted,i)))}),this.persist()}),nq(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),nq(this,"on",(e,t)=>{this.events.on(e,t)}),nq(this,"once",(e,t)=>{this.events.once(e,t)}),nq(this,"off",(e,t)=>{this.events.off(e,t)}),nq(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,o.U5)(t,this.name)}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let i={topic:t.topic,request:(0,rl.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=iX("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(rx.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=iX("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(rx.created,e=>{let t=rx.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(rx.updated,e=>{let t=rx.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(rx.deleted,e=>{let t=rx.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(n.li.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,M.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(rx.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var n$=Object.defineProperty,nz=(e,t,i)=>t in e?n$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nB=(e,t,i)=>nz(e,"symbol"!=typeof t?t+"":t,i);class nH extends _{constructor(e,t){super(e,t),this.core=e,this.logger=t,nB(this,"expirations",new Map),nB(this,"events",new r.EventEmitter),nB(this,"name","expirer"),nB(this,"version","0.3"),nB(this,"cached",[]),nB(this,"initialized",!1),nB(this,"storagePrefix",rp),nB(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nB(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),nB(this,"set",(e,t)=>{this.isInitialized();let i=this.formatTarget(e),r={target:i,expiry:t};this.expirations.set(i,r),this.checkExpiry(i,r),this.events.emit(rP.created,{target:i,expiration:r})}),nB(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),nB(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),i=this.getExpiration(t);this.expirations.delete(t),this.events.emit(rP.deleted,{target:t,expiration:i})}}),nB(this,"on",(e,t)=>{this.events.on(e,t)}),nB(this,"once",(e,t)=>{this.events.once(e,t)}),nB(this,"off",(e,t)=>{this.events.off(e,t)}),nB(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,o.U5)(t,this.name)}get context(){return(0,o.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return eo("topic",e);if("number"==typeof e)return eo("id",e);let{message:t}=iX("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(rP.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=iX("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=iX("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:i}=t;(0,M.toMiliseconds)(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(rP.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(n.li.pulse,()=>this.checkExpirations()),this.events.on(rP.created,e=>{let t=rP.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(rP.expired,e=>{let t=rP.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(rP.deleted,e=>{let t=rP.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}}var nW=Object.defineProperty,nF=(e,t,i)=>t in e?nW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nV=(e,t,i)=>nF(e,"symbol"!=typeof t?t+"":t,i);class nK extends C{constructor(e,t,i){super(e,t,i),this.core=e,this.logger=t,this.store=i,nV(this,"name","verify-api"),nV(this,"abortController"),nV(this,"isDevEnv"),nV(this,"verifyUrlV3",rM),nV(this,"storagePrefix",rp),nV(this,"version",2),nV(this,"publicKey"),nV(this,"fetchPromise"),nV(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,M.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),nV(this,"register",async e=>{if(!Q()||this.isDevEnv)return;let t=window.location.origin,{id:i,decryptedId:r}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${i}&decryptedId=${r}`;try{let e=(0,U.getDocument)(),t=this.startAbortTimer(5*M.ONE_SECOND),r=await new Promise((r,n)=>{let a=()=>{window.removeEventListener("message",c),e.body.removeChild(o),n("attestation aborted")};this.abortController.signal.addEventListener("abort",a);let o=e.createElement("iframe");o.src=s,o.style.display="none",o.addEventListener("error",a,{signal:this.abortController.signal});let c=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if((0,k.Cq)(n.attestation).payload.id!==i)return;clearInterval(t),e.body.removeChild(o),this.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",c),r(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(o),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",r),r}catch(e){this.logger.warn(e)}return""}),nV(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:i,encryptedId:r}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if((0,k.Cq)(t).payload.id!==r)return;let e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!i)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(i,s)}),nV(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let i=this.startAbortTimer(5*M.ONE_SECOND),r=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(i),200===r.status?await r.json():void 0}),nV(this,"getVerifyUrl",e=>{let t=e||rO;return rR.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${rO}`),t=rO),t}),nV(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(M.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),nV(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),nV(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),nV(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let i=await this.fetchAndPersistPublicKey();try{if(i)return this.validateAttestation(e,i)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),nV(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),nV(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),nV(this,"validateAttestation",(e,t)=>{let i=function(e,t){let[i,r,s]=e.split("."),n=W.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=t.length%4;return i>0&&(t+="=".repeat(4-i)),t}(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let a=n.slice(0,32).toString("hex"),o=n.slice(32,64).toString("hex"),c=t1(`${i}.${r}`),l=new z.ec("p256").keyFromPublic({x:W.from(t.x,"base64").toString("hex"),y:W.from(t.y,"base64").toString("hex")},"hex"),d=(0,$.dI)(c,iw);if(!l.verify(d,{r:a,s:o}))throw Error("Invalid signature");return(0,k.Cq)(e).payload}(e,t.publicKey),r={hasExpired:(0,M.toMiliseconds)(i.exp)<Date.now(),payload:i};if(r.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:r.payload.origin,isScam:r.payload.isScam,isVerified:r.payload.isVerified}}),this.logger=(0,o.U5)(t,this.name),this.abortController=new AbortController,this.isDevEnv=em(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,o.oI)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,M.toMiliseconds)(e))}}var nG=Object.defineProperty,nJ=(e,t,i)=>t in e?nG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nY=(e,t,i)=>nJ(e,"symbol"!=typeof t?t+"":t,i);class nQ extends A{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,nY(this,"context","echo"),nY(this,"registerDeviceToken",async e=>{let{clientId:t,token:i,notificationType:r,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:r,token:i,always_raw:s})})}),this.logger=(0,o.U5)(t,this.context)}}var nX=Object.defineProperty,nZ=Object.getOwnPropertySymbols,n0=Object.prototype.hasOwnProperty,n1=Object.prototype.propertyIsEnumerable,n2=(e,t,i)=>t in e?nX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,n5=(e,t)=>{for(var i in t||(t={}))n0.call(t,i)&&n2(e,i,t[i]);if(nZ)for(var i of nZ(t))n1.call(t,i)&&n2(e,i,t[i]);return e},n3=(e,t,i)=>n2(e,"symbol"!=typeof t?t+"":t,i);class n6 extends S{constructor(e,t,i=!0){super(e,t,i),this.core=e,this.logger=t,n3(this,"context","event-client"),n3(this,"storagePrefix",rp),n3(this,"storageVersion",.1),n3(this,"events",new Map),n3(this,"shouldPersist",!1),n3(this,"init",async()=>{if(!em())try{let e={eventId:ey(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:et(this.core.relayer.protocol,this.core.relayer.version,rE)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),n3(this,"createEvent",e=>{let{event:t="ERROR",type:i="",properties:{topic:r,trace:s}}=e,n=ey(),a=this.core.projectId||"",o=n5({eventId:n,timestamp:Date.now(),props:{event:t,type:i,properties:{topic:r,trace:s}},bundleId:a,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,o),this.shouldPersist=!0),o}),n3(this,"getEvent",e=>{let{eventId:t,topic:i}=e;if(t)return this.events.get(t);let r=Array.from(this.events.values()).find(e=>e.props.properties.topic===i);if(r)return n5(n5({},r),this.setMethods(r.eventId))}),n3(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),n3(this,"setEventListeners",()=>{this.core.heartbeat.on(n.li.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,M.fromMiliseconds)(Date.now())-(0,M.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),n3(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),n3(this,"addTrace",(e,t)=>{let i=this.events.get(e);i&&(i.props.properties.trace.push(t),this.events.set(e,i),this.shouldPersist=!0)}),n3(this,"setError",(e,t)=>{let i=this.events.get(e);i&&(i.props.type=t,i.timestamp=Date.now(),this.events.set(e,i),this.shouldPersist=!0)}),n3(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),n3(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,n5(n5({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),n3(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,i]of this.events)i.props.type&&e.push(i);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),n3(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${rE}${t}`,{method:"POST",body:JSON.stringify(e)})}),n3(this,"getAppDomain",()=>ee().url),this.logger=(0,o.U5)(t,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var n4=Object.defineProperty,n8=Object.getOwnPropertySymbols,n9=Object.prototype.hasOwnProperty,n7=Object.prototype.propertyIsEnumerable,ae=(e,t,i)=>t in e?n4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,at=(e,t)=>{for(var i in t||(t={}))n9.call(t,i)&&ae(e,i,t[i]);if(n8)for(var i of n8(t))n7.call(t,i)&&ae(e,i,t[i]);return e},ai=(e,t,i)=>ae(e,"symbol"!=typeof t?t+"":t,i);class ar extends u{constructor(e){var t;super(e),ai(this,"protocol","wc"),ai(this,"version",2),ai(this,"name",ru),ai(this,"relayUrl"),ai(this,"projectId"),ai(this,"customStoragePrefix"),ai(this,"events",new r.EventEmitter),ai(this,"logger"),ai(this,"heartbeat"),ai(this,"relayer"),ai(this,"crypto"),ai(this,"storage"),ai(this,"history"),ai(this,"expirer"),ai(this,"pairing"),ai(this,"verify"),ai(this,"echoClient"),ai(this,"linkModeSupportedApps"),ai(this,"eventClient"),ai(this,"initialized",!1),ai(this,"logChunkController"),ai(this,"on",(e,t)=>this.events.on(e,t)),ai(this,"once",(e,t)=>this.events.once(e,t)),ai(this,"off",(e,t)=>this.events.off(e,t)),ai(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),ai(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:i})=>{if(!e||!t)return;let r={topic:e,message:t,publishedAt:Date.now(),transportType:r_.link_mode};this.relayer.onLinkMessageEvent(r,{sessionExists:i})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||rw,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=(0,o.iP)({level:"string"==typeof e?.logger&&e.logger?e.logger:rf.logger,name:ru}),{logger:s,chunkLoggerController:c}=(0,o.D5)({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=c,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,o.U5)(s,this.name),this.heartbeat=new n.VH,this.crypto=new sU(this,this.logger,e?.keychain),this.history=new nj(this,this.logger),this.expirer=new nH(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new a.A(at(at({},rg),e?.storageOptions)),this.relayer=new nm({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new nD(this,this.logger),this.verify=new nK(this,this.logger,this.storage),this.echoClient=new nQ(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new n6(this,this.logger,e?.telemetryEnabled)}static async init(e){let t=new ar(e);await t.initialize();let i=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",i),t}get context(){return(0,o.oI)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(rA,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(rA)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}let as="client",an=`wc@2:${as}:`,aa={name:as,logger:"error"},ao="WALLETCONNECT_DEEPLINK_CHOICE",ac="Proposal expired",al=M.SEVEN_DAYS,ad={wc_sessionPropose:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1104},res:{ttl:M.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1106},res:{ttl:M.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:M.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1112},res:{ttl:M.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:M.ONE_DAY,prompt:!1,tag:1114},res:{ttl:M.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:M.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:M.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:M.FIVE_MINUTES,prompt:!1,tag:1119}}},ah={min:M.FIVE_MINUTES,max:M.SEVEN_DAYS},au={idle:"IDLE",active:"ACTIVE"},ap={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},af=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],ag="wc@1.5:auth:",ay=`${ag}:PUB_KEY`;var am=Object.defineProperty,ab=Object.defineProperties,aw=Object.getOwnPropertyDescriptors,av=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,aE=Object.prototype.propertyIsEnumerable,a_=(e,t,i)=>t in e?am(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,aC=(e,t)=>{for(var i in t||(t={}))aI.call(t,i)&&a_(e,i,t[i]);if(av)for(var i of av(t))aE.call(t,i)&&a_(e,i,t[i]);return e},aA=(e,t)=>ab(e,aw(t)),aS=(e,t,i)=>a_(e,"symbol"!=typeof t?t+"":t,i);class aN extends O{constructor(e){super(e),aS(this,"name","engine"),aS(this,"events",new(s())),aS(this,"initialized",!1),aS(this,"requestQueue",{state:au.idle,queue:[]}),aS(this,"sessionRequestQueue",{state:au.idle,queue:[]}),aS(this,"requestQueueDelay",M.ONE_SECOND),aS(this,"expectedPairingMethodMap",new Map),aS(this,"recentlyDeletedMap",new Map),aS(this,"recentlyDeletedLimit",200),aS(this,"relayMessageCache",[]),aS(this,"pendingSessions",new Map),aS(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(ad)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,M.toMiliseconds)(this.requestQueueDelay)))}),aS(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=aA(aC({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:i,requiredNamespaces:r,optionalNamespaces:s,sessionProperties:n,scopedProperties:a,relays:o}=t,c=i,l,d=!1;try{if(c){let e=this.client.core.pairing.pairings.get(c);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),d=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),e}if(!c||!d){let{topic:e,uri:t}=await this.client.core.pairing.create();c=e,l=t}if(!c){let{message:e}=iX("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw Error(e)}let h=await this.client.core.crypto.generateKeyPair(),u=ad.wc_sessionPropose.req.ttl||M.FIVE_MINUTES,p=el(u),f=aA(aC(aC({requiredNamespaces:r,optionalNamespaces:s,relays:o??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:c},n&&{sessionProperties:n}),a&&{scopedProperties:a}),{id:(0,rl.payloadId)()}),g=eh("session_connect",f.id),{reject:y,resolve:m,done:b}=en(u,ac),w=({id:e})=>{e===f.id&&(this.client.events.off("proposal_expire",w),this.pendingSessions.delete(f.id),this.events.emit(g,{error:{message:ac,code:0}}))};return this.client.events.on("proposal_expire",w),this.events.once(g,({error:e,session:t})=>{this.client.events.off("proposal_expire",w),e?y(e):t&&m(t)}),await this.sendRequest({topic:c,method:"wc_sessionPropose",params:f,throwOnFailedPublish:!0,clientRpcId:f.id}),await this.setProposal(f.id,f),{uri:l,approval:b}}),aS(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),aS(this,"approve",async e=>{var t,i,r;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[rU.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError(rL.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError(rL.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError(rL.session_approve_namespace_validation_failure),e}let{id:n,relayProtocol:a,namespaces:o,sessionProperties:c,scopedProperties:l,sessionConfig:d}=e,h=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:u,proposer:p,requiredNamespaces:f,optionalNamespaces:g}=h,y=null==(i=this.client.core.eventClient)?void 0:i.getEvent({topic:u});y||(y=null==(r=this.client.core.eventClient)?void 0:r.createEvent({type:rU.session_approve_started,properties:{topic:u,trace:[rU.session_approve_started,rU.session_namespaces_validation_success]}}));let m=await this.client.core.crypto.generateKeyPair(),b=p.publicKey,w=await this.client.core.crypto.generateSharedKey(m,b),v=aC(aC(aC({relay:{protocol:a??"irn"},namespaces:o,controller:{publicKey:m,metadata:this.client.metadata},expiry:el(al)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),d&&{sessionConfig:d}),I=r_.relay;y.addTrace(rU.subscribing_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:I})}catch(e){throw y.setError(rL.subscribe_session_topic_failure),e}y.addTrace(rU.subscribe_session_topic_success);let E=aA(aC({},v),{topic:w,requiredNamespaces:f,optionalNamespaces:g,pairingTopic:u,acknowledged:!1,self:v.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:m,transportType:r_.relay});await this.client.session.set(w,E),y.addTrace(rU.store_session);try{y.addTrace(rU.publishing_session_settle),await this.sendRequest({topic:w,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(e=>{throw y?.setError(rL.session_settle_publish_failure),e}),y.addTrace(rU.session_settle_publish_success),y.addTrace(rU.publishing_session_approve),await this.sendResult({id:n,topic:u,result:{relay:{protocol:a??"irn"},responderPublicKey:m},throwOnFailedPublish:!0}).catch(e=>{throw y?.setError(rL.session_approve_publish_failure),e}),y.addTrace(rU.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(w,iZ("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(w),e}return this.client.core.eventClient.deleteEvent({eventId:y.eventId}),await this.client.core.pairing.updateMetadata({topic:u,metadata:p.metadata}),await this.client.proposal.delete(n,iZ("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u}),await this.setExpiry(w,el(al)),{topic:w,acknowledged:()=>Promise.resolve(this.client.session.get(w))}}),aS(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:i,reason:r}=e;try{t=this.client.proposal.get(i).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),e}t&&(await this.sendError({id:i,topic:t,error:r,rpcOpts:ad.wc_sessionPropose.reject}),await this.client.proposal.delete(i,iZ("USER_DISCONNECTED")))}),aS(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:i}=e,{done:r,resolve:s,reject:n}=en(),a=(0,rl.payloadId)(),o=(0,rl.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(eh("session_update",a),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:i}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:o}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),n(e)}),{acknowledged:r}}),aS(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,i=(0,rl.payloadId)(),{done:r,resolve:s,reject:n}=en();return this.events.once(eh("session_extend",i),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,el(al)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:r}}),aS(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:i,topic:r,expiry:s=ad.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(r);n?.transportType===r_.relay&&await this.confirmOnlineStateOrThrow();let a=(0,rl.payloadId)(),o=(0,rl.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:d}=en(s,"Request expired. Please try again.");this.events.once(eh("session_request",a),({error:e,result:t})=>{e?d(e):l(t)});let h="wc_sessionRequest",u=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(u)return await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:r,method:h,params:{request:aA(aC({},i),{expiryTimestamp:el(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:u}).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:r,request:i,chainId:t,id:a}),await c();let p={request:aA(aC({},i),{expiryTimestamp:el(s)}),chainId:t},f=this.shouldSetTVF(h,p);return await Promise.all([new Promise(async e=>{await this.sendRequest(aC({clientRpcId:a,relayRpcId:o,topic:r,method:h,params:p,expiry:s,throwOnFailedPublish:!0},f&&{tvf:this.getTVFParams(a,p)})).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:r,request:i,chainId:t,id:a}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await ef(this.client.core.storage,ao);await ep({id:a,topic:r,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),aS(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:i}=e,{id:r}=i,s=this.client.session.get(t);s.transportType===r_.relay&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);(0,rl.isJsonRpcResult)(i)?await this.sendResult({id:r,topic:t,result:i.result,throwOnFailedPublish:!0,appLink:n}):(0,rl.isJsonRpcError)(i)&&await this.sendError({id:r,topic:t,error:i.error,appLink:n}),this.cleanupAfterResponse(e)}),aS(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,rl.payloadId)(),i=(0,rl.getBigIntRpcId)().toString(),{done:r,resolve:s,reject:n}=en();this.events.once(eh("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:i}),r()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),aS(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:i,chainId:r}=e,s=(0,rl.getBigIntRpcId)().toString(),n=(0,rl.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:i,chainId:r},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),aS(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:iZ("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=iX("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),aS(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:i}=t,r=Object.keys(e.namespaces),s=Object.keys(i),n=!0;return!!ei(s,r)&&(r.forEach(t=>{let{accounts:r,methods:s,events:a}=e.namespaces[t],o=iV(r),c=i[t];ei(K(t,c),o)&&ei(c.methods,s)&&ei(c.events,a)||(n=!1)}),n)})(t,e)))),aS(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),aS(this,"authenticate",async(e,t)=>{var i,r,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let a=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(i=this.client.metadata.redirect)?void 0:i.linkMode),o=a?r_.link_mode:r_.relay;o===r_.relay&&await this.confirmOnlineStateOrThrow();let{chains:c,statement:l="",uri:d,domain:h,nonce:u,type:p,exp:f,nbf:g,methods:y=[],expiry:m}=e,b=[...e.resources||[]],{topic:w,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:v}});let I=await this.client.core.crypto.generateKeyPair(),E=iC(I);if(await Promise.all([this.client.auth.authKeys.set(ay,{responseTopic:E,publicKey:I}),this.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:w})]),await this.client.core.relayer.subscribe(E,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${w}`),y.length>0){let{namespace:e}=F(c[0]),t=td(function(e,t,i,r={}){return i?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,i={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[i]})))}(t,i,r)}}}(e,"request",y));tf(b)&&(r=t,s=b.pop(),t=td(function(e,t){tl(e),tl(t);let i=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),r={att:{}};return i.forEach(i=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[i])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[i])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,a;r.att[i]=ti(tt({},r.att[i]),{[s]:(null==(n=e.att[i])?void 0:n[s])||(null==(a=t.att[i])?void 0:a[s])})})}),r}(th(r),th(s)))),b.push(t)}let _=m&&m>ad.wc_sessionAuthenticate.req.ttl?m:ad.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:p??"caip122",chains:c,statement:l,aud:d,domain:h,version:"1",nonce:u,iat:new Date().toISOString(),exp:f,nbf:g,resources:b},requester:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:el(_)},A={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:c,methods:[...new Set(["personal_sign",...y])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:el(ad.wc_sessionPropose.req.ttl),id:(0,rl.payloadId)()},{done:S,resolve:N,reject:T}=en(_,"Request expired"),x=(0,rl.payloadId)(),P=eh("session_connect",A.id),O=eh("session_request",x),M=async({error:e,session:t})=>{this.events.off(O,R),e?T(e):t&&N({session:t})},R=async e=>{var i,r,s;let n;if(await this.deletePendingAuthRequest(x,{message:"fulfilled",code:0}),e.error){let t=iZ("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(P,M),T(e.error.message))}await this.deleteProposal(A.id),this.events.off(P,M);let{cacaos:a,responder:c}=e.result,l=[],d=[];for(let e of a){await to({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),T(iZ("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,i=tf(t.resources),r=[tn(t.iss)],s=ta(t.iss);if(i){let e=tu(i),t=tp(i);l.push(...e),r.push(...t)}for(let e of r)d.push(`${e}:${s}`)}let h=await this.client.core.crypto.generateSharedKey(I,c.publicKey);l.length>0&&(n={topic:h,acknowledged:!0,self:{publicKey:I,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:el(al),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:iJ([...new Set(l)],[...new Set(d)]),transportType:o},await this.client.core.relayer.subscribe(h,{transportType:o}),await this.client.session.set(h,n),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),n=this.client.session.get(h)),null!=(i=this.client.metadata.redirect)&&i.linkMode&&null!=(r=c.metadata.redirect)&&r.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(h,{transportType:r_.link_mode})),N({auths:a,session:n})};this.events.once(P,M),this.events.once(O,R);try{if(a){let e=(0,rl.formatJsonRpcRequest)("wc_sessionAuthenticate",C,x);this.client.core.history.set(w,e);let i=await this.client.core.crypto.encode("",e,{type:2,encoding:iI});n=iU(t,w,i)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:x}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:A,expiry:ad.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A.id})])}catch(e){throw this.events.off(P,M),this.events.off(O,R),e}return await this.setProposal(A.id,A),await this.setAuthRequest(x,{request:aA(aC({},C),{verifyContext:{}}),pairingTopic:w,transportType:o}),{uri:n??v,response:S}}),aS(this,"approveSessionAuthenticate",async e=>{let t,{id:i,auths:r}=e,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[rq.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw s.setError(rj.no_internet_connection),e}let n=this.getPendingAuthRequest(i);if(!n)throw s.setError(rj.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${i}`);let a=n.transportType||r_.relay;a===r_.relay&&await this.confirmOnlineStateOrThrow();let o=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=iC(o),d={type:1,receiverPublicKey:o,senderPublicKey:c},h=[],u=[];for(let e of r){if(!await to({cacao:e,projectId:this.client.core.projectId})){s.setError(rj.invalid_cacao);let e=iZ("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:l,error:e,encodeOpts:d}),Error(e.message)}s.addTrace(rq.cacaos_verified);let{p:t}=e,r=tf(t.resources),n=[tn(t.iss)],a=ta(t.iss);if(r){let e=tu(r),t=tp(r);h.push(...e),n.push(...t)}for(let e of n)u.push(`${e}:${a}`)}let p=await this.client.core.crypto.generateSharedKey(c,o);if(s.addTrace(rq.create_authenticated_session_topic),h?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:o,metadata:n.requester.metadata},controller:o,expiry:el(al),authentication:r,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:iJ([...new Set(h)],[...new Set(u)]),transportType:a},s.addTrace(rq.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(e){throw s.setError(rj.subscribe_authenticated_session_topic_failure),e}s.addTrace(rq.subscribe_authenticated_session_topic_success),await this.client.session.set(p,t),s.addTrace(rq.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace(rq.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:i,result:{cacaos:r,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,a)})}catch(e){throw s.setError(rj.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),aS(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:i}=e,r=this.getPendingAuthRequest(t);if(!r)throw Error(`Could not find pending auth request with id ${t}`);r.transportType===r_.relay&&await this.confirmOnlineStateOrThrow();let s=r.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),a=iC(s);await this.sendError({id:t,topic:a,error:i,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:ad.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(r.requester.metadata,r.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,iZ("USER_DISCONNECTED"))}),aS(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:i}=e;return tc(t,i)}),aS(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),aS(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(i=>{var r,s;return(null==(r=i.peerMetadata)?void 0:r.url)&&(null==(s=i.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&i.topic&&i.topic!==t.topic});if(0===i.length)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),aS(this,"deleteSession",async e=>{var t;let{topic:i,expirerHasDeleted:r=!1,emitEvent:s=!0,id:n=0}=e,{self:a}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,iZ("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),r||this.client.core.expirer.del(i),this.client.core.storage.removeItem(ao).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===i&&this.deletePendingSessionRequest(e.id,iZ("USER_DISCONNECTED"))}),i===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=au.idle),s&&this.client.events.emit("session_delete",{id:n,topic:i})}),aS(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),i=this.client.core.eventClient.getEvent({topic:t.pairingTopic});i?.setError(rL.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,iZ("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),aS(this,"deletePendingSessionRequest",async(e,t,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),i?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),i&&(this.sessionRequestQueue.state=au.idle,this.client.events.emit("session_request_expire",{id:e}))}),aS(this,"deletePendingAuthRequest",async(e,t,i=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),i?Promise.resolve():this.client.core.expirer.del(e)])}),aS(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),aS(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,el(ad.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),aS(this,"setAuthRequest",async(e,t)=>{let{request:i,pairingTopic:r,transportType:s=r_.relay}=t;this.client.core.expirer.set(e,i.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:e,pairingTopic:r,verifyContext:i.verifyContext,transportType:s})}),aS(this,"setPendingSessionRequest",async e=>{let{id:t,topic:i,params:r,verifyContext:s}=e,n=r.request.expiryTimestamp||el(ad.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:i,params:r,verifyContext:s})}),aS(this,"sendRequest",async e=>{let t,r,{topic:s,method:n,params:a,expiry:o,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:d,appLink:h,tvf:u}=e,p=(0,rl.formatJsonRpcRequest)(n,a,l),f=!!h;try{let e=f?iI:iv;t=await this.client.core.crypto.encode(s,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(af.includes(n)){let e=iA(JSON.stringify(p)),i=iA(t);r=await this.client.core.verify.register({id:i,decryptedId:e})}let g=ad[n].req;if(g.attestation=r,o&&(g.ttl=o),c&&(g.id=c),this.client.core.history.set(s,p),f){let e=iU(h,s,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=ad[n].req;o&&(e.ttl=o),c&&(e.id=c),e.tvf=aA(aC({},u),{correlationId:p.id}),d?(e.internal=aA(aC({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,t,e)):this.client.core.relayer.publish(s,t,e).catch(e=>this.client.logger.error(e))}return p.id}),aS(this,"sendResult",async e=>{let t,r,s,{id:n,topic:a,result:o,throwOnFailedPublish:c,encodeOpts:l,appLink:d}=e,h=(0,rl.formatJsonRpcResult)(n,o),u=d&&"u">typeof(null==i.g?void 0:i.g.Linking);try{let e=u?iI:iv;t=await this.client.core.crypto.encode(a,h,aA(aC({},l||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),e}try{let e=(r=await this.client.core.history.get(a,n)).request;try{this.shouldSetTVF(e.method,e.params)&&(s=this.getTVFParams(n,e.params,o))}catch(e){this.client.logger.warn("sendResult() -> getTVFParams() failed",e)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${n}) failed`),e}if(u){let e=iU(d,a,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=ad[r.request.method].res;e.tvf=aA(aC({},s),{correlationId:n}),c?(e.internal=aA(aC({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,t,e)):this.client.core.relayer.publish(a,t,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(h)}),aS(this,"sendError",async e=>{let t,r,{id:s,topic:n,error:a,encodeOpts:o,rpcOpts:c,appLink:l}=e,d=(0,rl.formatJsonRpcError)(s,a),h=l&&"u">typeof(null==i.g?void 0:i.g.Linking);try{let e=h?iI:iv;t=await this.client.core.crypto.encode(n,d,aA(aC({},o||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{r=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(h){let e=iU(l,n,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=r.request.method,i=c||ad[e].res;this.client.core.relayer.publish(n,t,i)}await this.client.core.history.resolve(d)}),aS(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let i=!1;ed(t.expiry)&&(i=!0),this.client.core.crypto.keychain.has(t.topic)||(i=!0),i&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{ed(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),aS(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),aS(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),aS(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===au.active)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=au.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=au.idle}),aS(this,"processRequest",async e=>{let{topic:t,payload:i,attestation:r,transportType:s,encryptedId:n}=e,a=i.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:a}))switch(a){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:i,attestation:r,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,i);case"wc_sessionPing":return await this.onSessionPingRequest(t,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:i,attestation:r,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:i,attestation:r,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${a}`)}}),aS(this,"onRelayEventResponse",async e=>{let{topic:t,payload:i,transportType:r}=e,s=(await this.client.core.history.get(t,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,i,r);case"wc_sessionSettle":return this.onSessionSettleResponse(t,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,i);case"wc_sessionExtend":return this.onSessionExtendResponse(t,i);case"wc_sessionPing":return this.onSessionPingResponse(t,i);case"wc_sessionRequest":return this.onSessionRequestResponse(t,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),aS(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:i}=iX("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(i)}),aS(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:i}=e,r=this.expectedPairingMethodMap.get(t);return!(!r||r.includes(i))&&!!(r.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),aS(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:i,attestation:r,encryptedId:s}=e,{params:n,id:a}=i;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(rD.proposal_listener_not_found)),this.isValidConnect(aC({},i.params));let o=n.expiryTimestamp||el(ad.wc_sessionPropose.req.ttl),c=aC({id:a,pairingTopic:t,expiryTimestamp:o},n);await this.setProposal(a,c);let l=await this.getVerifyContext({attestationId:r,hash:iA(JSON.stringify(i)),encryptedId:s,metadata:c.proposer.metadata});e?.addTrace(rk.emit_session_proposal),this.client.events.emit("session_proposal",{id:a,params:c,verifyContext:l})}catch(e){await this.sendError({id:a,topic:t,error:e,rpcOpts:ad.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),aS(this,"onSessionProposeResponse",async(e,t,i)=>{let{id:r}=t;if((0,rl.isJsonRpcResult)(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let a=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});let o=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});let c=await this.client.core.crypto.generateSharedKey(a,o);this.pendingSessions.set(r,{sessionTopic:c,pairingTopic:e,proposalId:r,publicKey:a});let l=await this.client.core.relayer.subscribe(c,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,rl.isJsonRpcError)(t)){await this.client.proposal.delete(r,iZ("USER_DISCONNECTED"));let e=eh("session_connect",r);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),aS(this,"onSessionSettleRequest",async(e,t)=>{let{id:i,params:r}=t;try{this.isValidSessionSettleRequest(r);let{relay:i,controller:s,expiry:n,namespaces:a,sessionProperties:o,scopedProperties:c,sessionConfig:l}=t.params,d=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!d)return this.client.logger.error(`Pending session not found for topic ${e}`);let h=this.client.proposal.get(d.proposalId),u=aA(aC(aC(aC({topic:e,relay:i,expiry:n,namespaces:a,acknowledged:!0,pairingTopic:d.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:s.publicKey,self:{publicKey:d.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},o&&{sessionProperties:o}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:r_.relay});await this.client.session.set(u.topic,u),await this.setExpiry(u.topic,u.expiry),await this.client.core.pairing.updateMetadata({topic:d.pairingTopic,metadata:u.peer.metadata}),this.client.events.emit("session_connect",{session:u}),this.events.emit(eh("session_connect",d.proposalId),{session:u}),this.pendingSessions.delete(d.proposalId),this.deleteProposal(d.proposalId,!1),this.cleanupDuplicatePairings(u),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aS(this,"onSessionSettleResponse",async(e,t)=>{let{id:i}=t;(0,rl.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(eh("session_approve",i),{})):(0,rl.isJsonRpcError)(t)&&(await this.client.session.delete(e,iZ("USER_DISCONNECTED")),this.events.emit(eh("session_approve",i),{error:t.error}))}),aS(this,"onSessionUpdateRequest",async(e,t)=>{let{params:i,id:r}=t;try{let t=`${e}_session_update`,s=ro.get(t);if(s&&this.isRequestOutOfSync(s,r)){this.client.logger.warn(`Discarding out of sync request - ${r}`),this.sendError({id:r,topic:e,error:iZ("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(aC({topic:e},i));try{ro.set(t,r),await this.client.session.update(e,{namespaces:i.namespaces}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw ro.delete(t),e}this.client.events.emit("session_update",{id:r,topic:e,params:i})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),aS(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),aS(this,"onSessionUpdateResponse",(e,t)=>{let{id:i}=t,r=eh("session_update",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("session_update",i),{}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("session_update",i),{error:t.error})}),aS(this,"onSessionExtendRequest",async(e,t)=>{let{id:i}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,el(al)),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:e})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aS(this,"onSessionExtendResponse",(e,t)=>{let{id:i}=t,r=eh("session_extend",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("session_extend",i),{}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("session_extend",i),{error:t.error})}),aS(this,"onSessionPingRequest",async(e,t)=>{let{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:e})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aS(this,"onSessionPingResponse",(e,t)=>{let{id:i}=t,r=eh("session_ping",i);setTimeout(()=>{if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners 2176`);(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("session_ping",i),{}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("session_ping",i),{error:t.error})},500)}),aS(this,"onSessionDeleteRequest",async(e,t)=>{let{id:i}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(rv.publish,async()=>{t(await this.deleteSession({topic:e,id:i}))})}),this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:iZ("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),aS(this,"onSessionRequest",async e=>{var t,i,r;let{topic:s,payload:n,attestation:a,encryptedId:o,transportType:c}=e,{id:l,params:d}=n;try{await this.isValidRequest(aC({topic:s},d));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:a,hash:iA(JSON.stringify((0,rl.formatJsonRpcRequest)("wc_sessionRequest",d,l))),encryptedId:o,metadata:e.peer.metadata,transportType:c}),h={id:l,topic:s,params:d,verifyContext:n};await this.setPendingSessionRequest(h),c===r_.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(i=e.peer.metadata.redirect)?void 0:i.universal),null!=(r=this.client.signConfig)&&r.disableRequestQueue?this.emitSessionRequest(h):(this.addSessionRequestToSessionRequestQueue(h),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:s,error:e}),this.client.logger.error(e)}}),aS(this,"onSessionRequestResponse",(e,t)=>{let{id:i}=t,r=eh("session_request",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("session_request",i),{result:t.result}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("session_request",i),{error:t.error})}),aS(this,"onSessionEventRequest",async(e,t)=>{let{id:i,params:r}=t;try{let t=`${e}_session_event_${r.event.name}`,s=ro.get(t);if(s&&this.isRequestOutOfSync(s,i))return void this.client.logger.info(`Discarding out of sync request - ${i}`);this.isValidEmit(aC({topic:e},r)),this.client.events.emit("session_event",{id:i,topic:e,params:r}),ro.set(t,i)}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aS(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:i}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,rl.isJsonRpcResult)(t)?this.events.emit(eh("session_request",i),{result:t.result}):(0,rl.isJsonRpcError)(t)&&this.events.emit(eh("session_request",i),{error:t.error})}),aS(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:i,payload:r,attestation:s,encryptedId:n,transportType:a}=e;try{let{requester:e,authPayload:o,expiryTimestamp:c}=r.params,l=await this.getVerifyContext({attestationId:s,hash:iA(JSON.stringify(r)),encryptedId:n,metadata:e.metadata,transportType:a}),d={requester:e,pairingTopic:i,id:r.id,authPayload:o,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(r.id,{request:d,pairingTopic:i,transportType:a}),a===r_.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:r.params,id:r.id,verifyContext:l})}catch(n){this.client.logger.error(n);let e=r.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(r.params.requester.metadata,a);await this.sendError({id:r.id,topic:i,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:ad.wc_sessionAuthenticate.autoReject,appLink:s})}}),aS(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),aS(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=au.idle,this.processSessionRequestQueue()},(0,M.toMiliseconds)(this.requestQueueDelay))}),aS(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let i=this.client.core.history.pending;i.length>0&&i.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let i=eh("session_request",e.request.id);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);this.events.emit(eh("session_request",e.request.id),{error:t})})}),aS(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===au.active)return void this.client.logger.info("session request queue is already active.");let e=this.sessionRequestQueue.queue[0];if(!e)return void this.client.logger.info("session request queue is empty.");try{this.sessionRequestQueue.state=au.active,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),aS(this,"emitSessionRequest",e=>{this.client.events.emit("session_request",e)}),aS(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,rl.formatJsonRpcRequest)("wc_sessionPropose",aA(aC({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id)})}),aS(this,"isValidConnect",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:t,requiredNamespaces:i,optionalNamespaces:r,sessionProperties:s,scopedProperties:n,relays:a}=e;if(i2(t)||await this.isValidPairingTopic(t),!function(e,t){let i=!1;return t&&!e?i=!0:e&&i0(e)&&e.length&&e.forEach(e=>{i=i7(e)}),i}(a,!0)){let{message:e}=iX("MISSING_OR_INVALID",`connect() relays: ${a}`);throw Error(e)}if(i2(i)||0===i1(i)||this.validateNamespaces(i,"requiredNamespaces"),i2(r)||0===i1(r)||this.validateNamespaces(r,"optionalNamespaces"),i2(s)||this.validateSessionProps(s,"sessionProperties"),!i2(n)){this.validateSessionProps(n,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(r||{}));if(!Object.keys(n).every(t=>e.includes(t)))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(n)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),aS(this,"validateNamespaces",(e,t)=>{let i=function(e,t,i){let r=null;if(e&&i1(e)){let s,n=i8(e,t);n&&(r=n);let a=(s=null,Object.entries(e).forEach(([e,r])=>{var n,a;let o;if(s)return;let c=(n=K(e,r),a=`${t} ${i}`,o=null,i0(n)&&n.length?n.forEach(e=>{o||i6(e)||(o=iZ("UNSUPPORTED_CHAINS",`${a}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):i6(e)||(o=iZ("UNSUPPORTED_CHAINS",`${a}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),o);c&&(s=c)}),s);a&&(r=a)}else r=iX("MISSING_OR_INVALID",`${t}, ${i} should be an object with data`);return r}(e,"connect()",t);if(i)throw Error(i.message)}),aS(this,"isValidApprove",async e=>{if(!re(e))throw Error(iX("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:i,relayProtocol:r,sessionProperties:s,scopedProperties:n}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let a=this.client.proposal.get(t),o=i9(i,"approve()");if(o)throw Error(o.message);let c=ri(a.requiredNamespaces,i,"approve()");if(c)throw Error(c.message);if(!i5(r,!0)){let{message:e}=iX("MISSING_OR_INVALID",`approve() relayProtocol: ${r}`);throw Error(e)}if(i2(s)||this.validateSessionProps(s,"sessionProperties"),!i2(n)){this.validateSessionProps(n,"scopedProperties");let e=new Set(Object.keys(i));if(!Object.keys(n).every(t=>e.has(t)))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(n)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),aS(this,"isValidReject",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:i}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!(!e||"object"!=typeof e||!e.code||!i3(e.code,!1)||!e.message||!i5(e.message,!1))}(i)){let{message:e}=iX("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw Error(e)}}),aS(this,"isValidSessionSettleRequest",e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:t,controller:i,namespaces:r,expiry:s}=e;if(!i7(t)){let{message:e}=iX("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let n=function(e,t){let i=null;return i5(e?.publicKey,!1)||(i=iX("MISSING_OR_INVALID",`${t} controller public key should be a string`)),i}(i,"onSessionSettleRequest()");if(n)throw Error(n.message);let a=i9(r,"onSessionSettleRequest()");if(a)throw Error(a.message);if(ed(s)){let{message:e}=iX("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),aS(this,"isValidUpdate",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let r=this.client.session.get(t),s=i9(i,"update()");if(s)throw Error(s.message);let n=ri(r.requiredNamespaces,i,"update()");if(n)throw Error(n.message)}),aS(this,"isValidExtend",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),aS(this,"isValidRequest",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:t,request:i,chainId:r,expiry:s}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let{namespaces:n}=this.client.session.get(t);if(!rt(n,r)){let{message:e}=iX("MISSING_OR_INVALID",`request() chainId: ${r}`);throw Error(e)}if(!function(e){return!(i2(e)||!i5(e.method,!1))}(i)){let{message:e}=iX("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!function(e,t,i){return!!i5(i,!1)&&(function(e,t){let i=[];return Object.values(e).forEach(e=>{iV(e.accounts).includes(t)&&i.push(...e.methods)}),i})(e,t).includes(i)}(n,r,i.method)){let{message:e}=iX("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(s&&!function(e,t){return i3(e,!1)&&e<=t.max&&e>=t.min}(s,ah)){let{message:e}=iX("MISSING_OR_INVALID",`request() expiry: ${s}. Expiry must be a number (in seconds) between ${ah.min} and ${ah.max}`);throw Error(e)}}),aS(this,"isValidRespond",async e=>{var t;if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:i,response:r}=e;try{await this.isValidSessionTopic(i)}catch(i){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),i}if(!function(e){return!(i2(e)||i2(e.result)&&i2(e.error)||!i3(e.id,!1)||!i5(e.jsonrpc,!1))}(r)){let{message:e}=iX("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw Error(e)}}),aS(this,"isValidPing",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),aS(this,"isValidEmit",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:t,event:i,chainId:r}=e;await this.isValidSessionTopic(t);let{namespaces:s}=this.client.session.get(t);if(!rt(s,r)){let{message:e}=iX("MISSING_OR_INVALID",`emit() chainId: ${r}`);throw Error(e)}if(!function(e){return!(i2(e)||!i5(e.name,!1))}(i)||!function(e,t,i){return!!i5(i,!1)&&(function(e,t){let i=[];return Object.values(e).forEach(e=>{iV(e.accounts).includes(t)&&i.push(...e.events)}),i})(e,t).includes(i)}(s,r,i.name)){let{message:e}=iX("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),aS(this,"isValidDisconnect",async e=>{if(!re(e)){let{message:t}=iX("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),aS(this,"isValidAuthenticate",e=>{let{chains:t,uri:i,domain:r,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!i5(i,!1))throw Error("uri is required parameter");if(!i5(r,!1))throw Error("domain is required parameter");if(!i5(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>F(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=F(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),aS(this,"getVerifyContext",async e=>{let{attestationId:t,hash:i,encryptedId:r,metadata:s,transportType:n}=e,a={verified:{verifyUrl:s.verifyUrl||rO,validation:"UNKNOWN",origin:s.url||""}};try{if(n===r_.link_mode){let e=this.getAppLinkIfEnabled(s,n);return a.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",a}let e=await this.client.core.verify.resolve({attestationId:t,hash:i,encryptedId:r,verifyUrl:s.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a}),aS(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((i,r)=>{if(null==i){let{message:s}=iX("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${i} for key ${Object.keys(e)[r]}`);throw Error(s)}})}),aS(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),aS(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let i of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(i)}}}),aS(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:i}=iX("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(i)}}),aS(this,"isLinkModeEnabled",(e,t)=>{var r,s,n,a,o,c,l,d,h;return!!e&&t===r_.link_mode&&(null==(s=null==(r=this.client.metadata)?void 0:r.redirect)?void 0:s.linkMode)===!0&&(null==(a=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:a.universal)!==void 0&&(null==(c=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(d=e?.redirect)?void 0:d.universal)!==""&&(null==(h=e?.redirect)?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==i.g?void 0:i.g.Linking)}),aS(this,"getAppLinkIfEnabled",(e,t)=>{var i;return this.isLinkModeEnabled(e,t)?null==(i=e?.redirect)?void 0:i.universal:void 0}),aS(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=eg(e,"topic")||"",i=decodeURIComponent(eg(e,"wc_ev")||""),r=this.client.session.keys.includes(t);r&&this.client.session.update(t,{transportType:r_.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:i,sessionExists:r})}),aS(this,"registerLinkModeListeners",async()=>{var e;if(em()||Y()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==i.g?void 0:i.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),aS(this,"shouldSetTVF",(e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;let{request:i}=t;return Object.keys(ap).includes(i.method)}),aS(this,"getTVFParams",(e,t,i)=>{var r,s;try{let n=t.request.method,a=this.extractTxHashesFromResult(n,i);return aA(aC({correlationId:e,rpcMethods:[n],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(s=null==(r=t.request.params)?void 0:r[0])?void 0:s.to]}),{txHashes:a})}catch(e){this.client.logger.warn("Error getting TVF params",e)}return{}}),aS(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let i=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!i.startsWith("0x"))return!1;let r=i.slice(2);return!!/^[0-9a-fA-F]*$/.test(r)&&r.length%2==0}catch{}return!1}),aS(this,"extractTxHashesFromResult",(e,t)=>{try{let i=ap[e];if("string"==typeof t)return[t];let r=t[i.key];if(i0(r))return"solana_signAllTransactions"===e?r.map(e=>(function(e){let t=atob(e),i=new Uint8Array(t.length);for(let e=0;e<t.length;e++)i[e]=t.charCodeAt(e);let r=i[0];if(0===r)throw Error("No signatures found");if(i.length<1+64*r)throw Error("Transaction data too short for claimed signature count");if(i.length<100)throw Error("Transaction too short");let s=W.from(e,"base64").slice(1,65);return j.A.encode(s)})(e)):r;if("string"==typeof r)return[r]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,i]of Object.entries(t))for(let t of i)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){let{message:e}=iX("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(rv.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:i,attestation:r,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(ay)?this.client.auth.authKeys.get(ay):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,i,{receiverPublicKey:n,encoding:s===r_.link_mode?iI:iv});(0,rl.isJsonRpcRequest)(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:r,transportType:s,encryptedId:iA(i)})):(0,rl.isJsonRpcResponse)(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:s}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:s}),await this.client.core.relayer.messages.ack(t,i)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(rP.expired,async e=>{let{topic:t,id:i}=ec(e.target);return i&&this.client.pendingRequest.keys.includes(i)?await this.deletePendingSessionRequest(i,iX("EXPIRED"),!0):i&&this.client.auth.requests.keys.includes(i)?await this.deletePendingAuthRequest(i,iX("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i})))})}registerPairingEvents(){this.client.core.pairing.events.on(rT.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(rT.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!i5(e,!1)){let{message:t}=iX("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=iX("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ed(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=iX("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!i5(e,!1)){let{message:t}=iX("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=iX("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(ed(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=iX("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=iX("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(i5(e,!1)){let{message:t}=iX("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=iX("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=iX("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=iX("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(ed(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=iX("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class aT extends nO{constructor(e,t){super(e,t,"proposal",an),this.core=e,this.logger=t}}class ax extends nO{constructor(e,t){super(e,t,"session",an),this.core=e,this.logger=t}}class aP extends nO{constructor(e,t){super(e,t,"request",an,e=>e.id),this.core=e,this.logger=t}}class aO extends nO{constructor(e,t){super(e,t,"authKeys",ag,()=>ay),this.core=e,this.logger=t}}class aM extends nO{constructor(e,t){super(e,t,"pairingTopics",ag),this.core=e,this.logger=t}}class aR extends nO{constructor(e,t){super(e,t,"requests",ag,e=>e.id),this.core=e,this.logger=t}}var ak=Object.defineProperty,aD=(e,t,i)=>t in e?ak(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,aU=(e,t,i)=>aD(e,"symbol"!=typeof t?t+"":t,i);class aL{constructor(e,t){this.core=e,this.logger=t,aU(this,"authKeys"),aU(this,"pairingTopics"),aU(this,"requests"),this.authKeys=new aO(this.core,this.logger),this.pairingTopics=new aM(this.core,this.logger),this.requests=new aR(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var aq=Object.defineProperty,aj=(e,t,i)=>t in e?aq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,a$=(e,t,i)=>aj(e,"symbol"!=typeof t?t+"":t,i);class az extends P{constructor(e){super(e),a$(this,"protocol","wc"),a$(this,"version",2),a$(this,"name",aa.name),a$(this,"metadata"),a$(this,"core"),a$(this,"logger"),a$(this,"events",new r.EventEmitter),a$(this,"engine"),a$(this,"session"),a$(this,"proposal"),a$(this,"pendingRequest"),a$(this,"auth"),a$(this,"signConfig"),a$(this,"on",(e,t)=>this.events.on(e,t)),a$(this,"once",(e,t)=>this.events.once(e,t)),a$(this,"off",(e,t)=>this.events.off(e,t)),a$(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),a$(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),a$(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),a$(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),a$(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||aa.name,this.metadata=e?.metadata||ee(),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,o.h6)((0,o.iP)({level:e?.logger||aa.logger}));this.core=e?.core||new ar(e),this.logger=(0,o.U5)(t,this.name),this.session=new ax(this.core,this.logger),this.proposal=new aT(this.core,this.logger),this.pendingRequest=new aP(this.core,this.logger),this.engine=new aN(this),this.auth=new aL(this.core,this.logger)}static async init(e){let t=new az(e);return await t.initialize(),t}get context(){return(0,o.oI)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,M.toMiliseconds)(M.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var aB=i(60657),aH=i(29155).Buffer;let aW="error",aF="wc@2:universal_provider:",aV="https://rpc.walletconnect.org/v1/",aK="generic",aG=`${aV}bundler`,aJ={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function aY(){}function aQ(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function aX(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function aZ(e){return"object"==typeof e&&null!==e}function a0(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function a1(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let a2="[object String]",a5="[object Number]",a3="[object Boolean]",a6="[object Arguments]";function a4(e,t,i,r=new Map,s){let n=s?.(e,t,i,r);if(null!=n)return n;if(aQ(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){let t=Array(e.length);r.set(e,t);for(let n=0;n<e.length;n++)t[n]=a4(e[n],n,i,r,s);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[n,a]of(r.set(e,t),e))t.set(n,a4(a,n,i,r,s));return t}if(e instanceof Set){let t=new Set;for(let n of(r.set(e,t),e))t.add(a4(n,void 0,i,r,s));return t}if("u">typeof aH&&aH.isBuffer(e))return e.subarray();if(aX(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,t);for(let n=0;n<e.length;n++)t[n]=a4(e[n],n,i,r,s);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),a8(t,e,i,r,s),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return r.set(e,t),a8(t,e,i,r,s),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return r.set(e,t),a8(t,e,i,r,s),t}if(e instanceof Error){let t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,a8(t,e,i,r,s),t}if("object"==typeof e&&function(e){switch(a1(e)){case a6:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case a3:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case a5:case"[object Object]":case"[object RegExp]":case"[object Set]":case a2:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),a8(t,e,i,r,s),t}return e}function a8(e,t,i=e,r,s){let n=[...Object.keys(t),...a0(t)];for(let a=0;a<n.length;a++){let o=n[a],c=Object.getOwnPropertyDescriptor(e,o);(null==c||c.writable)&&(e[o]=a4(t[o],o,i,r,s))}}function a9(e){var t;return t=(t,i,r,s)=>{let n=void 0;if(null!=n)return n;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case a5:case a2:case a3:{let t=new e.constructor(e?.valueOf());return a8(t,e),t}case a6:{let t={};return a8(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}},a4(e,void 0,e,new Map,t)}function a7(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===a1(e)}var oe=Object.defineProperty,ot=Object.defineProperties,oi=Object.getOwnPropertyDescriptors,or=Object.getOwnPropertySymbols,os=Object.prototype.hasOwnProperty,on=Object.prototype.propertyIsEnumerable,oa=(e,t,i)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oo=(e,t)=>{for(var i in t||(t={}))os.call(t,i)&&oa(e,i,t[i]);if(or)for(var i of or(t))on.call(t,i)&&oa(e,i,t[i]);return e},oc=(e,t)=>ot(e,oi(t));function ol(e,t,i){var r;let s=F(e);return(null==(r=t.rpcMap)?void 0:r[s.reference])||`${aV}?chainId=${s.namespace}:${s.reference}&projectId=${i}`}function od(e){return e.includes(":")?e.split(":")[1]:e}function oh(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function ou(e={},t={}){return function(e,...t){return function(e,...t){let i=t.slice(0,-1),r=t[t.length-1],s=e;for(let e=0;e<i.length;e++)s=function e(t,i,r,s){if(aQ(t)&&(t=Object(t)),null==i||"object"!=typeof i)return t;if(s.has(i))return function(e){if(aQ(e))return e;if(Array.isArray(e)||aX(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),i=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new i(e);if(e instanceof RegExp){let t=new i(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new i(e.buffer.slice(0));if(e instanceof Error){let t=new i(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}return"u">typeof File&&e instanceof File?new i([e],e.name,{type:e.type,lastModified:e.lastModified}):"object"==typeof e?Object.assign(Object.create(t),e):e}(s.get(i));if(s.set(i,t),Array.isArray(i)){i=i.slice();for(let e=0;e<i.length;e++)i[e]=i[e]??void 0}let n=[...Object.keys(i),...a0(i)];for(let a=0;a<n.length;a++){let o=n[a],c=i[o],l=t[o];if(a7(c)&&(c={...c}),a7(l)&&(l={...l}),"u">typeof aH&&aH.isBuffer(c)&&(c=a9(c)),Array.isArray(c))if("object"==typeof l&&null!=l){let e=[],t=Reflect.ownKeys(l);for(let i=0;i<t.length;i++){let r=t[i];e[r]=l[r]}l=e}else l=[];let d=r(l,c,o,t,i,s);null!=d?t[o]=d:Array.isArray(c)||aZ(l)&&aZ(c)?t[o]=e(l,c,r,s):null==l&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return null!=t&&!!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(c)?t[o]=e({},c,r,s):null==l&&aX(c)?t[o]=a9(c):(void 0===l||void 0!==c)&&(t[o]=c)}return t}(s,i[e],r,new Map);return s}(e,...t,aY)}(op(e),op(t))}function op(e){var t,i,r,s;let n={};if(!i1(e))return n;for(let[a,o]of Object.entries(e)){let e=iK(a)?[a]:o.chains,c=o.methods||[],l=o.events||[],d=o.rpcMap||{},h=iG(a);n[h]=oc(oo(oo({},n[h]),o),{chains:eu(e,null==(t=n[h])?void 0:t.chains),methods:eu(c,null==(i=n[h])?void 0:i.methods),events:eu(l,null==(r=n[h])?void 0:r.events),rpcMap:oo(oo({},d),null==(s=n[h])?void 0:s.rpcMap)})}return n}function of(e){return e.includes(":")?e.split(":")[2]:e}function og(e){let t={};for(let[i,r]of Object.entries(e)){let e=r.methods||[],s=r.events||[],n=r.accounts||[],a=iK(i)?[i]:r.chains?r.chains:oh(r.accounts);t[i]={chains:a,methods:e,events:s,accounts:n}}return t}function oy(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let om={},ob=e=>om[e],ow=(e,t)=>{om[e]=t};var ov=Object.defineProperty,oI=(e,t,i)=>t in e?ov(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oE=(e,t,i)=>oI(e,"symbol"!=typeof t?t+"":t,i);class o_{constructor(e){oE(this,"name","polkadot"),oE(this,"client"),oE(this,"httpProviders"),oE(this,"events"),oE(this,"namespace"),oE(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=od(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var oC=Object.defineProperty,oA=Object.defineProperties,oS=Object.getOwnPropertyDescriptors,oN=Object.getOwnPropertySymbols,oT=Object.prototype.hasOwnProperty,ox=Object.prototype.propertyIsEnumerable,oP=(e,t,i)=>t in e?oC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oO=(e,t)=>{for(var i in t||(t={}))oT.call(t,i)&&oP(e,i,t[i]);if(oN)for(var i of oN(t))ox.call(t,i)&&oP(e,i,t[i]);return e},oM=(e,t)=>oA(e,oS(t)),oR=(e,t,i)=>oP(e,"symbol"!=typeof t?t+"":t,i);class ok{constructor(e){oR(this,"name","eip155"),oR(this,"client"),oR(this,"chainId"),oR(this,"namespace"),oR(this,"httpProviders"),oR(this,"events"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let i=t||ol(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.V(i,ob("disableProviderPing")))}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=parseInt(od(t));e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let r=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",s=parseInt(r=r.startsWith("0x")?r:`0x${r}`,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:r}]},chainId:null==(i=this.namespace.chains)?void 0:i[0]}),this.setDefaultChain(`${s}`);else throw Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,i,r;let s=null==(i=null==(t=e.request)?void 0:t.params)?void 0:i[0];if(!s)throw Error("Missing address parameter in `wallet_getCapabilities` request");let n=this.client.session.get(e.topic),a=(null==(r=n?.sessionProperties)?void 0:r.capabilities)||{};if(null!=a&&a[s])return a?.[s];let o=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:oM(oO({},n.sessionProperties||{}),{capabilities:oM(oO({},a||{}),{[s]:o})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return o}async getCallStatus(e){var t,i;let r=this.client.session.get(e.topic),s=null==(t=r.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(i=r.sessionProperties)?void 0:i.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var i;let r=new URL(e),s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,rl.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(i=t.request.params)?void 0:i[0]]))});if(!s.ok)throw Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${aG}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var oD=Object.defineProperty,oU=(e,t,i)=>t in e?oD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oL=(e,t,i)=>oU(e,"symbol"!=typeof t?t+"":t,i);class oq{constructor(e){oL(this,"name","solana"),oL(this,"client"),oL(this,"httpProviders"),oL(this,"events"),oL(this,"namespace"),oL(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=od(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var oj=Object.defineProperty,o$=(e,t,i)=>t in e?oj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oz=(e,t,i)=>o$(e,"symbol"!=typeof t?t+"":t,i);class oB{constructor(e){oz(this,"name","cosmos"),oz(this,"client"),oz(this,"httpProviders"),oz(this,"events"),oz(this,"namespace"),oz(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=od(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var oH=Object.defineProperty,oW=(e,t,i)=>t in e?oH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oF=(e,t,i)=>oW(e,"symbol"!=typeof t?t+"":t,i);class oV{constructor(e){oF(this,"name","algorand"),oF(this,"client"),oF(this,"httpProviders"),oF(this,"events"),oF(this,"namespace"),oF(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let i=t||ol(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rc.F(new aB.A(i,ob("disableProviderPing")))}}var oK=Object.defineProperty,oG=(e,t,i)=>t in e?oK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oJ=(e,t,i)=>oG(e,"symbol"!=typeof t?t+"":t,i);class oY{constructor(e){oJ(this,"name","cip34"),oJ(this,"client"),oJ(this,"httpProviders"),oJ(this,"events"),oJ(this,"namespace"),oJ(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let i=this.getCardanoRPCUrl(t),r=od(t);e[r]=this.createHttpProvider(r,i)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||this.getCardanoRPCUrl(e);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var oQ=Object.defineProperty,oX=(e,t,i)=>t in e?oQ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,oZ=(e,t,i)=>oX(e,"symbol"!=typeof t?t+"":t,i);class o0{constructor(e){oZ(this,"name","elrond"),oZ(this,"client"),oZ(this,"httpProviders"),oZ(this,"events"),oZ(this,"namespace"),oZ(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=od(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var o1=Object.defineProperty,o2=(e,t,i)=>t in e?o1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,o5=(e,t,i)=>o2(e,"symbol"!=typeof t?t+"":t,i);class o3{constructor(e){o5(this,"name","multiversx"),o5(this,"client"),o5(this,"httpProviders"),o5(this,"events"),o5(this,"namespace"),o5(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=od(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var o6=Object.defineProperty,o4=(e,t,i)=>t in e?o6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,o8=(e,t,i)=>o4(e,"symbol"!=typeof t?t+"":t,i);class o9{constructor(e){o8(this,"name","near"),o8(this,"client"),o8(this,"httpProviders"),o8(this,"events"),o8(this,"namespace"),o8(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let i=t||ol(`${this.name}:${e}`,this.namespace);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace);return typeof i>"u"?void 0:new rc.F(new aB.A(i,ob("disableProviderPing")))}}var o7=Object.defineProperty,ce=(e,t,i)=>t in e?o7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ct=(e,t,i)=>ce(e,"symbol"!=typeof t?t+"":t,i);class ci{constructor(e){ct(this,"name","tezos"),ct(this,"client"),ct(this,"httpProviders"),ct(this,"events"),ct(this,"namespace"),ct(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let i=t||ol(`${this.name}:${e}`,this.namespace);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace);return typeof i>"u"?void 0:new rc.F(new aB.A(i))}}var cr=Object.defineProperty,cs=(e,t,i)=>t in e?cr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cn=(e,t,i)=>cs(e,"symbol"!=typeof t?t+"":t,i);class ca{constructor(e){cn(this,"name",aK),cn(this,"client"),cn(this,"httpProviders"),cn(this,"events"),cn(this,"namespace"),cn(this,"chainId"),this.namespace=e.namespace,this.events=ob("events"),this.client=ob("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aJ.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let i={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=F(e);i[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),i}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||ol(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rc.F(new aB.A(i,ob("disableProviderPing")))}}var co=Object.defineProperty,cc=Object.defineProperties,cl=Object.getOwnPropertyDescriptors,cd=Object.getOwnPropertySymbols,ch=Object.prototype.hasOwnProperty,cu=Object.prototype.propertyIsEnumerable,cp=(e,t,i)=>t in e?co(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cf=(e,t)=>{for(var i in t||(t={}))ch.call(t,i)&&cp(e,i,t[i]);if(cd)for(var i of cd(t))cu.call(t,i)&&cp(e,i,t[i]);return e},cg=(e,t)=>cc(e,cl(t)),cy=(e,t,i)=>cp(e,"symbol"!=typeof t?t+"":t,i);class cm{constructor(e){cy(this,"client"),cy(this,"namespaces"),cy(this,"optionalNamespaces"),cy(this,"sessionProperties"),cy(this,"scopedProperties"),cy(this,"events",new(s())),cy(this,"rpcProviders",{}),cy(this,"session"),cy(this,"providerOpts"),cy(this,"logger"),cy(this,"uri"),cy(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,o.h6)((0,o.iP)({level:e?.logger||aW})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new cm(e);return await t.initialize(),t}async request(e,t,i){let[r,s]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(r).request({request:cf({},e),chainId:`${r}:${s}`,topic:this.session.topic,expiry:i})}sendAsync(e,t,i,r){let s=new Date().getTime();this.request(e,i,r).then(e=>t(null,(0,rl.formatJsonRpcResult)(s,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:iZ("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:i,response:r}=await this.client.authenticate(e,t);i&&(this.uri=i,this.events.emit("display_uri",i));let s=await r();if(this.session=s.session,this.session){let e=og(this.session.namespaces);this.namespaces=ou(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let r=await i();this.session=r;let s=og(r.namespaces);return this.namespaces=ou(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[i,r]=this.validateChain(e),s=this.getProvider(i);s.name===aK?s.setDefaultChain(`${i}:${r}`,t):s.setDefaultChain(r,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(i0(t)){for(let i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await az.init({core:this.providerOpts.core,logger:this.providerOpts.logger||aW,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(i){throw this.logger.error("Failed to get session",i),Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>iG(e)))];ow("client",this.client),ow("events",this.events),ow("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let i=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!i.length)return[];let r=[];return i.forEach(e=>{let i=t.namespaces[e].accounts;r.push(...i)}),r}(e,this.session),i=oh(t),r=cg(cf({},ou(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:i});switch(e){case"eip155":this.rpcProviders[e]=new ok({namespace:r});break;case"algorand":this.rpcProviders[e]=new oV({namespace:r});break;case"solana":this.rpcProviders[e]=new oq({namespace:r});break;case"cosmos":this.rpcProviders[e]=new oB({namespace:r});break;case"polkadot":this.rpcProviders[e]=new o_({namespace:r});break;case"cip34":this.rpcProviders[e]=new oY({namespace:r});break;case"elrond":this.rpcProviders[e]=new o0({namespace:r});break;case"multiversx":this.rpcProviders[e]=new o3({namespace:r});break;case"near":this.rpcProviders[e]=new o9({namespace:r});break;case"tezos":this.rpcProviders[e]=new ci({namespace:r});break;default:this.rpcProviders[aK]?this.rpcProviders[aK].updateNamespace(r):this.rpcProviders[aK]=new ca({namespace:r})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:i}=e;i===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:i,topic:r}=e;if(r!==(null==(t=this.session)?void 0:t.topic))return;let{event:s}=i;if("accountsChanged"===s.name){let e=s.data;e&&i0(e)&&this.events.emit("accountsChanged",e.map(of))}else if("chainChanged"===s.name){let e=i.chainId,t=i.event.data,r=iG(e),s=oy(e)!==oy(t)?`${r}:${oy(t)}`:e;this.onChainChanged(s)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i,r;if(e!==(null==(i=this.session)?void 0:i.topic))return;let{namespaces:s}=t,n=null==(r=this.client)?void 0:r.session.get(e);this.session=cg(cf({},n),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",cg(cf({},iZ("USER_DISCONNECTED")),{data:e.topic})))}),this.on(aJ.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[aK]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:i,sessionProperties:r,scopedProperties:s}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=r,this.scopedProperties=s}validateChain(e){let[t,i]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(e=>iG(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];let r=iG(Object.keys(this.namespaces)[0]),s=this.rpcProviders[r].getDefaultChain();return[r,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;let[i,r]=this.validateChain(e);r&&(t||this.getProvider(i).setDefaultChain(r),this.namespaces[i]?this.namespaces[i].defaultChain=r:this.namespaces[`${i}:${r}`]?this.namespaces[`${i}:${r}`].defaultChain=r:this.namespaces[`${i}:${r}`]={defaultChain:r},this.events.emit("chainChanged",r),await this.persist("namespaces",this.namespaces))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var i;let r=(null==(i=this.session)?void 0:i.topic)||"";await this.client.core.storage.setItem(`${aF}/${e}${r}`,t)}async getFromStore(e){var t;let i=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${aF}/${e}${i}`)}async deleteFromStore(e){var t;let i=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${aF}/${e}${i}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;for(let e of(await this.client.core.storage.getKeys()))e.startsWith(aF)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}},38311:(e,t)=>{"use strict";function i(e){return 1===e.length?"0"+e:e}function r(e){for(var t="",r=0;r<e.length;r++)t+=i(e[r].toString(16));return t}t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)i[r]=0|e[r];return i}if("hex"===t){(e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e);for(var r=0;r<e.length;r+=2)i.push(parseInt(e[r]+e[r+1],16))}else for(var r=0;r<e.length;r++){var s=e.charCodeAt(r),n=s>>8,a=255&s;n?i.push(n,a):i.push(a)}return i},t.zero2=i,t.toHex=r,t.encode=function(e,t){return"hex"===t?r(e):e}},38691:(e,t,i)=>{"use strict";i.d(t,{H:()=>r8});var r,s,n,a,o,c=i(86742),l=i(46185),d=i(36292),h=i(81243),u=i(517),p=i(29966),f=i(66328),g=i(9908),y=i(70574),m=i(64159),b=i(46729),w=i(7672),v=i(10599),I=i(80267),E=i(81104);let _=[{inputs:[{internalType:"address",name:"_implementation",type:"address"},{internalType:"bytes4",name:"_initializerSelector",type:"bytes4"},{internalType:"address",name:"_registry",type:"address"},{internalType:"bytes32",name:"_proxyBytecodeHash",type:"bytes32"},{internalType:"address",name:"_deployer",type:"address"},{internalType:"address",name:"_owner",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"ALREADY_CREATED",type:"error"},{inputs:[],name:"DEPLOYMENT_FAILED",type:"error"},{inputs:[],name:"INVALID_INITIALIZER",type:"error"},{inputs:[],name:"NOT_FROM_DEPLOYER",type:"error"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"OwnableInvalidOwner",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"OwnableUnauthorizedAccount",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"}],name:"AGWAccountCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"}],name:"AGWAccountDeployed",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"deployer",type:"address"},{indexed:!0,internalType:"bool",name:"authorized",type:"bool"}],name:"DeployerAuthorized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newImplementation",type:"address"}],name:"ImplementationChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferStarted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"previousOwner",type:"address"},{indexed:!0,internalType:"address",name:"newOwner",type:"address"}],name:"OwnershipTransferred",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newRegistry",type:"address"}],name:"RegistryChanged",type:"event"},{inputs:[],name:"acceptOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"}],name:"accountToDeployer",outputs:[{internalType:"address",name:"deployer",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"accountAddress",type:"address"}],name:"agwAccountCreated",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"deployer",type:"address"}],name:"authorizedDeployers",outputs:[{internalType:"bool",name:"authorized",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"},{internalType:"bytes4",name:"newInitializerSelector",type:"bytes4"}],name:"changeImplementation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newRegistry",type:"address"}],name:"changeRegistry",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"bytes",name:"initializer",type:"bytes"}],name:"deployAccount",outputs:[{internalType:"address",name:"accountAddress",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"}],name:"getAddressForSalt",outputs:[{internalType:"address",name:"accountAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"address",name:"_implementation",type:"address"}],name:"getAddressForSaltAndImplementation",outputs:[{internalType:"address",name:"accountAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"implementationAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"initializerSelector",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[],name:"owner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"pendingOwner",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proxyBytecodeHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"registry",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"renounceOwnership",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"salt",type:"bytes32"}],name:"saltToAccount",outputs:[{internalType:"address",name:"accountAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"deployer",type:"address"},{internalType:"bool",name:"authorized",type:"bool"}],name:"setDeployer",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"newOwner",type:"address"}],name:"transferOwnership",outputs:[],stateMutability:"nonpayable",type:"function"}],C="0x9B947df68D35281C972511B3E7BC875926f26C1A",A="0x74b9ae28EC45E3FA11533c7954752597C3De3e7A",S="0x34ca1501FAE231cC2ebc995CE013Dbe882d7d081",N="0x0000000000000000000000000000000000008006",T="0xe7931438",x="0x0000000078CC4Cc1C14E27c0fa35ED6E5E58825D",P="0xc10dcfe266c1f71ef476efbd3223555750dc271e4115626b";I.g.id,E.b.id;let O="0xfD20b9d7A406e2C4f5D6Df71ABE3Ee48B2EccC9F";var M=i(51280);class R extends b.C{constructor(){super('Transaction is not an EIP712 transaction.\n\nTransaction must:\n  - include `type: "eip712"`\n  - include one of the following: `customSignature`, `paymaster`, `paymasterInput`, `gasPerPubdata`, `factoryDeps`',{name:"InvalidEip712TransactionError"})}}function k(e){return"eip712"===e.type||"customSignature"in e&&!!e.customSignature||"paymaster"in e&&!!e.paymaster||"paymasterInput"in e&&!!e.paymasterInput||"gasPerPubdata"in e&&"bigint"==typeof e.gasPerPubdata||"factoryDeps"in e&&!!e.factoryDeps||!1}let D={[I.g.id]:I.g,[E.b.id]:E.b};function U(e){return"bigint"==typeof e?e.toString():Array.isArray(e)?e.map(U):"object"==typeof e&&null!==e?Object.fromEntries(Object.entries(e).map(([e,t])=>[e,U(t)])):e}async function L(e,t){if(void 0===e)throw Error("Initial signer is required to get smart account address");let i=(0,p.ZJ)(e),r=(0,f.S)(i);return await t.readContract({address:C,abi:_,functionName:"getAddressForSalt",args:[r]})}async function q(e,t){return void 0!==await e.getCode({address:t})}function j(e,t,i){return(0,g.p)({abi:[{name:"initialize",type:"function",inputs:[{name:"initialK1Owner",type:"address"},{name:"initialK1Validator",type:"address"},{name:"modules",type:"bytes[]"},{name:"initCall",type:"tuple",components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"value",type:"uint256"},{name:"callData",type:"bytes"}]}],outputs:[],stateMutability:"nonpayable"}],functionName:"initialize",args:[e,t,[],i]})}function $(e,t){if(e)for(let i of t)(0,y.q)(e[i])&&(e[i]=(0,m.aD)(e[i],"bigint"))}function z(e){return e.message&&e.domain?.name==="zkSync"&&e.domain?.version==="2"&&k(e.message)}function B(e){if(!z(e))throw new b.C("Typed data is not an EIP712 transaction");if(e.domain?.chainId===void 0)throw new b.C("Chain ID is required for EIP712 transaction");return{chainId:Number(e.domain.chainId),account:(0,v.J)((0,w.nj)(BigInt(e.message.from),{size:20})),to:(0,w.nj)(BigInt(e.message.to),{size:20}),gas:BigInt(e.message.gasLimit),gasPerPubdata:BigInt(e.message.gasPerPubdataByteLimit),maxFeePerGas:BigInt(e.message.maxFeePerGas),maxPriorityFeePerGas:BigInt(e.message.maxPriorityFeePerGas),paymaster:"0"!=e.message.paymaster?(0,w.nj)(BigInt(e.message.paymaster),{size:20}):void 0,nonce:e.message.nonce,value:BigInt(e.message.value),data:"0x0"===e.message.data?"0x":e.message.data,factoryDeps:e.message.factoryDeps,paymasterInput:"0x"!==e.message.paymasterInput?e.message.paymasterInput:void 0}}var H=i(78764),W=i(86673),F=i(2505),V=i(38890),K=i(44694);let G=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"ADDRESS_ALREADY_EXISTS",type:"error"},{inputs:[],name:"ADDRESS_NOT_EXISTS",type:"error"},{inputs:[],name:"BYTES_ALREADY_EXISTS",type:"error"},{inputs:[],name:"BYTES_NOT_EXISTS",type:"error"},{inputs:[],name:"CALL_FAILED",type:"error"},{inputs:[],name:"EMPTY_HOOK_ADDRESS",type:"error"},{inputs:[],name:"EMPTY_MODULE_ADDRESS",type:"error"},{inputs:[],name:"EMPTY_OWNERS",type:"error"},{inputs:[],name:"EMPTY_VALIDATORS",type:"error"},{inputs:[],name:"FEE_PAYMENT_FAILED",type:"error"},{inputs:[],name:"HOOK_ERC165_FAIL",type:"error"},{inputs:[],name:"INSUFFICIENT_FUNDS",type:"error"},{inputs:[],name:"INVALID_ADDRESS",type:"error"},{inputs:[],name:"INVALID_BYTES",type:"error"},{inputs:[],name:"INVALID_KEY",type:"error"},{inputs:[],name:"INVALID_PUBKEY_LENGTH",type:"error"},{inputs:[],name:"INVALID_SALT",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"MODULE_ERC165_FAIL",type:"error"},{inputs:[{internalType:"uint256",name:"actualValue",type:"uint256"},{internalType:"uint256",name:"expectedValue",type:"uint256"}],name:"MsgValueMismatch",type:"error"},{inputs:[],name:"NOT_FROM_BOOTLOADER",type:"error"},{inputs:[],name:"NOT_FROM_DEPLOYER",type:"error"},{inputs:[],name:"NOT_FROM_HOOK",type:"error"},{inputs:[],name:"NOT_FROM_MODULE",type:"error"},{inputs:[],name:"NOT_FROM_SELF",type:"error"},{inputs:[],name:"NOT_FROM_SELF_OR_MODULE",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{inputs:[],name:"RECUSIVE_MODULE_CALL",type:"error"},{inputs:[],name:"SAME_IMPLEMENTATION",type:"error"},{inputs:[],name:"UNAUTHORIZED_OUTSIDE_TRANSACTION",type:"error"},{inputs:[],name:"VALIDATION_HOOK_FAILED",type:"error"},{inputs:[],name:"VALIDATOR_ERC165_FAIL",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"hook",type:"address"}],name:"AddHook",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"module",type:"address"}],name:"AddModule",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"AddModuleValidator",type:"event"},{anonymous:!1,inputs:[],name:"EIP712DomainChanged",type:"event"},{anonymous:!1,inputs:[],name:"FeePaid",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"addr",type:"address"}],name:"K1AddOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"K1AddValidator",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"addr",type:"address"}],name:"K1RemoveOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"K1RemoveValidator",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes",name:"pubKey",type:"bytes"}],name:"R1AddOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"R1AddValidator",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes",name:"pubKey",type:"bytes"}],name:"R1RemoveOwner",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"R1RemoveValidator",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"hook",type:"address"}],name:"RemoveHook",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"module",type:"address"}],name:"RemoveModule",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"RemoveModuleValidator",type:"event"},{anonymous:!1,inputs:[],name:"ResetOwners",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldImplementation",type:"address"},{indexed:!0,internalType:"address",name:"newImplementation",type:"address"}],name:"Upgraded",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[],name:"VERSION",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"hookAndData",type:"bytes"},{internalType:"bool",name:"isValidation",type:"bool"}],name:"addHook",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"moduleAndData",type:"bytes"}],name:"addModule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"},{internalType:"bytes",name:"initialAccountValidationKey",type:"bytes"}],name:"addModuleValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"allowFailure",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Call[]",name:"_calls",type:"tuple[]"}],name:"batchCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"agwMessageTypeHash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"pure",type:"function"},{inputs:[{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"allowFailure",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Call[]",name:"_calls",type:"tuple[]"}],name:"batchCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"executeFromModule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"",type:"bytes32"},{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"}],name:"executeTransaction",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"}],name:"executeTransactionFromOutside",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"signedHash",type:"bytes32"}],internalType:"struct ERC1271Handler.AGWMessage",name:"agwMessage",type:"tuple"}],name:"getEip712Hash",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"hook",type:"address"},{internalType:"bytes32",name:"key",type:"bytes32"}],name:"getHookData",outputs:[{internalType:"bytes",name:"",type:"bytes"}],stateMutability:"view",type:"function"},{inputs:[],name:"implementationAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"initialK1Owner",type:"address"},{internalType:"address",name:"initialK1Validator",type:"address"},{internalType:"bytes[]",name:"modules",type:"bytes[]"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bool",name:"allowFailure",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"callData",type:"bytes"}],internalType:"struct Call",name:"initCall",type:"tuple"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"isHook",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"isModule",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"isModuleValidator",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"signedHash",type:"bytes32"},{internalType:"bytes",name:"signatureAndValidator",type:"bytes"}],name:"isValidSignature",outputs:[{internalType:"bytes4",name:"magicValue",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"k1AddOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"k1AddValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"k1IsOwner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"k1IsValidator",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"k1ListOwners",outputs:[{internalType:"address[]",name:"k1OwnerList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"k1ListValidators",outputs:[{internalType:"address[]",name:"validatorList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"}],name:"k1RemoveOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"k1RemoveValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"isValidation",type:"bool"}],name:"listHooks",outputs:[{internalType:"address[]",name:"hookList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"listModuleValidators",outputs:[{internalType:"address[]",name:"validatorList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"listModules",outputs:[{internalType:"address[]",name:"moduleList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155BatchReceived",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"",type:"bytes32"},{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"}],name:"payForTransaction",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"",type:"bytes32"},{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"}],name:"prepareForPaymaster",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"pubKey",type:"bytes"}],name:"r1AddOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"r1AddValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"pubKey",type:"bytes"}],name:"r1IsOwner",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"r1IsValidator",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"r1ListOwners",outputs:[{internalType:"bytes[]",name:"r1OwnerList",type:"bytes[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"r1ListValidators",outputs:[{internalType:"address[]",name:"validatorList",type:"address[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"pubKey",type:"bytes"}],name:"r1RemoveOwner",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"r1RemoveValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"hook",type:"address"},{internalType:"bool",name:"isValidation",type:"bool"}],name:"removeHook",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"module",type:"address"}],name:"removeModule",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"validator",type:"address"}],name:"removeModuleValidator",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"pubKey",type:"bytes"}],name:"resetOwners",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"key",type:"bytes32"},{internalType:"bytes",name:"data",type:"bytes"}],name:"setHookData",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"}],name:"upgradeTo",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"suggestedSignedHash",type:"bytes32"},{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"}],name:"validateTransaction",outputs:[{internalType:"bytes4",name:"magic",type:"bytes4"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}],J=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"}],name:"Disabled",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"}],name:"Inited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"bytes32",name:"sessionHash",type:"bytes32"},{components:[{internalType:"address",name:"signer",type:"address"},{internalType:"uint256",name:"expiresAt",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"feeLimit",type:"tuple"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"},{components:[{internalType:"enum SessionLib.Condition",name:"condition",type:"uint8"},{internalType:"uint64",name:"index",type:"uint64"},{internalType:"bytes32",name:"refValue",type:"bytes32"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"limit",type:"tuple"}],internalType:"struct SessionLib.Constraint[]",name:"constraints",type:"tuple[]"}],internalType:"struct SessionLib.CallSpec[]",name:"callPolicies",type:"tuple[]"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"}],internalType:"struct SessionLib.TransferSpec[]",name:"transferPolicies",type:"tuple[]"}],indexed:!1,internalType:"struct SessionLib.SessionSpec",name:"sessionSpec",type:"tuple"}],name:"SessionCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"bytes32",name:"sessionHash",type:"bytes32"}],name:"SessionRevoked",type:"event"},{inputs:[{internalType:"bytes",name:"sessionData",type:"bytes"}],name:"addValidationKey",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address",name:"signer",type:"address"},{internalType:"uint256",name:"expiresAt",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"feeLimit",type:"tuple"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"},{components:[{internalType:"enum SessionLib.Condition",name:"condition",type:"uint8"},{internalType:"uint64",name:"index",type:"uint64"},{internalType:"bytes32",name:"refValue",type:"bytes32"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"limit",type:"tuple"}],internalType:"struct SessionLib.Constraint[]",name:"constraints",type:"tuple[]"}],internalType:"struct SessionLib.CallSpec[]",name:"callPolicies",type:"tuple[]"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"}],internalType:"struct SessionLib.TransferSpec[]",name:"transferPolicies",type:"tuple[]"}],internalType:"struct SessionLib.SessionSpec",name:"sessionSpec",type:"tuple"}],name:"createSession",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"disable",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum OperationType",name:"operationType",type:"uint8"},{internalType:"bytes32",name:"signedHash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"handleValidation",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"data",type:"bytes"}],name:"init",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"smartAccount",type:"address"}],name:"isInited",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes32",name:"sessionHash",type:"bytes32"}],name:"revokeKey",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32[]",name:"sessionHashes",type:"bytes32[]"}],name:"revokeKeys",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{components:[{internalType:"address",name:"signer",type:"address"},{internalType:"uint256",name:"expiresAt",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"feeLimit",type:"tuple"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"},{components:[{internalType:"enum SessionLib.Condition",name:"condition",type:"uint8"},{internalType:"uint64",name:"index",type:"uint64"},{internalType:"bytes32",name:"refValue",type:"bytes32"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"limit",type:"tuple"}],internalType:"struct SessionLib.Constraint[]",name:"constraints",type:"tuple[]"}],internalType:"struct SessionLib.CallSpec[]",name:"callPolicies",type:"tuple[]"},{components:[{internalType:"address",name:"target",type:"address"},{internalType:"uint256",name:"maxValuePerUse",type:"uint256"},{components:[{internalType:"enum SessionLib.LimitType",name:"limitType",type:"uint8"},{internalType:"uint256",name:"limit",type:"uint256"},{internalType:"uint256",name:"period",type:"uint256"}],internalType:"struct SessionLib.UsageLimit",name:"valueLimit",type:"tuple"}],internalType:"struct SessionLib.TransferSpec[]",name:"transferPolicies",type:"tuple[]"}],internalType:"struct SessionLib.SessionSpec",name:"spec",type:"tuple"}],name:"sessionState",outputs:[{components:[{internalType:"uint256",name:"expiresAt",type:"uint256"},{internalType:"enum SessionLib.Status",name:"status",type:"uint8"},{internalType:"uint256",name:"feesRemaining",type:"uint256"},{components:[{internalType:"uint256",name:"remaining",type:"uint256"},{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"index",type:"uint256"}],internalType:"struct SessionLib.LimitState[]",name:"transferValue",type:"tuple[]"},{components:[{internalType:"uint256",name:"remaining",type:"uint256"},{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"index",type:"uint256"}],internalType:"struct SessionLib.LimitState[]",name:"callValue",type:"tuple[]"},{components:[{internalType:"uint256",name:"remaining",type:"uint256"},{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"uint256",name:"index",type:"uint256"}],internalType:"struct SessionLib.LimitState[]",name:"callParams",type:"tuple[]"}],internalType:"struct SessionLib.SessionState",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"sessionHash",type:"bytes32"}],name:"sessionStatus",outputs:[{internalType:"enum SessionLib.Status",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes32",name:"signedHash",type:"bytes32"},{components:[{internalType:"uint256",name:"txType",type:"uint256"},{internalType:"uint256",name:"from",type:"uint256"},{internalType:"uint256",name:"to",type:"uint256"},{internalType:"uint256",name:"gasLimit",type:"uint256"},{internalType:"uint256",name:"gasPerPubdataByteLimit",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"uint256",name:"paymaster",type:"uint256"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256[4]",name:"reserved",type:"uint256[4]"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"},{internalType:"bytes32[]",name:"factoryDeps",type:"bytes32[]"},{internalType:"bytes",name:"paymasterInput",type:"bytes"},{internalType:"bytes",name:"reservedDynamic",type:"bytes"}],internalType:"struct Transaction",name:"transaction",type:"tuple"},{internalType:"bytes",name:"hookData",type:"bytes"}],name:"validationHook",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"pure",type:"function"}];var Y=i(25678),Q=i(26357),X=i(4377);function Z(){return(0,Y.iY)({abi:J,name:"createSession"}).inputs[0]}function ee(e){return(0,Q.h)([Z()],[e])}function et(e,t){return(0,Q.h)([Z(),{type:"uint64[]"}],[e,t])}!function(e){e[e.Unlimited=0]="Unlimited",e[e.Lifetime=1]="Lifetime",e[e.Allowance=2]="Allowance"}(r||(r={})),r.Unlimited,r.Lifetime,function(e){e[e.Unconstrained=0]="Unconstrained",e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.Less=3]="Less",e[e.GreaterEqual=4]="GreaterEqual",e[e.LessEqual=5]="LessEqual",e[e.NotEqual=6]="NotEqual"}(s||(s={})),function(e){e[e.NotInitialized=0]="NotInitialized",e[e.Active=1]="Active",e[e.Closed=2]="Closed",e[e.Expired=3]="Expired"}(n||(n={}));let ei=e=>{let t=e.timestamp||BigInt(Math.floor(Date.now()/1e3)),i=(0,X.b)(e.target),s=e=>e.limitType===r.Allowance?t/e.period:0n,n=!!e.selector&&e.selector.length>=10,a=n?e.sessionConfig.callPolicies.find(t=>t.target.toLowerCase()===i.toLowerCase()&&t.selector==e.selector):e.sessionConfig.transferPolicies.find(e=>e.target.toLowerCase()===i.toLowerCase());if(!a)throw Error("Transaction does not fit any policy");return[s(e.sessionConfig.feeLimit),s(a.valueLimit),...n?a.constraints.map(e=>s(e.limit)):[]]};function er(e){return(0,f.S)(ee(e))}async function es(e,t,i){let r,{session:s,...n}=i;if(await q(t,e.account.address)&&await en(e))r=await (0,K.T)(e,F.E,"writeContract")({address:S,abi:J,functionName:"createSession",args:[s],...n});else{let t=ee(s);r=await (0,K.T)(e,F.E,"writeContract")({address:e.account.address,abi:G,functionName:"addModule",args:[(0,W.aP)([S,t])],...n})}return{transactionHash:r,session:s}}async function en(e){return(await (0,K.T)(e,V.J,"readContract")({address:e.account.address,abi:G,functionName:"listHooks",args:[!0]})).some(e=>e===S)}var ea=i(85375),eo=i(48720);let ec=[{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],name:"AccountNonceOrderingUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"accountAddress",type:"address"},{indexed:!1,internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"aaVersion",type:"uint8"}],name:"AccountVersionUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"deployerAddress",type:"address"},{indexed:!0,internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{indexed:!0,internalType:"address",name:"contractAddress",type:"address"}],name:"ContractDeployed",type:"event"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"create2",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"create2Account",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"},{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_aaVersion",type:"uint8"}],name:"createAccount",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"extendedAccountVersion",outputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"_keccak256BytecodeHash",type:"bytes32"}],name:"forceDeployKeccak256",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment",name:"_deployment",type:"tuple"},{internalType:"address",name:"_sender",type:"address"}],name:"forceDeployOnAddress",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"bytecodeHash",type:"bytes32"},{internalType:"address",name:"newAddress",type:"address"},{internalType:"bool",name:"callConstructor",type:"bool"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"input",type:"bytes"}],internalType:"struct ContractDeployer.ForceDeployment[]",name:"_deployments",type:"tuple[]"}],name:"forceDeployOnAddresses",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_address",type:"address"}],name:"getAccountInfo",outputs:[{components:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"supportedAAVersion",type:"uint8"},{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"nonceOrdering",type:"uint8"}],internalType:"struct IContractDeployer.AccountInfo",name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"uint256",name:"_senderNonce",type:"uint256"}],name:"getNewAddressCreate",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"_sender",type:"address"},{internalType:"bytes32",name:"_bytecodeHash",type:"bytes32"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"bytes",name:"_input",type:"bytes"}],name:"getNewAddressCreate2",outputs:[{internalType:"address",name:"newAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountAbstractionVersion",name:"_version",type:"uint8"}],name:"updateAccountVersion",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"enum IContractDeployer.AccountNonceOrdering",name:"_nonceOrdering",type:"uint8"}],name:"updateNonceOrdering",outputs:[],stateMutability:"nonpayable",type:"function"}];var el=i(29451);let ed="/docs/contract/encodeDeployData";function eh(e,t,i,r){let s=[t,i,r];return({create:{functionName:"create",argsContractDeployer:s},create2:{functionName:"create2",argsContractDeployer:s},createAccount:{functionName:"createAccount",argsContractDeployer:[...s,1]},create2Account:{functionName:"create2Account",argsContractDeployer:[...s,1]}})[e||"create"]}var eu=i(82330);class ep extends b.C{constructor(){super("Insufficient balance for transaction.",{name:"InsufficientBalanceError"})}}let ef=(e,t)=>"bigint"==typeof e?t(e):Array.isArray(e)?e.map(e=>ef(e,t)):e&&"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,i])=>[e,ef(i,t)])):e;async function eg(e,t){return await e.request({method:"privy_signSmartWalletMessage",params:[t.message]},{retryCount:0})}async function ey(e,t){return await e.request({method:"privy_signSmartWalletTypedData",params:[e.account.address,t]},{retryCount:0})}async function em(e,t){let{chain:i,account:r,...s}=t;return await e.request({method:"privy_signSmartWalletTx",params:[ef(s,w.nj)]},{retryCount:0})}var eb=i(95148),ew=i(54914);class ev extends b.C{constructor({docsPath:e}={}){super("Could not find an Account to execute with this Action.\nPlease provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client.",{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}var eI=i(49564),eE=i(48275),e_=i(99498),eC=i(77032),eA=i(807),eS=i(81611);async function eN(e,t){let{account:i,...r}=t,s=i?(0,v.J)(i):e.account,n=e.chain?.formatters,a=n?.transactionRequest?.format({...r,from:s?.address}),o=await e.request({method:"zks_estimateFee",params:[a]});return{gasLimit:(0,m.uU)(o.gas_limit),gasPerPubdataLimit:(0,m.uU)(o.gas_per_pubdata_limit),maxPriorityFeePerGas:(0,m.uU)(o.max_priority_fee_per_gas),maxFeePerGas:(0,m.uU)(o.max_fee_per_gas)}}let eT=[{type:"function",name:"DELEGATE_REGISTRY",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"GLOBAL_DELEGATION",inputs:[],outputs:[{name:"",type:"bytes24",internalType:"bytes24"}],stateMutability:"view"},{type:"function",name:"decodeRightsExpiration",inputs:[{name:"rights",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes24",internalType:"bytes24"},{name:"",type:"uint40",internalType:"uint40"}],stateMutability:"pure"},{type:"function",name:"delegatedWalletsByRights",inputs:[{name:"wallet",type:"address",internalType:"address"},{name:"rights",type:"bytes24",internalType:"bytes24"}],outputs:[{name:"",type:"address[]",internalType:"address[]"}],stateMutability:"view"},{type:"function",name:"exclusiveOwnerByRights",inputs:[{name:"contractAddress",type:"address",internalType:"address"},{name:"tokenId",type:"uint256",internalType:"uint256"},{name:"rights",type:"bytes24",internalType:"bytes24"}],outputs:[{name:"owner",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"exclusiveWalletByRights",inputs:[{name:"vault",type:"address",internalType:"address"},{name:"rights",type:"bytes24",internalType:"bytes24"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"generateRightsWithExpiration",inputs:[{name:"rightsIdentifier",type:"bytes24",internalType:"bytes24"},{name:"expiration",type:"uint40",internalType:"uint40"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"pure"}];var ex=i(14729);let eP=["blobVersionedHashes","chainId","fees","gas","nonce","type"];class eO extends b.C{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${(0,eI.Q)(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}async function eM(e,t,i,r){let s,n;$(r,["value","nonce","maxFeePerGas","maxPriorityFeePerGas","gas","chainId","gasPerPubdata"]);let a="paymaster"in r&&"paymasterInput"in r&&void 0!==r.paymaster&&void 0!==r.paymasterInput,{gas:o,nonce:c,parameters:l=eP}=r,d=await q(i,e.account.address);if(!d){let e={target:r.to,allowFailure:!1,value:r.value??0,callData:r.data??"0x"},i=j(t.account.address,A,e),s=(0,p.ZJ)(t.account.address),n=(0,f.S)(s),a=(0,g.p)({abi:_,functionName:"deployAccount",args:[n,i]});r.to=C,r.data=a}let h=(0,v.J)(d?e.account:t.account),u={...r,from:h.address},y=[];(!a||void 0!==u.value&&u.value>0n)&&y.push((0,eC.r)(i,{address:h.address}).then(e=>{s=e})),l.includes("nonce")&&void 0===c&&h&&y.push((0,K.T)(i,eA.y,"getTransactionCount")({address:h.address,blockTag:"pending"}).then(e=>{u.nonce=e})),l.includes("fees")&&(void 0===u.maxFeePerGas||void 0===u.maxPriorityFeePerGas)&&y.push((async()=>{let e,t;if(u.to===N)e=25000000n,t=0n;else{let r,s={account:h,to:u.to,value:u.value,data:u.data,gas:u.gas,nonce:u.nonce,chainId:u.chainId,authorizationList:[]};try{r=await eN(i,s)}catch(e){if(e instanceof Error&&e.message.includes(T))throw new ep;if(e instanceof eE.J8&&e.details.includes("execution reverted"))throw new e_.A7({message:`${e.data}`});throw e}e=r.maxFeePerGas,t=r.maxPriorityFeePerGas,n=r.gasLimit}if(void 0===r.maxPriorityFeePerGas&&r.maxFeePerGas&&r.maxFeePerGas<t)throw new eO({maxPriorityFeePerGas:t});u.maxPriorityFeePerGas=t,u.maxFeePerGas=e,void 0===o&&(u.gas=n)})()),await Promise.all(y);let m=!a&&u.gas&&u.maxFeePerGas?u.gas*u.maxFeePerGas:0n;if(void 0!==s&&s<(u.value??0n)+m)throw new ep;return l.includes("gas")&&void 0===o&&void 0===n&&(u.gas=await (0,K.T)(e,eS.Q,"estimateGas")({...u,account:h?{address:h.address,type:"json-rpc"}:void 0})),(0,M.c)(u),delete u.parameters,delete u.isInitialTransaction,u}var eR=i(62595),ek=i(6875),eD=i(92201),eU=i(11273),eL=i(27053);let eq=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AccessControlBadConfirmation",type:"error"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"bytes32",name:"neededRole",type:"bytes32"}],name:"AccessControlUnauthorizedAccount",type:"error"},{inputs:[{internalType:"address",name:"target",type:"address"}],name:"AddressEmptyCode",type:"error"},{inputs:[{internalType:"address",name:"implementation",type:"address"}],name:"ERC1967InvalidImplementation",type:"error"},{inputs:[],name:"ERC1967NonPayable",type:"error"},{inputs:[],name:"FailedCall",type:"error"},{inputs:[],name:"InvalidInitialization",type:"error"},{inputs:[],name:"NotInitializing",type:"error"},{inputs:[],name:"UUPSUnauthorizedCallContext",type:"error"},{inputs:[{internalType:"bytes32",name:"slot",type:"bytes32"}],name:"UUPSUnsupportedProxiableUUID",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint64",name:"version",type:"uint64"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"enum PolicyType",name:"policyType",type:"uint8"},{indexed:!0,internalType:"address",name:"target",type:"address"},{indexed:!0,internalType:"bytes32",name:"data",type:"bytes32"},{indexed:!1,internalType:"enum Status",name:"status",type:"uint8"}],name:"PolicyStatusChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"implementation",type:"address"}],name:"Upgraded",type:"event"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"MANAGER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"UPGRADE_INTERFACE_VERSION",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"target",type:"address"}],name:"getApprovalTargetStatus",outputs:[{internalType:"enum Status",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"getCallPolicyStatus",outputs:[{internalType:"enum Status",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"}],name:"getTransferPolicyStatus",outputs:[{internalType:"enum Status",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"owner",type:"address"}],name:"initialize",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"proxiableUUID",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"callerConfirmation",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"address",name:"target",type:"address"},{internalType:"enum Status",name:"status",type:"uint8"}],name:"setApprovalTargetStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"bytes4",name:"selector",type:"bytes4"},{internalType:"enum Status",name:"status",type:"uint8"}],name:"setCallPolicyStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"target",type:"address"},{internalType:"enum Status",name:"status",type:"uint8"}],name:"setTransferPolicyStatus",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newImplementation",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"upgradeToAndCall",outputs:[],stateMutability:"payable",type:"function"}],ej=new Set([(0,eD.V)("function setApprovalForAll(address, bool)"),(0,eD.V)("function approve(address, uint256)"),(0,eD.V)("function transfer(address, uint256)")]);async function e$(e,t,i,r){if(t!==E.b.id)return;let n=[];if(r.to===i.address&&r.data?.substring(0,10)==="0x8f0273a9"){let e=(0,eU.J)({abi:G,data:r.data});if("batchCall"===e.functionName)for(let t of e.args[0]){let e=ez(i,{...r,to:t.target,data:t.callData});e&&n.push(e)}}else{let e=ez(i,r);e&&n.push(e)}if(0!==n.length)for(let t of n){let i=t.callPolicies,r=t.transferPolicies,n=[];for(let e of i)if(ej.has(e.selector)){let t=e.constraints.filter(e=>0n===e.index&&e.condition===s.Equal);if(0===t.length)throw new b.C(`Unconstrained token approval/transfer destination in call policy. Selector: ${e.selector}; Target: ${e.target}`);for(let i of t){let[t]=(0,eL.n)([{type:"address"}],i.refValue);n.push({target:t,check:{address:O,abi:eq,functionName:"getApprovalTargetStatus",args:[e.target,t]}})}}else n.push({target:e.target,check:{address:O,abi:eq,functionName:"getCallPolicyStatus",args:[e.target,e.selector]}});for(let e of r)n.push({target:e.target,check:{address:O,abi:eq,functionName:"getTransferPolicyStatus",args:[e.target]}});let o=await e.multicall({contracts:n.map(e=>e.check),allowFailure:!1});for(let e=0;e<n.length;e++){let t=o[e],i=n[e];if(Number(t)!==a.Allowed)throw new b.C(`Session key policy violation. Target: ${i?.target}; Status: ${a[Number(t)]}`)}}}function ez(e,t){if(t.to===S&&t.data?.substring(0,10)==="0x5a0694d2"){let e=(0,eU.J)({abi:J,data:t.data});if("createSession"===e.functionName)return e.args[0]}if(t.to===e?.address&&t.data?.substring(0,10)==="0xd3bdf4b5"){let e=(0,eU.J)({abi:G,data:t.data});if("addModule"===e.functionName&&e.args[0].toLowerCase().startsWith(S.toLowerCase())){let t=e.args[0].substring(42);return(0,eL.n)([Z()],`0x${t}`)[0]}}}async function eB(e,t,i,r,s,n={},a,o=!1){let c=e.chain;if(o)return em(e,r);if(!c?.serializers?.transaction)throw new b.C("transaction serializer not found on chain.");let{transaction:l,customSignature:d}=await eH(e,t,i,r,s,n,a);return c.serializers.transaction({...l,customSignature:d,type:"eip712"},{r:"0x0",s:"0x0",v:0n})}async function eH(e,t,i,r,s,n={},a){let o,{account:c=e.account,chain:l=e.chain,...d}=r;if(d.type="eip712",$(d,["value","nonce","maxFeePerGas","maxPriorityFeePerGas","gas","chainId","gasPerPubdata"]),!c)throw new ev({docsPath:"/docs/actions/wallet/signTransaction"});let h=(0,v.J)(c),u=d.from===t.account.address,p=u?t.account:h;var f={account:p,chain:l,...d};if(!k(f))throw new R;if((0,M.c)(f),!l||void 0===D[l.id])throw new b.C("Invalid chain specified");if(!l?.custom?.getEip712Domain)throw new b.C("`getEip712Domain` not found on chain.");let g=await (0,K.T)(e,H.T,"getChainId")({});null!==l&&(0,ew.v)({currentChainId:g,chain:l}),await e$(i,g,p,d);let y=await eW(g,p,d,a);void 0===y.data&&(y.data="0x");let m=l?.custom.getEip712Domain({...y,type:"eip712"}),w=await (0,ek.C)(t,{...m,account:t.account});if(u)o=w;else{let t=[];if(!u)for(let i of(await (0,K.T)(e,V.J,"readContract")({address:e.account.address,abi:G,functionName:"listHooks",args:[!0]})))t.push(n[i]??"0x");o=(0,Q.h)((0,eR.m)(["bytes","address","bytes[]"]),[w,s,t])}return{transaction:y,customSignature:o}}async function eW(e,t,i,r){if(r&&!i.paymaster&&!i.paymasterInput){let s=await r({chainId:e,from:t.address,data:i.data,gas:i.gas??0n,gasPrice:i.gasPrice??0n,gasPerPubdata:i.gasPerPubdata??0n,maxFeePerGas:i.maxFeePerGas??0n,maxPriorityFeePerGas:i.maxPriorityFeePerGas??0n,nonce:i.nonce??0,to:i.to??"0x0",value:i.value??0n});return{...i,...s,from:t.address,chainId:e}}return{...i,from:t.address,chainId:e}}async function eF(e,t,i,r,s,n={},a){let{chain:o=e.chain}=r;if(!t.account)throw new ev({docsPath:"/docs/actions/wallet/sendTransaction"});let c=(0,v.J)(t.account);try{let c,l=await eM(e,t,i,{...r,parameters:["gas","nonce","fees"],isSponsored:void 0!==a||void 0!==r.paymaster});null!==o&&(c=await (0,K.T)(t,H.T,"getChainId")({}),(0,ew.v)({currentChainId:c,chain:o}));let d=await eB(e,t,i,{...l,chainId:c},s,n,a);return await (0,K.T)(e,eb.L,"sendRawTransaction")({serializedTransaction:d})}catch(e){if(e instanceof Error&&e.message.includes(T))throw new ep;throw(0,eu.p)(e,{...r,account:c,chain:o})}}async function eV(e,t,i,r,s=!1,n){if(s)try{let t={};!n||r.paymaster||r.paymasterInput||(t=await n({...r,from:e.account.address,chainId:r.chain?.id??e.chain.id}));let s={...r,...t},a=await em(e,s);return await i.sendRawTransaction({serializedTransaction:a})}catch(e){if(e instanceof Error&&e.message.includes(T))throw new ep;throw(0,eu.p)(e,{...r,account:r.account?(0,v.J)(r.account):null,chain:r.chain??void 0})}return eF(e,t,i,r,A,{},n)}!function(e){e[e.Unset=0]="Unset",e[e.Allowed=1]="Allowed",e[e.Denied=2]="Denied"}(a||(a={}));var eK=i(74655),eG=i(17190);async function eJ(e,t){let{agwAddress:i}=t;if(!(0,eK.P)(i,{strict:!1}))throw new eG.M({address:i});let r=(0,X.b)(i);return{linkedAccounts:[...await (0,K.T)(e,V.J,"readContract")({abi:eT,address:x,functionName:"delegatedWalletsByRights",args:[r,P]})]}}async function eY(e,t){let{address:i=e.account?.address}=t;if(void 0===i)throw new b.C("No address provided");if(!(0,eK.P)(i,{strict:!1}))throw new eG.M({address:i});let r=(0,X.b)(i),s=await (0,K.T)(e,V.J,"readContract")({abi:eT,address:x,functionName:"exclusiveWalletByRights",args:[r,P]});return s===r?{agw:void 0}:{agw:s}}async function eQ(e,t){let{address:i}=t;if(void 0===e.account)throw new ev({docsPath:"/docs/contract/readContract"});let r=(0,v.J)(e.account),{agw:s}=await eY(e,{address:i});return s===r.address}async function eX(e,t,i){let r="string"==typeof i?i:er(i);return await e.readContract({address:S,abi:J,functionName:"sessionStatus",args:[t,r]})}async function eZ(e,t){let{session:i,...r}=t,s="string"==typeof i?[i]:Array.isArray(i)?i.map(e0):[er(i)];return{transactionHash:await (0,K.T)(e,F.E,"writeContract")({address:S,abi:J,functionName:"revokeKeys",args:[s],...r})}}function e0(e){return"string"==typeof e?e:er(e)}function e1(e,t){let{calls:i,paymaster:r,paymasterInput:s}=t,n=i.map(e=>{if(!e.to)throw Error("Transaction target (to) is required");return{target:e.to,allowFailure:!1,value:BigInt(e.value??0),callData:e.data??"0x"}}),a=(0,g.p)({abi:G,functionName:"batchCall",args:[n]});return{to:e,data:a,value:n.reduce((e,t)=>e+BigInt(t.value),BigInt(0)),paymaster:r,paymasterInput:s,type:"eip712"}}async function e2(e,t,i,r,s=!1,n){let{calls:a,...o}=r;if(0===a.length)throw Error("No calls provided");if(s){let t=await em(e,r);return await i.sendRawTransaction({serializedTransaction:t})}let c=e1(e.account.address,r);return eF(e,t,i,{...c,...o},A,{},n)}async function e5(e,t,i,r,s,n){let a=r.data?`0x${r.data.slice(2,10)}`:void 0;if(!r.to)throw new b.C("Transaction to field is not specified");return eF(e,t,i,r,S,{[S]:et(s,ei({sessionConfig:s,target:r.to,selector:a,timestamp:BigInt(Math.floor(Date.now()/1e3))}))},n)}var e3=i(2513),e6=i(67466),e4=i(65350),e8=i(66248),e9=i(8997);async function e7(e){let{client:t,signer:i,messageHash:r}=e,s=t.chain.id,n=t.account,a=await (0,ek.C)(i,{domain:{name:"AbstractGlobalWallet",version:"1.0.0",chainId:BigInt(s),verifyingContract:n.address},types:{EIP712Domain:[{name:"name",type:"string"},{name:"version",type:"string"},{name:"chainId",type:"uint256"},{name:"verifyingContract",type:"address"}],AGWMessage:[{name:"signedHash",type:"bytes32"}]},message:{signedHash:r},primaryType:"AGWMessage"}),o=(0,Q.h)((0,eR.m)(["bytes","address"]),[a,A]);if(void 0!==await (0,e9.Q)(t,{address:n.address}))return o;let c=(0,p.ZJ)(i.account.address),l=(0,f.S)(c);return(0,e4.E)({address:C,data:(0,g.p)({abi:_,functionName:"deployAccount",args:[l,j(i.account.address,A,{target:e8.Xd,allowFailure:!1,callData:"0x",value:0n})]}),signature:o})}async function te(e,t,i,r=!1){return r?("object"==typeof i.message&&(i.message.raw instanceof Uint8Array?i.message=(0,e3.Ar)(i.message.raw):i.message=(0,m.aD)(i.message.raw,"string")),await eg(e,i)):await e7({client:e,signer:t,messageHash:(0,e6.A)(i.message)})}async function tt(e,t,i,r,s,n={},a,o=!1){let{calls:c,...l}=r;if(0===c.length)throw Error("No calls provided");if(o)return await em(e,r);let d=e1(e.account.address,r);return eB(e,t,i,{...d,...l},s,n,a)}async function ti(e,t,i,r,s,n){if(!await q(i,e.account.address))throw new b.C("Smart account not deployed");let a=r.data?`0x${r.data.slice(2,10)}`:void 0;if(!r.to)throw new b.C("Transaction to field is not specified");return await eB(e,t,i,r,S,{[S]:et(s,ei({sessionConfig:s,target:r.to,selector:a,timestamp:BigInt(Math.floor(Date.now()/1e3))}))},n)}var tr=i(20391),ts=i(43506);function tn(e,t,i){if(128===i&&t<128)return 1;if(t<=i+55)return t-i;if(t===i+55+1)return e.readUint8();if(t===i+55+2)return e.readUint16();if(t===i+55+3)return e.readUint24();if(t===i+55+4)return e.readUint32();throw new b.C("Invalid RLP prefix")}var ta=i(74737);async function to(e,t,i,r,s=!1){if(z(r)){let n=B(r);if(n.chainId!==e.chain.id)throw new b.C("Chain ID mismatch in AGW typed signature");let a=await eB(e,t,i,{...n,chain:e.chain},A,{},void 0,s);if(!a.startsWith("0x71"))throw new b.C("Expected RLP encoded EIP-712 transaction as signature");let o=function(e,t="hex"){let i=(()=>{if("string"==typeof e){if(e.length>3&&e.length%2!=0)throw new tr.G6(e);return(0,p.aT)(e)}return e})();return function e(t,i="hex"){if(0===t.bytes.length)return"hex"===i?(0,w.My)(t.bytes):t.bytes;let r=t.readByte();if(r<128&&t.decrementPosition(1),r<192){let e=tn(t,r,128),s=t.readBytes(e);return"hex"===i?(0,w.My)(s):s}let s=tn(t,r,192);var n=t,a=s,o=i;let c=n.position,l=[];for(;n.position-c<a;)l.push(e(n,o));return l}((0,ts.l)(i,{recursiveReadLimit:Number.POSITIVE_INFINITY}),t)}(`0x${a.slice(4)}`,"hex");if(o.length<15)throw new b.C("Expected RLP encoded EIP-712 transaction with at least 15 fields");return o[14]}return s?await ey(e,r):await e7({client:e,signer:t,messageHash:(0,ta.Zh)(r)})}async function tc(e,t,i,r,s,n){if(!z(r))throw new b.C("Session client can only sign EIP712 transactions as typed data");let a=B(r);if(!a.to)throw new b.C("Transaction must have a to address");let o={[S]:et(s,ei({sessionConfig:s,target:a.to,selector:a.data?.slice(0,10)??"0x",timestamp:BigInt(Math.floor(Date.now()/1e3))}))},{customSignature:c}=await eH(e,t,i,{chain:e.chain,...a},S,o,n);return c}var tl=i(90132);async function td(e,t,i,r,s=!1){let{abi:n,account:a=e.account,address:o,args:c,dataSuffix:l,functionName:d,...h}=r;if(!a)throw new ev({docsPath:"/docs/contract/writeContract"});let u=(0,v.J)(a),p=(0,g.p)({abi:n,args:c,functionName:d});try{return await eV(e,t,i,{data:`${p}${l?l.replace("0x",""):""}`,to:o,account:u,...h},s)}catch(e){throw(0,tl.j)(e,{abi:n,address:o,args:c,docsPath:"/docs/contract/writeContract",functionName:d,sender:u.address})}}async function th(e,t,i,r,s,n){let{abi:a,account:o=e.account,address:c,args:l,dataSuffix:d,functionName:h,...u}=r;if(!o)throw new ev({docsPath:"/docs/contract/writeContract"});let p=(0,v.J)(o),f=(0,g.p)({abi:a,args:l,functionName:h});try{return await e5(e,t,i,{data:`${f}${d?d.replace("0x",""):""}`,to:c,account:p,...u},s,n)}catch(e){throw(0,tl.j)(e,{abi:a,address:c,args:l,docsPath:"/docs/contract/writeContract",functionName:h,sender:p.address})}}async function tu({signer:e,chain:t,transport:i,address:r,isPrivyCrossApp:s=!1,publicTransport:n=(0,c.L)(),customPaymasterHandler:a}){if(!i)throw Error("Transport is required");let o=(0,l.l)({chain:t,transport:n}),p=r??await L(e.address,o),f=(0,d.U)({account:(0,u.t)(p),chain:t,transport:i}),y=(0,h.F)({account:e,chain:t,transport:i});return f.extend(function(e,t,i=!1,r){return s=>({getChainId:()=>(0,H.T)(s),getLinkedAccounts:()=>eJ(s,{agwAddress:(0,v.J)(s.account).address}),isLinkedAccount:e=>eQ(s,e),createSession:e=>es(s,t,e),revokeSessions:e=>eZ(s,e),prepareAbstractTransactionRequest:i=>eM(s,e,t,i),sendTransaction:n=>eV(s,e,t,n,i,r),sendTransactionBatch:n=>e2(s,e,t,n,i,r),signMessage:t=>te(s,e,t,i),signTransaction:n=>eB(s,e,t,n,A,{},r,i),signTransactionBatch:n=>tt(s,e,t,n,A,{},r,i),signTypedData:r=>to(s,e,t,r,i),deployContract:r=>(function(e,t,i,r,s=!1){let{abi:n,args:a,bytecode:o,deploymentType:c,salt:l,...d}=r,h=function(e){let{abi:t,args:i,bytecode:r,deploymentType:s,salt:n}=e;if(!i||0===i.length){let{functionName:e,argsContractDeployer:t}=eh(s,n??ea.t,(0,w.nj)((0,el.Y)(r)),"0x");return(0,g.p)({abi:ec,functionName:e,args:t})}let a=t.find(e=>"type"in e&&"constructor"===e.type);if(!a)throw new eo.YW({docsPath:ed});if(!("inputs"in a)||!a.inputs||0===a.inputs.length)throw new eo.YF({docsPath:ed});let o=(0,Q.h)(a.inputs,i),{functionName:c,argsContractDeployer:l}=eh(s,n??ea.t,(0,w.nj)((0,el.Y)(r)),o);return(0,g.p)({abi:ec,functionName:c,args:l})}({abi:n,args:a,bytecode:o,deploymentType:c,salt:l});return d.factoryDeps=d.factoryDeps||[],d.factoryDeps.includes(o)||d.factoryDeps.push(o),eV(e,t,i,{...d,data:h,to:N},s)})(s,e,t,r,i),writeContract:n=>td(Object.assign(s,{sendTransaction:n=>eV(s,e,t,n,i,r)}),e,t,n,i),toSessionClient:(e,t)=>(function({client:e,signer:t,session:i,paymasterHandler:r}){return function({account:e,signer:t,chain:i,transport:r,session:s,paymasterHandler:n}){var a,o,p,f;r||(r=(0,c.L)());let g=(0,l.l)({transport:r,chain:i}),y=(0,d.U)({account:"string"==typeof e?(0,u.t)(e):e,chain:i,transport:r}),m=(0,h.F)({account:t,chain:i,transport:r});return y.extend((a=m,o=g,p=s,f=n,e=>({sendTransaction:t=>e5(e,a,o,t,p,f),writeContract:t=>th(e,a,o,t,p,f),signTransaction:t=>ti(e,a,o,t,p,f),signTypedData:t=>tc(e,a,o,t,p,f),getSessionStatus:()=>eX(o,(0,v.J)(e.account).address,p)})))}({account:e.account,chain:e.chain,session:i,signer:t,transport:(0,ex.I)(e.transport),paymasterHandler:r})})({client:s,signer:e,session:t,paymasterHandler:r}),getSessionStatus:e=>eX(t,(0,v.J)(s.account).address,e)})}(y,o,s,a))}!function(e){e[e.Pending=100]="Pending",e[e.Confirmed=200]="Confirmed",e[e.OffchainFailure=400]="OffchainFailure",e[e.Reverted=500]="Reverted",e[e.PartiallyReverted=600]="PartiallyReverted"}(o||(o={}));let tp={"0xab5":{atomic:{status:"supported"}},"0x2b74":{atomic:{status:"supported"}}};async function tf(e,t,i){let r=(0,l.l)({chain:e,transport:t});return await L(i,r)}async function tg(e,t="eth_accounts"){let i=await e.request({method:t});return i?.[0]}async function ty(e,t,i,r,s,n){let a=(0,h.F)({account:e,transport:i}),o=(0,u.t)({address:e,signMessage:a.signMessage,signTransaction:a.signTransaction,signTypedData:a.signTypedData});return await tu({chain:t,signer:o,transport:i,isPrivyCrossApp:r,publicTransport:s,customPaymasterHandler:n})}var tm=i(40440),tb=i(46303),tw=i(80994),tv=i(59441);async function tI({providerAppId:e,apiUrl:t}){let i=await fetch(`${t}/api/v1/apps/${e}/cross-app/details`,{method:"GET",headers:{"Content-Type":"application/json"}}),{custom_api_url:r,icon_url:s,name:n}=await i.json();return{url:r,name:n,iconUrl:s}}var tE=i(97167),t_=i(22844),tC=i(47989);let tA=BigInt(0),tS=BigInt(1);function tN(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}function tT(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function tx(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?tA:BigInt("0x"+e)}function tP(e){return tx((0,tC.My)(e))}function tO(e){return(0,tC.DO)(e),tx((0,tC.My)(Uint8Array.from(e).reverse()))}function tM(e,t){return(0,tC.aT)(e.toString(16).padStart(2*t,"0"))}function tR(e,t){return tM(e,t).reverse()}function tk(e,t,i){let r;if("string"==typeof t)try{r=(0,tC.aT)(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if((0,tC.aY)(t))r=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=r.length;if("number"==typeof i&&s!==i)throw Error(e+" of length "+i+" expected, got "+s);return r}let tD=e=>"bigint"==typeof e&&tA<=e,tU=e=>(tS<<BigInt(e))-tS;function tL(e,t,i={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function r(t,i,r){let s=e[t];if(r&&void 0===s)return;let n=typeof s;if(n!==i||null===s)throw Error(`param "${t}" is invalid: expected ${i}, got ${n}`)}Object.entries(t).forEach(([e,t])=>r(e,t,!1)),Object.entries(i).forEach(([e,t])=>r(e,t,!0))}function tq(e){let t=new WeakMap;return(i,...r)=>{let s=t.get(i);if(void 0!==s)return s;let n=e(i,...r);return t.set(i,n),n}}let tj=BigInt(0),t$=BigInt(1),tz=BigInt(2),tB=BigInt(3),tH=BigInt(4),tW=BigInt(5),tF=BigInt(8);function tV(e,t){let i=e%t;return i>=tj?i:t+i}function tK(e,t,i){let r=e;for(;t-- >tj;)r*=r,r%=i;return r}function tG(e,t){if(e===tj)throw Error("invert: expected non-zero number");if(t<=tj)throw Error("invert: expected positive modulus, got "+t);let i=tV(e,t),r=t,s=tj,n=t$,a=t$,o=tj;for(;i!==tj;){let e=r/i,t=r%i,c=s-a*e,l=n-o*e;r=i,i=t,s=a,n=o,a=c,o=l}if(r!==t$)throw Error("invert: does not exist");return tV(s,t)}function tJ(e,t){let i=(e.ORDER+t$)/tH,r=e.pow(t,i);if(!e.eql(e.sqr(r),t))throw Error("Cannot find square root");return r}function tY(e,t){let i=(e.ORDER-tW)/tF,r=e.mul(t,tz),s=e.pow(r,i),n=e.mul(t,s),a=e.mul(e.mul(n,tz),s),o=e.mul(n,e.sub(a,e.ONE));if(!e.eql(e.sqr(o),t))throw Error("Cannot find square root");return o}let tQ=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tX(e,t,i=!1){let r=Array(t.length).fill(i?e.ZERO:void 0),s=t.reduce((t,i,s)=>e.is0(i)?t:(r[s]=t,e.mul(t,i)),e.ONE),n=e.inv(s);return t.reduceRight((t,i,s)=>e.is0(i)?t:(r[s]=e.mul(t,r[s]),e.mul(t,i)),n),r}function tZ(e,t){let i=(e.ORDER-t$)/tz,r=e.pow(t,i),s=e.eql(r,e.ONE),n=e.eql(r,e.ZERO),a=e.eql(r,e.neg(e.ONE));if(!s&&!n&&!a)throw Error("invalid Legendre symbol result");return s?1:n?0:-1}function t0(e,t,i=!1,r={}){let s,n,a;if(e<=tj)throw Error("invalid field: expected ORDER > 0, got "+e);if("object"==typeof t&&null!=t){if(r.sqrt||i)throw Error("cannot specify opts in two arguments");t.BITS&&(n=t.BITS),t.sqrt&&(a=t.sqrt),"boolean"==typeof t.isLE&&(i=t.isLE)}else"number"==typeof t&&(n=t),r.sqrt&&(a=r.sqrt);let{nBitLength:o,nByteLength:c}=function(e,t){void 0!==t&&(0,tC.Fe)(t);let i=void 0!==t?t:e.toString(2).length,r=Math.ceil(i/8);return{nBitLength:i,nByteLength:r}}(e,n);if(c>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:e,isLE:i,BITS:o,BYTES:c,MASK:tU(o),ZERO:tj,ONE:t$,create:t=>tV(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return tj<=t&&t<e},is0:e=>e===tj,isValidNot0:e=>!l.is0(e)&&l.isValid(e),isOdd:e=>(e&t$)===t$,neg:t=>tV(-t,e),eql:(e,t)=>e===t,sqr:t=>tV(t*t,e),add:(t,i)=>tV(t+i,e),sub:(t,i)=>tV(t-i,e),mul:(t,i)=>tV(t*i,e),pow:(e,t)=>(function(e,t,i){if(i<tj)throw Error("invalid exponent, negatives unsupported");if(i===tj)return e.ONE;if(i===t$)return t;let r=e.ONE,s=t;for(;i>tj;)i&t$&&(r=e.mul(r,s)),s=e.sqr(s),i>>=t$;return r})(l,e,t),div:(t,i)=>tV(t*tG(i,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>tG(t,e),sqrt:a||(t=>(s||(s=e%tH===tB?tJ:e%tF===tW?tY:function(e){if(e<BigInt(3))throw Error("sqrt is not defined for small field");let t=e-t$,i=0;for(;t%tz===tj;)t/=tz,i++;let r=tz,s=t0(e);for(;1===tZ(s,r);)if(r++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===i)return tJ;let n=s.pow(r,t),a=(t+t$)/tz;return function(e,r){if(e.is0(r))return r;if(1!==tZ(e,r))throw Error("Cannot find square root");let s=i,o=e.mul(e.ONE,n),c=e.pow(r,t),l=e.pow(r,a);for(;!e.eql(c,e.ONE);){if(e.is0(c))return e.ZERO;let t=1,i=e.sqr(c);for(;!e.eql(i,e.ONE);)if(t++,i=e.sqr(i),t===s)throw Error("Cannot find square root");let r=t$<<BigInt(s-t-1),n=e.pow(o,r);s=t,o=e.sqr(n),c=e.mul(c,o),l=e.mul(l,n)}return l}}(e)),s(l,t))),toBytes:e=>i?tR(e,c):tM(e,c),fromBytes:e=>{if(e.length!==c)throw Error("Field.fromBytes: expected "+c+" bytes, got "+e.length);return i?tO(e):tP(e)},invertBatch:e=>tX(l,e),cmov:(e,t,i)=>i?t:e});return Object.freeze(l)}function t1(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function t2(e){let t=t1(e);return t+Math.ceil(t/2)}let t5=BigInt(0),t3=BigInt(1);function t6(e,t){let i=t.negate();return e?i:t}function t4(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function t8(e,t){t4(e,t);let i=Math.ceil(t/e)+1,r=2**(e-1),s=2**e;return{windows:i,windowSize:r,mask:tU(e),maxNumber:s,shiftBy:BigInt(e)}}function t9(e,t,i){let{windowSize:r,mask:s,maxNumber:n,shiftBy:a}=i,o=Number(e&s),c=e>>a;o>r&&(o-=n,c+=t3);let l=t*r,d=l+Math.abs(o)-1,h=0===o;return{nextN:c,offset:d,isZero:h,isNeg:o<0,isNegF:t%2!=0,offsetF:l}}let t7=new WeakMap,ie=new WeakMap;function it(e){return ie.get(e)||1}function ii(e){if(e!==t5)throw Error("invalid wNAF")}function ir(e,t){if(!t)return t0(e);if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return tL(t,tQ.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}function is(e){void 0!==e.lowS&&tN("lowS",e.lowS),void 0!==e.prehash&&tN("prehash",e.prehash)}class ia extends Error{constructor(e=""){super(e)}}let io={Err:ia,_tlv:{encode:(e,t)=>{let{Err:i}=io;if(e<0||e>256)throw new i("tlv.encode: wrong tag");if(1&t.length)throw new i("tlv.encode: unpadded data");let r=t.length/2,s=tT(r);if(s.length/2&128)throw new i("tlv.encode: long form length too big");let n=r>127?tT(s.length/2|128):"";return tT(e)+n+s+t},decode(e,t){let{Err:i}=io,r=0;if(e<0||e>256)throw new i("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new i("tlv.decode: wrong tlv");let s=t[r++],n=0;if(128&s){let e=127&s;if(!e)throw new i("tlv.decode(long): indefinite length not supported");if(e>4)throw new i("tlv.decode(long): byte length is too big");let a=t.subarray(r,r+e);if(a.length!==e)throw new i("tlv.decode: length bytes not complete");if(0===a[0])throw new i("tlv.decode(long): zero leftmost byte");for(let e of a)n=n<<8|e;if(r+=e,n<128)throw new i("tlv.decode(long): not minimal encoding")}else n=s;let a=t.subarray(r,r+n);if(a.length!==n)throw new i("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+n)}}},_int:{encode(e){let{Err:t}=io;if(e<ic)throw new t("integer: negative integers are not allowed");let i=tT(e);if(8&Number.parseInt(i[0],16)&&(i="00"+i),1&i.length)throw new t("unexpected DER parsing assertion: unpadded hex");return i},decode(e){let{Err:t}=io;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return tP(e)}},toSig(e){let{Err:t,_int:i,_tlv:r}=io,s=tk("signature",e),{v:n,l:a}=r.decode(48,s);if(a.length)throw new t("invalid signature: left bytes after parsing");let{v:o,l:c}=r.decode(2,n),{v:l,l:d}=r.decode(2,c);if(d.length)throw new t("invalid signature: left bytes after parsing");return{r:i.decode(o),s:i.decode(l)}},hexFromSig(e){let{_tlv:t,_int:i}=io,r=t.encode(2,i.encode(e.r)),s=t.encode(2,i.encode(e.s));return t.encode(48,r+s)}},ic=BigInt(0),il=BigInt(1),id=BigInt(2),ih=BigInt(3),iu=BigInt(4);function ip(e,t,i){let{BYTES:r}=e;return function(s){let n;if("bigint"==typeof s)n=s;else{let i=tk("private key",s);if(t){if(!t.includes(2*i.length))throw Error("invalid private key");let e=new Uint8Array(r);e.set(i,e.length-i.length),i=e}try{n=e.fromBytes(i)}catch(e){throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof s}`)}}if(i&&(n=e.create(n)),!e.isValidNot0(n))throw Error("invalid private key: out of range [1..N-1]");return n}}function ig(e){return Uint8Array.of(e?2:3)}let iy={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},im=BigInt(0),ib=BigInt(1),iw=BigInt(2),iv=(e,t)=>(e+t/iw)/t,iI=t0(iy.p,void 0,void 0,{sqrt:function(e){let t=iy.p,i=BigInt(3),r=BigInt(6),s=BigInt(11),n=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),l=e*e*e%t,d=l*l*e%t,h=tK(d,i,t)*d%t,u=tK(h,i,t)*d%t,p=tK(u,iw,t)*l%t,f=tK(p,s,t)*p%t,g=tK(f,n,t)*f%t,y=tK(g,o,t)*g%t,m=tK(y,c,t)*y%t,b=tK(m,o,t)*g%t,w=tK(b,i,t)*d%t,v=tK(w,a,t)*f%t,I=tK(v,r,t)*l%t,E=tK(I,iw,t);if(!iI.eql(iI.sqr(E),e))throw Error("Cannot find square root");return E}}),iE=function(e,t){let i=t=>(function(e){let{CURVE:t,curveOpts:i,ecdsaOpts:r}=function(e){let{CURVE:t,curveOpts:i}=function(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},i={Fp:e.Fp,Fn:t0(t.n,e.nBitLength),allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:i}}(e);return{CURVE:t,curveOpts:i,ecdsaOpts:{hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN}}}(e),s=function(e,t,i={}){tL(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let r=t.randomBytes||tC.po,s=t.hmac||((e,...i)=>(0,t_.w)(t.hash,e,(0,tC.Id)(...i))),{Fp:n,Fn:a}=e,{ORDER:o,BITS:c}=a;function l(e,t){if(!a.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..CURVE.n`)}class d{constructor(e,t,i){l("r",e),l("s",t),this.r=e,this.s=t,null!=i&&(this.recovery=i),Object.freeze(this)}static fromCompact(e){let t=a.BYTES,i=tk("compactSignature",e,2*t);return new d(a.fromBytes(i.subarray(0,t)),a.fromBytes(i.subarray(t,2*t)))}static fromDER(e){let{r:t,s:i}=io.toSig(tk("DER",e));return new d(t,i)}assertValidity(){}addRecoveryBit(e){return new d(this.r,this.s,e)}recoverPublicKey(t){let i=n.ORDER,{r,s,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");if(o*id<i&&c>1)throw Error("recovery id is ambiguous for h>1 curve");let l=2===c||3===c?r+o:r;if(!n.isValid(l))throw Error("recovery id 2 or 3 invalid");let d=n.toBytes(l),h=e.fromHex((0,tC.Id)(ig((1&c)==0),d)),u=a.inv(l),p=f(tk("msgHash",t)),g=a.create(-p*u),y=a.create(s*u),m=e.BASE.multiplyUnsafe(g).add(h.multiplyUnsafe(y));if(m.is0())throw Error("point at infinify");return m.assertValidity(),m}hasHighS(){return this.s>o>>il}normalizeS(){return this.hasHighS()?new d(this.r,a.neg(this.s),this.recovery):this}toBytes(e){if("compact"===e)return(0,tC.Id)(a.toBytes(this.r),a.toBytes(this.s));if("der"===e)return(0,tC.aT)(io.hexFromSig(this));throw Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return(0,tC.My)(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return(0,tC.My)(this.toBytes("compact"))}}let h=ip(a,i.allowedPrivateKeyLengths,i.wrapPrivateKey);function u(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let r=tk("key",t).length,s=n.BYTES,o=s+1;if(!i.allowedPrivateKeyLengths&&a.BYTES!==o)return r===o||r===2*s+1}let p=t.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=tP(e),i=8*e.length-c;return i>0?t>>BigInt(i):t},f=t.bits2int_modN||function(e){return a.create(p(e))},g=tU(c);function y(e){return!function(e,t,i,r){if(!(tD(t)&&tD(i)&&tD(r))||!(i<=t)||!(t<r))throw Error("expected valid "+e+": "+i+" <= n < "+r+", got "+t)}("num < 2^"+c,e,ic,g),a.toBytes(e)}let m={lowS:t.lowS,prehash:!1},b={lowS:t.lowS,prehash:!1};return e.BASE.precompute(8),Object.freeze({getPublicKey:function(t,i=!0){return e.fromPrivateKey(t).toBytes(i)},getSharedSecret:function(t,i,r=!0){if(!0===u(t))throw Error("first arg must be private key");if(!1===u(i))throw Error("second arg must be public key");return e.fromHex(i).multiply(h(t)).toBytes(r)},sign:function(i,c,l=m){let{seed:u,k2sig:g}=function(i,s,c=m){if(["recovered","canonical"].some(e=>e in c))throw Error("sign() legacy options not supported");let{hash:l}=t,{lowS:u,prehash:g,extraEntropy:b}=c;null==u&&(u=!0),i=tk("msgHash",i),is(c),g&&(i=tk("prehashed msgHash",l(i)));let w=f(i),v=h(s),I=[y(v),y(w)];if(null!=b&&!1!==b){let e=!0===b?r(n.BYTES):b;I.push(tk("extraEntropy",e))}return{seed:(0,tC.Id)(...I),k2sig:function(t){var i;let r=p(t);if(!a.isValidNot0(r))return;let s=a.inv(r),n=e.BASE.multiply(r).toAffine(),c=a.create(n.x);if(c===ic)return;let l=a.create(s*a.create(w+c*v));if(l===ic)return;let h=2*(n.x!==c)|Number(n.y&il),f=l;return u&&l>o>>il&&(f=(i=l)>o>>il?a.neg(i):i,h^=1),new d(c,f,h)}}}(i,c,l);return(function(e,t,i){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof i)throw Error("hmacFn must be a function");let r=e=>new Uint8Array(e),s=e=>Uint8Array.of(e),n=r(e),a=r(e),o=0,c=()=>{n.fill(1),a.fill(0),o=0},l=(...e)=>i(a,n,...e),d=(e=r(0))=>{a=l(s(0),e),n=l(),0!==e.length&&(a=l(s(1),e),n=l())},h=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let e=0,i=[];for(;e<t;){let t=(n=l()).slice();i.push(t),e+=n.length}return(0,tC.Id)(...i)};return(e,t)=>{let i;for(c(),d(e);!(i=t(h()));)d();return c(),i}})(t.hash.outputLen,a.BYTES,s)(u,g)},verify:function(i,r,s,n=b){let o,c;r=tk("msgHash",r),s=tk("publicKey",s),is(n);let{lowS:l,prehash:h,format:u}=n;if("strict"in n)throw Error("options.strict was renamed to lowS");if(void 0!==u&&!["compact","der","js"].includes(u))throw Error('format must be "compact", "der" or "js"');let p="string"==typeof i||(0,tC.aY)(i),g=!p&&!u&&"object"==typeof i&&null!==i&&"bigint"==typeof i.r&&"bigint"==typeof i.s;if(!p&&!g)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g)if(void 0===u||"js"===u)c=new d(i.r,i.s);else throw Error("invalid format");if(p){try{"compact"!==u&&(c=d.fromDER(i))}catch(e){if(!(e instanceof io.Err))throw e}c||"der"===u||(c=d.fromCompact(i))}o=e.fromHex(s)}catch(e){return!1}if(!c||l&&c.hasHighS())return!1;h&&(r=t.hash(r));let{r:y,s:m}=c,w=f(r),v=a.inv(m),I=a.create(w*v),E=a.create(y*v),_=e.BASE.multiplyUnsafe(I).add(o.multiplyUnsafe(E));return!_.is0()&&a.create(_.x)===y},utils:{isValidPrivateKey(e){try{return h(e),!0}catch(e){return!1}},normPrivateKeyToScalar:h,randomPrivateKey:()=>(function(e,t,i=!1){let r=e.length,s=t1(t),n=t2(t);if(r<16||r<n||r>1024)throw Error("expected "+n+"-1024 bytes of input, got "+r);let a=tV(i?tO(e):tP(e),t-t$)+t$;return i?tR(a,s):tM(a,s)})(r(t2(o)),o),precompute:(t=8,i=e.BASE)=>i.precompute(t,!1)},Point:e,Signature:d})}(function(e,t={}){var i,r,s,n;let{Fp:a,Fn:o}=function(e,t,i={}){if(!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let i=t[e];if(!("bigint"==typeof i&&i>t5))throw Error(`CURVE.${e} must be positive bigint`)}let r=ir(t.p,i.Fp),s=ir(t.n,i.Fn);for(let i of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!r.isValid(t[i]))throw Error(`CURVE.${i} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}("weierstrass",e,t),{h:c,n:l}=e;tL(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:d}=t;if(d&&(!a.is0(e.a)||"bigint"!=typeof d.beta||"function"!=typeof d.splitScalar))throw Error('invalid endo: expected "beta": bigint and "splitScalar": function');function h(){if(!a.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let u=t.toBytes||function(e,t,i){let{x:r,y:s}=t.toAffine(),n=a.toBytes(r);if(tN("isCompressed",i),!i)return(0,tC.Id)(Uint8Array.of(4),n,a.toBytes(s));{h();let e=!a.isOdd(s);return(0,tC.Id)(ig(e),n)}},p=t.fromBytes||function(e){(0,tC.DO)(e);let t=a.BYTES,i=t+1,r=2*t+1,s=e.length,n=e[0],o=e.subarray(1);if(s===i&&(2===n||3===n)){let e,t=a.fromBytes(o);if(!a.isValid(t))throw Error("bad point: is not on curve, wrong x");let i=f(t);try{e=a.sqrt(i)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return h(),(1&n)==1!==a.isOdd(e)&&(e=a.neg(e)),{x:t,y:e}}if(s===r&&4===n){let e=a.fromBytes(o.subarray(0*t,+t)),i=a.fromBytes(o.subarray(+t,2*t));if(!g(e,i))throw Error("bad point: is not on curve");return{x:e,y:i}}throw Error(`bad point: got length ${s}, expected compressed=${i} or uncompressed=${r}`)},f=(r=a,s=e.a,n=e.b,function(e){let t=r.sqr(e),i=r.mul(t,e);return r.add(r.add(i,r.mul(e,s)),n)});function g(e,t){let i=a.sqr(t),r=f(e);return a.eql(i,r)}if(!g(e.Gx,e.Gy))throw Error("bad curve params: generator point");let y=a.mul(a.pow(e.a,ih),iu),m=a.mul(a.sqr(e.b),BigInt(27));if(a.is0(a.add(y,m)))throw Error("bad curve params: a or b");function b(e,t,i=!1){if(!a.isValid(t)||i&&a.is0(t))throw Error(`bad point coordinate ${e}`);return t}function w(e){if(!(e instanceof _))throw Error("ProjectivePoint expected")}let v=tq((e,t)=>{let{px:i,py:r,pz:s}=e;if(a.eql(s,a.ONE))return{x:i,y:r};let n=e.is0();null==t&&(t=n?a.ONE:a.inv(s));let o=a.mul(i,t),c=a.mul(r,t),l=a.mul(s,t);if(n)return{x:a.ZERO,y:a.ZERO};if(!a.eql(l,a.ONE))throw Error("invZ was invalid");return{x:o,y:c}}),I=tq(e=>{if(e.is0()){if(t.allowInfinityPoint&&!a.is0(e.py))return;throw Error("bad point: ZERO")}let{x:i,y:r}=e.toAffine();if(!a.isValid(i)||!a.isValid(r))throw Error("bad point: x or y not field elements");if(!g(i,r))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function E(e,t,i,r,s){return i=new _(a.mul(i.px,e),i.py,i.pz),t=t6(r,t),i=t6(s,i),t.add(i)}class _{constructor(e,t,i){this.px=b("x",e),this.py=b("y",t,!0),this.pz=b("z",i),Object.freeze(this)}static fromAffine(e){let{x:t,y:i}=e||{};if(!e||!a.isValid(t)||!a.isValid(i))throw Error("invalid affine point");if(e instanceof _)throw Error("projective point not allowed");return a.is0(t)&&a.is0(i)?_.ZERO:new _(t,i,a.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=tX(_.Fp,e.map(e=>e.pz));return e.map((e,i)=>e.toAffine(t[i])).map(_.fromAffine)}static fromBytes(e){return(0,tC.DO)(e),_.fromHex(e)}static fromHex(e){let t=_.fromAffine(p(tk("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){let i=ip(o,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return _.BASE.multiply(i(e))}static msm(e,t){return function(e,t,i,r){(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,i)=>{if(!(e instanceof t))throw Error("invalid point at index "+i)})})(i,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,i)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+i)})}(r,t);let s=i.length,n=r.length;if(s!==n)throw Error("arrays of points and scalars must have equal length");let a=e.ZERO,o=function(e){let t;for(t=0;e>tA;e>>=tS,t+=1);return t}(BigInt(s)),c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);let l=tU(c),d=Array(Number(l)+1).fill(a),h=Math.floor((t.BITS-1)/c)*c,u=a;for(let e=h;e>=0;e-=c){d.fill(a);for(let t=0;t<n;t++){let s=Number(r[t]>>BigInt(e)&l);d[s]=d[s].add(i[t])}let t=a;for(let e=d.length-1,i=a;e>0;e--)i=i.add(d[e]),t=t.add(i);if(u=u.add(t),0!==e)for(let e=0;e<c;e++)u=u.double()}return u}(_,o,e,t)}precompute(e=8,t=!0){return A.setWindowSize(this,e),t||this.multiply(ih),this}_setWindowSize(e){this.precompute(e)}assertValidity(){I(this)}hasEvenY(){let{y:e}=this.toAffine();if(!a.isOdd)throw Error("Field doesn't support isOdd");return!a.isOdd(e)}equals(e){w(e);let{px:t,py:i,pz:r}=this,{px:s,py:n,pz:o}=e,c=a.eql(a.mul(t,o),a.mul(s,r)),l=a.eql(a.mul(i,o),a.mul(n,r));return c&&l}negate(){return new _(this.px,a.neg(this.py),this.pz)}double(){let{a:t,b:i}=e,r=a.mul(i,ih),{px:s,py:n,pz:o}=this,c=a.ZERO,l=a.ZERO,d=a.ZERO,h=a.mul(s,s),u=a.mul(n,n),p=a.mul(o,o),f=a.mul(s,n);return f=a.add(f,f),d=a.mul(s,o),d=a.add(d,d),c=a.mul(t,d),l=a.mul(r,p),l=a.add(c,l),c=a.sub(u,l),l=a.add(u,l),l=a.mul(c,l),c=a.mul(f,c),d=a.mul(r,d),p=a.mul(t,p),f=a.sub(h,p),f=a.mul(t,f),f=a.add(f,d),d=a.add(h,h),h=a.add(d,h),h=a.add(h,p),h=a.mul(h,f),l=a.add(l,h),p=a.mul(n,o),p=a.add(p,p),h=a.mul(p,f),c=a.sub(c,h),d=a.mul(p,u),d=a.add(d,d),new _(c,l,d=a.add(d,d))}add(t){w(t);let{px:i,py:r,pz:s}=this,{px:n,py:o,pz:c}=t,l=a.ZERO,d=a.ZERO,h=a.ZERO,u=e.a,p=a.mul(e.b,ih),f=a.mul(i,n),g=a.mul(r,o),y=a.mul(s,c),m=a.add(i,r),b=a.add(n,o);m=a.mul(m,b),b=a.add(f,g),m=a.sub(m,b),b=a.add(i,s);let v=a.add(n,c);return b=a.mul(b,v),v=a.add(f,y),b=a.sub(b,v),v=a.add(r,s),l=a.add(o,c),v=a.mul(v,l),l=a.add(g,y),v=a.sub(v,l),h=a.mul(u,b),l=a.mul(p,y),h=a.add(l,h),l=a.sub(g,h),h=a.add(g,h),d=a.mul(l,h),g=a.add(f,f),g=a.add(g,f),y=a.mul(u,y),b=a.mul(p,b),g=a.add(g,y),y=a.sub(f,y),y=a.mul(u,y),b=a.add(b,y),f=a.mul(g,b),d=a.add(d,f),f=a.mul(v,b),l=a.mul(m,l),l=a.sub(l,f),f=a.mul(m,g),h=a.mul(v,h),new _(l,d,h=a.add(h,f))}subtract(e){return this.add(e.negate())}is0(){return this.equals(_.ZERO)}multiply(e){let i,r,{endo:s}=t;if(!o.isValidNot0(e))throw Error("invalid scalar: out of range");let n=e=>A.wNAFCached(this,e,_.normalizeZ);if(s){let{k1neg:t,k1:a,k2neg:o,k2:c}=s.splitScalar(e),{p:l,f:d}=n(a),{p:h,f:u}=n(c);r=d.add(u),i=E(s.beta,l,h,t,o)}else{let{p:t,f:s}=n(e);i=t,r=s}return _.normalizeZ([i,r])[0]}multiplyUnsafe(e){let{endo:i}=t;if(!o.isValid(e))throw Error("invalid scalar: out of range");if(e===ic||this.is0())return _.ZERO;if(e===il)return this;if(A.hasPrecomputes(this))return this.multiply(e);if(!i)return A.wNAFCachedUnsafe(this,e);{let{k1neg:t,k1:r,k2neg:s,k2:n}=i.splitScalar(e),{p1:a,p2:o}=function(e,t,i,r){let s=t,n=e.ZERO,a=e.ZERO;for(;i>t5||r>t5;)i&t3&&(n=n.add(s)),r&t3&&(a=a.add(s)),s=s.double(),i>>=t3,r>>=t3;return{p1:n,p2:a}}(_,this,r,n);return E(i.beta,a,o,t,s)}}multiplyAndAddUnsafe(e,t,i){let r=this.multiplyUnsafe(t).add(e.multiplyUnsafe(i));return r.is0()?void 0:r}toAffine(e){return v(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return c===il||(e?e(_,this):A.wNAFCachedUnsafe(this,l).is0())}clearCofactor(){let{clearCofactor:e}=t;return c===il?this:e?e(_,this):this.multiplyUnsafe(c)}toBytes(e=!0){return tN("isCompressed",e),this.assertValidity(),u(_,this,e)}toRawBytes(e=!0){return this.toBytes(e)}toHex(e=!0){return(0,tC.My)(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(e.Gx,e.Gy,a.ONE),_.ZERO=new _(a.ZERO,a.ONE,a.ZERO),_.Fp=a,_.Fn=o;let C=o.BITS,A=(i=t.endo?Math.ceil(C/2):C,{constTimeNegate:t6,hasPrecomputes:e=>1!==it(e),unsafeLadder(e,t,i=_.ZERO){let r=e;for(;t>t5;)t&t3&&(i=i.add(r)),r=r.double(),t>>=t3;return i},precomputeWindow(e,t){let{windows:r,windowSize:s}=t8(t,i),n=[],a=e,o=a;for(let e=0;e<r;e++){o=a,n.push(o);for(let e=1;e<s;e++)o=o.add(a),n.push(o);a=o.double()}return n},wNAF(e,t,r){let s=_.ZERO,n=_.BASE,a=t8(e,i);for(let e=0;e<a.windows;e++){let{nextN:i,offset:o,isZero:c,isNeg:l,isNegF:d,offsetF:h}=t9(r,e,a);r=i,c?n=n.add(t6(d,t[h])):s=s.add(t6(l,t[o]))}return ii(r),{p:s,f:n}},wNAFUnsafe(e,t,r,s=_.ZERO){let n=t8(e,i);for(let e=0;e<n.windows&&r!==t5;e++){let{nextN:i,offset:a,isZero:o,isNeg:c}=t9(r,e,n);if(r=i,!o){let e=t[a];s=s.add(c?e.negate():e)}}return ii(r),s},getPrecomputes(e,t,i){let r=t7.get(t);return r||(r=this.precomputeWindow(t,e),1!==e&&("function"==typeof i&&(r=i(r)),t7.set(t,r))),r},wNAFCached(e,t,i){let r=it(e);return this.wNAF(r,this.getPrecomputes(r,e,i),t)},wNAFCachedUnsafe(e,t,i,r){let s=it(e);return 1===s?this.unsafeLadder(e,t,r):this.wNAFUnsafe(s,this.getPrecomputes(s,e,i),t,r)},setWindowSize(e,t){t4(t,i),ie.set(e,t),t7.delete(e)}});return _}(t,i),r,i);return Object.assign({},s,{ProjectivePoint:s.Point,CURVE:e})})({...e,hash:t});return{...i(t),create:i}}({...iy,Fp:iI,lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=iy.n,i=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-ib*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),n=BigInt("0x100000000000000000000000000000000"),a=iv(i*e,t),o=iv(-r*e,t),c=tV(e-a*i-o*s,t),l=tV(-a*r-o*i,t),d=c>n,h=l>n;if(d&&(c=t-c),h&&(l=t-l),c>n||l>n)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:d,k1:c,k2neg:h,k2:l}}}},tE.sc),i_={},iC=e=>e.toBytes(!0).slice(1),iA=e=>mod(e,iy.n),iS=e=>e%iw===im;function iN(...e){let t=e=>e,i=(e,t)=>i=>e(t(i));return{encode:e.map(e=>e.encode).reduceRight(i,t),decode:e.map(e=>e.decode).reduce(i,t)}}function iT(e){return{encode:t=>{if(!Array.isArray(t)||t.length&&"number"!=typeof t[0])throw Error("alphabet.encode input should be an array of numbers");return t.map(t=>{if(t<0||t>=e.length)throw Error(`Digit index outside alphabet: ${t} (alphabet: ${e.length})`);return e[t]})},decode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw Error("alphabet.decode input should be array of strings");return t.map(t=>{if("string"!=typeof t)throw Error(`alphabet.decode: not string element=${t}`);let i=e.indexOf(t);if(-1===i)throw Error(`Unknown letter: "${t}". Allowed: ${e}`);return i})}}}function ix(e=""){if("string"!=typeof e)throw Error("join separator should be string");return{encode:t=>{if(!Array.isArray(t)||t.length&&"string"!=typeof t[0])throw Error("join.encode input should be array of strings");for(let e of t)if("string"!=typeof e)throw Error(`join.encode: non-string input=${e}`);return t.join(e)},decode:t=>{if("string"!=typeof t)throw Error("join.decode input should be string");return t.split(e)}}}let iP=(e,t)=>t?iP(t,e%t):e,iO=(e,t)=>e+(t-iP(e,t));function iM(e,t,i,r){if(!Array.isArray(e))throw Error("convertRadix2: data should be array");if(t<=0||t>32)throw Error(`convertRadix2: wrong from=${t}`);if(i<=0||i>32)throw Error(`convertRadix2: wrong to=${i}`);if(iO(t,i)>32)throw Error(`convertRadix2: carry overflow from=${t} to=${i} carryBits=${iO(t,i)}`);let s=0,n=0,a=2**i-1,o=[];for(let r of e){if(r>=2**t)throw Error(`convertRadix2: invalid data word=${r} from=${t}`);if(s=s<<t|r,n+t>32)throw Error(`convertRadix2: carry overflow pos=${n} from=${t}`);for(n+=t;n>=i;n-=i)o.push((s>>n-i&a)>>>0);s&=2**n-1}if(s=s<<i-n&a,!r&&n>=t)throw Error("Excess padding");if(!r&&s)throw Error(`Non-zero padding: ${s}`);return r&&n>0&&o.push(s>>>0),o}let iR=iN(function(e,t=!1){if(e>32)throw Error("radix2: bits should be in (0..32]");if(iO(8,e)>32||iO(e,8)>32)throw Error("radix2: carry overflow");return{encode:i=>{var r;if(!((r=i)instanceof Uint8Array||null!=r&&"object"==typeof r&&"Uint8Array"===r.constructor.name))throw Error("radix2.encode input should be Uint8Array");return iM(Array.from(i),8,e,!t)},decode:i=>{if(!Array.isArray(i)||i.length&&"number"!=typeof i[0])throw Error("radix2.decode input should be array of numbers");return Uint8Array.from(iM(i,e,8,t))}}}(6),iT("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),function(e,t="="){if("string"!=typeof t)throw Error("padding chr should be string");return{encode(e){if(!Array.isArray(e)||e.length&&"string"!=typeof e[0])throw Error("padding.encode input should be array of strings");for(let t of e)if("string"!=typeof t)throw Error(`padding.encode: non-string input=${t}`);for(;6*e.length%8;)e.push(t);return e},decode(i){if(!Array.isArray(i)||i.length&&"string"!=typeof i[0])throw Error("padding.encode input should be array of strings");for(let e of i)if("string"!=typeof e)throw Error(`padding.decode: non-string input=${e}`);let r=i.length;if(6*r%8)throw Error("Invalid padding: string should have whole number of bytes");for(;r>0&&i[r-1]===t;r--)if(!((r-1)*e%8))throw Error("Invalid padding: string has too much padding");return i.slice(0,r)}}}(6),ix("")),ik=iN(iT("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),ix(""));function iD(e){let t=e>>25,i=(0x1ffffff&e)<<5;for(let e=0;e<null.length;e++)(t>>e&1)==1&&(i^=null[e]);return i}var iU=i(29155),iL={},iq=function(e,t,i,r,s){var n=new Worker(iL[t]||(iL[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return n.onmessage=function(e){var t=e.data,i=t.$e$;if(i){var r=Error(i[0]);r.code=i[1],r.stack=i[2],s(r,null)}else s(null,t)},n.postMessage(i,r),n},ij=Uint8Array,i$=Uint16Array,iz=Int32Array,iB=new ij([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),iH=new ij([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),iW=new ij([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),iF=function(e,t){for(var i=new i$(31),r=0;r<31;++r)i[r]=t+=1<<e[r-1];for(var s=new iz(i[30]),r=1;r<30;++r)for(var n=i[r];n<i[r+1];++n)s[n]=n-i[r]<<5|r;return{b:i,r:s}},iV=iF(iB,2),iK=iV.b,iG=iV.r;iK[28]=258,iG[258]=28;for(var iJ=iF(iH,0),iY=iJ.b,iQ=iJ.r,iX=new i$(32768),iZ=0;iZ<32768;++iZ){var i0=(43690&iZ)>>1|(21845&iZ)<<1;i0=(61680&(i0=(52428&i0)>>2|(13107&i0)<<2))>>4|(3855&i0)<<4,iX[iZ]=((65280&i0)>>8|(255&i0)<<8)>>1}for(var i1=function(e,t,i){for(var r,s=e.length,n=0,a=new i$(t);n<s;++n)e[n]&&++a[e[n]-1];var o=new i$(t);for(n=1;n<t;++n)o[n]=o[n-1]+a[n-1]<<1;if(i){r=new i$(1<<t);var c=15-t;for(n=0;n<s;++n)if(e[n])for(var l=n<<4|e[n],d=t-e[n],h=o[e[n]-1]++<<d,u=h|(1<<d)-1;h<=u;++h)r[iX[h]>>c]=l}else for(n=0,r=new i$(s);n<s;++n)e[n]&&(r[n]=iX[o[e[n]-1]++]>>15-e[n]);return r},i2=new ij(288),iZ=0;iZ<144;++iZ)i2[iZ]=8;for(var iZ=144;iZ<256;++iZ)i2[iZ]=9;for(var iZ=256;iZ<280;++iZ)i2[iZ]=7;for(var iZ=280;iZ<288;++iZ)i2[iZ]=8;for(var i5=new ij(32),iZ=0;iZ<32;++iZ)i5[iZ]=5;var i3=i1(i2,9,0),i6=i1(i2,9,1),i4=i1(i5,5,0),i8=i1(i5,5,1),i9=function(e){for(var t=e[0],i=1;i<e.length;++i)e[i]>t&&(t=e[i]);return t},i7=function(e,t,i){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(7&t)&i},re=function(e,t){var i=t/8|0;return(e[i]|e[i+1]<<8|e[i+2]<<16)>>(7&t)},rt=function(e){return(e+7)/8|0},ri=function(e,t,i){return(null==t||t<0)&&(t=0),(null==i||i>e.length)&&(i=e.length),new ij(e.subarray(t,i))},rr=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],rs=function(e,t,i){var r=Error(t||rr[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,rs),!i)throw r;return r},rn=function(e,t,i,r){var s=e.length,n=r?r.length:0;if(!s||t.f&&!t.l)return i||new ij(0);var a=!i,o=a||2!=t.i,c=t.i;a&&(i=new ij(3*s));var l=function(e){var t=i.length;if(e>t){var r=new ij(Math.max(2*t,e));r.set(i),i=r}},d=t.f||0,h=t.p||0,u=t.b||0,p=t.l,f=t.d,g=t.m,y=t.n,m=8*s;do{if(!p){d=i7(e,h,1);var b=i7(e,h+1,3);if(h+=3,b)if(1==b)p=i6,f=i8,g=9,y=5;else if(2==b){var w=i7(e,h,31)+257,v=i7(e,h+10,15)+4,I=w+i7(e,h+5,31)+1;h+=14;for(var E=new ij(I),_=new ij(19),C=0;C<v;++C)_[iW[C]]=i7(e,h+3*C,7);h+=3*v;for(var A=i9(_),S=(1<<A)-1,N=i1(_,A,1),C=0;C<I;){var T=N[i7(e,h,S)];h+=15&T;var x=T>>4;if(x<16)E[C++]=x;else{var P=0,O=0;for(16==x?(O=3+i7(e,h,3),h+=2,P=E[C-1]):17==x?(O=3+i7(e,h,7),h+=3):18==x&&(O=11+i7(e,h,127),h+=7);O--;)E[C++]=P}}var M=E.subarray(0,w),R=E.subarray(w);g=i9(M),y=i9(R),p=i1(M,g,1),f=i1(R,y,1)}else rs(1);else{var x=rt(h)+4,k=e[x-4]|e[x-3]<<8,D=x+k;if(D>s){c&&rs(0);break}o&&l(u+k),i.set(e.subarray(x,D),u),t.b=u+=k,t.p=h=8*D,t.f=d;continue}if(h>m){c&&rs(0);break}}o&&l(u+131072);for(var U=(1<<g)-1,L=(1<<y)-1,q=h;;q=h){var P=p[re(e,h)&U],j=P>>4;if((h+=15&P)>m){c&&rs(0);break}if(P||rs(2),j<256)i[u++]=j;else if(256==j){q=h,p=null;break}else{var $=j-254;if(j>264){var C=j-257,z=iB[C];$=i7(e,h,(1<<z)-1)+iK[C],h+=z}var B=f[re(e,h)&L],H=B>>4;B||rs(3),h+=15&B;var R=iY[H];if(H>3){var z=iH[H];R+=re(e,h)&(1<<z)-1,h+=z}if(h>m){c&&rs(0);break}o&&l(u+131072);var W=u+$;if(u<R){var F=n-R,V=Math.min(R,W);for(F+u<0&&rs(3);u<V;++u)i[u]=r[F+u]}for(;u<W;++u)i[u]=i[u-R]}}t.l=p,t.p=q,t.b=u,t.f=d,p&&(d=1,t.m=g,t.d=f,t.n=y)}while(!d);return u!=i.length&&a?ri(i,0,u):i.subarray(0,u)},ra=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>8},ro=function(e,t,i){i<<=7&t;var r=t/8|0;e[r]|=i,e[r+1]|=i>>8,e[r+2]|=i>>16},rc=function(e,t){for(var i=[],r=0;r<e.length;++r)e[r]&&i.push({s:r,f:e[r]});var s=i.length,n=i.slice();if(!s)return{t:rg,l:0};if(1==s){var a=new ij(i[0].s+1);return a[i[0].s]=1,{t:a,l:1}}i.sort(function(e,t){return e.f-t.f}),i.push({s:-1,f:25001});var o=i[0],c=i[1],l=0,d=1,h=2;for(i[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=s-1;)o=i[i[l].f<i[h].f?l++:h++],c=i[l!=d&&i[l].f<i[h].f?l++:h++],i[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var u=n[0].s,r=1;r<s;++r)n[r].s>u&&(u=n[r].s);var p=new i$(u+1),f=rl(i[d-1],p,0);if(f>t){var r=0,g=0,y=f-t,m=1<<y;for(n.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});r<s;++r){var b=n[r].s;if(p[b]>t)g+=m-(1<<f-p[b]),p[b]=t;else break}for(g>>=y;g>0;){var w=n[r].s;p[w]<t?g-=1<<t-p[w]++-1:++r}for(;r>=0&&g;--r){var v=n[r].s;p[v]==t&&(--p[v],++g)}f=t}return{t:new ij(p),l:f}},rl=function(e,t,i){return -1==e.s?Math.max(rl(e.l,t,i+1),rl(e.r,t,i+1)):t[e.s]=i},rd=function(e){for(var t=e.length;t&&!e[--t];);for(var i=new i$(++t),r=0,s=e[0],n=1,a=function(e){i[r++]=e},o=1;o<=t;++o)if(e[o]==s&&o!=t)++n;else{if(!s&&n>2){for(;n>138;n-=138)a(32754);n>2&&(a(n>10?n-11<<5|28690:n-3<<5|12305),n=0)}else if(n>3){for(a(s),--n;n>6;n-=6)a(8304);n>2&&(a(n-3<<5|8208),n=0)}for(;n--;)a(s);n=1,s=e[o]}return{c:i.subarray(0,r),n:t}},rh=function(e,t){for(var i=0,r=0;r<t.length;++r)i+=e[r]*t[r];return i},ru=function(e,t,i){var r=i.length,s=rt(t+2);e[s]=255&r,e[s+1]=r>>8,e[s+2]=255^e[s],e[s+3]=255^e[s+1];for(var n=0;n<r;++n)e[s+n+4]=i[n];return(s+4+r)*8},rp=function(e,t,i,r,s,n,a,o,c,l,d){ra(t,d++,i),++s[256];for(var h,u,p,f,g=rc(s,15),y=g.t,m=g.l,b=rc(n,15),w=b.t,v=b.l,I=rd(y),E=I.c,_=I.n,C=rd(w),A=C.c,S=C.n,N=new i$(19),T=0;T<E.length;++T)++N[31&E[T]];for(var T=0;T<A.length;++T)++N[31&A[T]];for(var x=rc(N,7),P=x.t,O=x.l,M=19;M>4&&!P[iW[M-1]];--M);var R=l+5<<3,k=rh(s,i2)+rh(n,i5)+a,D=rh(s,y)+rh(n,w)+a+14+3*M+rh(N,P)+2*N[16]+3*N[17]+7*N[18];if(c>=0&&R<=k&&R<=D)return ru(t,d,e.subarray(c,c+l));if(ra(t,d,1+(D<k)),d+=2,D<k){h=i1(y,m,0),u=y,p=i1(w,v,0),f=w;var U=i1(P,O,0);ra(t,d,_-257),ra(t,d+5,S-1),ra(t,d+10,M-4),d+=14;for(var T=0;T<M;++T)ra(t,d+3*T,P[iW[T]]);d+=3*M;for(var L=[E,A],q=0;q<2;++q)for(var j=L[q],T=0;T<j.length;++T){var $=31&j[T];ra(t,d,U[$]),d+=P[$],$>15&&(ra(t,d,j[T]>>5&127),d+=j[T]>>12)}}else h=i3,u=i2,p=i4,f=i5;for(var T=0;T<o;++T){var z=r[T];if(z>255){var $=z>>18&31;ro(t,d,h[$+257]),d+=u[$+257],$>7&&(ra(t,d,z>>23&31),d+=iB[$]);var B=31&z;ro(t,d,p[B]),d+=f[B],B>3&&(ro(t,d,z>>5&8191),d+=iH[B])}else ro(t,d,h[z]),d+=u[z]}return ro(t,d,h[256]),d+u[256]},rf=new iz([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rg=new ij(0),ry=function(e,t,i,r,s,n){var a=n.z||e.length,o=new ij(r+a+5*(1+Math.ceil(a/7e3))+s),c=o.subarray(r,o.length-s),l=n.l,d=7&(n.r||0);if(t){d&&(c[0]=n.r>>3);for(var h=rf[t-1],u=h>>13,p=8191&h,f=(1<<i)-1,g=n.p||new i$(32768),y=n.h||new i$(f+1),m=Math.ceil(i/3),b=2*m,w=function(t){return(e[t]^e[t+1]<<m^e[t+2]<<b)&f},v=new iz(25e3),I=new i$(288),E=new i$(32),_=0,C=0,A=n.i||0,S=0,N=n.w||0,T=0;A+2<a;++A){var x=w(A),P=32767&A,O=y[x];if(g[P]=O,y[x]=P,N<=A){var M=a-A;if((_>7e3||S>24576)&&(M>423||!l)){d=rp(e,c,0,v,I,E,C,S,T,A-T,d),S=_=C=0,T=A;for(var R=0;R<286;++R)I[R]=0;for(var R=0;R<30;++R)E[R]=0}var k=2,D=0,U=p,L=P-O&32767;if(M>2&&x==w(A-L))for(var q=Math.min(u,M)-1,j=Math.min(32767,A),$=Math.min(258,M);L<=j&&--U&&P!=O;){if(e[A+k]==e[A+k-L]){for(var z=0;z<$&&e[A+z]==e[A+z-L];++z);if(z>k){if(k=z,D=L,z>q)break;for(var B=Math.min(L,z-2),H=0,R=0;R<B;++R){var W=A-L+R&32767,F=g[W],V=W-F&32767;V>H&&(H=V,O=W)}}}O=g[P=O],L+=P-O&32767}if(D){v[S++]=0x10000000|iG[k]<<18|iQ[D];var K=31&iG[k],G=31&iQ[D];C+=iB[K]+iH[G],++I[257+K],++E[G],N=A+k,++_}else v[S++]=e[A],++I[e[A]]}}for(A=Math.max(A,N);A<a;++A)v[S++]=e[A],++I[e[A]];d=rp(e,c,l,v,I,E,C,S,T,A-T,d),l||(n.r=7&d|c[d/8|0]<<3,d-=7,n.h=y,n.p=g,n.i=A,n.w=N)}else{for(var A=n.w||0;A<a+l;A+=65535){var J=A+65535;J>=a&&(c[d/8|0]=l,J=a),d=ru(c,d+1,e.subarray(A,J))}n.i=a}return ri(o,0,r+rt(d)+s)},rm=function(){var e=-1;return{p:function(t){for(var i=e,r=0;r<t.length;++r)i=null[255&i^t[r]]^i>>>8;e=i},d:function(){return~e}}},rb=function(){var e=1,t=0;return{p:function(i){for(var r=e,s=t,n=0|i.length,a=0;a!=n;){for(var o=Math.min(a+2655,n);a<o;++a)s+=r+=i[a];r=(65535&r)+15*(r>>16),s=(65535&s)+15*(s>>16)}e=r,t=s},d:function(){return e%=65521,t%=65521,(255&e)<<24|(65280&e)<<8|(255&t)<<8|t>>8}}},rw=function(e,t,i,r,s){if(!s&&(s={l:1},t.dictionary)){var n=t.dictionary.subarray(-32768),a=new ij(n.length+e.length);a.set(n),a.set(e,n.length),e=a,s.w=n.length}return ry(e,null==t.level?6:t.level,null==t.mem?s.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,i,r,s)},rv=function(e,t){var i={};for(var r in e)i[r]=e[r];for(var r in t)i[r]=t[r];return i},rI=function(e,t,i){for(var r=e(),s=e.toString(),n=s.slice(s.indexOf("[")+1,s.lastIndexOf("]")).replace(/\s+/g,"").split(","),a=0;a<r.length;++a){var o=r[a],c=n[a];if("function"==typeof o){t+=";"+c+"=";var l=o.toString();if(o.prototype)if(-1!=l.indexOf("[native code]")){var d=l.indexOf(" ",8)+1;t+=l.slice(d,l.indexOf("(",d))}else for(var h in t+=l,o.prototype)t+=";"+c+".prototype."+h+"="+o.prototype[h].toString();else t+=l}else i[c]=o}return t},rE=function(e){var t=[];for(var i in e)e[i].buffer&&t.push((e[i]=new e[i].constructor(e[i])).buffer);return t},r_=function(e,t,i,r){if(!null[i]){for(var s="",n={},a=e.length-1,o=0;o<a;++o)s=rI(e[o],s,n);null[i]={c:rI(e[a],s,n),e:n}}var c=rv({},null[i].e);return iq(null[i].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",i,c,rE(c),r)},rC=function(){return[ij,i$,iz,iB,iH,iW,iK,iY,i6,i8,iX,rr,i1,i9,i7,re,rt,ri,rs,rn,rj,rA,rS]},rA=function(e){return postMessage(e,[e.buffer])},rS=function(e){return e&&{out:e.size&&new ij(e.size),dictionary:e.dictionary}},rN=function(e,t,i,r,s,n){var a=r_(i,r,s,function(e,t){a.terminate(),n(e,t)});return a.postMessage([e,t],t.consume?[e.buffer]:[]),function(){a.terminate()}},rT=function(e,t){return e[t]|e[t+1]<<8},rx=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},rP=function(e,t){return rx(e,t)+0x100000000*rx(e,t+4)},rO=function(e,t,i){for(;i;++t)e[t]=i,i>>>=8},rM=function(e,t){var i=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:2*(9==t.level),e[9]=3,0!=t.mtime&&rO(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),i){e[3]=8;for(var r=0;r<=i.length;++r)e[r+10]=i.charCodeAt(r)}},rR=function(e){(31!=e[0]||139!=e[1]||8!=e[2])&&rs(6,"invalid gzip data");var t=e[3],i=10;4&t&&(i+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[i++]);return i+(2&t)},rk=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},rD=function(e){return 10+(e.filename?e.filename.length+1:0)},rU=function(e,t){var i=t.level;if(e[0]=120,e[1]=(0==i?0:i<6?1:9==i?3:2)<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var r=rb();r.p(t.dictionary),rO(e,2,r.d())}},rL=function(e,t){return((15&e[0])!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&rs(6,"invalid zlib data"),(e[1]>>5&1)==+!t&&rs(6,"invalid zlib data: "+(32&e[1]?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function rq(e,t){return rw(e,t||{},0,0)}function rj(e,t){return rn(e,{i:2},t&&t.out,t&&t.dictionary)}var r$="undefined"!=typeof TextEncoder&&new TextEncoder,rz="undefined"!=typeof TextDecoder&&new TextDecoder;try{rz.decode(rg,{stream:!0})}catch(e){}var rB=function(e){for(var t="",i=0;;){var r=e[i++],s=(r>127)+(r>223)+(r>239);if(i+s>e.length)return{s:t,r:ri(e,i-1)};s?3==s?t+=String.fromCharCode(55296|(r=((15&r)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++])-65536)>>10,56320|1023&r):1&s?t+=String.fromCharCode((31&r)<<6|63&e[i++]):t+=String.fromCharCode((15&r)<<12|(63&e[i++])<<6|63&e[i++]):t+=String.fromCharCode(r)}},rH=function(e,t){for(;1!=rT(e,t);t+=4+rT(e,t+2));return[rP(e,t+12),rP(e,t+4),rP(e,t+20)]},rW=function(e){var t=0;if(e)for(var i in e){var r=e[i].length;r>65535&&rs(9),t+=r+4}return t};async function rF(e,t){var i,r,s,n;let a=JSON.stringify(e),o=(i=(new TextEncoder).encode(a),r||(r={}),(s=rb()).p(i),rU(n=rw(i,r,r.dictionary?6:2,4),r),rO(n,n.length-4,s.d()),n),c=iR.decode(t),l=await crypto.subtle.importKey("raw",c,{name:"AES-GCM"},!0,["encrypt"]),d=crypto.getRandomValues(new Uint8Array(12)),h=await crypto.subtle.encrypt({name:"AES-GCM",iv:d},l,o);return{iv:iR.encode(d),encryptedRequest:iR.encode(new Uint8Array(h))}}async function rV({encryptedResult:e,iv:t,sharedSecret:i}){var r,s;let n=iR.decode(i),a=iR.decode(t),o=await crypto.subtle.importKey("raw",n,{name:"AES-GCM"},!0,["decrypt"]),c=iR.decode(e),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:a},o,c),d=rn((r=iU.Buffer.from(l)).subarray(rL(r,void 0),-4),{i:2},s&&s.out,s&&s.dictionary);return(new TextDecoder).decode(d)}async function rK(e){let t=window.open(void 0,void 0,rG({w:440,h:680}));if(!t)throw Error("");return t.location=e.href,new Promise((e,i)=>{let r,s=setTimeout(()=>{i(Error("Authorization request timed out after 2 minutes.")),n()},12e4);function n(){t?.close(),window.removeEventListener("message",o)}let a=setInterval(()=>{t?.closed&&!r&&(n(),clearInterval(a),clearTimeout(s),i(Error("User rejected request")))},300);function o(a){a.data&&("PRIVY_CROSS_APP_CONNECT_RESPONSE"===a.data.type&&(e(a.data),t?.close()),"PRIVY_OAUTH_ERROR"===a.data.type&&(clearTimeout(s),i(Error(a.data.error)),n()),"PRIVY_OAUTH_USE_BROADCAST_CHANNEL"===a.data.type&&((r=new BroadcastChannel("popup-privy-oauth")).onmessage=o))}window.addEventListener("message",o)})}function rG({w:e,h:t}){let i=void 0!==window.screenLeft?window.screenLeft:window.screenX,r=void 0!==window.screenTop?window.screenTop:window.screenY,s=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,n=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height;return`toolbar=0,location=0,menubar=0,height=${t},width=${e},popup=1,left=${(s-e)/2/(s/window.screen.availWidth)+i},top=${(n-t)/2/(n/window.screen.availHeight)+r}`}async function rJ({request:e,apiUrl:t,publicKey:i,sharedSecret:r,providerAppId:s}){let n=window.open(void 0,void 0,rG({w:400,h:680}));if(!n)throw Error("Failed to initialize request");let a=new URL(`${t}/cross-app/transact`),{encryptedRequest:o,iv:c}=await rF(e,r);return a.searchParams.set("requester_public_key",i),a.searchParams.set("encrypted_request",o),a.searchParams.set("requester_origin",window.location.origin),a.searchParams.set("iv",c),a.searchParams.set("provider_app_id",s),a.searchParams.set("signout_enabled","true"),a.searchParams.set("v","1"),n.location=a.href,new Promise((e,t)=>{let i=setTimeout(()=>{o(),t(new rY("Request timeout"))},12e4),s=setInterval(()=>{n.closed&&(o(),t(new rY("User rejected request")))},300),a=async i=>{i.data&&("PRIVY_CROSS_APP_ACTION_RESPONSE"===i.data.type&&i.data.encryptedResult&&(o(),e(await rV({encryptedResult:i.data.encryptedResult,iv:i.data.iv,sharedSecret:r}))),"PRIVY_CROSS_APP_ACTION_ERROR"===i.data.type&&i.data.error&&(o(),t(new rY(i.data.error,{mwp:i.data.mwp,code:i.data?.errorCode}))))};window.addEventListener("message",a);let o=()=>{n.close(),clearInterval(s),clearTimeout(i),window.removeEventListener("message",a)}})}"function"==typeof queueMicrotask&&queueMicrotask;class rY extends Error{constructor(e,t){super(e),t?.mwp?.action&&(this.action=t.mwp.action),t?.code&&(this.code=t.code)}}async function rQ({providerAppId:e,providerUrl:t,connectionOpts:i}){let r,s,n=new URL(`${t}/cross-app/connect`),{privateKey:a,publicKey:o}=(r=iE.utils.randomPrivateKey(),s=iE.getPublicKey(r),{privateKey:iR.encode(r),publicKey:iR.encode(s)});n.searchParams.set("requester_public_key",o),n.searchParams.set("connect","true"),n.searchParams.set("provider_app_id",e),n.searchParams.set("requester_origin",window.location.origin),n.searchParams.set("smart_wallet_mode",i?.smartWalletMode?"true":"false");let{address:c,providerPublicKey:l,exp:d}=await rK(n);return{address:c,sharedSecret:function({privateKey:e,publicKey:t}){let i=iE.getSharedSecret(iR.decode(e),iR.decode(t)).slice(1);return iR.encode(i)}({privateKey:a,publicKey:l}),publicKey:o,exp:d}}class rX{get(e){return this._cache[e]}put(e,t){void 0!==t?this._cache[e]=t:this.del(e)}del(e){delete this._cache[e]}getKeys(){return Object.keys(this._cache)}constructor(){this._cache={}}}class rZ{get(e){let t=localStorage.getItem(e);return null===t?void 0:JSON.parse(t)}put(e,t){void 0!==t?localStorage.setItem(e,JSON.stringify(t)):this.del(e)}del(e){localStorage.removeItem(e)}getKeys(){return Object.entries(localStorage).map(([e])=>e)}}var r0="undefined"!=typeof window&&window.localStorage?new rZ:new rX;let r1=({providerAppId:e,chains:t,chainId:i,apiUrl:r,connectionOpts:s})=>new r2(e,t,i,r,s);class r2{get STORAGE_CONNECTION_KEY(){let{smartWalletMode:e}=this._connectionOpts??{};return`privy-caw:${this.providerAppId}:connection${e?":smart-wallet":""}`}get STORAGE_CHAIN_ID_KEY(){let{smartWalletMode:e}=this._connectionOpts??{};return`privy-caw:${this.providerAppId}:connection_chain_id${e?":smart-wallet":""}`}async getProviderUrl(){if(!this._providerUrl){let{url:e}=await tI({providerAppId:this.providerAppId,apiUrl:this._apiUrl});this._providerUrl=e}return this._providerUrl}clearConnection(){this._sharedSecret=void 0,this._publicKey=void 0,this._address=void 0,r0.del(this.STORAGE_CONNECTION_KEY),r0.del(this.STORAGE_CHAIN_ID_KEY)}get chain(){return this.chains.find(({id:e})=>e===this.chainId)}get address(){return this._address}async requestConnection(){let{address:e,sharedSecret:t,publicKey:i,exp:r}=await rQ({providerAppId:this.providerAppId,providerUrl:await this.getProviderUrl(),connectionOpts:this._connectionOpts});r0.put(this.STORAGE_CONNECTION_KEY,{address:e,sharedSecret:t,publicKey:i,exp:r}),this._address=e,this._sharedSecret=t,this._publicKey=i}switchChain({id:e}){this.chainId=e,r0.put(this.STORAGE_CHAIN_ID_KEY,this.chainId)}async sendRequest(e,t){if(!this._sharedSecret||!this._publicKey)throw Error(`Must call 'eth_requestAccounts' before ${e}`);try{return await rJ({request:{method:e,params:t,chainId:this.chainId},apiUrl:await this.getProviderUrl(),publicKey:this._publicKey,providerAppId:this.providerAppId,sharedSecret:this._sharedSecret})}catch(e){throw e instanceof rY&&"clear"===e.action&&this.clearConnection(),e}}constructor(e,t,i,r,s){this.providerAppId=e,this.chains=t,this._apiUrl=r??"https://auth.privy.io",this._connectionOpts=s;let n=r0.get(this.STORAGE_CONNECTION_KEY),a=n&&n.exp>(new Date).getTime(),o=r0.get(this.STORAGE_CHAIN_ID_KEY);this.chainId=i??o??t[0].id,a?(this._sharedSecret=n.sharedSecret,this._publicKey=n.publicKey,this._address=n.address):this.clearConnection(),this.getProviderUrl()}}let r5=e=>{let t=r1({providerAppId:e.providerAppId,chains:e.chains,chainId:e.chainId,apiUrl:e.apiUrl,connectionOpts:{smartWalletMode:e.smartWalletMode}}),i=(0,l.l)({chain:t.chain,transport:e.transports?.[t.chain.id]??(0,c.L)()}),r={accountsChanged:[],connect:[],chainChanged:[],disconnect:[],message:[]},s=()=>{t.clearConnection(),r.accountsChanged?.forEach(e=>e([]))};return{on:(e,t)=>{r[e].push(t)},removeListener:(e,t)=>{let i=r[e].indexOf(t);i>-1&&r[e].splice(i)},request:async n=>{e.smartWalletMode&&("eth_sendTransaction"===n.method&&(n.method="privy_sendSmartWalletTx"),"eth_signTransaction"===n.method&&(n.method="privy_signSmartWalletTx"),"personal_sign"===n.method&&(n.method="privy_signSmartWalletMessage"),"eth_signTypedData_v4"===n.method&&(n.method="privy_signSmartWalletTypedData"));let{method:a,params:o}=n;if(console.debug("PrivyWalletProvider.request",{method:a,params:o}),"wallet_requestPermissions"===a||"eth_requestAccounts"===a&&!t.address)return await t.requestConnection(),r.accountsChanged?.forEach(e=>e([t.address])),void r.connect?.forEach(e=>e({chainId:r3(t.chain.id)}));if("eth_chainId"===a)return t.chain.id;if(r4(a))return i.request({method:a,params:o});switch(a){case"eth_requestAccounts":case"eth_accounts":return t.address?[t.address]:[];case"wallet_switchEthereumChain":return t.switchChain({id:Number(o[0].chainId)}),i=(0,l.l)({chain:t.chain,transport:e.transports?.[t.chain.id]??(0,c.L)()}),r.chainChanged.forEach(e=>e(r3(t.chain.id))),null;case"wallet_revokePermissions":return void s();case"eth_sendTransaction":case"eth_signTransaction":case"eth_signTypedData_v4":case"eth_sign":case"privy_signSmartWalletMessage":case"privy_signSmartWalletTypedData":case"privy_signSmartWalletTx":case"privy_sendSmartWalletTx":case"personal_sign":["eth_sendTransaction","eth_signTransaction","privy_sendSmartWalletTx","privy_signSmartWalletTx"].includes(a)&&(o[0].chainId??=t.chain.id);try{return await t.sendRequest(a,o)}catch(e){if(e instanceof rY&&("clear"===e.action&&s(),void 0===e.code&&"User rejected request"===e.message))throw new tv.Bh(Error("User rejected request"),{code:4001,shortMessage:"User rejected request"});throw new tv.Bh(e,{code:e.code??-1,shortMessage:e.message})}default:throw new tv.Bh(Error("Unsupported method"),{code:4200,shortMessage:`Unsupported method: ${a}`})}}}},r3=e=>`0x${e.toString(16)}`,r6={web3_clientVersion:!0,web3_sha3:!0,net_listening:!0,net_peerCount:!0,net_version:!0,eth_blobBaseFee:!0,eth_blockNumber:!0,eth_call:!0,eth_chainId:!0,eth_coinbase:!0,eth_estimateGas:!0,eth_feeHistory:!0,eth_gasPrice:!0,eth_getBalance:!0,eth_getBlockByHash:!0,eth_getBlockByNumber:!0,eth_getBlockTransactionCountByHash:!0,eth_getBlockTransactionCountByNumber:!0,eth_getCode:!0,eth_getFilterChanges:!0,eth_getFilterLogs:!0,eth_getLogs:!0,eth_getProof:!0,eth_getStorageAt:!0,eth_getTransactionByBlockHashAndIndex:!0,eth_getTransactionByBlockNumberAndIndex:!0,eth_getTransactionByHash:!0,eth_getTransactionCount:!0,eth_getTransactionReceipt:!0,eth_getUncleByBlockHashAndIndex:!0,eth_getUncleByBlockNumberAndIndex:!0,eth_getUncleCountByBlockHash:!0,eth_getUncleCountByBlockNumber:!0,eth_maxPriorityFeePerGas:!0,eth_newBlockFilter:!0,eth_newFilter:!0,eth_newPendingTransactionFilter:!0,eth_protocolVersion:!0,eth_sendRawTransaction:!0,eth_uninstallFilter:!0,zks_estimateFee:!0,eth_createAccessList:!0,eth_simulateV1:!0},r4=e=>!!r6[e];function r8(e={}){let{rkDetails:t,customPaymasterHandler:i}=e;return e=>{var r;let s,n,a,l,d,h=[...e.chains],u=e.chains[0];for(let e of Object.keys(D).map(Number).sort(function(e,t){return e-t})){let t=h.findIndex(t=>t.id===e);if(-1!==t){u=h.splice(t,1)[0]??u;break}}let p=(r={iconUrl:"https://abstract-assets.abs.xyz/icons/light.png",id:"cm04asygd041fmry9zmcyn5o5",name:"Abstract"},d=null,(0,tm.U)(e=>({id:r.id,name:r.name,icon:r.iconUrl,type:"privy",...void 0,isWalletConnectModalConnector:!1,async setup(){let e=await this.getProvider();e&&(a||(a=this.onConnect.bind(this),e.on("connect",a)),s||(s=this.onAccountsChanged.bind(this),e.on("accountsChanged",s)))},async connect(e){let t=await this.getProvider();if(t&&await this.isAuthorized()){let[e,t]=await Promise.all([this.getAccounts(),this.getChainId()]);return{accounts:e,chainId:t}}if(e?.isReconnecting)return{accounts:[],chainId:1};await t.request({method:"eth_requestAccounts"}),a&&(t.removeListener("connect",a),a=void 0),s||(s=this.onAccountsChanged.bind(this),t.on("accountsChanged",s)),n||(n=this.onChainChanged.bind(this),t.on("chainChanged",n)),l||(l=this.onDisconnect.bind(this),t.on("disconnect",l)),e?.chainId&&await this.switchChain({chainId:e.chainId});let[i,r]=await Promise.all([this.getAccounts(),this.getChainId()]);return{accounts:i,chainId:r}},async disconnect(){let e=await this.getProvider();n&&(e.removeListener("chainChanged",n),n=void 0),l&&(e.removeListener("disconnect",l),l=void 0),a||(a=this.onConnect.bind(this),e.on("connect",a)),await e.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),this.onDisconnect()},async getAccounts(){let e=await this.getProvider();if(!e)throw new tb.N;return(await e.request({method:"eth_accounts"})).map(e=>(0,X.b)(e))},async getChainId(){let e=await this.getProvider();if(!e)throw new tb.N;return Number(await e.request({method:"eth_chainId"}))},getProvider:async()=>(d||(d=r5({chains:e.chains,transports:e.transports,providerAppId:r.id,apiUrl:r.apiUrl,smartWalletMode:r.smartWalletMode})),d),async isAuthorized(){try{return!!(await this.getAccounts()).length}catch(e){return!1}},async switchChain({chainId:t}){let i=await this.getProvider();if(!i)throw new tb.N;let r=e.chains.find(e=>e.id===t);if(!r)throw new tv.ch(new tw.nk);return t===Number(await i.request({method:"eth_chainId"}))||(await i.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${t.toString(16)}`}]}),e.emitter.emit("change",{chainId:t})),r},async onAccountsChanged(t){if(0!==t.length)if(e.emitter.listenerCount("connect")){let e=(await this.getChainId()).toString();this.onConnect?.({chainId:e})}else e.emitter.emit("change",{accounts:t.map(e=>(0,X.b)(e))});else this.onDisconnect()},onChainChanged(t){let i=Number(t);e.emitter.emit("change",{chainId:i})},async onConnect(t){let i=await this.getAccounts();if(0===i.length)return;let r=Number(t.chainId);e.emitter.emit("connect",{accounts:i,chainId:r});let o=await this.getProvider();o&&(a&&(o.removeListener("connect",a),a=void 0),s||(s=this.onAccountsChanged.bind(this),o.on("accountsChanged",s)),n||(n=this.onChainChanged.bind(this),o.on("chainChanged",n)),l||(l=this.onDisconnect.bind(this),o.on("disconnect",l)))},async onDisconnect(){e.emitter.emit("disconnect")}})))({...e,chains:[u,...h]}),f=async t=>{let r=t?.chainId??u.id;if(!D[r])throw Error("Unsupported chain");let s=e.chains.find(e=>e.id===r)??D[r];return function(e){let{provider:t,chain:i,transport:r,isPrivyCrossApp:s=!1,customPaymasterHandler:n}=e,a=(0,ex.I)(t),c=async e=>{let{method:c,params:l}=e;switch(c){case"eth_requestAccounts":{let e=await tg(t,c);if(!e)return[];return[await tf(i,a,e),e]}case"eth_accounts":{let e=await tg(t);if(!e)return[];return[await tf(i,a,e),e]}case"eth_signTypedData_v4":{let o=await tg(t);if(!o)throw Error("Account not found");if(l[0]===o)return t.request(e);return(await ty(o,i,a,s,r,n)).signTypedData(JSON.parse(l[1]))}case"personal_sign":{let o=await tg(t);if(!o)throw Error("Account not found");if(l[1]===o)return t.request(e);let c=await ty(o,i,a,s,r,n);return await c.signMessage({message:{raw:l[0]}})}case"eth_signTransaction":case"eth_sendTransaction":{let o=await tg(t);if(!o)throw Error("Account not found");let d=l[0];if(d.from===o)return await t.request(e);let h=await ty(o,i,a,s,r,n);if(d.eip712Meta&&d.eip712Meta.paymasterParams&&(d.paymaster=d.eip712Meta.paymasterParams.paymaster,d.paymasterInput=(0,w.nj)(d.eip712Meta.paymasterParams.paymasterInput)),"eth_signTransaction"===c)return await h.signTransaction(d);if("eth_sendTransaction"===c)return await h.sendTransaction(d);throw Error("Should not have reached this point")}case"wallet_sendCalls":{let o=await tg(t);if(!o)throw Error("Account not found");let c=l[0];if(c.from===o)return await t.request(e);if(("1.0"===c.version||void 0===c.version)&&c.calls.forEach(e=>{e.chainId&&(0,ew.v)({chain:i,currentChainId:(0,m.aD)(e.chainId,"number")})}),"2.0.0"===c.version&&(0,m.aD)(c.chainId,"number")!==i.id)return{code:5710,message:"Chain not supported"};let d=await ty(o,i,a,s,r,n);if(c.from!==(0,v.J)(d.account).address)return{code:4001,message:"Unauthorized"};let h=await d.sendTransactionBatch({calls:c.calls.map(e=>({to:e.to,value:e.value?(0,m.uU)(e.value):void 0,data:e.data}))});if(void 0===c.version||"1.0"===c.version)return h;return{id:h}}case"wallet_getCallsStatus":{let e=await t.request({method:"eth_getTransactionReceipt",params:l});return{version:"2.0.0",id:l[0],chainId:(0,w.nj)(i.id),status:function(e){switch(e?.status){case void 0:return o.Pending;case"0x1":return o.Confirmed;case"0x0":return o.Reverted}}(e??void 0),atomic:!0,receipts:null!=e?[e]:void 0}}case"wallet_addEthereumChain":case"wallet_switchEthereumChain":{let i=l[0].chainId;if(!i)throw Error("Chain ID is required");let r=(0,y.q)(i)?(0,m.ME)(i):i;if(!Object.values(D).find(e=>e.id===r))throw Error(`Chain ${r} not supported`);return await t.request(e)}case"wallet_showCallsStatus":return;case"wallet_getCapabilities":{let i=await tg(t);if(!i)throw Error("Account not found");if(l[0]===i)return await t.request(e);let r=l[1];if(!r)return tp;{let e={};for(let t of r)tp[t]&&(e[t]=tp[t]);return e}}default:return await t.request(e)}};return{...t,on:t.on,removeListener:t.removeListener,request:c}}({provider:await p.getProvider({chainId:r}),chain:s,transport:e.transports?.[r]??(0,c.L)(),isPrivyCrossApp:!0,customPaymasterHandler:i})};return{...p,...t,getProvider:f,type:"injected",id:"xyz.abs.privy"}}}},40274:(e,t,i)=>{"use strict";t.sha1=i(68374),t.sha224=i(79237),t.sha256=i(59176),t.sha384=i(97348),t.sha512=i(72597)},41036:(e,t,i)=>{"use strict";i.d(t,{j:()=>a});var r=i(41179),s=i(74801);let n=(0,r.BX)({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),a={state:n,subscribeNetworkImages:e=>(0,r.B1)(n.networkImages,()=>e(n.networkImages)),subscribeKey:(e,t)=>(0,s.u$)(n,e,t),subscribe:e=>(0,r.B1)(n,()=>e(n)),setWalletImage(e,t){n.walletImages[e]=t},setNetworkImage(e,t){n.networkImages[e]=t},setChainImage(e,t){n.chainImages[e]=t},setConnectorImage(e,t){n.connectorImages={...n.connectorImages,[e]:t}},setTokenImage(e,t){n.tokenImages[e]=t},setCurrencyImage(e,t){n.currencyImages[e]=t}}},41572:(e,t,i)=>{"use strict";async function r(...e){let t=await fetch(...e);if(!t.ok)throw Error(`HTTP status code: ${t.status}`,{cause:t});return t}i.d(t,{Z:()=>s});class s{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:i,...s}){let n=this.createUrl(s);return(await r(n,{method:"GET",headers:e,signal:t,cache:i})).json()}async getBlob({headers:e,signal:t,...i}){let s=this.createUrl(i);return(await r(s,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:i,...s}){let n=this.createUrl(s);return(await r(n,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:i})).json()}async put({body:e,headers:t,signal:i,...s}){let n=this.createUrl(s);return(await r(n,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:i})).json()}async delete({body:e,headers:t,signal:i,...s}){let n=this.createUrl(s);return(await r(n,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:i})).json()}createUrl({path:e,params:t}){let i=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([e,t])=>{t&&i.searchParams.append(e,t)}),this.clientId&&i.searchParams.append("clientId",this.clientId),i}}},42270:(e,t,i)=>{"use strict";i.d(t,{T:()=>g});var r=i(41179),s=i(51605),n=i(91019),a=i(41572),o=i(5001),c=i(1711),l=i(63),d=i(75808),h=i(97490);let u={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},p=n.w.getBlockchainApiUrl(),f=(0,r.BX)({clientId:null,api:new a.Z({baseUrl:p,clientId:null}),supportedChains:{http:[],ws:[]}}),g={state:f,async get(e){let{st:t,sv:i}=g.getSdkProperties(),r=d.H.state.projectId,s={...e.params||{},st:t,sv:i,projectId:r};return f.api.get({...e,params:s})},getSdkProperties(){let{sdkType:e,sdkVersion:t}=d.H.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{f.supportedChains.http.length||await g.getSupportedNetworks()}catch(e){return!1}return f.supportedChains.http.includes(e)},async getSupportedNetworks(){let e=await g.get({path:"v1/supported-chains"});return f.supportedChains=e,e},async fetchIdentity({address:e,caipNetworkId:t}){if(!await g.isNetworkSupported(t))return{avatar:"",name:""};let i=o.i.getIdentityFromCacheForAddress(e);if(i)return i;let r=await g.get({path:`/v1/identity/${e}`,params:{sender:l.W.state.activeCaipAddress?n.w.getPlainAddress(l.W.state.activeCaipAddress):void 0}});return o.i.updateIdentityCache({address:e,identity:r,timestamp:Date.now()}),r},fetchTransactions:async({account:e,cursor:t,onramp:i,signal:r,cache:s,chainId:n})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/account/${e}/history`,params:{cursor:t,onramp:i,chainId:n},signal:r,cache:s}):{data:[],next:void 0},fetchSwapQuote:async({amount:e,userAddress:t,from:i,to:r,gasPrice:s})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:i,to:r,gasPrice:s}}):{quotes:[]},fetchSwapTokens:async({chainId:e})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]},fetchTokenPrice:async({addresses:e})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:d.H.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]},fetchSwapAllowance:async({tokenAddress:e,userAddress:t})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"},async fetchGasPrice({chainId:e}){let{st:t,sv:i}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Gas Price");return g.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:i}})},async generateSwapCalldata({amount:e,from:t,to:i,userAddress:r,disableEstimate:n}){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Swaps");return f.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:s.oU.CONVERT_SLIPPAGE_TOLERANCE},projectId:d.H.state.projectId,from:t,to:i,userAddress:r,disableEstimate:n}})},async generateApproveCalldata({from:e,to:t,userAddress:i}){let{st:r,sv:s}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Swaps");return g.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:i,from:e,to:t,st:r,sv:s}})},async getBalance(e,t,i){let{st:r,sv:s}=g.getSdkProperties();if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return h.P.showError("Token Balance Unavailable"),{balances:[]};let n=`${t}:${e}`,a=o.i.getBalanceCacheForCaipAddress(n);if(a)return a;let c=await g.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:i,st:r,sv:s}});return o.i.updateBalanceCache({caipAddress:n,balance:c,timestamp:Date.now()}),c},lookupEnsName:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]},reverseLookupEnsName:async({address:e})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/reverse/${e}`,params:{sender:c.U.state.address,apiVersion:"2"}}):[],getEnsNameSuggestions:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]},registerEnsName:async({coinType:e,address:t,message:i,signature:r})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:i,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1},generateOnRampURL:async({destinationWallets:e,partnerUserId:t,defaultNetwork:i,purchaseAmount:r,paymentAmount:s})=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?(await f.api.post({path:"/v1/generators/onrampurl",params:{projectId:d.H.state.projectId},body:{destinationWallets:e,defaultNetwork:i,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:"",async getOnrampOptions(){if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await g.get({path:"/v1/onramp/options"})}catch(e){return u}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:i,network:r}){try{if(!await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId))return null;return await f.api.post({path:"/v1/onramp/quote",params:{projectId:d.H.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:i,network:r}})}catch(e){return{coinbaseFee:{amount:i,currency:t.id},networkFee:{amount:i,currency:t.id},paymentSubtotal:{amount:i,currency:t.id},paymentTotal:{amount:i,currency:t.id},purchaseAmount:{amount:i,currency:t.id},quoteId:"mocked-quote-id"}}},getSmartSessions:async e=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/sessions/${e}`}):[],revokeSmartSession:async(e,t,i)=>await g.isNetworkSupported(l.W.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:d.H.state.projectId},body:{pci:t,signature:i}}):{success:!1},setClientId(e){f.clientId=e,f.api=new a.Z({baseUrl:p,clientId:e})}}},44040:(e,t,i)=>{"use strict";i.d(t,{Zv:()=>s.Z,EM:()=>h.E,RF:()=>r.RF,JX:()=>r.JX,ds:()=>r.ds});var r=i(17232),s=i(8145),n=i(3074),a=i(25781),o=i(24956),c=i(3986);n.extend(o),n.extend(c);let l={...a,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}},d=["January","February","March","April","May","June","July","August","September","October","November","December"];n.locale("en-web3-modal",l);var h=i(6267)},44488:(e,t,i)=>{"use strict";var r=i(2289),s=i(18835),n=i(93973),a=i(33589),o=r.assert;function c(e){this.twisted=(0|e.a)!=1,this.mOneA=this.twisted&&(0|e.a)==-1,this.extended=this.mOneA,a.call(this,"edwards",e),this.a=new s(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),o(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=(0|e.c)==1}function l(e,t,i,r,n){a.BasePoint.call(this,e,"projective"),null===t&&null===i&&null===r?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(t,16),this.y=new s(i,16),this.z=r?new s(r,16):this.curve.one,this.t=n&&new s(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}n(c,a),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,i,r){return this.point(e,t,i,r)},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),r=this.c2.redSub(this.a.redMul(i)),n=this.one.redSub(this.c2.redMul(this.d).redMul(i)),a=r.redMul(n.redInvm()),o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw Error("invalid point");var c=o.fromRed().isOdd();return(t&&!c||!t&&c)&&(o=o.redNeg()),this.point(e,o)},c.prototype.pointFromY=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),r=i.redSub(this.c2),n=i.redMul(this.d).redMul(this.c2).redSub(this.a),a=r.redMul(n.redInvm());if(0===a.cmp(this.zero))if(!t)return this.point(this.zero,e);else throw Error("invalid point");var o=a.redSqrt();if(0!==o.redSqr().redSub(a).cmp(this.zero))throw Error("invalid point");return o.fromRed().isOdd()!==t&&(o=o.redNeg()),this.point(o,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),r=t.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return 0===r.cmp(s)},n(l,a.BasePoint),c.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},c.prototype.point=function(e,t,i,r){return new l(this,e,t,i,r)},l.fromJSON=function(e,t){return new l(e,t[0],t[1],t[2])},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},l.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var r=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),n=r.redAdd(t),a=n.redSub(i),o=r.redSub(t),c=s.redMul(a),l=n.redMul(o),d=s.redMul(o),h=a.redMul(n);return this.curve.point(c,l,h,d)},l.prototype._projDbl=function(){var e,t,i,r,s,n,a=this.x.redAdd(this.y).redSqr(),o=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var l=(r=this.curve._mulA(o)).redAdd(c);this.zOne?(e=a.redSub(o).redSub(c).redMul(l.redSub(this.curve.two)),t=l.redMul(r.redSub(c)),i=l.redSqr().redSub(l).redSub(l)):(s=this.z.redSqr(),n=l.redSub(s).redISub(s),e=a.redSub(o).redISub(c).redMul(n),t=l.redMul(r.redSub(c)),i=l.redMul(n))}else r=o.redAdd(c),s=this.curve._mulC(this.z).redSqr(),n=r.redSub(s).redSub(s),e=this.curve._mulC(a.redISub(r)).redMul(n),t=this.curve._mulC(r).redMul(o.redISub(c)),i=r.redMul(n);return this.curve.point(e,t,i)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},l.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),n=i.redSub(t),a=s.redSub(r),o=s.redAdd(r),c=i.redAdd(t),l=n.redMul(a),d=o.redMul(c),h=n.redMul(c),u=a.redMul(o);return this.curve.point(l,d,u,h)},l.prototype._projAdd=function(e){var t,i,r=this.z.redMul(e.z),s=r.redSqr(),n=this.x.redMul(e.x),a=this.y.redMul(e.y),o=this.curve.d.redMul(n).redMul(a),c=s.redSub(o),l=s.redAdd(o),d=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(a),h=r.redMul(c).redMul(d);return this.curve.twisted?(t=r.redMul(l).redMul(a.redSub(this.curve._mulA(n))),i=c.redMul(l)):(t=r.redMul(l).redMul(a.redSub(n)),i=this.curve._mulC(c).redMul(l)),this.curve.point(h,t,i)},l.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},l.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)},l.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)},l.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},l.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()},l.prototype.getY=function(){return this.normalize(),this.y.fromRed()},l.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},l.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var i=e.clone(),r=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(r),0===this.x.cmp(t))return!0}},l.prototype.toP=l.prototype.normalize,l.prototype.mixedAdd=l.prototype.add},50209:(e,t,i)=>{"use strict";i.d(t,{W:()=>y});var r=i(41179),s=i(74801),n=i(91019),a=i(1711),o=i(14572),c=i(63),l=i(95954),d=i(1221),h=i(14109),u=i(75808),p=i(9686),f=i(20641);let g=(0,r.BX)({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),y={state:g,subscribe:e=>(0,r.B1)(g,()=>e(g)),subscribeKey:(e,t)=>(0,s.u$)(g,e,t),async open(e){let t="connected"===a.U.state.status;l.x.state.wcBasic?o.N.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await o.N.prefetch({fetchConnectorImages:!t,fetchFeaturedWallets:!t,fetchRecommendedWallets:!t}),e?.namespace?(await c.W.switchActiveNamespace(e.namespace),y.setLoading(!0,e.namespace)):y.setLoading(!0),d.a.setFilterByNamespace(e?.namespace);let i=c.W.getAccountData(e?.namespace)?.caipAddress;c.W.state.noAdapters&&!i?n.w.isMobile()?f.I.reset("AllWallets"):f.I.reset("ConnectingWalletConnectBasic"):e?.view?f.I.reset(e.view):i?f.I.reset("Account"):f.I.reset("Connect"),g.open=!0,p.z.set({open:!0}),h.E.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!i}})},close(){let e=u.H.state.enableEmbedded,t=!!c.W.state.activeCaipAddress;g.open&&h.E.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),g.open=!1,y.clearLoading(),e?t?f.I.replace("Account"):f.I.push("Connect"):p.z.set({open:!1}),l.x.resetUri()},setLoading(e,t){t&&g.loadingNamespaceMap.set(t,e),g.loading=e,p.z.set({loading:e})},clearLoading(){g.loadingNamespaceMap.clear(),g.loading=!1},shake(){g.shake||(g.shake=!0,setTimeout(()=>{g.shake=!1},500))}}},51285:(e,t,i)=>{"use strict";i.d(t,{K:()=>dq});var r,s,n,a,o=i(88371),c=i(16591),l=i(38582),d=i(69990);!function(e){e.Mainnet="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",e.Devnet="solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",e.Deprecated_Mainnet="solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",e.Deprecated_Devnet="solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}(n||(n={})),function(e){e.signTransaction="solana_signTransaction",e.signMessage="solana_signMessage",e.signAndSendTransaction="solana_signAndSendTransaction",e.signAndSendAllTransactions="solana_signAndSendAllTransactions",e.signAllTransactions="solana_signAllTransactions"}(a||(a={}));let h={Mainnet:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",Devnet:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",Deprecated_Mainnet:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",Deprecated_Devnet:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};var u=i(75031),p=i(4398),f=i(97709),g=i.n(f),y=i(76460),m=i(34691),b=i(23430),w=i(4886),v=Object.defineProperty,I=(e,t,i)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,E=(e,t,i)=>I(e,"symbol"!=typeof t?t+"":t,i);class _ extends w.H{constructor(e){super(),this.opts=e,E(this,"protocol","wc"),E(this,"version",2)}}var C=Object.defineProperty,A=(e,t,i)=>t in e?C(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,S=(e,t,i)=>A(e,"symbol"!=typeof t?t+"":t,i);class N extends w.H{constructor(e,t){super(),this.core=e,this.logger=t,S(this,"records",new Map)}}class T{constructor(e,t){this.logger=e,this.core=t}}class x extends w.H{constructor(e,t){super(),this.relayer=e,this.logger=t}}class P extends w.H{constructor(e){super()}}class O{constructor(e,t,i,r){this.core=e,this.logger=t,this.name=i}}var M=Object.defineProperty;class R extends w.H{constructor(e,t){super(),this.relayer=e,this.logger=t}}class k extends w.H{constructor(e,t){super(),this.core=e,this.logger=t}}class D{constructor(e,t,i){this.core=e,this.logger=t,this.store=i}}class U{constructor(e,t){this.projectId=e,this.logger=t}}class L{constructor(e,t,i){this.core=e,this.logger=t,this.telemetryEnabled=i}}var q=Object.defineProperty,j=(e,t,i)=>t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,$=(e,t,i)=>j(e,"symbol"!=typeof t?t+"":t,i);g();class z{constructor(e){this.opts=e,$(this,"protocol","wc"),$(this,"version",2)}}f.EventEmitter;class B{constructor(e){this.client=e}}var H=i(14421),W=i(29220),F=i(74711),V=i(54969),K=i(92064),G=i(31718),J=i(82336),Y=i(30505),Q=i(21415),X=i(99370),Z=i(55036),ee=i(29155).Buffer;function et(e){let[t,i]=e.split(":");return{namespace:t,reference:i}}function ei(e){let[t,i,r]=e.split(":");return{namespace:t,reference:i,address:r}}function er(e,t){return e.includes(":")?[e]:t.chains||[]}let es={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function en(){return"u">typeof Z&&"u">typeof Z.versions&&"u">typeof Z.versions.node}function ea(){return!(0,K.getDocument)()&&!!(0,K.getNavigator)()&&"ReactNative"===navigator.product}function eo(){return!en()&&!!(0,K.getNavigator)()&&!!(0,K.getDocument)()}function ec(){return ea()?es.reactNative:en()?es.node:eo()?es.browser:es.unknown}function el(){var e;try{return ea()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Application)?null==(e=i.g.Application)?void 0:e.applicationId:void 0}catch{return}}function ed(){return(0,G.g)()||{name:"",description:"",url:"",icons:[""]}}function eh(e,t,r){let s=function(){if(ec()===es.reactNative&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)){let{OS:e,Version:t}=i.g.Platform;return[e,t].join("-")}let e=(0,V.o0)();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),n=function(){var e;let t=ec();return t===es.browser?[t,(null==(e=(0,K.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",r].join("-"),s,n].join("/")}function eu(e,t){return e.filter(e=>t.includes(e)).length===e.length}function ep(e){return Object.fromEntries(e.entries())}function ef(e){return new Map(Object.entries(e))}function eg(e=H.FIVE_MINUTES,t){let i,r,s,n,a=(0,H.toMiliseconds)(e||H.FIVE_MINUTES);return{resolve:e=>{s&&i&&(clearTimeout(s),i(e),n=Promise.resolve(e))},reject:e=>{s&&r&&(clearTimeout(s),r(e))},done:()=>new Promise((e,o)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),o(e)},a),i=e,r=o})}}function ey(e,t,i){return new Promise(async(r,s)=>{let n=setTimeout(()=>s(Error(i)),t);try{let t=await e;r(t)}catch(e){s(e)}clearTimeout(n)})}function em(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function eb(e){let[t,i]=e.split(":"),r={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof i)r.topic=i;else if("id"===t&&Number.isInteger(Number(i)))r.id=Number(i);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${i}`);return r}function ew(e,t){return(0,H.fromMiliseconds)((t||Date.now())+(0,H.toMiliseconds)(e))}function ev(e){return Date.now()>=(0,H.toMiliseconds)(e)}function eI(e,t){return`${e}${t?`:${t}`:""}`}function eE(e=[],t=[]){return[...new Set([...e,...t])]}async function e_({id:e,topic:t,wcDeepLink:r}){var s,n;try{if(!r)return;let a="string"==typeof r?JSON.parse(r):r,o=a?.href;if("string"!=typeof o)return;let c=function(e,t,i){let r=`requestId=${t}&sessionTopic=${i}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let i=ee.from(e).toString("base64");return t?i.replace(/[=]/g,""):i}(r,!0)}`}else s=`${s}/wc?${r}`;return s}(o,e,t),l=ec();if(l===es.browser){let e;if(!(null!=(s=(0,K.getDocument)())&&s.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");n=c,e="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?("u">typeof window&&(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto)||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"):e="_top",window.open(n,e,"noreferrer noopener")}else l===es.reactNative&&"u">typeof(null==i.g?void 0:i.g.Linking)&&await i.g.Linking.openURL(c)}catch(e){console.error(e)}}async function eC(e,t){let i="";try{if(eo()&&(i=localStorage.getItem(t)))return i;i=await e.getItem(t)}catch(e){console.error(e)}return i}function eA(e,t){if(!e.includes(t))return null;let i=e.split(/([&,?,=])/),r=i.indexOf(t);return i[r+2]}function eS(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function eN(){return"u">typeof Z&&"true"===Z.env.IS_VITEST}function eT(e){return ee.from(e,"base64").toString("utf-8")}function ex(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function eP(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function eO(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");ex(e.outputLen),ex(e.blockLen)}function eM(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function eR(e,t){eP(e);let i=t.outputLen;if(e.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}let ek=BigInt(0x100000000-1),eD=BigInt(32),eU=(e,t,i)=>e<<i|t>>>32-i,eL=(e,t,i)=>t<<i|e>>>32-i,eq=(e,t,i)=>t<<i-32|e>>>64-i,ej=(e,t,i)=>e<<i-32|t>>>64-i,e$="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ez(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function eB(e,t){return e<<32-t|e>>>t}let eH=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function eW(e){for(let i=0;i<e.length;i++){var t;e[i]=(t=e[i])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}}function eF(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),eP(e),e}class eV{clone(){return this._cloneInto()}}function eK(e){let t=t=>e().update(eF(t)).digest(),i=e();return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=()=>e(),t}function eG(e=32){if(e$&&"function"==typeof e$.getRandomValues)return e$.getRandomValues(new Uint8Array(e));if(e$&&"function"==typeof e$.randomBytes)return e$.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let eJ=[],eY=[],eQ=[],eX=BigInt(0),eZ=BigInt(1),e0=BigInt(2),e1=BigInt(7),e2=BigInt(256),e5=BigInt(113);for(let e=0,t=eZ,i=1,r=0;e<24;e++){[i,r]=[r,(2*i+3*r)%5],eJ.push(2*(5*r+i)),eY.push((e+1)*(e+2)/2%64);let s=eX;for(let e=0;e<7;e++)(t=(t<<eZ^(t>>e1)*e5)%e2)&e0&&(s^=eZ<<(eZ<<BigInt(e))-eZ);eQ.push(s)}let[e3,e6]=function(e,t=!1){let i=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:a}=function(e,t=!1){return t?{h:Number(e&ek),l:Number(e>>eD&ek)}:{h:0|Number(e>>eD&ek),l:0|Number(e&ek)}}(e[s],t);[i[s],r[s]]=[n,a]}return[i,r]}(eQ,!0),e4=(e,t,i)=>i>32?eq(e,t,i):eU(e,t,i),e8=(e,t,i)=>i>32?ej(e,t,i):eL(e,t,i);class e9 extends eV{constructor(e,t,i,r=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=i,this.enableXOF=r,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ex(i),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}(this.state)}keccak(){eH||eW(this.state32),function(e,t=24){let i=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let t=0;t<10;t++)i[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let r=(t+8)%10,s=(t+2)%10,n=i[s],a=i[s+1],o=e4(n,a,1)^i[r],c=e8(n,a,1)^i[r+1];for(let i=0;i<50;i+=10)e[t+i]^=o,e[t+i+1]^=c}let t=e[2],s=e[3];for(let i=0;i<24;i++){let r=eY[i],n=e4(t,s,r),a=e8(t,s,r),o=eJ[i];t=e[o],s=e[o+1],e[o]=n,e[o+1]=a}for(let t=0;t<50;t+=10){for(let r=0;r<10;r++)i[r]=e[t+r];for(let r=0;r<10;r++)e[t+r]^=~i[(r+2)%10]&i[(r+4)%10]}e[0]^=e3[r],e[1]^=e6[r]}i.fill(0)}(this.state32,this.rounds),eH||eW(this.state32),this.posOut=0,this.pos=0}update(e){eM(this);let{blockLen:t,state:i}=this,r=(e=eF(e)).length;for(let s=0;s<r;){let n=Math.min(t-this.pos,r-s);for(let t=0;t<n;t++)i[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:i,blockLen:r}=this;e[i]^=t,(128&t)!=0&&i===r-1&&this.keccak(),e[r-1]^=128,this.keccak()}writeInto(e){eM(this,!1),eP(e),this.finish();let t=this.state,{blockLen:i}=this;for(let r=0,s=e.length;r<s;){this.posOut>=i&&this.keccak();let n=Math.min(i-this.posOut,s-r);e.set(t.subarray(this.posOut,this.posOut+n),r),this.posOut+=n,r+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ex(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(eR(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:i,outputLen:r,rounds:s,enableXOF:n}=this;return e||(e=new e9(t,i,r,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=r,e.enableXOF=n,e.destroyed=this.destroyed,e}}let e7=eK(()=>new e9(136,1,32));function te(e){let t=`Ethereum Signed Message:
${e.length}`,i=new TextEncoder().encode(t+e);return"0x"+ee.from(e7(i)).toString("hex")}async function tt(e,t,i,r,s,n){switch(i.t){case"eip191":return await ti(e,t,i.s);case"eip1271":return await tr(e,t,i.s,r,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${i.t}`)}}async function ti(e,t,i){return(await (0,J.x)({hash:te(t),signature:i})).toLowerCase()===e.toLowerCase()}async function tr(e,t,i,r,s,n){let a=et(r);if(!a.namespace||!a.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{let a="0x1626ba7e",o=i.substring(2),c=te(t).substring(2),l=a+c+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+o,d=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${r}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:l},"latest"]})}),{result:h}=await d.json();return!!h&&h.slice(0,a.length).toLowerCase()===a.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var ts=Object.defineProperty,tn=Object.defineProperties,ta=Object.getOwnPropertyDescriptors,to=Object.getOwnPropertySymbols,tc=Object.prototype.hasOwnProperty,tl=Object.prototype.propertyIsEnumerable,td=(e,t,i)=>t in e?ts(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,th=(e,t)=>{for(var i in t||(t={}))tc.call(t,i)&&td(e,i,t[i]);if(to)for(var i of to(t))tl.call(t,i)&&td(e,i,t[i]);return e},tu=(e,t)=>tn(e,ta(t));let tp=e=>e?.split(":"),tf=e=>{let t=e&&tp(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},tg=e=>{let t=e&&tp(e);if(t)return t[2]+":"+t[3]},ty=e=>{let t=e&&tp(e);if(t)return t.pop()};async function tm(e){let{cacao:t,projectId:i}=e,{s:r,p:s}=t,n=tb(s,s.iss),a=ty(s.iss);return await tt(a,n,r,tg(s.iss),i)}let tb=(e,t)=>{let i=`${e.domain} wants you to sign in with your Ethereum account:`,r=ty(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,a=`Version: ${e.version}`,o=`Chain ID: ${tf(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,d=e.exp?`Expiration Time: ${e.exp}`:void 0,h=e.nbf?`Not Before: ${e.nbf}`:void 0,u=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,f=tC(e.resources);return f&&(s=function(e="",t){tw(t);let i="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(i))return e;let r=[],s=0;Object.keys(t.att).forEach(e=>{let i=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));i.sort((e,t)=>e.action.localeCompare(t.action));let n={};i.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let a=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));r.push(a.join(", ").replace(".,","."))});let n=r.join(" "),a=`${i}${n}`;return`${e?e+" ":""}${a}`}(s,tI(f))),[i,r,"",s,"",n,a,o,c,l,d,h,u,p].filter(e=>null!=e).join(`
`)};function tw(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let i=e.att[t];if(Array.isArray(i)||"object"!=typeof i)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(i).length)throw Error(`Resource object is empty: ${t}`);Object.keys(i).forEach(e=>{let t=i[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function tv(e){return tw(e),`urn:recap:${ee.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function tI(e){var t;let i=(t=e.replace("urn:recap:",""),JSON.parse(ee.from(t,"base64").toString("utf-8")));return tw(i),i}function tE(e){var t;let i=tI(e);tw(i);let r=null==(t=i.att)?void 0:t.eip155;return r?Object.keys(r).map(e=>e.split("/")[1]):[]}function t_(e){let t=tI(e);tw(t);let i=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&i.push(e[0].chains)})}),[...new Set(i.flat())]}function tC(e){var t;if(!e)return;let i=e?.[e.length-1];return(t=i)&&t.includes("urn:recap:")?i:void 0}function tA(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function tS(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function tN(e,...t){if(!tS(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function tT(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function tx(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}let tP=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),tO=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([0x11223344]).buffer)[0])throw Error("Non little-endian hardware is not supported");function tM(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(tS(e))e=tD(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function tR(e,t,i=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(i&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function tk(e,t,i,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,i,r);let s=BigInt(32),n=BigInt(0xffffffff),a=Number(i>>s&n),o=Number(i&n),c=4*!!r,l=4*!r;e.setUint32(t+c,a,r),e.setUint32(t+l,o,r)}function tD(e){return Uint8Array.from(e)}function tU(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let tL=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),tq=tL("expand 16-byte k"),tj=tL("expand 32-byte k"),t$=tP(tq),tz=tP(tj);function tB(e,t){return e<<t|e>>>32-t}function tH(e){return e.byteOffset%4==0}let tW=0x100000000-1,tF=new Uint32Array,tV=(e,t)=>255&e[t++]|(255&e[t++])<<8;class tK{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,tN(e=tM(e),32);let t=tV(e,0),i=tV(e,2),r=tV(e,4),s=tV(e,6),n=tV(e,8),a=tV(e,10),o=tV(e,12),c=tV(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|i<<3)&8191,this.r[2]=(i>>>10|r<<6)&7939,this.r[3]=(r>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|a<<2)&8191,this.r[7]=(a>>>11|o<<5)&8065,this.r[8]=(o>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=tV(e,16+2*t)}process(e,t,i=!1){let{h:r,r:s}=this,n=s[0],a=s[1],o=s[2],c=s[3],l=s[4],d=s[5],h=s[6],u=s[7],p=s[8],f=s[9],g=tV(e,t+0),y=tV(e,t+2),m=tV(e,t+4),b=tV(e,t+6),w=tV(e,t+8),v=tV(e,t+10),I=tV(e,t+12),E=tV(e,t+14),_=r[0]+(8191&g),C=r[1]+((g>>>13|y<<3)&8191),A=r[2]+((y>>>10|m<<6)&8191),S=r[3]+((m>>>7|b<<9)&8191),N=r[4]+((b>>>4|w<<12)&8191),T=r[5]+(w>>>1&8191),x=r[6]+((w>>>14|v<<2)&8191),P=r[7]+((v>>>11|I<<5)&8191),O=r[8]+((I>>>8|E<<8)&8191),M=r[9]+(E>>>5|2048*!i),R=0,k=0+_*n+5*f*C+5*p*A+5*u*S+5*h*N;R=k>>>13,k&=8191,k+=5*d*T+5*l*x+5*c*P+5*o*O+5*a*M,R+=k>>>13,k&=8191;let D=R+_*a+C*n+5*f*A+5*p*S+5*u*N;R=D>>>13,D&=8191,D+=5*h*T+5*d*x+5*l*P+5*c*O+5*o*M,R+=D>>>13,D&=8191;let U=R+_*o+C*a+A*n+5*f*S+5*p*N;R=U>>>13,U&=8191,U+=5*u*T+5*h*x+5*d*P+5*l*O+5*c*M,R+=U>>>13,U&=8191;let L=R+_*c+C*o+A*a+S*n+5*f*N;R=L>>>13,L&=8191,L+=5*p*T+5*u*x+5*h*P+5*d*O+5*l*M,R+=L>>>13,L&=8191;let q=R+_*l+C*c+A*o+S*a+N*n;R=q>>>13,q&=8191,q+=5*f*T+5*p*x+5*u*P+5*h*O+5*d*M,R+=q>>>13,q&=8191;let j=R+_*d+C*l+A*c+S*o+N*a;R=j>>>13,j&=8191,j+=T*n+5*f*x+5*p*P+5*u*O+5*h*M,R+=j>>>13,j&=8191;let $=R+_*h+C*d+A*l+S*c+N*o;R=$>>>13,$&=8191,$+=T*a+x*n+5*f*P+5*p*O+5*u*M,R+=$>>>13,$&=8191;let z=R+_*u+C*h+A*d+S*l+N*c;R=z>>>13,z&=8191,z+=T*o+x*a+P*n+5*f*O+5*p*M,R+=z>>>13,z&=8191;let B=R+_*p+C*u+A*h+S*d+N*l;R=B>>>13,B&=8191,B+=T*c+x*o+P*a+O*n+5*f*M,R+=B>>>13,B&=8191;let H=R+_*f+C*p+A*u+S*h+N*d;R=H>>>13,H&=8191,H+=T*l+x*c+P*o+O*a+M*n,R+=H>>>13,H&=8191,k=8191&(R=(R=(R<<2)+R|0)+k|0),R>>>=13,D+=R,r[0]=k,r[1]=D,r[2]=U,r[3]=L,r[4]=q,r[5]=j,r[6]=$,r[7]=z,r[8]=B,r[9]=H}finalize(){let{h:e,pad:t}=this,i=new Uint16Array(10),r=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=r,r=e[t]>>>13,e[t]&=8191;e[0]+=5*r,r=e[0]>>>13,e[0]&=8191,e[1]+=r,r=e[1]>>>13,e[1]&=8191,e[2]+=r,i[0]=e[0]+5,r=i[0]>>>13,i[0]&=8191;for(let t=1;t<10;t++)i[t]=e[t]+r,r=i[t]>>>13,i[t]&=8191;i[9]-=8192;let s=(1^r)-1;for(let e=0;e<10;e++)i[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|i[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let i=1;i<8;i++)n=(e[i]+t[i]|0)+(n>>>16)|0,e[i]=65535&n;tU(i)}update(e){tT(this);let{buffer:t,blockLen:i}=this,r=(e=tM(e)).length;for(let s=0;s<r;){let n=Math.min(i-this.pos,r-s);if(n===i){for(;i<=r-s;s+=i)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===i&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){tU(this.h,this.r,this.buffer,this.pad)}digestInto(e){tT(this),function(e,t){tN(e);let i=t.outputLen;if(e.length<i)throw Error("digestInto() expects output buffer of length at least "+i)}(e,this),this.finished=!0;let{buffer:t,h:i}=this,{pos:r}=this;if(r){for(t[r++]=1;r<16;r++)t[r]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=i[t]>>>0,e[s++]=i[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}}let tG=function(e){let t=(t,i)=>e(i).update(tM(t)).digest(),i=e(new Uint8Array(32));return t.outputLen=i.outputLen,t.blockLen=i.blockLen,t.create=t=>e(t),t}(e=>new tK(e)),tJ=function(e,t){let{allowShortKeys:i,extendNonceFn:r,counterLength:s,counterRight:n,rounds:a}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return tA(s),tA(a),tx(n),tx(i),(t,o,c,l,d=0)=>{tN(t),tN(o),tN(c);let h=c.length;if(void 0===l&&(l=new Uint8Array(h)),tN(l),tA(d),d<0||d>=tW)throw Error("arx: counter overflow");if(l.length<h)throw Error(`arx: output (${l.length}) is shorter than data (${h})`);let u=[],p=t.length,f,g;if(32===p)u.push(f=tD(t)),g=tz;else if(16===p&&i)(f=new Uint8Array(32)).set(t),f.set(t,16),g=t$,u.push(f);else throw Error(`arx: invalid 32-byte key, got length=${p}`);tH(o)||u.push(o=tD(o));let y=tP(f);if(r){if(24!==o.length)throw Error("arx: extended nonce must be 24 bytes");r(g,y,tP(o.subarray(0,16)),y),o=o.subarray(16)}let m=16-s;if(m!==o.length)throw Error(`arx: nonce must be ${m} or 16 bytes`);if(12!==m){let e=new Uint8Array(12);e.set(o,n?0:12-o.length),o=e,u.push(o)}return function(e,t,i,r,s,n,a,o){let c=s.length,l=new Uint8Array(64),d=tP(l),h=tH(s)&&tH(n),u=h?tP(s):tF,p=h?tP(n):tF;for(let f=0;f<c;a++){if(e(t,i,r,d,a,o),a>=tW)throw Error("arx: counter overflow");let g=Math.min(64,c-f);if(h&&64===g){let e=f/4;if(f%4!=0)throw Error("arx: invalid block position");for(let t=0,i;t<16;t++)p[i=e+t]=u[i]^d[t];f+=64;continue}for(let e=0,t;e<g;e++)n[t=f+e]=s[t]^l[e];f+=g}}(e,g,y,tP(o),c,l,d,a),tU(...u),l}}(function(e,t,i,r,s,n=20){let a=e[0],o=e[1],c=e[2],l=e[3],d=t[0],h=t[1],u=t[2],p=t[3],f=t[4],g=t[5],y=t[6],m=t[7],b=i[0],w=i[1],v=i[2],I=a,E=o,_=c,C=l,A=d,S=h,N=u,T=p,x=f,P=g,O=y,M=m,R=s,k=b,D=w,U=v;for(let e=0;e<n;e+=2)x=x+(R=tB(R^(I=I+A|0),16))|0,I=I+(A=tB(A^x,12))|0,x=x+(R=tB(R^I,8))|0,A=tB(A^x,7),P=P+(k=tB(k^(E=E+S|0),16))|0,E=E+(S=tB(S^P,12))|0,P=P+(k=tB(k^E,8))|0,S=tB(S^P,7),O=O+(D=tB(D^(_=_+N|0),16))|0,_=_+(N=tB(N^O,12))|0,O=O+(D=tB(D^_,8))|0,N=tB(N^O,7),M=M+(U=tB(U^(C=C+T|0),16))|0,C=C+(T=tB(T^M,12))|0,M=M+(U=tB(U^C,8))|0,T=tB(T^M,7),O=O+(U=tB(U^(I=I+S|0),16))|0,I=I+(S=tB(S^O,12))|0,O=O+(U=tB(U^I,8))|0,S=tB(S^O,7),M=M+(R=tB(R^(E=E+N|0),16))|0,E=E+(N=tB(N^M,12))|0,M=M+(R=tB(R^E,8))|0,N=tB(N^M,7),x=x+(k=tB(k^(_=_+T|0),16))|0,_=_+(T=tB(T^x,12))|0,x=x+(k=tB(k^_,8))|0,T=tB(T^x,7),P=P+(D=tB(D^(C=C+A|0),16))|0,C=C+(A=tB(A^P,12))|0,P=P+(D=tB(D^C,8))|0,A=tB(A^P,7);let L=0;r[L++]=a+I|0,r[L++]=o+E|0,r[L++]=c+_|0,r[L++]=l+C|0,r[L++]=d+A|0,r[L++]=h+S|0,r[L++]=u+N|0,r[L++]=p+T|0,r[L++]=f+x|0,r[L++]=g+P|0,r[L++]=y+O|0,r[L++]=m+M|0,r[L++]=s+R|0,r[L++]=b+k|0,r[L++]=w+D|0,r[L++]=v+U|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),tY=new Uint8Array(16),tQ=(e,t)=>{e.update(t);let i=t.length%16;i&&e.update(tY.subarray(i))},tX=new Uint8Array(32);function tZ(e,t,i,r,s){let n=e(t,i,tX),a=tG.create(n);s&&tQ(a,s),tQ(a,r);let o=new Uint8Array(16),c=tO(o);tk(c,0,BigInt(s?s.length:0),!0),tk(c,8,BigInt(r.length),!0),a.update(o);let l=a.digest();return tU(n,o),l}let t0=((e,t)=>{function i(r,...s){if(tN(r),void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?tN(t):tN(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&tN(s[1]);let a=t(r,...s),o=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");tN(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,tN(e),o(a.encrypt.length,t),a.encrypt(e,t)},decrypt(e,t){if(tN(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return o(a.decrypt.length,t),a.decrypt(e,t)}}}return Object.assign(i,e),i})({blockSize:64,nonceLength:12,tagLength:16},(e=>(t,i,r)=>({encrypt(s,n){let a=s.length;(n=tR(a+16,n,!1)).set(s);let o=n.subarray(0,-16);e(t,i,o,o,1);let c=tZ(e,t,i,o,r);return n.set(c,a),tU(c),n},decrypt(s,n){n=tR(s.length-16,n,!1);let a=s.subarray(0,-16),o=s.subarray(-16),c=tZ(e,t,i,a,r);if(!function(e,t){if(e.length!==t.length)return!1;let i=0;for(let r=0;r<e.length;r++)i|=e[r]^t[r];return 0===i}(o,c))throw Error("invalid tag");return n.set(s.subarray(0,-16)),e(t,i,n,n,1),tU(c),n}}))(tJ));class t1 extends eV{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,eO(e);let i=eF(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let r=this.blockLen,s=new Uint8Array(r);s.set(i.length>r?e.create().update(i).digest():i);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return eM(this),this.iHash.update(e),this}digestInto(e){eM(this),eP(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:i,finished:r,destroyed:s,blockLen:n,outputLen:a}=this;return e.finished=r,e.destroyed=s,e.blockLen=n,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let t2=(e,t,i)=>new t1(e,t).update(i).digest();t2.create=(e,t)=>new t1(e,t);let t5=new Uint8Array([0]),t3=new Uint8Array,t6=(e,t,i,r,s)=>(function(e,t,i,r=32){if(eO(e),ex(r),r>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(r/e.outputLen);void 0===i&&(i=t3);let n=new Uint8Array(s*e.outputLen),a=t2.create(e,t),o=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let t=0;t<s;t++)t5[0]=t+1,o.update(0===t?t3:c).update(i).update(t5).digestInto(c),n.set(c,e.outputLen*t),a._cloneInto(o);return a.destroy(),o.destroy(),c.fill(0),t5.fill(0),n.slice(0,r)})(e,function(e,t,i){return eO(e),void 0===i&&(i=new Uint8Array(e.outputLen)),t2(e,eF(i),eF(t))}(e,t,i),r,s);class t4 extends eV{constructor(e,t,i,r){super(),this.blockLen=e,this.outputLen=t,this.padOffset=i,this.isLE=r,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ez(this.buffer)}update(e){eM(this);let{view:t,buffer:i,blockLen:r}=this,s=(e=eF(e)).length;for(let n=0;n<s;){let a=Math.min(r-this.pos,s-n);if(a===r){let t=ez(e);for(;r<=s-n;n+=r)this.process(t,n);continue}i.set(e.subarray(n,n+a),this.pos),this.pos+=a,n+=a,this.pos===r&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){eM(this),eR(e,this),this.finished=!0;let{buffer:t,view:i,blockLen:r,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>r-n&&(this.process(i,0),n=0);for(let e=n;e<r;e++)t[e]=0;(function(e,t,i,r){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,i,r);let s=BigInt(32),n=BigInt(0xffffffff),a=Number(i>>s&n),o=Number(i&n),c=4*!!r,l=4*!r;e.setUint32(t+c,a,r),e.setUint32(t+l,o,r)})(i,r-8,BigInt(8*this.length),s),this.process(i,0);let a=ez(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=o/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)a.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let i=e.slice(0,t);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:i,length:r,finished:s,destroyed:n,pos:a}=this;return e.length=r,e.pos=a,e.finished=s,e.destroyed=n,r%t&&e.buffer.set(i),e}}let t8=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),t9=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),t7=new Uint32Array(64);class ie extends t4{constructor(){super(64,32,8,!1),this.A=0|t9[0],this.B=0|t9[1],this.C=0|t9[2],this.D=0|t9[3],this.E=0|t9[4],this.F=0|t9[5],this.G=0|t9[6],this.H=0|t9[7]}get(){let{A:e,B:t,C:i,D:r,E:s,F:n,G:a,H:o}=this;return[e,t,i,r,s,n,a,o]}set(e,t,i,r,s,n,a,o){this.A=0|e,this.B=0|t,this.C=0|i,this.D=0|r,this.E=0|s,this.F=0|n,this.G=0|a,this.H=0|o}process(e,t){for(let i=0;i<16;i++,t+=4)t7[i]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=t7[e-15],i=t7[e-2],r=eB(t,7)^eB(t,18)^t>>>3,s=eB(i,17)^eB(i,19)^i>>>10;t7[e]=s+t7[e-7]+r+t7[e-16]|0}let{A:i,B:r,C:s,D:n,E:a,F:o,G:c,H:l}=this;for(let e=0;e<64;e++){var d,h,u,p;let t=l+(eB(a,6)^eB(a,11)^eB(a,25))+((d=a)&o^~d&c)+t8[e]+t7[e]|0,f=(eB(i,2)^eB(i,13)^eB(i,22))+((h=i)&(u=r)^h&(p=s)^u&p)|0;l=c,c=o,o=a,a=n+t|0,n=s,s=r,r=i,i=t+f|0}i=i+this.A|0,r=r+this.B|0,s=s+this.C|0,n=n+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(i,r,s,n,a,o,c,l)}roundClean(){t7.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let it=eK(()=>new ie),ii=BigInt(0);function ir(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function is(e){if(!ir(e))throw Error("Uint8Array expected")}let ia=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),io={_0:48,_9:57,A:65,F:70,a:97,f:102};function ic(e){return e>=io._0&&e<=io._9?e-io._0:e>=io.A&&e<=io.F?e-(io.A-10):e>=io.a&&e<=io.f?e-(io.a-10):void 0}function il(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,i=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(i);for(let t=0,s=0;t<i;t++,s+=2){let i=ic(e.charCodeAt(s)),n=ic(e.charCodeAt(s+1));if(void 0===i||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);r[t]=16*i+n}return r}function id(e){return is(e),function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?ii:BigInt("0x"+e)}(function(e){is(e);let t="";for(let i=0;i<e.length;i++)t+=ia[e[i]];return t}(Uint8Array.from(e).reverse()))}function ih(e,t,i){let r;if("string"==typeof t)try{r=il(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(ir(t))r=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=r.length;if("number"==typeof i&&s!==i)throw Error(e+" of length "+i+" expected, got "+s);return r}let iu=e=>"bigint"==typeof e&&ii<=e;function ip(e,t,i,r){if(!(iu(t)&&iu(i)&&iu(r))||!(i<=t)||!(t<r))throw Error("expected valid "+e+": "+i+" <= n < "+r+", got "+t)}let ig={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||ir(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)},iy=BigInt(0),im=BigInt(1);function ib(e,t){let i=e%t;return i>=iy?i:t+i}function iw(e,t,i){let r=e;for(;t-- >iy;)r*=r,r%=i;return r}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);let iv=BigInt(0),iI=BigInt(1),iE=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let i_=BigInt(1),iC=BigInt(2),iA=BigInt(3),iS=BigInt(5);BigInt(8);let iN=function(e){let t=(function(e,t,i={}){let r=(t,i,r)=>{let s=ig[i];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(r&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+i+", got "+n)};for(let[e,i]of Object.entries(t))r(e,i,!1);for(let[e,t]of Object.entries(i))r(e,t,!0)}(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:i}=t,r=e=>ib(e,i),s=t.montgomeryBits,n=Math.ceil(s/8),a=t.nByteLength,o=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>(function(e,t,i){if(t<iy)throw Error("invalid exponent, negatives unsupported");if(i<=iy)throw Error("invalid modulus");if(i===im)return iy;let r=im;for(;t>iy;)t&im&&(r=r*e%i),e=e*e%i,t>>=im;return r})(e,i-BigInt(2),i));function l(e,t,i){let s=r(e*(t-i));return[t=r(t-s),i=r(i+s)]}let d=(t.a-BigInt(2))/BigInt(4);function h(e){var t;return t=r(e),il(t.toString(16).padStart(2*n,"0")).reverse()}function u(e,t){let u=function(e,t){ip("u",e,iv,i),ip("scalar",t,iv,i);let n=iI,a=iv,o=e,h=iI,u=iv,p;for(let i=BigInt(s-1);i>=iv;i--){let s=t>>i&iI;u^=s,n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,h))[0],h=p[1],u=s;let c=n+a,f=r(c*c),g=n-a,y=r(g*g),m=f-y,b=o+h,w=r((o-h)*c),v=r(b*g),I=w+v,E=w-v;o=r(I*I),h=r(e*r(E*E)),n=r(f*y),a=r(m*(f+r(d*m)))}return n=(p=l(u,n,o))[0],o=p[1],a=(p=l(u,a,h))[0],h=p[1],r(n*c(a))}(function(e){let t=ih("u coordinate",e,n);return 32===a&&(t[31]&=127),id(t)}(t),function(e){let t=ih("scalar",e),i=t.length;if(i!==n&&i!==a)throw Error("invalid scalar, expected "+(""+n+" or ")+a+" bytes, got "+i);return id(o(t))}(e));if(u===iv)throw Error("invalid private or public key received");return h(u)}let p=h(t.Gu);function f(e){return u(e,p)}return{scalarMult:u,scalarMultBase:f,getSharedSecret:(e,t)=>u(e,t),getPublicKey:e=>f(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:p}}({P:iE,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:i}=function(e){let t=BigInt(10),i=BigInt(20),r=BigInt(40),s=BigInt(80),n=e*e%iE*e%iE,a=iw(n,iC,iE)*n%iE,o=iw(a,i_,iE)*e%iE,c=iw(o,iS,iE)*o%iE,l=iw(c,t,iE)*c%iE,d=iw(l,i,iE)*l%iE,h=iw(d,r,iE)*d%iE,u=iw(h,s,iE)*h%iE,p=iw(u,s,iE)*h%iE,f=iw(p,t,iE)*c%iE;return{pow_p_5_8:iw(f,iC,iE)*e%iE,b2:n}}(e);return ib(iw(t,iA,iE)*i,iE)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:eG}),iT="base10",ix="base16",iP="base64pad",iO="base64url",iM="utf8";function iR(){let e=eG(32);return(0,Y.dI)(e,ix)}function ik(e){let t=it((0,Y.sH)(e,ix));return(0,Y.dI)(t,ix)}function iD(e){let t=it((0,Y.sH)(e,iM));return(0,Y.dI)(t,ix)}function iU(e){return(0,Y.sH)(`${e}`,iT)}function iL(e){return Number((0,Y.dI)(e,iT))}function iq(e){let{encoding:t=iP}=e;if(2===iL(e.type))return(0,Y.dI)((0,Y.xW)([e.type,e.sealed]),t);if(1===iL(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,Y.dI)((0,Y.xW)([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return(0,Y.dI)((0,Y.xW)([e.type,e.iv,e.sealed]),t)}function ij(e){let{encoded:t,encoding:i=iP}=e,r=(0,Y.sH)(t,i),s=r.slice(0,1);if(1===iL(s)){let e=r.slice(1,33),t=r.slice(33,45);return{type:s,sealed:r.slice(45),iv:t,senderPublicKey:e}}if(2===iL(s))return{type:s,sealed:r.slice(1),iv:eG(12)};let n=r.slice(1,13);return{type:s,sealed:r.slice(13),iv:n}}function i$(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function iz(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function iB(e){return e?.relay||{protocol:"irn"}}function iH(e){let t=X.CG[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}function iW(e){var t;if(!e.includes("wc:")){let t=eT(e);null!=t&&t.includes("wc:")&&(e=t)}let i=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),r=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,i),n=e.substring(i+1,r).split("@"),a=new URLSearchParams("u">typeof r?e.substring(r):""),o={};a.forEach((e,t)=>{o[t]=e});let c="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:o.symKey,relay:function(e,t="-"){let i={},r="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(r)){let s=t.replace(r,""),n=e[t];i[s]=n}}),i}(o),methods:c,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function iF(e){let t=new URLSearchParams,i=function(e,t="-"){let i={};return Object.keys(e).forEach(r=>{e[r]&&(i["relay"+t+r]=e[r])}),i}(e.relay);Object.keys(i).sort().forEach(e=>{t.set(e,i[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));let r=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${r}`}function iV(e,t,i){return`${e}?wc_ev=${i}&topic=${t}`}var iK=Object.defineProperty,iG=Object.defineProperties,iJ=Object.getOwnPropertyDescriptors,iY=Object.getOwnPropertySymbols,iQ=Object.prototype.hasOwnProperty,iX=Object.prototype.propertyIsEnumerable,iZ=(e,t,i)=>t in e?iK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,i0=(e,t)=>{for(var i in t||(t={}))iQ.call(t,i)&&iZ(e,i,t[i]);if(iY)for(var i of iY(t))iX.call(t,i)&&iZ(e,i,t[i]);return e},i1=(e,t)=>iG(e,iJ(t));function i2(e){let t=[];return e.forEach(e=>{let[i,r]=e.split(":");t.push(`${i}:${r}`)}),t}function i5(e){return e.includes(":")}function i3(e){return i5(e)?e.split(":")[0]:e}function i6(e,t){let i=function(e){let t={};return e?.forEach(e=>{var i;let[r,s]=e.split(":");t[r]||(t[r]={accounts:[],chains:[],events:[],methods:[]}),t[r].accounts.push(e),null==(i=t[r].chains)||i.push(`${r}:${s}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,r]of Object.entries(i))r.methods?r.methods=eE(r.methods,e):r.methods=e,r.events=["chainChanged","accountsChanged"];return i}let i4={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},i8={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function i9(e,t){let{message:i,code:r}=i8[e];return{message:t?`${i} ${t}`:i,code:r}}function i7(e,t){let{message:i,code:r}=i4[e];return{message:t?`${i} ${t}`:i,code:r}}function re(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function rt(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function ri(e){return typeof e>"u"}function rr(e,t){return!!(t&&ri(e))||"string"==typeof e&&!!e.trim().length}function rs(e,t){return!!(t&&ri(e))||"number"==typeof e&&!isNaN(e)}function rn(e){return!!(rr(e,!1)&&e.includes(":"))&&2===e.split(":").length}function ra(e){let t=!0;return re(e)?e.length&&(t=e.every(e=>rr(e,!1))):t=!1,t}function ro(e,t){let i=null;return Object.values(e).forEach(e=>{var r;let s;if(i)return;let n=(r=`${t}, namespace`,s=null,ra(e?.methods)?ra(e?.events)||(s=i7("UNSUPPORTED_EVENTS",`${r}, events should be an array of strings or empty array for no events`)):s=i7("UNSUPPORTED_METHODS",`${r}, methods should be an array of strings or empty array for no methods`),s);n&&(i=n)}),i}function rc(e,t){let i=null;if(e&&rt(e)){let r,s=ro(e,t);s&&(i=s);let n=(r=null,Object.values(e).forEach(e=>{var i,s;let n;if(r)return;let a=(i=e?.accounts,s=`${t} namespace`,n=null,re(i)?i.forEach(e=>{n||function(e){if(rr(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&rn(e)}}return!1}(e)||(n=i7("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=i7("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);a&&(r=a)}),r);n&&(i=n)}else i=i9("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return i}function rl(e){return rr(e.protocol,!0)}function rd(e){return"u">typeof e}function rh(e,t){return!(!rn(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...i2(e.accounts))}),t})(e).includes(t))}function ru(e,t,i){let r=null,s=function(e){let t={};return Object.keys(e).forEach(i=>{var r;i.includes(":")?t[i]=e[i]:null==(r=e[i].chains)||r.forEach(r=>{t[r]={methods:e[i].methods,events:e[i].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(i=>{if(i.includes(":"))t[i]=e[i];else{let r=i2(e[i].accounts);r?.forEach(r=>{t[r]={accounts:e[i].accounts.filter(e=>e.includes(`${r}:`)),methods:e[i].methods,events:e[i].events}})}}),t}(t),a=Object.keys(s),o=Object.keys(n),c=rp(Object.keys(e)),l=rp(Object.keys(t)),d=c.filter(e=>!l.includes(e));return d.length&&(r=i9("NON_CONFORMING_NAMESPACES",`${i} namespaces keys don't satisfy requiredNamespaces.
      Required: ${d.toString()}
      Received: ${Object.keys(t).toString()}`)),eu(a,o)||(r=i9("NON_CONFORMING_NAMESPACES",`${i} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${o.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||r)return;let s=i2(t[e].accounts);s.includes(e)||(r=i9("NON_CONFORMING_NAMESPACES",`${i} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),a.forEach(e=>{r||(eu(s[e].methods,n[e].methods)?eu(s[e].events,n[e].events)||(r=i9("NON_CONFORMING_NAMESPACES",`${i} namespaces events don't satisfy namespace events for ${e}`)):r=i9("NON_CONFORMING_NAMESPACES",`${i} namespaces methods don't satisfy namespace methods for ${e}`))}),r}function rp(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function rf(){let e=ec();return new Promise(t=>{switch(e){case es.browser:t(eo()&&navigator?.onLine);break;case es.reactNative:t(rg());break;case es.node:default:t(!0)}})}async function rg(){if(ea()&&"u">typeof i.g&&null!=i.g&&i.g.NetInfo){let e=await (null==i.g?void 0:i.g.NetInfo.fetch());return e?.isConnected}return!0}let ry={};class rm{static get(e){return ry[e]}static set(e,t){ry[e]=t}static delete(e){delete ry[e]}}var rb=i(41737),rw=i(13990),rv=i(77185),rI=i(77367),rE=i.n(rI);let r_="core",rC=`wc@2:${r_}:`,rA={logger:"error"},rS={database:":memory:"},rN="client_ed25519_seed",rT=H.ONE_DAY,rx=H.SIX_HOURS,rP="wss://relay.walletconnect.org",rO={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},rM={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},rR="2.19.0",rk={link_mode:"link_mode",relay:"relay"},rD="WALLETCONNECT_LINK_MODE_APPS",rU={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},rL=1e3*H.FIVE_SECONDS,rq={wc_pairingDelete:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:H.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:H.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:H.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:H.ONE_DAY,prompt:!1,tag:0},res:{ttl:H.ONE_DAY,prompt:!1,tag:0}}},rj={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},r$={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},rz={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},rB="https://verify.walletconnect.org",rH=`${rB}/v3`,rW=["https://verify.walletconnect.com",rB],rF={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},rV={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},rK={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},rG={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},rJ={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},rY={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var rQ=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var i=new Uint8Array(256),r=0;r<i.length;r++)i[r]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),a=n.charCodeAt(0);if(255!==i[a])throw TypeError(n+" is ambiguous");i[a]=s}var o=e.length,c=e.charAt(0),l=Math.log(o)/Math.log(256),d=Math.log(256)/Math.log(o);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var r=0,s=0;e[t]===c;)r++,t++;for(var n=(e.length-t)*l+1>>>0,a=new Uint8Array(n);e[t];){var d=i[e.charCodeAt(t)];if(255===d)return;for(var h=0,u=n-1;(0!==d||h<s)&&-1!==u;u--,h++)d+=o*a[u]>>>0,a[u]=d%256>>>0,d=d/256>>>0;if(0!==d)throw Error("Non-zero carry");s=h,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===a[p];)p++;for(var f=new Uint8Array(r+(n-p)),g=r;p!==n;)f[g++]=a[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var i=0,r=0,s=0,n=t.length;s!==n&&0===t[s];)s++,i++;for(var a=(n-s)*d+1>>>0,l=new Uint8Array(a);s!==n;){for(var h=t[s],u=0,p=a-1;(0!==h||u<r)&&-1!==p;p--,u++)h+=256*l[p]>>>0,l[p]=h%o>>>0,h=h/o>>>0;if(0!==h)throw Error("Non-zero carry");r=u,s++}for(var f=a-r;f!==a&&0===l[f];)f++;for(var g=c.repeat(i);f<a;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:h,decode:function(e){var i=h(e);if(i)return i;throw Error(`Non-${t} character`)}}};let rX=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},rZ=e=>new TextEncoder().encode(e),r0=e=>new TextDecoder().decode(e);class r1{constructor(e,t,i){this.name=e,this.prefix=t,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class r2{constructor(e,t,i){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=i}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return r3(this,e)}}class r5{constructor(e){this.decoders=e}or(e){return r3(this,e)}decode(e){let t=e[0],i=this.decoders[t];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let r3=(e,t)=>new r5({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class r6{constructor(e,t,i,r){this.name=e,this.prefix=t,this.baseEncode=i,this.baseDecode=r,this.encoder=new r1(e,t,i),this.decoder=new r2(e,t,r)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let r4=({name:e,prefix:t,encode:i,decode:r})=>new r6(e,t,i,r),r8=({prefix:e,name:t,alphabet:i})=>{let{encode:r,decode:s}=rQ(i,t);return r4({prefix:e,name:t,encode:r,decode:e=>rX(s(e))})},r9=(e,t,i,r)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let a=new Uint8Array(n*i/8|0),o=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${r} character`);c=c<<i|n,(o+=i)>=8&&(o-=8,a[l++]=255&c>>o)}if(o>=i||255&c<<8-o)throw SyntaxError("Unexpected end of data");return a},r7=(e,t,i)=>{let r="="===t[t.length-1],s=(1<<i)-1,n="",a=0,o=0;for(let r=0;r<e.length;++r)for(o=o<<8|e[r],a+=8;a>i;)a-=i,n+=t[s&o>>a];if(a&&(n+=t[s&o<<i-a]),r)for(;n.length*i&7;)n+="=";return n},se=({name:e,prefix:t,bitsPerChar:i,alphabet:r})=>r4({prefix:t,name:e,encode:e=>r7(e,r,i),decode:t=>r9(t,r,i,e)});var st=Object.freeze({__proto__:null,identity:r4({prefix:"\0",name:"identity",encode:e=>r0(e),decode:e=>rZ(e)})}),si=Object.freeze({__proto__:null,base2:se({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),sr=Object.freeze({__proto__:null,base8:se({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),ss=Object.freeze({__proto__:null,base10:r8({prefix:"9",name:"base10",alphabet:"0123456789"})}),sn=Object.freeze({__proto__:null,base16:se({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:se({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let sa=se({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),so=se({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sc=se({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sl=se({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),sd=se({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sh=se({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),su=se({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var sp=Object.freeze({__proto__:null,base32:sa,base32upper:so,base32pad:sc,base32padupper:sl,base32hex:sd,base32hexupper:sh,base32hexpad:su,base32hexpadupper:se({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:se({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),sf=Object.freeze({__proto__:null,base36:r8({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:r8({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),sg=Object.freeze({__proto__:null,base58btc:r8({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:r8({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let sy=se({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sm=se({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var sb=Object.freeze({__proto__:null,base64:sy,base64pad:sm,base64url:se({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:se({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let sw=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),sv=sw.reduce((e,t,i)=>(e[i]=t,e),[]),sI=sw.reduce((e,t,i)=>(e[t.codePointAt(0)]=i,e),[]);var sE=Object.freeze({__proto__:null,base256emoji:r4({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=sv[t],"")},decode:function(e){let t=[];for(let i of e){let e=sI[i.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${i}`);t.push(e)}return new Uint8Array(t)}})});function s_(e,t,i){t=t||[],i=i||0;for(var r=i;e>=0x80000000;)t[i++]=255&e|128,e/=128;for(;-128&e;)t[i++]=255&e|128,e>>>=7;return t[i]=0|e,s_.bytes=i-r+1,t}function sC(e,t){var i,r=0,t=t||0,s=0,n=t,a=e.length;do{if(n>=a)throw sC.bytes=0,RangeError("Could not decode varint");i=e[n++],r+=s<28?(127&i)<<s:(127&i)*Math.pow(2,s),s+=7}while(i>=128);return sC.bytes=n-t,r}var sA={encode:s_,encodingLength:function(e){return e<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:e<0x800000000?5:e<0x40000000000?6:e<0x2000000000000?7:e<0x100000000000000?8:e<0x8000000000000000?9:10}};let sS=(e,t,i=0)=>(sA.encode(e,t,i),t),sN=e=>sA.encodingLength(e),sT=(e,t)=>{let i=t.byteLength,r=sN(e),s=r+sN(i),n=new Uint8Array(s+i);return sS(e,n,0),sS(i,n,r),n.set(t,s),new sx(e,i,t,n)};class sx{constructor(e,t,i,r){this.code=e,this.size=t,this.digest=i,this.bytes=r}}let sP=({name:e,code:t,encode:i})=>new sO(e,t,i);class sO{constructor(e,t,i){this.name=e,this.code=t,this.encode=i}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?sT(this.code,t):t.then(e=>sT(this.code,e))}throw Error("Unknown type, must be binary type")}}let sM=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var sR=Object.freeze({__proto__:null,sha256:sP({name:"sha2-256",code:18,encode:sM("SHA-256")}),sha512:sP({name:"sha2-512",code:19,encode:sM("SHA-512")})}),sk=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:rX,digest:e=>sT(0,rX(e))}});new TextEncoder,new TextDecoder;let sD={...st,...si,...sr,...ss,...sn,...sp,...sf,...sg,...sb,...sE};function sU(e,t,i,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:i},decoder:{decode:r}}}({...sR,...sk});let sL=sU("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),sq=sU("ascii","a",e=>{let t="a";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}),sj={utf8:sL,"utf-8":sL,hex:sD.base16,latin1:sq,ascii:sq,binary:sq,...sD};var s$=Object.defineProperty,sz=(e,t,i)=>t in e?s$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sB=(e,t,i)=>sz(e,"symbol"!=typeof t?t+"":t,i);class sH{constructor(e,t){this.core=e,this.logger=t,sB(this,"keychain",new Map),sB(this,"name","keychain"),sB(this,"version","0.3"),sB(this,"initialized",!1),sB(this,"storagePrefix",rC),sB(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),sB(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),sB(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),sB(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=i9("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),sB(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,b.U5)(t,this.name)}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,ep(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ef(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var sW=Object.defineProperty,sF=(e,t,i)=>t in e?sW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sV=(e,t,i)=>sF(e,"symbol"!=typeof t?t+"":t,i);class sK{constructor(e,t,i){this.core=e,this.logger=t,sV(this,"name","crypto"),sV(this,"keychain"),sV(this,"randomSessionIdentifier",iR()),sV(this,"initialized",!1),sV(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),sV(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),sV(this,"getClientId",async()=>{this.isInitialized();let e=await this.getClientSeed(),t=F.TZ(e);return F.UF(t.publicKey)}),sV(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=iN.utils.randomPrivateKey(),t=iN.getPublicKey(e);return{privateKey:(0,Y.dI)(e,ix),publicKey:(0,Y.dI)(t,ix)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),sV(this,"signJWT",async e=>{this.isInitialized();let t=await this.getClientSeed(),i=F.TZ(t),r=this.randomSessionIdentifier;return await F.FA(r,e,rT,i)}),sV(this,"generateSharedKey",(e,t,i)=>{this.isInitialized();let r=function(e,t){let i=t6(it,iN.getSharedSecret((0,Y.sH)(e,ix),(0,Y.sH)(t,ix)),void 0,void 0,32);return(0,Y.dI)(i,ix)}(this.getPrivateKey(e),t);return this.setSymKey(r,i)}),sV(this,"setSymKey",async(e,t)=>{this.isInitialized();let i=t||ik(e);return await this.keychain.set(i,e),i}),sV(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),sV(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),sV(this,"encode",async(e,t,i)=>{this.isInitialized();let r=i$(i),s=(0,W.h)(t);if(2===r.type)return function(e,t){let i=iU(2),r=eG(12);return iq({type:i,sealed:(0,Y.sH)(e,iM),iv:r,encoding:t})}(s,i?.encoding);if(iz(r)){let t=r.senderPublicKey,i=r.receiverPublicKey;e=await this.generateSharedKey(t,i)}let n=this.getSymKey(e),{type:a,senderPublicKey:o}=r;return function(e){let t=iU("u">typeof e.type?e.type:0);if(1===iL(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let i="u">typeof e.senderPublicKey?(0,Y.sH)(e.senderPublicKey,ix):void 0,r="u">typeof e.iv?(0,Y.sH)(e.iv,ix):eG(12);return iq({type:t,sealed:t0((0,Y.sH)(e.symKey,ix),r).encrypt((0,Y.sH)(e.message,iM)),iv:r,senderPublicKey:i,encoding:e.encoding})}({type:a,symKey:n,message:s,senderPublicKey:o,encoding:i?.encoding})}),sV(this,"decode",async(e,t,i)=>{this.isInitialized();let r=function(e,t){let i=ij({encoded:e,encoding:t?.encoding});return i$({type:iL(i.type),senderPublicKey:"u">typeof i.senderPublicKey?(0,Y.dI)(i.senderPublicKey,ix):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,i);if(2===r.type){let e=function(e,t){let{sealed:i}=ij({encoded:e,encoding:t});return(0,Y.dI)(i,iM)}(t,i?.encoding);return(0,W.j)(e)}if(iz(r)){let t=r.receiverPublicKey,i=r.senderPublicKey;e=await this.generateSharedKey(t,i)}try{let r=this.getSymKey(e),s=function(e){let t=(0,Y.sH)(e.symKey,ix),{sealed:i,iv:r}=ij(e),s=t0(t,r).decrypt(i);if(null===s)throw Error("Failed to decrypt");return(0,Y.dI)(s,iM)}({symKey:r,encoded:t,encoding:i?.encoding});return(0,W.j)(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),sV(this,"getPayloadType",(e,t=iP)=>iL(ij({encoded:e,encoding:t}).type)),sV(this,"getPayloadSenderPublicKey",(e,t=iP)=>{let i=ij({encoded:e,encoding:t});return i.senderPublicKey?(0,Y.dI)(i.senderPublicKey,ix):void 0}),this.core=e,this.logger=(0,b.U5)(t,this.name),this.keychain=i||new sH(this.core,this.logger)}get context(){return(0,b.oI)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(rN)}catch{e=iR(),await this.keychain.set(rN,e)}return function(e,t="utf8"){let i=sj[t];if(!i)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):i.decoder.decode(`${i.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var sG=Object.defineProperty,sJ=(e,t,i)=>t in e?sG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,sY=(e,t,i)=>sJ(e,"symbol"!=typeof t?t+"":t,i);class sQ extends T{constructor(e,t){super(e,t),this.logger=e,this.core=t,sY(this,"messages",new Map),sY(this,"name","messages"),sY(this,"version","0.3"),sY(this,"initialized",!1),sY(this,"storagePrefix",rC),sY(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),sY(this,"set",async(e,t)=>{this.isInitialized();let i=iD(t),r=this.messages.get(e);return typeof r>"u"&&(r={}),"u">typeof r[i]||(r[i]=t,this.messages.set(e,r),await this.persist()),i}),sY(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),sY(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[iD(t)])),sY(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()}),this.logger=(0,b.U5)(e,this.name),this.core=t}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,ep(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?ef(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var sX=Object.defineProperty,sZ=Object.defineProperties,s0=Object.getOwnPropertyDescriptors,s1=Object.getOwnPropertySymbols,s2=Object.prototype.hasOwnProperty,s5=Object.prototype.propertyIsEnumerable,s3=(e,t,i)=>t in e?sX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,s6=(e,t)=>{for(var i in t||(t={}))s2.call(t,i)&&s3(e,i,t[i]);if(s1)for(var i of s1(t))s5.call(t,i)&&s3(e,i,t[i]);return e},s4=(e,t)=>sZ(e,s0(t)),s8=(e,t,i)=>s3(e,"symbol"!=typeof t?t+"":t,i);class s9 extends x{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,s8(this,"events",new f.EventEmitter),s8(this,"name","publisher"),s8(this,"queue",new Map),s8(this,"publishTimeout",(0,H.toMiliseconds)(H.ONE_MINUTE)),s8(this,"initialPublishTimeout",(0,H.toMiliseconds)(15*H.ONE_SECOND)),s8(this,"needsTransportRestart",!1),s8(this,"publish",async(e,t,i)=>{var r;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:i}});let s=i?.ttl||rx,n=iB(i),a=i?.prompt||!1,o=i?.tag||0,c=i?.id||(0,rw.getBigIntRpcId)().toString(),l={topic:e,message:t,opts:{ttl:s,relay:n,prompt:a,tag:o,id:c,attestation:i?.attestation,tvf:i?.tvf}},d=`Failed to publish payload, please try again. id:${c} tag:${o}`;try{let r=new Promise(async r=>{let n=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(rO.publish,n),r(l))};this.relayer.events.on(rO.publish,n);let d=ey(new Promise((r,n)=>{this.rpcPublish({topic:e,message:t,ttl:s,prompt:a,tag:o,id:c,attestation:i?.attestation,tvf:i?.tvf}).then(r).catch(e=>{this.logger.warn(e,e?.message),n(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${o}`);try{await d,this.events.removeListener(rO.publish,n)}catch(e){this.queue.set(c,s4(s6({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:i}}),await ey(r,this.publishTimeout,d)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(r=i?.internal)&&r.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),s8(this,"on",(e,t)=>{this.events.on(e,t)}),s8(this,"once",(e,t)=>{this.events.once(e,t)}),s8(this,"off",(e,t)=>{this.events.off(e,t)}),s8(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,b.U5)(t,this.name),this.registerEventListeners()}get context(){return(0,b.oI)(this.logger)}async rpcPublish(e){var t,i,r,s;let{topic:n,message:a,ttl:o=rx,prompt:c,tag:l,id:d,attestation:h,tvf:u}=e,p={method:iH(iB().protocol).publish,params:s6({topic:n,message:a,ttl:o,prompt:c,tag:l,attestation:h},u),id:d};ri(null==(t=p.params)?void 0:t.prompt)&&(null==(i=p.params)||delete i.prompt),ri(null==(r=p.params)?void 0:r.tag)&&(null==(s=p.params)||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});let f=await this.relayer.request(p);return this.relayer.events.emit(rO.publish,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{let i=e.attempt+1;this.queue.set(t,s4(s6({},e),{attempt:i}));let{topic:r,message:s,opts:n,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish(s4(s6({},e),{topic:r,message:s,ttl:n.ttl,prompt:n.prompt,tag:n.tag,id:n.id,attestation:a,tvf:n.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(y.li.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(rO.connection_stalled);return}this.checkQueue()}),this.relayer.on(rO.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var s7=Object.defineProperty,ne=(e,t,i)=>t in e?s7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nt=(e,t,i)=>ne(e,"symbol"!=typeof t?t+"":t,i);class ni{constructor(){nt(this,"map",new Map),nt(this,"set",(e,t)=>{let i=this.get(e);this.exists(e,t)||this.map.set(e,[...i,t])}),nt(this,"get",e=>this.map.get(e)||[]),nt(this,"exists",(e,t)=>this.get(e).includes(t)),nt(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;let i=this.get(e);if(!this.exists(e,t))return;let r=i.filter(e=>e!==t);if(!r.length)return void this.map.delete(e);this.map.set(e,r)}),nt(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var nr=Object.defineProperty,ns=Object.defineProperties,nn=Object.getOwnPropertyDescriptors,na=Object.getOwnPropertySymbols,no=Object.prototype.hasOwnProperty,nc=Object.prototype.propertyIsEnumerable,nl=(e,t,i)=>t in e?nr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nd=(e,t)=>{for(var i in t||(t={}))no.call(t,i)&&nl(e,i,t[i]);if(na)for(var i of na(t))nc.call(t,i)&&nl(e,i,t[i]);return e},nh=(e,t)=>ns(e,nn(t)),nu=(e,t,i)=>nl(e,"symbol"!=typeof t?t+"":t,i);class np extends R{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,nu(this,"subscriptions",new Map),nu(this,"topicMap",new ni),nu(this,"events",new f.EventEmitter),nu(this,"name","subscription"),nu(this,"version","0.3"),nu(this,"pending",new Map),nu(this,"cached",[]),nu(this,"initialized",!1),nu(this,"pendingSubscriptionWatchLabel","pending_sub_watch_label"),nu(this,"pollingInterval",20),nu(this,"storagePrefix",rC),nu(this,"subscribeTimeout",(0,H.toMiliseconds)(H.ONE_MINUTE)),nu(this,"initialSubscribeTimeout",(0,H.toMiliseconds)(15*H.ONE_SECOND)),nu(this,"clientId"),nu(this,"batchSubscribeTopicsLimit",500),nu(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),nu(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let i=iB(t),r={topic:e,relay:i,transportType:t?.transportType};this.pending.set(e,r);let s=await this.rpcSubscribe(e,i,t);return"string"==typeof s&&(this.onSubscribe(s,r),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),nu(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),nu(this,"isSubscribed",async e=>{if(this.topics.includes(e))return!0;let t=`${this.pendingSubscriptionWatchLabel}_${e}`;return await new Promise((i,r)=>{let s=new H.Watch;s.start(t);let n=setInterval(()=>{(!this.pending.has(e)&&this.topics.includes(e)||this.cached.some(t=>t.topic===e))&&(clearInterval(n),s.stop(t),i(!0)),s.elapsed(t)>=rL&&(clearInterval(n),s.stop(t),r(Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),nu(this,"on",(e,t)=>{this.events.on(e,t)}),nu(this,"once",(e,t)=>{this.events.once(e,t)}),nu(this,"off",(e,t)=>{this.events.off(e,t)}),nu(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),nu(this,"start",async()=>{await this.onConnect()}),nu(this,"stop",async()=>{await this.onDisconnect()}),nu(this,"restart",async()=>{await this.restore(),await this.onRestart()}),nu(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),nu(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(y.li.pulse,async()=>{await this.checkPending()}),this.events.on(rU.created,async e=>{let t=rU.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(rU.deleted,async e=>{let t=rU.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,b.U5)(t,this.name),this.clientId=""}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let i=!1;try{i=this.getSubscription(e).topic===t}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let i=this.topicMap.get(e);await Promise.all(i.map(async i=>await this.unsubscribeById(e,i,t)))}async unsubscribeById(e,t,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}});try{let r=iB(i);await this.restartToComplete({topic:e,id:t,relay:r}),await this.rpcUnsubscribe(e,t,r);let s=i7("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:i}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,i){var r;i&&i?.transportType!==rk.relay||await this.restartToComplete({topic:e,id:e,relay:t});let s={method:iH(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(r=i?.internal)?void 0:r.throwOnFailedPublish;try{let t=await this.getSubscriptionId(e);if(i?.transportType===rk.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,H.toMiliseconds)(H.ONE_SECOND)),t;let r=new Promise(async t=>{let i=r=>{r.topic===e&&(this.events.removeListener(rU.created,i),t(r.id))};this.events.on(rU.created,i);try{let r=await ey(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(rU.created,i),t(r)}catch{}}),a=await ey(r,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!a&&n)throw Error(`Subscribing to ${e} failed, please try again`);return a?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(rO.connection_stalled),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:iH(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await ey(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(rO.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let i={method:iH(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{t=await await ey(new Promise((e,t)=>{this.relayer.request(i).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(rO.connection_stalled)}return t}rpcUnsubscribe(e,t,i){let r={method:iH(i.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r}),this.relayer.request(r)}onSubscribe(e,t){this.setSubscription(e,nh(nd({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,nd({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,i){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,nd({},t)),this.topicMap.set(t.topic,e),this.events.emit(rU.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=i9("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(rU.deleted,nh(nd({},i),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(rU.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<t;i++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(rU.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=i9("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>nh(nd({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let i=await this.rpcBatchFetchMessages(e);i&&i.messages&&(await (t=(0,H.toMiliseconds)(H.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(i.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return iD(e+await this.getClientId())}}var nf=Object.defineProperty,ng=Object.getOwnPropertySymbols,ny=Object.prototype.hasOwnProperty,nm=Object.prototype.propertyIsEnumerable,nb=(e,t,i)=>t in e?nf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nw=(e,t)=>{for(var i in t||(t={}))ny.call(t,i)&&nb(e,i,t[i]);if(ng)for(var i of ng(t))nm.call(t,i)&&nb(e,i,t[i]);return e},nv=(e,t,i)=>nb(e,"symbol"!=typeof t?t+"":t,i);class nI extends P{constructor(e){super(e),nv(this,"protocol","wc"),nv(this,"version",2),nv(this,"core"),nv(this,"logger"),nv(this,"events",new f.EventEmitter),nv(this,"provider"),nv(this,"messages"),nv(this,"subscriber"),nv(this,"publisher"),nv(this,"name","relayer"),nv(this,"transportExplicitlyClosed",!1),nv(this,"initialized",!1),nv(this,"connectionAttemptInProgress",!1),nv(this,"relayUrl"),nv(this,"projectId"),nv(this,"packageName"),nv(this,"bundleId"),nv(this,"hasExperiencedNetworkDisruption",!1),nv(this,"pingTimeout"),nv(this,"heartBeatTimeout",(0,H.toMiliseconds)(H.THIRTY_SECONDS+H.FIVE_SECONDS)),nv(this,"reconnectTimeout"),nv(this,"connectPromise"),nv(this,"reconnectInProgress",!1),nv(this,"requestsInFlight",[]),nv(this,"connectTimeout",(0,H.toMiliseconds)(15*H.ONE_SECOND)),nv(this,"request",async e=>{var t,i;this.logger.debug("Publishing Request Payload");let r=e.id||(0,rw.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:r,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${r}:${(null==(i=e.params)?void 0:i.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${r}`),e}}),nv(this,"resetPingTimeout",()=>{if(en())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,i;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)||i.terminate()},this.heartBeatTimeout)}catch(e){this.logger.warn(e,e?.message)}}),nv(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),nv(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(rO.connect)}),nv(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),nv(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(rO.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),nv(this,"registerProviderListeners",()=>{this.provider.on(rM.payload,this.onPayloadHandler),this.provider.on(rM.connect,this.onConnectHandler),this.provider.on(rM.disconnect,this.onDisconnectHandler),this.provider.on(rM.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,b.U5)(e.logger,this.name):(0,b.h6)((0,b.iP)({level:e.logger||"error"})),this.messages=new sQ(this.logger,e.core),this.subscriber=new np(this,this.logger),this.publisher=new s9(this,this.logger),this.relayUrl=e?.relayUrl||rP,this.projectId=e.projectId,ea()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)&&(null==i.g?void 0:i.g.Platform.OS)==="android"?this.packageName=el():ea()&&"u">typeof i.g&&"u">typeof(null==i.g?void 0:i.g.Platform)&&(null==i.g?void 0:i.g.Platform.OS)==="ios"&&(this.bundleId=el()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,b.oI)(this.logger)}get connected(){var e,t,i;return(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)===1}get connecting(){var e,t,i;return(null==(i=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:i.readyState)===0||void 0!==this.connectPromise}async publish(e,t,i){this.isInitialized(),await this.publisher.publish(e,t,i),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:rk.relay})}async subscribe(e,t){var i,r,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(i=t?.internal)?void 0:i.throwOnFailedPublish)>"u"||(null==(r=t?.internal)?void 0:r.throwOnFailedPublish),a=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",o,c=t=>{t.topic===e&&(this.subscriber.off(rU.created,c),o())};return await Promise.all([new Promise(e=>{o=e,this.subscriber.on(rU.created,c)}),new Promise(async(i,r)=>{a=await this.subscriber.subscribe(e,nw({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&r(e)})||a,i()})]),a}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await ey(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics)return void this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,i)=>{await this.connect(e).then(t).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await rf())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:i}=e;if(!t.sessionExists){let e=ew(H.FIVE_MINUTES);await this.core.pairing.pairings.set(i,{topic:i,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(rO.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(rM.disconnect,i),await ey(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(rM.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,t)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(rM.disconnect,i),await this.subscriber.start().then(e).catch(t).finally(()=>{this.provider.off(rM.disconnect,i)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,H.toMiliseconds)(+t))),t++}}startPingTimeout(){var e,t,i,r,s;if(en())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(s=null==(r=null==(i=this.provider)?void 0:i.connection)?void 0:r.socket)||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new rb.F(new rv.A(function({protocol:e,version:t,relayUrl:i,sdkVersion:r,auth:s,projectId:n,useOnCloseEvent:a,bundleId:o,packageName:c}){let l=i.split("?"),d=eh(e,t,r),h=function(e,t){let i=new URLSearchParams(e);for(let e of Object.keys(t).sort())if(t.hasOwnProperty(e)){let r=t[e];void 0!==r&&i.set(e,r)}return i.toString()}(l[1]||"",{auth:s,ua:d,projectId:n,useOnCloseEvent:a||void 0,packageName:c||void 0,bundleId:o||void 0});return l[0]+"?"+h}({sdkVersion:rR,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){let{topic:t,message:i}=e;await this.messages.set(t,i)}async shouldIgnoreMessageEvent(e){let{topic:t,message:i}=e;if(!i||0===i.length)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.warn(`Ignoring message for non-subscribed topic ${t}`),!0;let r=this.messages.has(t,i);return r&&this.logger.warn(`Ignoring duplicate message: ${i}`),r}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,rw.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:i,message:r,publishedAt:s,attestation:n}=t.data,a={topic:i,message:r,publishedAt:s,transportType:rk.relay,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(nw({type:"event",event:t.id},a)),this.events.emit(t.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else(0,rw.isJsonRpcResponse)(e)&&this.events.emit(rO.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(rO.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){let t=(0,rw.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(rM.payload,this.onPayloadHandler),this.provider.off(rM.connect,this.onConnectHandler),this.provider.off(rM.disconnect,this.onDisconnectHandler),this.provider.off(rM.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await rf();var t,r,s=async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))};switch(ec()){case es.browser:t=s,!ea()&&eo()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)));break;case es.reactNative:r=s,ea()&&"u">typeof i.g&&null!=i.g&&i.g.NetInfo&&i.g?.NetInfo.addEventListener(e=>r(e?.isConnected));case es.node:}}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(rO.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,H.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||await this.connect()}}var nE=Object.defineProperty,n_=Object.getOwnPropertySymbols,nC=Object.prototype.hasOwnProperty,nA=Object.prototype.propertyIsEnumerable,nS=(e,t,i)=>t in e?nE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nN=(e,t)=>{for(var i in t||(t={}))nC.call(t,i)&&nS(e,i,t[i]);if(n_)for(var i of n_(t))nA.call(t,i)&&nS(e,i,t[i]);return e},nT=(e,t,i)=>nS(e,"symbol"!=typeof t?t+"":t,i);class nx extends O{constructor(e,t,i,r=rC,s){super(e,t,i,r),this.core=e,this.logger=t,this.name=i,nT(this,"map",new Map),nT(this,"version","0.3"),nT(this,"cached",[]),nT(this,"initialized",!1),nT(this,"getKey"),nT(this,"storagePrefix",rC),nT(this,"recentlyDeleted",[]),nT(this,"recentlyDeletedLimit",200),nT(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{this.getKey&&null!==e&&!ri(e)?this.map.set(this.getKey(e),e):function(e){var t;return null==(t=e?.proposer)?void 0:t.publicKey}(e)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),nT(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),nT(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),nT(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(i=>rE()(t[i],e[i]))):this.values)),nT(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let i=nN(nN({},this.getData(e)),t);this.map.set(e,i),await this.persist()}),nT(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,b.U5)(t,this.name),this.storagePrefix=r,this.getKey=s}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=i9("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=i9("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=i9("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var nP=Object.defineProperty,nO=(e,t,i)=>t in e?nP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nM=(e,t,i)=>nO(e,"symbol"!=typeof t?t+"":t,i);class nR{constructor(e,t){this.core=e,this.logger=t,nM(this,"name","pairing"),nM(this,"version","0.3"),nM(this,"events",new(g())),nM(this,"pairings"),nM(this,"initialized",!1),nM(this,"storagePrefix",rC),nM(this,"ignoredPayloadTypes",[1]),nM(this,"registeredMethods",[]),nM(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),nM(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),nM(this,"create",async e=>{this.isInitialized();let t=iR(),i=await this.core.crypto.setSymKey(t),r=ew(H.FIVE_MINUTES),s={protocol:"irn"},n={topic:i,expiry:r,relay:s,active:!1,methods:e?.methods},a=iF({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:t,relay:s,expiryTimestamp:r,methods:e?.methods});return this.events.emit(rj.create,n),this.core.expirer.set(i,r),await this.pairings.set(i,n),await this.core.relayer.subscribe(i,{transportType:e?.transportType}),{topic:i,uri:a}}),nM(this,"pair",async e=>{let t;this.isInitialized();let i=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[rF.pairing_started]}});this.isValidPair(e,i);let{topic:r,symKey:s,relay:n,expiryTimestamp:a,methods:o}=iW(e.uri);if(i.props.properties.topic=r,i.addTrace(rF.pairing_uri_validation_success),i.addTrace(rF.pairing_uri_not_expired),this.pairings.keys.includes(r)){if(t=this.pairings.get(r),i.addTrace(rF.existing_pairing),t.active)throw i.setError(rV.active_pairing_already_exists),Error(`Pairing already exists: ${r}. Please try again with a new connection URI.`);i.addTrace(rF.pairing_not_expired)}let c=a||ew(H.FIVE_MINUTES),l={topic:r,relay:n,expiry:c,active:!1,methods:o};this.core.expirer.set(r,c),await this.pairings.set(r,l),i.addTrace(rF.store_new_pairing),e.activatePairing&&await this.activate({topic:r}),this.events.emit(rj.create,l),i.addTrace(rF.emit_inactive_pairing),this.core.crypto.keychain.has(r)||await this.core.crypto.setSymKey(s,r),i.addTrace(rF.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{i.setError(rV.no_internet_connection)}try{await this.core.relayer.subscribe(r,{relay:n})}catch(e){throw i.setError(rV.subscribe_pairing_topic_failure),e}return i.addTrace(rF.subscribe_pairing_topic_success),l}),nM(this,"activate",async({topic:e})=>{this.isInitialized();let t=ew(H.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),nM(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:i,resolve:r,reject:s}=eg();this.events.once(eI("pairing_ping",e),({error:e})=>{e?s(e):r()}),await i()}}),nM(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),nM(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),nM(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),nM(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",i7("USER_DISCONNECTED")),await this.deletePairing(t))}),nM(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:i,expiry:r,methods:s}=e,n=this.core.crypto.keychain.get(t);return iF({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:i,expiryTimestamp:r,methods:s})}),nM(this,"sendRequest",async(e,t,i)=>{let r=(0,rw.formatJsonRpcRequest)(t,i),s=await this.core.crypto.encode(e,r),n=rq[t].req;return this.core.history.set(e,r),this.core.relayer.publish(e,s,n),r.id}),nM(this,"sendResult",async(e,t,i)=>{let r=(0,rw.formatJsonRpcResult)(e,i),s=await this.core.crypto.encode(t,r),n=rq[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(r)}),nM(this,"sendError",async(e,t,i)=>{let r=(0,rw.formatJsonRpcError)(e,i),s=await this.core.crypto.encode(t,r),n=(await this.core.history.get(t,e)).request.method,a=rq[n]?rq[n].res:rq.unregistered_method.res;await this.core.relayer.publish(t,s,a),await this.core.history.resolve(r)}),nM(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,i7("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),nM(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>ev(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),nM(this,"onRelayEventRequest",e=>{let{topic:t,payload:i}=e;switch(i.method){case"wc_pairingPing":return this.onPairingPingRequest(t,i);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,i);default:return this.onUnknownRpcMethodRequest(t,i)}}),nM(this,"onRelayEventResponse",async e=>{let{topic:t,payload:i}=e,r=(await this.core.history.get(t,i.id)).request.method;return"wc_pairingPing"===r?this.onPairingPingResponse(t,i):this.onUnknownRpcMethodResponse(r)}),nM(this,"onPairingPingRequest",async(e,t)=>{let{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult(i,e,!0),this.events.emit(rj.ping,{id:i,topic:e})}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nM(this,"onPairingPingResponse",(e,t)=>{let{id:i}=t;setTimeout(()=>{(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("pairing_ping",i),{}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("pairing_ping",i),{error:t.error})},500)}),nM(this,"onPairingDeleteRequest",async(e,t)=>{let{id:i}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(rj.delete,{id:i,topic:e})}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nM(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:i,method:r}=t;try{if(this.registeredMethods.includes(r))return;let t=i7("WC_METHOD_UNSUPPORTED",r);await this.sendError(i,e,t),this.logger.error(t)}catch(t){await this.sendError(i,e,t),this.logger.error(t)}}),nM(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(i7("WC_METHOD_UNSUPPORTED",e))}),nM(this,"isValidPair",(e,t)=>{var i;if(!rd(e)){let{message:i}=i9("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(rV.malformed_pairing_uri),Error(i)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(rr(e,!1)){if(t(e))return!0;let i=eT(e);return t(i)}}catch{}return!1}(e.uri)){let{message:i}=i9("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(rV.malformed_pairing_uri),Error(i)}let r=iW(e?.uri);if(!(null!=(i=r?.relay)&&i.protocol)){let{message:e}=i9("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(rV.malformed_pairing_uri),Error(e)}if(!(null!=r&&r.symKey)){let{message:e}=i9("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(rV.malformed_pairing_uri),Error(e)}if(null!=r&&r.expiryTimestamp&&(0,H.toMiliseconds)(r?.expiryTimestamp)<Date.now()){t.setError(rV.pairing_expired);let{message:e}=i9("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),nM(this,"isValidPing",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nM(this,"isValidDisconnect",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),nM(this,"isValidPairingTopic",async e=>{if(!rr(e,!1)){let{message:t}=i9("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=i9("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=i9("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,b.U5)(t,this.name),this.pairings=new nx(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,b.oI)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(rO.message,async e=>{let{topic:t,message:i,transportType:r}=e;if(!this.pairings.keys.includes(t)||r===rk.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;let s=await this.core.crypto.decode(t,i);try{(0,rw.isJsonRpcRequest)(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):(0,rw.isJsonRpcResponse)(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(rz.expired,async e=>{let{topic:t}=eb(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(rj.expire,{topic:t}))})}}var nk=Object.defineProperty,nD=(e,t,i)=>t in e?nk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nU=(e,t,i)=>nD(e,"symbol"!=typeof t?t+"":t,i);class nL extends N{constructor(e,t){super(e,t),this.core=e,this.logger=t,nU(this,"records",new Map),nU(this,"events",new f.EventEmitter),nU(this,"name","history"),nU(this,"version","0.3"),nU(this,"cached",[]),nU(this,"initialized",!1),nU(this,"storagePrefix",rC),nU(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),nU(this,"set",(e,t,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:i}),this.records.has(t.id))return;let r={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:i,expiry:ew(H.THIRTY_DAYS)};this.records.set(r.id,r),this.persist(),this.events.emit(r$.created,r)}),nU(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,rw.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(r$.updated,t))}),nU(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),nU(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(i=>{i.topic===e&&("u">typeof t&&i.id!==t||(this.records.delete(i.id),this.events.emit(r$.deleted,i)))}),this.persist()}),nU(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),nU(this,"on",(e,t)=>{this.events.on(e,t)}),nU(this,"once",(e,t)=>{this.events.once(e,t)}),nU(this,"off",(e,t)=>{this.events.off(e,t)}),nU(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,b.U5)(t,this.name)}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let i={topic:t.topic,request:(0,rw.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=i9("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(r$.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=i9("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(r$.created,e=>{let t=r$.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(r$.updated,e=>{let t=r$.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(r$.deleted,e=>{let t=r$.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(y.li.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,H.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(r$.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var nq=Object.defineProperty,nj=(e,t,i)=>t in e?nq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,n$=(e,t,i)=>nj(e,"symbol"!=typeof t?t+"":t,i);class nz extends k{constructor(e,t){super(e,t),this.core=e,this.logger=t,n$(this,"expirations",new Map),n$(this,"events",new f.EventEmitter),n$(this,"name","expirer"),n$(this,"version","0.3"),n$(this,"cached",[]),n$(this,"initialized",!1),n$(this,"storagePrefix",rC),n$(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),n$(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),n$(this,"set",(e,t)=>{this.isInitialized();let i=this.formatTarget(e),r={target:i,expiry:t};this.expirations.set(i,r),this.checkExpiry(i,r),this.events.emit(rz.created,{target:i,expiration:r})}),n$(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),n$(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),i=this.getExpiration(t);this.expirations.delete(t),this.events.emit(rz.deleted,{target:t,expiration:i})}}),n$(this,"on",(e,t)=>{this.events.on(e,t)}),n$(this,"once",(e,t)=>{this.events.once(e,t)}),n$(this,"off",(e,t)=>{this.events.off(e,t)}),n$(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,b.U5)(t,this.name)}get context(){return(0,b.oI)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return em("topic",e);if("number"==typeof e)return em("id",e);let{message:t}=i9("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(rz.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=i9("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=i9("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:i}=t;(0,H.toMiliseconds)(i)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(rz.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(y.li.pulse,()=>this.checkExpirations()),this.events.on(rz.created,e=>{let t=rz.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(rz.expired,e=>{let t=rz.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(rz.deleted,e=>{let t=rz.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}}var nB=Object.defineProperty,nH=(e,t,i)=>t in e?nB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nW=(e,t,i)=>nH(e,"symbol"!=typeof t?t+"":t,i);class nF extends D{constructor(e,t,i){super(e,t,i),this.core=e,this.logger=t,this.store=i,nW(this,"name","verify-api"),nW(this,"abortController"),nW(this,"isDevEnv"),nW(this,"verifyUrlV3",rH),nW(this,"storagePrefix",rC),nW(this,"version",2),nW(this,"publicKey"),nW(this,"fetchPromise"),nW(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,H.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),nW(this,"register",async e=>{if(!eo()||this.isDevEnv)return;let t=window.location.origin,{id:i,decryptedId:r}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${i}&decryptedId=${r}`;try{let e=(0,K.getDocument)(),t=this.startAbortTimer(5*H.ONE_SECOND),r=await new Promise((r,n)=>{let a=()=>{window.removeEventListener("message",c),e.body.removeChild(o),n("attestation aborted")};this.abortController.signal.addEventListener("abort",a);let o=e.createElement("iframe");o.src=s,o.style.display="none",o.addEventListener("error",a,{signal:this.abortController.signal});let c=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if((0,F.Cq)(n.attestation).payload.id!==i)return;clearInterval(t),e.body.removeChild(o),this.abortController.signal.removeEventListener("abort",a),window.removeEventListener("message",c),r(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(o),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",r),r}catch(e){this.logger.warn(e)}return""}),nW(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:i,encryptedId:r}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if((0,F.Cq)(t).payload.id!==r)return;let e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!i)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(i,s)}),nW(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let i=this.startAbortTimer(5*H.ONE_SECOND),r=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(i),200===r.status?await r.json():void 0}),nW(this,"getVerifyUrl",e=>{let t=e||rB;return rW.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${rB}`),t=rB),t}),nW(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(H.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),nW(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),nW(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),nW(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let i=await this.fetchAndPersistPublicKey();try{if(i)return this.validateAttestation(e,i)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),nW(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),nW(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),nW(this,"validateAttestation",(e,t)=>{let i=function(e,t){let[i,r,s]=e.split("."),n=ee.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),i=t.length%4;return i>0&&(t+="=".repeat(4-i)),t}(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let a=n.slice(0,32).toString("hex"),o=n.slice(32,64).toString("hex"),c=it(`${i}.${r}`),l=new Q.ec("p256").keyFromPublic({x:ee.from(t.x,"base64").toString("hex"),y:ee.from(t.y,"base64").toString("hex")},"hex"),d=(0,Y.dI)(c,ix);if(!l.verify(d,{r:a,s:o}))throw Error("Invalid signature");return(0,F.Cq)(e).payload}(e,t.publicKey),r={hasExpired:(0,H.toMiliseconds)(i.exp)<Date.now(),payload:i};if(r.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:r.payload.origin,isScam:r.payload.isScam,isVerified:r.payload.isVerified}}),this.logger=(0,b.U5)(t,this.name),this.abortController=new AbortController,this.isDevEnv=eN(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,b.oI)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,H.toMiliseconds)(e))}}var nV=Object.defineProperty,nK=(e,t,i)=>t in e?nV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,nG=(e,t,i)=>nK(e,"symbol"!=typeof t?t+"":t,i);class nJ extends U{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,nG(this,"context","echo"),nG(this,"registerDeviceToken",async e=>{let{clientId:t,token:i,notificationType:r,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:r,token:i,always_raw:s})})}),this.logger=(0,b.U5)(t,this.context)}}var nY=Object.defineProperty,nQ=Object.getOwnPropertySymbols,nX=Object.prototype.hasOwnProperty,nZ=Object.prototype.propertyIsEnumerable,n0=(e,t,i)=>t in e?nY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,n1=(e,t)=>{for(var i in t||(t={}))nX.call(t,i)&&n0(e,i,t[i]);if(nQ)for(var i of nQ(t))nZ.call(t,i)&&n0(e,i,t[i]);return e},n2=(e,t,i)=>n0(e,"symbol"!=typeof t?t+"":t,i);class n5 extends L{constructor(e,t,i=!0){super(e,t,i),this.core=e,this.logger=t,n2(this,"context","event-client"),n2(this,"storagePrefix",rC),n2(this,"storageVersion",.1),n2(this,"events",new Map),n2(this,"shouldPersist",!1),n2(this,"init",async()=>{if(!eN())try{let e={eventId:eS(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:eh(this.core.relayer.protocol,this.core.relayer.version,rR)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),n2(this,"createEvent",e=>{let{event:t="ERROR",type:i="",properties:{topic:r,trace:s}}=e,n=eS(),a=this.core.projectId||"",o=n1({eventId:n,timestamp:Date.now(),props:{event:t,type:i,properties:{topic:r,trace:s}},bundleId:a,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,o),this.shouldPersist=!0),o}),n2(this,"getEvent",e=>{let{eventId:t,topic:i}=e;if(t)return this.events.get(t);let r=Array.from(this.events.values()).find(e=>e.props.properties.topic===i);if(r)return n1(n1({},r),this.setMethods(r.eventId))}),n2(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),n2(this,"setEventListeners",()=>{this.core.heartbeat.on(y.li.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,H.fromMiliseconds)(Date.now())-(0,H.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),n2(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),n2(this,"addTrace",(e,t)=>{let i=this.events.get(e);i&&(i.props.properties.trace.push(t),this.events.set(e,i),this.shouldPersist=!0)}),n2(this,"setError",(e,t)=>{let i=this.events.get(e);i&&(i.props.type=t,i.timestamp=Date.now(),this.events.set(e,i),this.shouldPersist=!0)}),n2(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),n2(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,n1(n1({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),n2(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,i]of this.events)i.props.type&&e.push(i);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),n2(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${rR}${t}`,{method:"POST",body:JSON.stringify(e)})}),n2(this,"getAppDomain",()=>ed().url),this.logger=(0,b.U5)(t,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var n3=Object.defineProperty,n6=Object.getOwnPropertySymbols,n4=Object.prototype.hasOwnProperty,n8=Object.prototype.propertyIsEnumerable,n9=(e,t,i)=>t in e?n3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,n7=(e,t)=>{for(var i in t||(t={}))n4.call(t,i)&&n9(e,i,t[i]);if(n6)for(var i of n6(t))n8.call(t,i)&&n9(e,i,t[i]);return e},ae=(e,t,i)=>n9(e,"symbol"!=typeof t?t+"":t,i);class at extends _{constructor(e){var t;super(e),ae(this,"protocol","wc"),ae(this,"version",2),ae(this,"name",r_),ae(this,"relayUrl"),ae(this,"projectId"),ae(this,"customStoragePrefix"),ae(this,"events",new f.EventEmitter),ae(this,"logger"),ae(this,"heartbeat"),ae(this,"relayer"),ae(this,"crypto"),ae(this,"storage"),ae(this,"history"),ae(this,"expirer"),ae(this,"pairing"),ae(this,"verify"),ae(this,"echoClient"),ae(this,"linkModeSupportedApps"),ae(this,"eventClient"),ae(this,"initialized",!1),ae(this,"logChunkController"),ae(this,"on",(e,t)=>this.events.on(e,t)),ae(this,"once",(e,t)=>this.events.once(e,t)),ae(this,"off",(e,t)=>this.events.off(e,t)),ae(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),ae(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:i})=>{if(!e||!t)return;let r={topic:e,message:t,publishedAt:Date.now(),transportType:rk.link_mode};this.relayer.onLinkMessageEvent(r,{sessionExists:i})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||rP,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let i=(0,b.iP)({level:"string"==typeof e?.logger&&e.logger?e.logger:rA.logger,name:r_}),{logger:r,chunkLoggerController:s}=(0,b.D5)({opts:i,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,b.U5)(r,this.name),this.heartbeat=new y.VH,this.crypto=new sK(this,this.logger,e?.keychain),this.history=new nL(this,this.logger),this.expirer=new nz(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new m.A(n7(n7({},rS),e?.storageOptions)),this.relayer=new nI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new nR(this,this.logger),this.verify=new nF(this,this.logger,this.storage),this.echoClient=new nJ(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new n5(this,this.logger,e?.telemetryEnabled)}static async init(e){let t=new at(e);await t.initialize();let i=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",i),t}get context(){return(0,b.oI)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(rD,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(rD)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}let ai="client",ar=`wc@2:${ai}:`,as={name:ai,logger:"error"},an="WALLETCONNECT_DEEPLINK_CHOICE",aa="Proposal expired",ao=H.SEVEN_DAYS,ac={wc_sessionPropose:{req:{ttl:H.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1104},res:{ttl:H.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1106},res:{ttl:H.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:H.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:H.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1112},res:{ttl:H.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:H.ONE_DAY,prompt:!1,tag:1114},res:{ttl:H.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:H.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:H.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:H.FIVE_MINUTES,prompt:!1,tag:1119}}},al={min:H.FIVE_MINUTES,max:H.SEVEN_DAYS},ad={idle:"IDLE",active:"ACTIVE"},ah={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},au=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],ap="wc@1.5:auth:",af=`${ap}:PUB_KEY`;var ag=Object.defineProperty,ay=Object.defineProperties,am=Object.getOwnPropertyDescriptors,ab=Object.getOwnPropertySymbols,aw=Object.prototype.hasOwnProperty,av=Object.prototype.propertyIsEnumerable,aI=(e,t,i)=>t in e?ag(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,aE=(e,t)=>{for(var i in t||(t={}))aw.call(t,i)&&aI(e,i,t[i]);if(ab)for(var i of ab(t))av.call(t,i)&&aI(e,i,t[i]);return e},a_=(e,t)=>ay(e,am(t)),aC=(e,t,i)=>aI(e,"symbol"!=typeof t?t+"":t,i);class aA extends B{constructor(e){super(e),aC(this,"name","engine"),aC(this,"events",new(g())),aC(this,"initialized",!1),aC(this,"requestQueue",{state:ad.idle,queue:[]}),aC(this,"sessionRequestQueue",{state:ad.idle,queue:[]}),aC(this,"requestQueueDelay",H.ONE_SECOND),aC(this,"expectedPairingMethodMap",new Map),aC(this,"recentlyDeletedMap",new Map),aC(this,"recentlyDeletedLimit",200),aC(this,"relayMessageCache",[]),aC(this,"pendingSessions",new Map),aC(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(ac)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,H.toMiliseconds)(this.requestQueueDelay)))}),aC(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=a_(aE({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:i,requiredNamespaces:r,optionalNamespaces:s,sessionProperties:n,relays:a}=t,o=i,c,l=!1;try{if(o){let e=this.client.core.pairing.pairings.get(o);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),l=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${o}) failed`),e}if(!o||!l){let{topic:e,uri:t}=await this.client.core.pairing.create();o=e,c=t}if(!o){let{message:e}=i9("NO_MATCHING_KEY",`connect() pairing topic: ${o}`);throw Error(e)}let d=await this.client.core.crypto.generateKeyPair(),h=ac.wc_sessionPropose.req.ttl||H.FIVE_MINUTES,u=ew(h),p=a_(aE({requiredNamespaces:r,optionalNamespaces:s,relays:a??[{protocol:"irn"}],proposer:{publicKey:d,metadata:this.client.metadata},expiryTimestamp:u,pairingTopic:o},n&&{sessionProperties:n}),{id:(0,rw.payloadId)()}),f=eI("session_connect",p.id),{reject:g,resolve:y,done:m}=eg(h,aa),b=({id:e})=>{e===p.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(p.id),this.events.emit(f,{error:{message:aa,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(f,({error:e,session:t})=>{this.client.events.off("proposal_expire",b),e?g(e):t&&y(t)}),await this.sendRequest({topic:o,method:"wc_sessionPropose",params:p,throwOnFailedPublish:!0,clientRpcId:p.id}),await this.setProposal(p.id,p),{uri:c,approval:m}}),aC(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),aC(this,"approve",async e=>{var t,i,r;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[rK.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError(rG.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError(rG.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError(rG.session_approve_namespace_validation_failure),e}let{id:n,relayProtocol:a,namespaces:o,sessionProperties:c,sessionConfig:l}=e,d=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:h,proposer:u,requiredNamespaces:p,optionalNamespaces:f}=d,g=null==(i=this.client.core.eventClient)?void 0:i.getEvent({topic:h});g||(g=null==(r=this.client.core.eventClient)?void 0:r.createEvent({type:rK.session_approve_started,properties:{topic:h,trace:[rK.session_approve_started,rK.session_namespaces_validation_success]}}));let y=await this.client.core.crypto.generateKeyPair(),m=u.publicKey,b=await this.client.core.crypto.generateSharedKey(y,m),w=aE(aE({relay:{protocol:a??"irn"},namespaces:o,controller:{publicKey:y,metadata:this.client.metadata},expiry:ew(ao)},c&&{sessionProperties:c}),l&&{sessionConfig:l}),v=rk.relay;g.addTrace(rK.subscribing_session_topic);try{await this.client.core.relayer.subscribe(b,{transportType:v})}catch(e){throw g.setError(rG.subscribe_session_topic_failure),e}g.addTrace(rK.subscribe_session_topic_success);let I=a_(aE({},w),{topic:b,requiredNamespaces:p,optionalNamespaces:f,pairingTopic:h,acknowledged:!1,self:w.controller,peer:{publicKey:u.publicKey,metadata:u.metadata},controller:y,transportType:rk.relay});await this.client.session.set(b,I),g.addTrace(rK.store_session);try{g.addTrace(rK.publishing_session_settle),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:w,throwOnFailedPublish:!0}).catch(e=>{throw g?.setError(rG.session_settle_publish_failure),e}),g.addTrace(rK.session_settle_publish_success),g.addTrace(rK.publishing_session_approve),await this.sendResult({id:n,topic:h,result:{relay:{protocol:a??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(e=>{throw g?.setError(rG.session_approve_publish_failure),e}),g.addTrace(rK.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,i7("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:h,metadata:u.metadata}),await this.client.proposal.delete(n,i7("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:h}),await this.setExpiry(b,ew(ao)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),aC(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:i,reason:r}=e;try{t=this.client.proposal.get(i).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),e}t&&(await this.sendError({id:i,topic:t,error:r,rpcOpts:ac.wc_sessionPropose.reject}),await this.client.proposal.delete(i,i7("USER_DISCONNECTED")))}),aC(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:i}=e,{done:r,resolve:s,reject:n}=eg(),a=(0,rw.payloadId)(),o=(0,rw.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(eI("session_update",a),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:i}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:i},throwOnFailedPublish:!0,clientRpcId:a,relayRpcId:o}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),n(e)}),{acknowledged:r}}),aC(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,i=(0,rw.payloadId)(),{done:r,resolve:s,reject:n}=eg();return this.events.once(eI("session_extend",i),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,ew(ao)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:i,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:r}}),aC(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:i,topic:r,expiry:s=ac.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(r);n?.transportType===rk.relay&&await this.confirmOnlineStateOrThrow();let a=(0,rw.payloadId)(),o=(0,rw.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:d}=eg(s,"Request expired. Please try again.");this.events.once(eI("session_request",a),({error:e,result:t})=>{e?d(e):l(t)});let h="wc_sessionRequest",u=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(u)return await this.sendRequest({clientRpcId:a,relayRpcId:o,topic:r,method:h,params:{request:a_(aE({},i),{expiryTimestamp:ew(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:u}).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:r,request:i,chainId:t,id:a}),await c();let p={request:a_(aE({},i),{expiryTimestamp:ew(s)}),chainId:t},f=this.shouldSetTVF(h,p);return await Promise.all([new Promise(async e=>{await this.sendRequest(aE({clientRpcId:a,relayRpcId:o,topic:r,method:h,params:p,expiry:s,throwOnFailedPublish:!0},f&&{tvf:this.getTVFParams(a,p)})).catch(e=>d(e)),this.client.events.emit("session_request_sent",{topic:r,request:i,chainId:t,id:a}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await eC(this.client.core.storage,an);await e_({id:a,topic:r,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),aC(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:i}=e,{id:r}=i,s=this.client.session.get(t);s.transportType===rk.relay&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);(0,rw.isJsonRpcResult)(i)?await this.sendResult({id:r,topic:t,result:i.result,throwOnFailedPublish:!0,appLink:n}):(0,rw.isJsonRpcError)(i)&&await this.sendError({id:r,topic:t,error:i.error,appLink:n}),this.cleanupAfterResponse(e)}),aC(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,rw.payloadId)(),i=(0,rw.getBigIntRpcId)().toString(),{done:r,resolve:s,reject:n}=eg();this.events.once(eI("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:i}),r()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),aC(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:i,chainId:r}=e,s=(0,rw.getBigIntRpcId)().toString(),n=(0,rw.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:i,chainId:r},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),aC(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:i7("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=i9("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),aC(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:i}=t,r=Object.keys(e.namespaces),s=Object.keys(i),n=!0;return!!eu(s,r)&&(r.forEach(t=>{let{accounts:r,methods:s,events:a}=e.namespaces[t],o=i2(r),c=i[t];eu(er(t,c),o)&&eu(c.methods,s)&&eu(c.events,a)||(n=!1)}),n)})(t,e)))),aC(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),aC(this,"authenticate",async(e,t)=>{var i,r,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let a=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(i=this.client.metadata.redirect)?void 0:i.linkMode),o=a?rk.link_mode:rk.relay;o===rk.relay&&await this.confirmOnlineStateOrThrow();let{chains:c,statement:l="",uri:d,domain:h,nonce:u,type:p,exp:f,nbf:g,methods:y=[],expiry:m}=e,b=[...e.resources||[]],{topic:w,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:v}});let I=await this.client.core.crypto.generateKeyPair(),E=ik(I);if(await Promise.all([this.client.auth.authKeys.set(af,{responseTopic:E,publicKey:I}),this.client.auth.pairingTopics.set(E,{topic:E,pairingTopic:w})]),await this.client.core.relayer.subscribe(E,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${w}`),y.length>0){let{namespace:e}=et(c[0]),t=tv(function(e,t,i,r={}){return i?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,i={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[i]})))}(t,i,r)}}}(e,"request",y));tC(b)&&(r=t,s=b.pop(),t=tv(function(e,t){tw(e),tw(t);let i=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),r={att:{}};return i.forEach(i=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[i])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[i])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,a;r.att[i]=tu(th({},r.att[i]),{[s]:(null==(n=e.att[i])?void 0:n[s])||(null==(a=t.att[i])?void 0:a[s])})})}),r}(tI(r),tI(s)))),b.push(t)}let _=m&&m>ac.wc_sessionAuthenticate.req.ttl?m:ac.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:p??"caip122",chains:c,statement:l,aud:d,domain:h,version:"1",nonce:u,iat:new Date().toISOString(),exp:f,nbf:g,resources:b},requester:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:ew(_)},A={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:c,methods:[...new Set(["personal_sign",...y])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:I,metadata:this.client.metadata},expiryTimestamp:ew(ac.wc_sessionPropose.req.ttl),id:(0,rw.payloadId)()},{done:S,resolve:N,reject:T}=eg(_,"Request expired"),x=(0,rw.payloadId)(),P=eI("session_connect",A.id),O=eI("session_request",x),M=async({error:e,session:t})=>{this.events.off(O,R),e?T(e):t&&N({session:t})},R=async e=>{var i,r,s;let n;if(await this.deletePendingAuthRequest(x,{message:"fulfilled",code:0}),e.error){let t=i7("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(P,M),T(e.error.message))}await this.deleteProposal(A.id),this.events.off(P,M);let{cacaos:a,responder:c}=e.result,l=[],d=[];for(let e of a){await tm({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),T(i7("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,i=tC(t.resources),r=[tg(t.iss)],s=ty(t.iss);if(i){let e=tE(i),t=t_(i);l.push(...e),r.push(...t)}for(let e of r)d.push(`${e}:${s}`)}let h=await this.client.core.crypto.generateSharedKey(I,c.publicKey);l.length>0&&(n={topic:h,acknowledged:!0,self:{publicKey:I,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:ew(ao),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:i6([...new Set(l)],[...new Set(d)]),transportType:o},await this.client.core.relayer.subscribe(h,{transportType:o}),await this.client.session.set(h,n),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),n=this.client.session.get(h)),null!=(i=this.client.metadata.redirect)&&i.linkMode&&null!=(r=c.metadata.redirect)&&r.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(h,{transportType:rk.link_mode})),N({auths:a,session:n})};this.events.once(P,M),this.events.once(O,R);try{if(a){let e=(0,rw.formatJsonRpcRequest)("wc_sessionAuthenticate",C,x);this.client.core.history.set(w,e);let i=await this.client.core.crypto.encode("",e,{type:2,encoding:iO});n=iV(t,w,i)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:x}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:A,expiry:ac.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A.id})])}catch(e){throw this.events.off(P,M),this.events.off(O,R),e}return await this.setProposal(A.id,A),await this.setAuthRequest(x,{request:a_(aE({},C),{verifyContext:{}}),pairingTopic:w,transportType:o}),{uri:n??v,response:S}}),aC(this,"approveSessionAuthenticate",async e=>{let t,{id:i,auths:r}=e,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[rJ.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw s.setError(rY.no_internet_connection),e}let n=this.getPendingAuthRequest(i);if(!n)throw s.setError(rY.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${i}`);let a=n.transportType||rk.relay;a===rk.relay&&await this.confirmOnlineStateOrThrow();let o=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=ik(o),d={type:1,receiverPublicKey:o,senderPublicKey:c},h=[],u=[];for(let e of r){if(!await tm({cacao:e,projectId:this.client.core.projectId})){s.setError(rY.invalid_cacao);let e=i7("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:l,error:e,encodeOpts:d}),Error(e.message)}s.addTrace(rJ.cacaos_verified);let{p:t}=e,r=tC(t.resources),n=[tg(t.iss)],a=ty(t.iss);if(r){let e=tE(r),t=t_(r);h.push(...e),n.push(...t)}for(let e of n)u.push(`${e}:${a}`)}let p=await this.client.core.crypto.generateSharedKey(c,o);if(s.addTrace(rJ.create_authenticated_session_topic),h?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:o,metadata:n.requester.metadata},controller:o,expiry:ew(ao),authentication:r,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:i6([...new Set(h)],[...new Set(u)]),transportType:a},s.addTrace(rJ.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(e){throw s.setError(rY.subscribe_authenticated_session_topic_failure),e}s.addTrace(rJ.subscribe_authenticated_session_topic_success),await this.client.session.set(p,t),s.addTrace(rJ.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace(rJ.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:i,result:{cacaos:r,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,a)})}catch(e){throw s.setError(rY.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),aC(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:i}=e,r=this.getPendingAuthRequest(t);if(!r)throw Error(`Could not find pending auth request with id ${t}`);r.transportType===rk.relay&&await this.confirmOnlineStateOrThrow();let s=r.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),a=ik(s);await this.sendError({id:t,topic:a,error:i,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:ac.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(r.requester.metadata,r.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,i7("USER_DISCONNECTED"))}),aC(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:i}=e;return tb(t,i)}),aC(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),aC(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),i=this.client.core.pairing.pairings.getAll().filter(i=>{var r,s;return(null==(r=i.peerMetadata)?void 0:r.url)&&(null==(s=i.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&i.topic&&i.topic!==t.topic});if(0===i.length)return;this.client.logger.info(`Cleaning up ${i.length} duplicate pairing(s)`),await Promise.all(i.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),aC(this,"deleteSession",async e=>{var t;let{topic:i,expirerHasDeleted:r=!1,emitEvent:s=!0,id:n=0}=e,{self:a}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),await this.client.session.delete(i,i7("USER_DISCONNECTED")),this.addToRecentlyDeleted(i,"session"),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),r||this.client.core.expirer.del(i),this.client.core.storage.removeItem(an).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===i&&this.deletePendingSessionRequest(e.id,i7("USER_DISCONNECTED"))}),i===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=ad.idle),s&&this.client.events.emit("session_delete",{id:n,topic:i})}),aC(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),i=this.client.core.eventClient.getEvent({topic:t.pairingTopic});i?.setError(rG.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,i7("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),aC(this,"deletePendingSessionRequest",async(e,t,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),i?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),i&&(this.sessionRequestQueue.state=ad.idle,this.client.events.emit("session_request_expire",{id:e}))}),aC(this,"deletePendingAuthRequest",async(e,t,i=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),i?Promise.resolve():this.client.core.expirer.del(e)])}),aC(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),aC(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,ew(ac.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),aC(this,"setAuthRequest",async(e,t)=>{let{request:i,pairingTopic:r,transportType:s=rk.relay}=t;this.client.core.expirer.set(e,i.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:i.authPayload,requester:i.requester,expiryTimestamp:i.expiryTimestamp,id:e,pairingTopic:r,verifyContext:i.verifyContext,transportType:s})}),aC(this,"setPendingSessionRequest",async e=>{let{id:t,topic:i,params:r,verifyContext:s}=e,n=r.request.expiryTimestamp||ew(ac.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:i,params:r,verifyContext:s})}),aC(this,"sendRequest",async e=>{let t,r,{topic:s,method:n,params:a,expiry:o,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:d,appLink:h,tvf:u}=e,p=(0,rw.formatJsonRpcRequest)(n,a,l),f=!!h;try{let e=f?iO:iP;t=await this.client.core.crypto.encode(s,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(au.includes(n)){let e=iD(JSON.stringify(p)),i=iD(t);r=await this.client.core.verify.register({id:i,decryptedId:e})}let g=ac[n].req;if(g.attestation=r,o&&(g.ttl=o),c&&(g.id=c),this.client.core.history.set(s,p),f){let e=iV(h,s,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=ac[n].req;o&&(e.ttl=o),c&&(e.id=c),e.tvf=a_(aE({},u),{correlationId:p.id}),d?(e.internal=a_(aE({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,t,e)):this.client.core.relayer.publish(s,t,e).catch(e=>this.client.logger.error(e))}return p.id}),aC(this,"sendResult",async e=>{let t,r,s,{id:n,topic:a,result:o,throwOnFailedPublish:c,encodeOpts:l,appLink:d}=e,h=(0,rw.formatJsonRpcResult)(n,o),u=d&&"u">typeof(null==i.g?void 0:i.g.Linking);try{let e=u?iO:iP;t=await this.client.core.crypto.encode(a,h,a_(aE({},l||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${a} failed`),e}try{let e=(r=await this.client.core.history.get(a,n)).request;try{this.shouldSetTVF(e.method,e.params)&&(s=this.getTVFParams(n,e.params,o))}catch(e){this.client.logger.warn("sendResult() -> getTVFParams() failed",e)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${a}, ${n}) failed`),e}if(u){let e=iV(d,a,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=ac[r.request.method].res;e.tvf=a_(aE({},s),{correlationId:n}),c?(e.internal=a_(aE({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,t,e)):this.client.core.relayer.publish(a,t,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(h)}),aC(this,"sendError",async e=>{let t,r,{id:s,topic:n,error:a,encodeOpts:o,rpcOpts:c,appLink:l}=e,d=(0,rw.formatJsonRpcError)(s,a),h=l&&"u">typeof(null==i.g?void 0:i.g.Linking);try{let e=h?iO:iP;t=await this.client.core.crypto.encode(n,d,a_(aE({},o||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{r=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(h){let e=iV(l,n,t);await i.g.Linking.openURL(e,this.client.name)}else{let e=r.request.method,i=c||ac[e].res;this.client.core.relayer.publish(n,t,i)}await this.client.core.history.resolve(d)}),aC(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let i=!1;ev(t.expiry)&&(i=!0),this.client.core.crypto.keychain.has(t.topic)||(i=!0),i&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{ev(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),aC(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),aC(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===ad.active)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ad.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=ad.idle}),aC(this,"processRequest",async e=>{let{topic:t,payload:i,attestation:r,transportType:s,encryptedId:n}=e,a=i.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:a}))switch(a){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:i,attestation:r,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,i);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,i);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,i);case"wc_sessionPing":return await this.onSessionPingRequest(t,i);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,i);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:i,attestation:r,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,i);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:i,attestation:r,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${a}`)}}),aC(this,"onRelayEventResponse",async e=>{let{topic:t,payload:i,transportType:r}=e,s=(await this.client.core.history.get(t,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,i,r);case"wc_sessionSettle":return this.onSessionSettleResponse(t,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,i);case"wc_sessionExtend":return this.onSessionExtendResponse(t,i);case"wc_sessionPing":return this.onSessionPingResponse(t,i);case"wc_sessionRequest":return this.onSessionRequestResponse(t,i);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),aC(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:i}=i9("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(i)}),aC(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:i}=e,r=this.expectedPairingMethodMap.get(t);return!(!r||r.includes(i))&&!!(r.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),aC(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:i,attestation:r,encryptedId:s}=e,{params:n,id:a}=i;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(rV.proposal_listener_not_found)),this.isValidConnect(aE({},i.params));let o=n.expiryTimestamp||ew(ac.wc_sessionPropose.req.ttl),c=aE({id:a,pairingTopic:t,expiryTimestamp:o},n);await this.setProposal(a,c);let l=await this.getVerifyContext({attestationId:r,hash:iD(JSON.stringify(i)),encryptedId:s,metadata:c.proposer.metadata});e?.addTrace(rF.emit_session_proposal),this.client.events.emit("session_proposal",{id:a,params:c,verifyContext:l})}catch(e){await this.sendError({id:a,topic:t,error:e,rpcOpts:ac.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),aC(this,"onSessionProposeResponse",async(e,t,i)=>{let{id:r}=t;if((0,rw.isJsonRpcResult)(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(r);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let a=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:a});let o=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:o});let c=await this.client.core.crypto.generateSharedKey(a,o);this.pendingSessions.set(r,{sessionTopic:c,pairingTopic:e,proposalId:r,publicKey:a});let l=await this.client.core.relayer.subscribe(c,{transportType:i});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,rw.isJsonRpcError)(t)){await this.client.proposal.delete(r,i7("USER_DISCONNECTED"));let e=eI("session_connect",r);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),aC(this,"onSessionSettleRequest",async(e,t)=>{let{id:i,params:r}=t;try{this.isValidSessionSettleRequest(r);let{relay:i,controller:s,expiry:n,namespaces:a,sessionProperties:o,sessionConfig:c}=t.params,l=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!l)return this.client.logger.error(`Pending session not found for topic ${e}`);let d=this.client.proposal.get(l.proposalId),h=a_(aE(aE({topic:e,relay:i,expiry:n,namespaces:a,acknowledged:!0,pairingTopic:l.pairingTopic,requiredNamespaces:d.requiredNamespaces,optionalNamespaces:d.optionalNamespaces,controller:s.publicKey,self:{publicKey:l.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},o&&{sessionProperties:o}),c&&{sessionConfig:c}),{transportType:rk.relay});await this.client.session.set(h.topic,h),await this.setExpiry(h.topic,h.expiry),await this.client.core.pairing.updateMetadata({topic:l.pairingTopic,metadata:h.peer.metadata}),this.client.events.emit("session_connect",{session:h}),this.events.emit(eI("session_connect",l.proposalId),{session:h}),this.pendingSessions.delete(l.proposalId),this.deleteProposal(l.proposalId,!1),this.cleanupDuplicatePairings(h),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aC(this,"onSessionSettleResponse",async(e,t)=>{let{id:i}=t;(0,rw.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(eI("session_approve",i),{})):(0,rw.isJsonRpcError)(t)&&(await this.client.session.delete(e,i7("USER_DISCONNECTED")),this.events.emit(eI("session_approve",i),{error:t.error}))}),aC(this,"onSessionUpdateRequest",async(e,t)=>{let{params:i,id:r}=t;try{let t=`${e}_session_update`,s=rm.get(t);if(s&&this.isRequestOutOfSync(s,r)){this.client.logger.warn(`Discarding out of sync request - ${r}`),this.sendError({id:r,topic:e,error:i7("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(aE({topic:e},i));try{rm.set(t,r),await this.client.session.update(e,{namespaces:i.namespaces}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw rm.delete(t),e}this.client.events.emit("session_update",{id:r,topic:e,params:i})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),aC(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),aC(this,"onSessionUpdateResponse",(e,t)=>{let{id:i}=t,r=eI("session_update",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("session_update",i),{}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("session_update",i),{error:t.error})}),aC(this,"onSessionExtendRequest",async(e,t)=>{let{id:i}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,ew(ao)),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:i,topic:e})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aC(this,"onSessionExtendResponse",(e,t)=>{let{id:i}=t,r=eI("session_extend",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("session_extend",i),{}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("session_extend",i),{error:t.error})}),aC(this,"onSessionPingRequest",async(e,t)=>{let{id:i}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:i,topic:e})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aC(this,"onSessionPingResponse",(e,t)=>{let{id:i}=t,r=eI("session_ping",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);setTimeout(()=>{(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("session_ping",i),{}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("session_ping",i),{error:t.error})},500)}),aC(this,"onSessionDeleteRequest",async(e,t)=>{let{id:i}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(rO.publish,async()=>{t(await this.deleteSession({topic:e,id:i}))})}),this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:i7("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),aC(this,"onSessionRequest",async e=>{var t,i,r;let{topic:s,payload:n,attestation:a,encryptedId:o,transportType:c}=e,{id:l,params:d}=n;try{await this.isValidRequest(aE({topic:s},d));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:a,hash:iD(JSON.stringify((0,rw.formatJsonRpcRequest)("wc_sessionRequest",d,l))),encryptedId:o,metadata:e.peer.metadata,transportType:c}),h={id:l,topic:s,params:d,verifyContext:n};await this.setPendingSessionRequest(h),c===rk.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(i=e.peer.metadata.redirect)?void 0:i.universal),null!=(r=this.client.signConfig)&&r.disableRequestQueue?this.emitSessionRequest(h):(this.addSessionRequestToSessionRequestQueue(h),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:s,error:e}),this.client.logger.error(e)}}),aC(this,"onSessionRequestResponse",(e,t)=>{let{id:i}=t,r=eI("session_request",i);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("session_request",i),{result:t.result}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("session_request",i),{error:t.error})}),aC(this,"onSessionEventRequest",async(e,t)=>{let{id:i,params:r}=t;try{let t=`${e}_session_event_${r.event.name}`,s=rm.get(t);if(s&&this.isRequestOutOfSync(s,i))return void this.client.logger.info(`Discarding out of sync request - ${i}`);this.isValidEmit(aE({topic:e},r)),this.client.events.emit("session_event",{id:i,topic:e,params:r}),rm.set(t,i)}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),aC(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:i}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,rw.isJsonRpcResult)(t)?this.events.emit(eI("session_request",i),{result:t.result}):(0,rw.isJsonRpcError)(t)&&this.events.emit(eI("session_request",i),{error:t.error})}),aC(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:i,payload:r,attestation:s,encryptedId:n,transportType:a}=e;try{let{requester:e,authPayload:o,expiryTimestamp:c}=r.params,l=await this.getVerifyContext({attestationId:s,hash:iD(JSON.stringify(r)),encryptedId:n,metadata:e.metadata,transportType:a}),d={requester:e,pairingTopic:i,id:r.id,authPayload:o,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(r.id,{request:d,pairingTopic:i,transportType:a}),a===rk.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:i,params:r.params,id:r.id,verifyContext:l})}catch(n){this.client.logger.error(n);let e=r.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(r.params.requester.metadata,a);await this.sendError({id:r.id,topic:i,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:ac.wc_sessionAuthenticate.autoReject,appLink:s})}}),aC(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),aC(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ad.idle,this.processSessionRequestQueue()},(0,H.toMiliseconds)(this.requestQueueDelay))}),aC(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let i=this.client.core.history.pending;i.length>0&&i.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let i=eI("session_request",e.request.id);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);this.events.emit(eI("session_request",e.request.id),{error:t})})}),aC(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===ad.active)return void this.client.logger.info("session request queue is already active.");let e=this.sessionRequestQueue.queue[0];if(!e)return void this.client.logger.info("session request queue is empty.");try{this.sessionRequestQueue.state=ad.active,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),aC(this,"emitSessionRequest",e=>{this.client.events.emit("session_request",e)}),aC(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,rw.formatJsonRpcRequest)("wc_sessionPropose",{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties},t.id)})}),aC(this,"isValidConnect",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:t,requiredNamespaces:i,optionalNamespaces:r,sessionProperties:s,relays:n}=e;if(ri(t)||await this.isValidPairingTopic(t),!function(e,t){let i=!1;return t&&!e?i=!0:e&&re(e)&&e.length&&e.forEach(e=>{i=rl(e)}),i}(n,!0)){let{message:e}=i9("MISSING_OR_INVALID",`connect() relays: ${n}`);throw Error(e)}ri(i)||0===rt(i)||this.validateNamespaces(i,"requiredNamespaces"),ri(r)||0===rt(r)||this.validateNamespaces(r,"optionalNamespaces"),ri(s)||this.validateSessionProps(s,"sessionProperties")}),aC(this,"validateNamespaces",(e,t)=>{let i=function(e,t,i){let r=null;if(e&&rt(e)){let s,n=ro(e,t);n&&(r=n);let a=(s=null,Object.entries(e).forEach(([e,r])=>{var n,a;let o;if(s)return;let c=(n=er(e,r),a=`${t} ${i}`,o=null,re(n)&&n.length?n.forEach(e=>{o||rn(e)||(o=i7("UNSUPPORTED_CHAINS",`${a}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):rn(e)||(o=i7("UNSUPPORTED_CHAINS",`${a}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),o);c&&(s=c)}),s);a&&(r=a)}else r=i9("MISSING_OR_INVALID",`${t}, ${i} should be an object with data`);return r}(e,"connect()",t);if(i)throw Error(i.message)}),aC(this,"isValidApprove",async e=>{if(!rd(e))throw Error(i9("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:i,relayProtocol:r,sessionProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let n=this.client.proposal.get(t),a=rc(i,"approve()");if(a)throw Error(a.message);let o=ru(n.requiredNamespaces,i,"approve()");if(o)throw Error(o.message);if(!rr(r,!0)){let{message:e}=i9("MISSING_OR_INVALID",`approve() relayProtocol: ${r}`);throw Error(e)}ri(s)||this.validateSessionProps(s,"sessionProperties")}),aC(this,"isValidReject",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:i}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!function(e){return!(!e||"object"!=typeof e||!e.code||!rs(e.code,!1)||!e.message||!rr(e.message,!1))}(i)){let{message:e}=i9("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw Error(e)}}),aC(this,"isValidSessionSettleRequest",e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:t,controller:i,namespaces:r,expiry:s}=e;if(!rl(t)){let{message:e}=i9("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let n=function(e,t){let i=null;return rr(e?.publicKey,!1)||(i=i9("MISSING_OR_INVALID",`${t} controller public key should be a string`)),i}(i,"onSessionSettleRequest()");if(n)throw Error(n.message);let a=rc(r,"onSessionSettleRequest()");if(a)throw Error(a.message);if(ev(s)){let{message:e}=i9("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),aC(this,"isValidUpdate",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:i}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let r=this.client.session.get(t),s=rc(i,"update()");if(s)throw Error(s.message);let n=ru(r.requiredNamespaces,i,"update()");if(n)throw Error(n.message)}),aC(this,"isValidExtend",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),aC(this,"isValidRequest",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:t,request:i,chainId:r,expiry:s}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let{namespaces:n}=this.client.session.get(t);if(!rh(n,r)){let{message:e}=i9("MISSING_OR_INVALID",`request() chainId: ${r}`);throw Error(e)}if(!function(e){return!(ri(e)||!rr(e.method,!1))}(i)){let{message:e}=i9("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!function(e,t,i){return!!rr(i,!1)&&(function(e,t){let i=[];return Object.values(e).forEach(e=>{i2(e.accounts).includes(t)&&i.push(...e.methods)}),i})(e,t).includes(i)}(n,r,i.method)){let{message:e}=i9("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(s&&!function(e,t){return rs(e,!1)&&e<=t.max&&e>=t.min}(s,al)){let{message:e}=i9("MISSING_OR_INVALID",`request() expiry: ${s}. Expiry must be a number (in seconds) between ${al.min} and ${al.max}`);throw Error(e)}}),aC(this,"isValidRespond",async e=>{var t;if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:i,response:r}=e;try{await this.isValidSessionTopic(i)}catch(i){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),i}if(!function(e){return!(ri(e)||ri(e.result)&&ri(e.error)||!rs(e.id,!1)||!rr(e.jsonrpc,!1))}(r)){let{message:e}=i9("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(r)}`);throw Error(e)}}),aC(this,"isValidPing",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),aC(this,"isValidEmit",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:t,event:i,chainId:r}=e;await this.isValidSessionTopic(t);let{namespaces:s}=this.client.session.get(t);if(!rh(s,r)){let{message:e}=i9("MISSING_OR_INVALID",`emit() chainId: ${r}`);throw Error(e)}if(!function(e){return!(ri(e)||!rr(e.name,!1))}(i)||!function(e,t,i){return!!rr(i,!1)&&(function(e,t){let i=[];return Object.values(e).forEach(e=>{i2(e.accounts).includes(t)&&i.push(...e.events)}),i})(e,t).includes(i)}(s,r,i.name)){let{message:e}=i9("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),aC(this,"isValidDisconnect",async e=>{if(!rd(e)){let{message:t}=i9("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),aC(this,"isValidAuthenticate",e=>{let{chains:t,uri:i,domain:r,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!rr(i,!1))throw Error("uri is required parameter");if(!rr(r,!1))throw Error("domain is required parameter");if(!rr(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>et(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=et(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),aC(this,"getVerifyContext",async e=>{let{attestationId:t,hash:i,encryptedId:r,metadata:s,transportType:n}=e,a={verified:{verifyUrl:s.verifyUrl||rB,validation:"UNKNOWN",origin:s.url||""}};try{if(n===rk.link_mode){let e=this.getAppLinkIfEnabled(s,n);return a.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",a}let e=await this.client.core.verify.resolve({attestationId:t,hash:i,encryptedId:r,verifyUrl:s.verifyUrl});e&&(a.verified.origin=e.origin,a.verified.isScam=e.isScam,a.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(a)}`),a}),aC(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach(e=>{if(!rr(e,!1)){let{message:i}=i9("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw Error(i)}})}),aC(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),aC(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let i of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(i)}}}),aC(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:i}=i9("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(i)}}),aC(this,"isLinkModeEnabled",(e,t)=>{var r,s,n,a,o,c,l,d,h;return!!e&&t===rk.link_mode&&(null==(s=null==(r=this.client.metadata)?void 0:r.redirect)?void 0:s.linkMode)===!0&&(null==(a=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:a.universal)!==void 0&&(null==(c=null==(o=this.client.metadata)?void 0:o.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(d=e?.redirect)?void 0:d.universal)!==""&&(null==(h=e?.redirect)?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==i.g?void 0:i.g.Linking)}),aC(this,"getAppLinkIfEnabled",(e,t)=>{var i;return this.isLinkModeEnabled(e,t)?null==(i=e?.redirect)?void 0:i.universal:void 0}),aC(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=eA(e,"topic")||"",i=decodeURIComponent(eA(e,"wc_ev")||""),r=this.client.session.keys.includes(t);r&&this.client.session.update(t,{transportType:rk.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:i,sessionExists:r})}),aC(this,"registerLinkModeListeners",async()=>{var e;if(eN()||ea()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==i.g?void 0:i.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),aC(this,"shouldSetTVF",(e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;let{request:i}=t;return Object.keys(ah).includes(i.method)}),aC(this,"getTVFParams",(e,t,i)=>{var r,s;try{let n=t.request.method,a=this.extractTxHashesFromResult(n,i);return a_(aE({correlationId:e,rpcMethods:[n],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(s=null==(r=t.request.params)?void 0:r[0])?void 0:s.to]}),{txHashes:a})}catch(e){this.client.logger.warn("Error getting TVF params",e)}return{}}),aC(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let i=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!i.startsWith("0x"))return!1;let r=i.slice(2);return!!/^[0-9a-fA-F]*$/.test(r)&&r.length%2==0}catch{}return!1}),aC(this,"extractTxHashesFromResult",(e,t)=>{try{let i=ah[e];if("string"==typeof t)return[t];let r=t[i.key];if(re(r))return r;if("string"==typeof r)return[r]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}isInitialized(){if(!this.initialized){let{message:e}=i9("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(rO.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){let{topic:t,message:i,attestation:r,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(af)?this.client.auth.authKeys.get(af):{responseTopic:void 0,publicKey:void 0},a=await this.client.core.crypto.decode(t,i,{receiverPublicKey:n,encoding:s===rk.link_mode?iO:iP});try{(0,rw.isJsonRpcRequest)(a)?(this.client.core.history.set(t,a),this.onRelayEventRequest({topic:t,payload:a,attestation:r,transportType:s,encryptedId:iD(i)})):(0,rw.isJsonRpcResponse)(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:t,payload:a,transportType:s}),this.client.core.history.delete(t,a.id)):this.onRelayEventUnknownPayload({topic:t,payload:a,transportType:s})}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(rz.expired,async e=>{let{topic:t,id:i}=eb(e.target);return i&&this.client.pendingRequest.keys.includes(i)?await this.deletePendingSessionRequest(i,i9("EXPIRED"),!0):i&&this.client.auth.requests.keys.includes(i)?await this.deletePendingAuthRequest(i,i9("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i})))})}registerPairingEvents(){this.client.core.pairing.events.on(rj.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(rj.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!rr(e,!1)){let{message:t}=i9("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=i9("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=i9("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!rr(e,!1)){let{message:t}=i9("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=i9("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=i9("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=i9("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(rr(e,!1)){let{message:t}=i9("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=i9("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=i9("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=i9("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(ev(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=i9("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class aS extends nx{constructor(e,t){super(e,t,"proposal",ar),this.core=e,this.logger=t}}class aN extends nx{constructor(e,t){super(e,t,"session",ar),this.core=e,this.logger=t}}class aT extends nx{constructor(e,t){super(e,t,"request",ar,e=>e.id),this.core=e,this.logger=t}}class ax extends nx{constructor(e,t){super(e,t,"authKeys",ap,()=>af),this.core=e,this.logger=t}}class aP extends nx{constructor(e,t){super(e,t,"pairingTopics",ap),this.core=e,this.logger=t}}class aO extends nx{constructor(e,t){super(e,t,"requests",ap,e=>e.id),this.core=e,this.logger=t}}var aM=Object.defineProperty,aR=(e,t,i)=>t in e?aM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ak=(e,t,i)=>aR(e,"symbol"!=typeof t?t+"":t,i);class aD{constructor(e,t){this.core=e,this.logger=t,ak(this,"authKeys"),ak(this,"pairingTopics"),ak(this,"requests"),this.authKeys=new ax(this.core,this.logger),this.pairingTopics=new aP(this.core,this.logger),this.requests=new aO(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var aU=Object.defineProperty,aL=(e,t,i)=>t in e?aU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,aq=(e,t,i)=>aL(e,"symbol"!=typeof t?t+"":t,i);class aj extends z{constructor(e){super(e),aq(this,"protocol","wc"),aq(this,"version",2),aq(this,"name",as.name),aq(this,"metadata"),aq(this,"core"),aq(this,"logger"),aq(this,"events",new f.EventEmitter),aq(this,"engine"),aq(this,"session"),aq(this,"proposal"),aq(this,"pendingRequest"),aq(this,"auth"),aq(this,"signConfig"),aq(this,"on",(e,t)=>this.events.on(e,t)),aq(this,"once",(e,t)=>this.events.once(e,t)),aq(this,"off",(e,t)=>this.events.off(e,t)),aq(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),aq(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),aq(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),aq(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),aq(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||as.name,this.metadata=e?.metadata||ed(),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,b.h6)((0,b.iP)({level:e?.logger||as.logger}));this.core=e?.core||new at(e),this.logger=(0,b.U5)(t,this.name),this.session=new aN(this.core,this.logger),this.proposal=new aS(this.core,this.logger),this.pendingRequest=new aT(this.core,this.logger),this.engine=new aA(this),this.auth=new aD(this.core,this.logger)}static async init(e){let t=new aj(e);return await t.initialize(),t}get context(){return(0,b.oI)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,H.toMiliseconds)(H.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var a$=i(60657);let az="error",aB="wc@2:universal_provider:",aH="https://rpc.walletconnect.org/v1/",aW="generic",aF=`${aH}bundler`,aV={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var aK="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof i.g?i.g:"u">typeof self?self:{},aG=function(e,t){return e===t||e!=e&&t!=t},aJ=function(e,t){for(var i=e.length;i--;)if(aG(e[i][0],t))return i;return -1},aY=Array.prototype.splice;function aQ(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}aQ.prototype.clear=function(){this.__data__=[],this.size=0},aQ.prototype.delete=function(e){var t=this.__data__,i=aJ(t,e);return!(i<0)&&(i==t.length-1?t.pop():aY.call(t,i,1),--this.size,!0)},aQ.prototype.get=function(e){var t=this.__data__,i=aJ(t,e);return i<0?void 0:t[i][1]},aQ.prototype.has=function(e){return aJ(this.__data__,e)>-1},aQ.prototype.set=function(e,t){var i=this.__data__,r=aJ(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this};var aX="object"==typeof aK&&aK&&aK.Object===Object&&aK,aZ="object"==typeof self&&self&&self.Object===Object&&self,a0=aX||aZ||Function("return this")(),a1=a0.Symbol,a2=Object.prototype,a5=a2.hasOwnProperty,a3=a2.toString,a6=a1?a1.toStringTag:void 0,a4=Object.prototype.toString,a8=function(e){var t=a5.call(e,a6),i=e[a6];try{e[a6]=void 0;var r=!0}catch{}var s=a3.call(e);return r&&(t?e[a6]=i:delete e[a6]),s},a9=a1?a1.toStringTag:void 0,a7=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a9&&a9 in Object(e)?a8(e):a4.call(e)},oe=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ot=function(e){if(!oe(e))return!1;var t=a7(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},oi=a0["__core-js_shared__"],or=function(){var e=/[^.]+$/.exec(oi&&oi.keys&&oi.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),os=Function.prototype.toString,on=function(e){if(null!=e){try{return os.call(e)}catch{}try{return e+""}catch{}}return""},oa=/^\[object .+?Constructor\]$/,oo=Object.prototype,oc=Function.prototype.toString,ol=oo.hasOwnProperty,od=RegExp("^"+oc.call(ol).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),oh=function(e){return!!oe(e)&&(!or||!(or in e))&&(ot(e)?od:oa).test(on(e))},ou=function(e,t){var i=e?.[t];return oh(i)?i:void 0},op=ou(a0,"Map"),of=ou(Object,"create"),og=Object.prototype.hasOwnProperty,oy=Object.prototype.hasOwnProperty;function om(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}om.prototype.clear=function(){this.__data__=of?of(null):{},this.size=0},om.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},om.prototype.get=function(e){var t=this.__data__;if(of){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return og.call(t,e)?t[e]:void 0},om.prototype.has=function(e){var t=this.__data__;return of?void 0!==t[e]:oy.call(t,e)},om.prototype.set=function(e,t){var i=this.__data__;return this.size+=+!this.has(e),i[e]=of&&void 0===t?"__lodash_hash_undefined__":t,this};var ob=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},ow=function(e,t){var i=e.__data__;return ob(t)?i["string"==typeof t?"string":"hash"]:i.map};function ov(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function oI(e){var t=this.__data__=new aQ(e);this.size=t.size}ov.prototype.clear=function(){this.size=0,this.__data__={hash:new om,map:new(op||aQ),string:new om}},ov.prototype.delete=function(e){var t=ow(this,e).delete(e);return this.size-=!!t,t},ov.prototype.get=function(e){return ow(this,e).get(e)},ov.prototype.has=function(e){return ow(this,e).has(e)},ov.prototype.set=function(e,t){var i=ow(this,e),r=i.size;return i.set(e,t),this.size+=+(i.size!=r),this},oI.prototype.clear=function(){this.__data__=new aQ,this.size=0},oI.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},oI.prototype.get=function(e){return this.__data__.get(e)},oI.prototype.has=function(e){return this.__data__.has(e)},oI.prototype.set=function(e,t){var i=this.__data__;if(i instanceof aQ){var r=i.__data__;if(!op||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new ov(r)}return i.set(e,t),this.size=i.size,this};var oE=function(){try{var e=ou(Object,"defineProperty");return e({},"",{}),e}catch{}}(),o_=function(e,t,i){"__proto__"==t&&oE?oE(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i},oC=function(e,t,i){(void 0===i||aG(e[t],i))&&(void 0!==i||t in e)||o_(e,t,i)},oA={exports:{}};!function(e,t){var i=t&&!t.nodeType&&t,r=i&&e&&!e.nodeType&&e,s=r&&r.exports===i?a0.Buffer:void 0,n=s?s.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var i=e.length,r=n?n(i):new e.constructor(i);return e.copy(r),r}}(oA,oA.exports);var oS=a0.Uint8Array,oN=function(e){var t=new e.constructor(e.byteLength);return new oS(t).set(new oS(e)),t},oT=Object.create,ox=function(){function e(){}return function(t){if(!oe(t))return{};if(oT)return oT(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),oP=(r=Object.getPrototypeOf,s=Object,function(e){return r(s(e))}),oO=Object.prototype,oM=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||oO)},oR=function(e){return null!=e&&"object"==typeof e},ok=function(e){return oR(e)&&"[object Arguments]"==a7(e)},oD=Object.prototype,oU=oD.hasOwnProperty,oL=oD.propertyIsEnumerable,oq=ok(function(){return arguments}())?ok:function(e){return oR(e)&&oU.call(e,"callee")&&!oL.call(e,"callee")},oj=Array.isArray,o$=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff},oz=function(e){return null!=e&&o$(e.length)&&!ot(e)},oB={exports:{}},oH=function(){return!1};!function(e,t){var i=t&&!t.nodeType&&t,r=i&&e&&!e.nodeType&&e,s=r&&r.exports===i?a0.Buffer:void 0;e.exports=(s?s.isBuffer:void 0)||oH}(oB,oB.exports);var oW=Object.prototype,oF=Function.prototype.toString,oV=oW.hasOwnProperty,oK=oF.call(Object),oG={};oG["[object Float32Array]"]=oG["[object Float64Array]"]=oG["[object Int8Array]"]=oG["[object Int16Array]"]=oG["[object Int32Array]"]=oG["[object Uint8Array]"]=oG["[object Uint8ClampedArray]"]=oG["[object Uint16Array]"]=oG["[object Uint32Array]"]=!0,oG["[object Arguments]"]=oG["[object Array]"]=oG["[object ArrayBuffer]"]=oG["[object Boolean]"]=oG["[object DataView]"]=oG["[object Date]"]=oG["[object Error]"]=oG["[object Function]"]=oG["[object Map]"]=oG["[object Number]"]=oG["[object Object]"]=oG["[object RegExp]"]=oG["[object Set]"]=oG["[object String]"]=oG["[object WeakMap]"]=!1;var oJ={exports:{}};!function(e,t){var i=t&&!t.nodeType&&t,r=i&&e&&!e.nodeType&&e,s=r&&r.exports===i&&aX.process;e.exports=function(){try{return r&&r.require&&r.require("util").types||s&&s.binding&&s.binding("util")}catch{}}()}(oJ,oJ.exports);var oY=oJ.exports,oQ=oY&&oY.isTypedArray,oX=oQ?function(e){return oQ(e)}:function(e){return oR(e)&&o$(e.length)&&!!oG[a7(e)]},oZ=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},o0=Object.prototype.hasOwnProperty,o1=function(e,t,i){var r=e[t];o0.call(e,t)&&aG(r,i)&&(void 0!==i||t in e)||o_(e,t,i)},o2=/^(?:0|[1-9]\d*)$/,o5=function(e,t){var i=typeof e;return!!(t=t??0x1fffffffffffff)&&("number"==i||"symbol"!=i&&o2.test(e))&&e>-1&&e%1==0&&e<t},o3=function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r},o6=oB.exports,o4=Object.prototype.hasOwnProperty,o8=function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t},o9=Object.prototype.hasOwnProperty,o7=function(e,t){var i=oj(e),r=!i&&oq(e),s=!i&&!r&&o6(e),n=!i&&!r&&!s&&oX(e),a=i||r||s||n,o=a?o3(e.length,String):[],c=o.length;for(var l in e)(t||o4.call(e,l))&&!(a&&("length"==l||s&&("offset"==l||"parent"==l)||n&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||o5(l,c)))&&o.push(l);return o},ce=function(e){if(!oe(e))return o8(e);var t=oM(e),i=[];for(var r in e)"constructor"==r&&(t||!o9.call(e,r))||i.push(r);return i},ct=function(e){return oz(e)?o7(e,!0):ce(e)},ci=function(e,t,i,r){var s=!i;i||(i={});for(var n=-1,a=t.length;++n<a;){var o=t[n],c=r?r(i[o],e[o],o,i,e):void 0;void 0===c&&(c=e[o]),s?o_(i,o,c):o1(i,o,c)}return i},cr=oA.exports,cs=function(e,t){var i=t?oN(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)},cn=function(e,t){var i=-1,r=e.length;for(t||(t=Array(r));++i<r;)t[i]=e[i];return t},ca=oB.exports,co=function(e){if(!oR(e)||"[object Object]"!=a7(e))return!1;var t=oP(e);if(null===t)return!0;var i=oV.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&oF.call(i)==oK},cc=function(e,t,i){for(var r=-1,s=Object(e),n=i(e),a=n.length;a--;){var o=n[++r];if(!1===t(s[o],o,s))break}return e},cl=function(e,t,i,r,s,n,a){var o=oZ(e,i),c=oZ(t,i),l=a.get(c);if(l)return void oC(e,i,l);var d=n?n(o,c,i+"",e,t,a):void 0,h=void 0===d;if(h){var u=oj(c),p=!u&&ca(c),f=!u&&!p&&oX(c);d=c,u||p||f?oj(o)?d=o:oR(o)&&oz(o)?d=cn(o):p?(h=!1,d=cr(c,!0)):f?(h=!1,d=cs(c,!0)):d=[]:co(c)||oq(c)?(d=o,oq(o)?d=ci(o,ct(o)):(!oe(o)||ot(o))&&(d="function"!=typeof c.constructor||oM(c)?{}:ox(oP(c)))):h=!1}h&&(a.set(c,d),s(d,c,r,n,a),a.delete(c)),oC(e,i,d)},cd=function(e){return e},ch=function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)},cu=Math.max,cp=Date.now,cf=function(e){var t=0,i=0;return function(){var r=cp(),s=16-(r-i);if(i=r,s>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(oE?function(e,t){return oE(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:cd),cg=function(e,t){var i;return cf((i=cu(void 0===(i=t)?e.length-1:i,0),function(){for(var t=arguments,r=-1,s=cu(t.length-i,0),n=Array(s);++r<s;)n[r]=t[i+r];r=-1;for(var a=Array(i+1);++r<i;)a[r]=t[r];return a[i]=cd(n),ch(e,this,a)}),e+"")},cy=function(e,t,i){if(!oe(i))return!1;var r=typeof t;return("number"==r?!!(oz(i)&&o5(t,i.length)):"string"==r&&t in i)&&aG(i[t],e)},cm=function e(t,i,r,s,n){t!==i&&cc(i,function(a,o){if(n||(n=new oI),oe(a))cl(t,i,o,r,e,s,n);else{var c=s?s(oZ(t,o),a,o+"",t,i,n):void 0;void 0===c&&(c=a),oC(t,o,c)}},ct)},cb=function(e){return cg(function(t,i){var r=-1,s=i.length,n=s>1?i[s-1]:void 0,a=s>2?i[2]:void 0;for(n=e.length>3&&"function"==typeof n?(s--,n):void 0,a&&cy(i[0],i[1],a)&&(n=s<3?void 0:n,s=1),t=Object(t);++r<s;){var o=i[r];o&&e(t,o,r,n)}return t})}(function(e,t,i){cm(e,t,i)}),cw=Object.defineProperty,cv=Object.defineProperties,cI=Object.getOwnPropertyDescriptors,cE=Object.getOwnPropertySymbols,c_=Object.prototype.hasOwnProperty,cC=Object.prototype.propertyIsEnumerable,cA=(e,t,i)=>t in e?cw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cS=(e,t)=>{for(var i in t||(t={}))c_.call(t,i)&&cA(e,i,t[i]);if(cE)for(var i of cE(t))cC.call(t,i)&&cA(e,i,t[i]);return e},cN=(e,t)=>cv(e,cI(t));function cT(e,t,i){var r;let s=et(e);return(null==(r=t.rpcMap)?void 0:r[s.reference])||`${aH}?chainId=${s.namespace}:${s.reference}&projectId=${i}`}function cx(e){return e.includes(":")?e.split(":")[1]:e}function cP(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function cO(e={},t={}){return cb(cM(e),cM(t))}function cM(e){var t,i,r,s;let n={};if(!rt(e))return n;for(let[a,o]of Object.entries(e)){let e=i5(a)?[a]:o.chains,c=o.methods||[],l=o.events||[],d=o.rpcMap||{},h=i3(a);n[h]=cN(cS(cS({},n[h]),o),{chains:eE(e,null==(t=n[h])?void 0:t.chains),methods:eE(c,null==(i=n[h])?void 0:i.methods),events:eE(l,null==(r=n[h])?void 0:r.events),rpcMap:cS(cS({},d),null==(s=n[h])?void 0:s.rpcMap)})}return n}function cR(e){return e.includes(":")?e.split(":")[2]:e}function ck(e){let t={};for(let[i,r]of Object.entries(e)){let e=r.methods||[],s=r.events||[],n=r.accounts||[],a=i5(i)?[i]:r.chains?r.chains:cP(r.accounts);t[i]={chains:a,methods:e,events:s,accounts:n}}return t}function cD(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let cU={},cL=e=>cU[e],cq=(e,t)=>{cU[e]=t};var cj=Object.defineProperty,c$=(e,t,i)=>t in e?cj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cz=(e,t,i)=>c$(e,"symbol"!=typeof t?t+"":t,i);class cB{constructor(e){cz(this,"name","polkadot"),cz(this,"client"),cz(this,"httpProviders"),cz(this,"events"),cz(this,"namespace"),cz(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=cx(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var cH=Object.defineProperty,cW=Object.defineProperties,cF=Object.getOwnPropertyDescriptors,cV=Object.getOwnPropertySymbols,cK=Object.prototype.hasOwnProperty,cG=Object.prototype.propertyIsEnumerable,cJ=(e,t,i)=>t in e?cH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,cY=(e,t)=>{for(var i in t||(t={}))cK.call(t,i)&&cJ(e,i,t[i]);if(cV)for(var i of cV(t))cG.call(t,i)&&cJ(e,i,t[i]);return e},cQ=(e,t)=>cW(e,cF(t)),cX=(e,t,i)=>cJ(e,"symbol"!=typeof t?t+"":t,i);class cZ{constructor(e){cX(this,"name","eip155"),cX(this,"client"),cX(this,"chainId"),cX(this,"namespace"),cX(this,"httpProviders"),cX(this,"events"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let i=t||cT(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.V(i,cL("disableProviderPing")))}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=parseInt(cx(t));e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,i;let r=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",s=parseInt(r=r.startsWith("0x")?r:`0x${r}`,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:r}]},chainId:null==(i=this.namespace.chains)?void 0:i[0]}),this.setDefaultChain(`${s}`);else throw Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,i,r;let s=null==(i=null==(t=e.request)?void 0:t.params)?void 0:i[0];if(!s)throw Error("Missing address parameter in `wallet_getCapabilities` request");let n=this.client.session.get(e.topic),a=(null==(r=n?.sessionProperties)?void 0:r.capabilities)||{};if(null!=a&&a[s])return a?.[s];let o=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:cQ(cY({},n.sessionProperties||{}),{capabilities:cQ(cY({},a||{}),{[s]:o})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return o}async getCallStatus(e){var t,i;let r=this.client.session.get(e.topic),s=null==(t=r.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(i=r.sessionProperties)?void 0:i.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var i;let r=new URL(e),s=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,rw.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(i=t.request.params)?void 0:i[0]]))});if(!s.ok)throw Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${aF}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var c0=Object.defineProperty,c1=(e,t,i)=>t in e?c0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,c2=(e,t,i)=>c1(e,"symbol"!=typeof t?t+"":t,i);class c5{constructor(e){c2(this,"name","solana"),c2(this,"client"),c2(this,"httpProviders"),c2(this,"events"),c2(this,"namespace"),c2(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=cx(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var c3=Object.defineProperty,c6=(e,t,i)=>t in e?c3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,c4=(e,t,i)=>c6(e,"symbol"!=typeof t?t+"":t,i);class c8{constructor(e){c4(this,"name","cosmos"),c4(this,"client"),c4(this,"httpProviders"),c4(this,"events"),c4(this,"namespace"),c4(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=cx(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var c9=Object.defineProperty,c7=(e,t,i)=>t in e?c9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,le=(e,t,i)=>c7(e,"symbol"!=typeof t?t+"":t,i);class lt{constructor(e){le(this,"name","algorand"),le(this,"client"),le(this,"httpProviders"),le(this,"events"),le(this,"namespace"),le(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let i=t||cT(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new rb.F(new a$.A(i,cL("disableProviderPing")))}}var li=Object.defineProperty,lr=(e,t,i)=>t in e?li(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ls=(e,t,i)=>lr(e,"symbol"!=typeof t?t+"":t,i);class ln{constructor(e){ls(this,"name","cip34"),ls(this,"client"),ls(this,"httpProviders"),ls(this,"events"),ls(this,"namespace"),ls(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let i=this.getCardanoRPCUrl(t),r=cx(t);e[r]=this.createHttpProvider(r,i)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||this.getCardanoRPCUrl(e);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var la=Object.defineProperty,lo=(e,t,i)=>t in e?la(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lc=(e,t,i)=>lo(e,"symbol"!=typeof t?t+"":t,i);class ll{constructor(e){lc(this,"name","elrond"),lc(this,"client"),lc(this,"httpProviders"),lc(this,"events"),lc(this,"namespace"),lc(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=cx(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var ld=Object.defineProperty,lh=(e,t,i)=>t in e?ld(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lu=(e,t,i)=>lh(e,"symbol"!=typeof t?t+"":t,i);class lp{constructor(e){lu(this,"name","multiversx"),lu(this,"client"),lu(this,"httpProviders"),lu(this,"events"),lu(this,"namespace"),lu(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;let r=cx(t);e[r]=this.createHttpProvider(r,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var lf=Object.defineProperty,lg=(e,t,i)=>t in e?lf(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ly=(e,t,i)=>lg(e,"symbol"!=typeof t?t+"":t,i);class lm{constructor(e){ly(this,"name","near"),ly(this,"client"),ly(this,"httpProviders"),ly(this,"events"),ly(this,"namespace"),ly(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let i=t||cT(`${this.name}:${e}`,this.namespace);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var i;e[t]=this.createHttpProvider(t,null==(i=this.namespace.rpcMap)?void 0:i[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace);return typeof i>"u"?void 0:new rb.F(new a$.A(i,cL("disableProviderPing")))}}var lb=Object.defineProperty,lw=(e,t,i)=>t in e?lb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lv=(e,t,i)=>lw(e,"symbol"!=typeof t?t+"":t,i);class lI{constructor(e){lv(this,"name","tezos"),lv(this,"client"),lv(this,"httpProviders"),lv(this,"events"),lv(this,"namespace"),lv(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let i=t||cT(`${this.name}:${e}`,this.namespace);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace);return typeof i>"u"?void 0:new rb.F(new a$.A(i))}}var lE=Object.defineProperty,l_=(e,t,i)=>t in e?lE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lC=(e,t,i)=>l_(e,"symbol"!=typeof t?t+"":t,i);class lA{constructor(e){lC(this,"name",aW),lC(this,"client"),lC(this,"httpProviders"),lC(this,"events"),lC(this,"namespace"),lC(this,"chainId"),this.namespace=e.namespace,this.events=cL("events"),this.client=cL("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(aV.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let i={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=et(e);i[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),i}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let i=this.createHttpProvider(e,t);i&&(this.httpProviders[e]=i)}createHttpProvider(e,t){let i=t||cT(e,this.namespace,this.client.core.projectId);if(!i)throw Error(`No RPC url provided for chainId: ${e}`);return new rb.F(new a$.A(i,cL("disableProviderPing")))}}var lS=Object.defineProperty,lN=Object.defineProperties,lT=Object.getOwnPropertyDescriptors,lx=Object.getOwnPropertySymbols,lP=Object.prototype.hasOwnProperty,lO=Object.prototype.propertyIsEnumerable,lM=(e,t,i)=>t in e?lS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,lR=(e,t)=>{for(var i in t||(t={}))lP.call(t,i)&&lM(e,i,t[i]);if(lx)for(var i of lx(t))lO.call(t,i)&&lM(e,i,t[i]);return e},lk=(e,t)=>lN(e,lT(t)),lD=(e,t,i)=>lM(e,"symbol"!=typeof t?t+"":t,i);class lU{constructor(e){lD(this,"client"),lD(this,"namespaces"),lD(this,"optionalNamespaces"),lD(this,"sessionProperties"),lD(this,"events",new(g())),lD(this,"rpcProviders",{}),lD(this,"session"),lD(this,"providerOpts"),lD(this,"logger"),lD(this,"uri"),lD(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,b.h6)((0,b.iP)({level:e?.logger||az})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new lU(e);return await t.initialize(),t}async request(e,t,i){let[r,s]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(r).request({request:lR({},e),chainId:`${r}:${s}`,topic:this.session.topic,expiry:i})}sendAsync(e,t,i,r){let s=new Date().getTime();this.request(e,i,r).then(e=>t(null,(0,rw.formatJsonRpcResult)(s,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:i7("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:i,response:r}=await this.client.authenticate(e,t);i&&(this.uri=i,this.events.emit("display_uri",i));let s=await r();if(this.session=s.session,this.session){let e=ck(this.session.namespaces);this.namespaces=cO(this.namespaces,e),this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:i}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let r=await i();this.session=r;let s=ck(r.namespaces);return this.namespaces=cO(this.namespaces,s),this.persist("namespaces",this.namespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[i,r]=this.validateChain(e),s=this.getProvider(i);s.name===aW?s.setDefaultChain(`${i}:${r}`,t):s.setDefaultChain(r,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(re(t)){for(let i of t)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){let e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await aj.init({core:this.providerOpts.core,logger:this.providerOpts.logger||az,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>i3(e)))];cq("client",this.client),cq("events",this.events),cq("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let i=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!i.length)return[];let r=[];return i.forEach(e=>{let i=t.namespaces[e].accounts;r.push(...i)}),r}(e,this.session),i=cP(t),r=lk(lR({},cO(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:i});switch(e){case"eip155":this.rpcProviders[e]=new cZ({namespace:r});break;case"algorand":this.rpcProviders[e]=new lt({namespace:r});break;case"solana":this.rpcProviders[e]=new c5({namespace:r});break;case"cosmos":this.rpcProviders[e]=new c8({namespace:r});break;case"polkadot":this.rpcProviders[e]=new cB({namespace:r});break;case"cip34":this.rpcProviders[e]=new ln({namespace:r});break;case"elrond":this.rpcProviders[e]=new ll({namespace:r});break;case"multiversx":this.rpcProviders[e]=new lp({namespace:r});break;case"near":this.rpcProviders[e]=new lm({namespace:r});break;case"tezos":this.rpcProviders[e]=new lI({namespace:r});break;default:this.rpcProviders[aW]?this.rpcProviders[aW].updateNamespace(r):this.rpcProviders[aW]=new lA({namespace:r})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{let{params:t}=e,{event:i}=t;if("accountsChanged"===i.name){let e=i.data;e&&re(e)&&this.events.emit("accountsChanged",e.map(cR))}else if("chainChanged"===i.name){let e=t.chainId,i=t.event.data,r=i3(e),s=cD(e)!==cD(i)?`${r}:${cD(i)}`:e;this.onChainChanged(s)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var i;let{namespaces:r}=t,s=null==(i=this.client)?void 0:i.session.get(e);this.session=lk(lR({},s),{namespaces:r}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",lk(lR({},i7("USER_DISCONNECTED")),{data:e.topic}))}),this.on(aV.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[aW]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:i,sessionProperties:r}=e;t&&Object.keys(t).length&&(this.namespaces=t),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=r,this.persist("namespaces",t),this.persist("optionalNamespaces",i)}validateChain(e){let[t,i]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,i];if(t&&!Object.keys(this.namespaces||{}).map(e=>i3(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&i)return[t,i];let r=i3(Object.keys(this.namespaces)[0]),s=this.rpcProviders[r].getDefaultChain();return[r,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;let[i,r]=this.validateChain(e);r&&(t||this.getProvider(i).setDefaultChain(r),this.namespaces[i]?this.namespaces[i].defaultChain=r:this.namespaces[`${i}:${r}`]?this.namespaces[`${i}:${r}`].defaultChain=r:this.namespaces[`${i}:${r}`]={defaultChain:r},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",r))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${aB}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${aB}/${e}`)}}var lL=i(1221),lq=i(95954),lj=i(91019),l$=i(75808),lz=i(35597),lB=i(3046);let lH={validateCaipAddress(e){if(e.split(":")?.length!==3)throw Error("Invalid CAIP Address");return e},parseCaipAddress(e){let t=e.split(":");if(3!==t.length)throw Error(`Invalid CAIP-10 address: ${e}`);let[i,r,s]=t;if(!i||!r||!s)throw Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:i,chainId:r,address:s}},parseCaipNetworkId(e){let t=e.split(":");if(2!==t.length)throw Error(`Invalid CAIP-2 network id: ${e}`);let[i,r]=t;if(!i||!r)throw Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:i,chainId:r}}};var lW=i(197),lF=i(63),lV=i(42270),lK=i(1711),lG=i(50209),lJ=i(5001),lY=i(41179),lQ=i(74801);let lX={convertEVMChainIdToCoinType(e){if(e>=0x80000000)throw Error("Invalid chainId");return(0x80000000|e)>>>0}};var lZ=i(20641);let l0=(0,lY.BX)({suggestions:[],loading:!1}),l1={state:l0,subscribe:e=>(0,lY.B1)(l0,()=>e(l0)),subscribeKey:(e,t)=>(0,lQ.u$)(l0,e,t),async resolveName(e){try{return await lV.T.lookupEnsName(e)}catch(e){throw Error(e?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await lV.T.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{return l0.loading=!0,l0.suggestions=[],l0.suggestions=(await lV.T.getEnsNameSuggestions(e)).suggestions.map(e=>({...e,name:e.name}))||[],l0.suggestions}catch(e){throw Error(this.parseEnsApiError(e,"Error fetching name suggestions"))}finally{l0.loading=!1}},async getNamesForAddress(e){try{if(!lF.W.state.activeCaipNetwork)return[];let t=lJ.i.getEnsFromCacheForAddress(e);if(t)return t;let i=await lV.T.reverseLookupEnsName({address:e});return lJ.i.updateEnsCache({address:e,ens:i,timestamp:Date.now()}),i}catch(e){throw Error(this.parseEnsApiError(e,"Error fetching names for address"))}},async registerName(e){let t=lF.W.state.activeCaipNetwork;if(!t)throw Error("Network not found");let i=lK.U.state.address,r=lL.a.getAuthConnector();if(!i||!r)throw Error("Address or auth connector not found");l0.loading=!0;try{let r=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});lZ.I.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){l0.loading=!1}});let s=await lq.x.signMessage(r),n=t.id;if(!n)throw Error("Network not found");let a=lX.convertEVMChainIdToCoinType(Number(n));await lV.T.registerEnsName({coinType:a,address:i,signature:s,message:r}),lK.U.setProfileName(e,t.chainNamespace),lZ.I.replace("RegisterAccountNameSuccess")}catch(i){let t=this.parseEnsApiError(i,`Error registering name ${e}`);throw lZ.I.replace("RegisterAccountName"),Error(t)}finally{l0.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError:(e,t)=>e?.reasons?.[0]?.description||t};var l2=i(18756),l5=i(9686),l3=i(14109),l6=i(24857),l4=i(69386),l8=i(97490);i(64606),i(77575);var l9=i(2010),l7=i(44040);let de={UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${"undefined"!=typeof window?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},SOCIALS_TIMEOUT:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}};var dt=i(86742),di=i(47704),dr=i(65121);let ds={ConnectorExplorerIds:{[lB.o.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[lB.o.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[lB.o.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[lB.o.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[lB.o.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[dr.o.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[dr.o.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[dr.o.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[dr.o.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[dr.o.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[dr.o.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[dr.o.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[dr.o.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[dr.o.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[dr.o.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[dr.o.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",0xaa36a7:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",0x4e454152:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[lB.o.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[lB.o.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[lB.o.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[lB.o.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[lB.o.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[lB.o.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[lB.o.CONNECTOR_ID.INJECTED]:"Browser Wallet",[lB.o.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[lB.o.CONNECTOR_ID.COINBASE]:"Coinbase",[lB.o.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[lB.o.CONNECTOR_ID.LEDGER]:"Ledger",[lB.o.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[lB.o.CONNECTOR_ID.INJECTED]:"INJECTED",[lB.o.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[lB.o.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[lB.o.CONNECTOR_ID.AUTH]:"AUTH"},WalletConnectRpcChainIds:[1,5,0xaa36a7,10,420,42161,421613,137,80001,42220,0x4e454152,0x4e454153,56,97,43114,43113,100,8453,84531,7777777,999,324,280]},dn=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],da={extendRpcUrlWithProjectId(e,t){let i=!1;try{i="rpc.walletconnect.org"===new URL(e).host}catch(e){i=!1}if(i){let i=new URL(e);return i.searchParams.has("projectId")||i.searchParams.set("projectId",t),i.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:lB.o.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${lB.o.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,i){let r=e.rpcUrls?.default?.http?.[0];if(dn.includes(t)){let e=new URL("https://rpc.walletconnect.org/v1/");return e.searchParams.set("chainId",t),e.searchParams.set("projectId",i),e.toString()}return r||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:i,customRpcUrls:r}){let s=this.getChainNamespace(e),n=this.getCaipNetworkId(e),a=e.rpcUrls.default.http?.[0],o=this.getDefaultRpcUrl(e,n,i),c=e?.rpcUrls?.chainDefault?.http?.[0]||a,l=r?.[n]?.map(e=>e.url)||[],d=[...l,o],h=[...l];return c&&!h.includes(c)&&h.push(c),{...e,chainNamespace:s,caipNetworkId:n,assets:{imageId:ds.NetworkImageIds[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:d},chainDefault:{http:h}}}},extendCaipNetworks:(e,{customNetworkImageUrls:t,projectId:i,customRpcUrls:r})=>e.map(e=>da.extendCaipNetwork(e,{customNetworkImageUrls:t,customRpcUrls:r,projectId:i})),getViemTransport(e,t,i){let r=[];if(i?.forEach(e=>{r.push((0,dt.L)(e.url,e.config))}),dn.includes(e.caipNetworkId)){let i=this.getDefaultRpcUrl(e,e.caipNetworkId,t);r.push((0,dt.L)(i,{fetchOptions:{headers:{"Content-Type":"text/plain"}}}))}return(0,di.Np)(r)},extendWagmiTransports(e,t,i){if(dn.includes(e.caipNetworkId)){let r=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return(0,di.Np)([i,(0,dt.L)(r)])}return i},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:lB.o.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){let t=lJ.i.getActiveCaipNetworkId(),i=lF.W.getAllRequestedCaipNetworks(),r=Array.from(lF.W.state.chains?.keys()||[]),s=t?.split(":")[0],n=!!s&&r.includes(s),a=i?.find(e=>e.caipNetworkId===t);return n&&!a&&t?this.getUnsupportedNetwork(t):a||e||i?.[0]}};var dc=i(52749);let dl={createLogger(e,t="error"){let i=(0,b.iP)({level:t}),{logger:r}=(0,b.D5)({opts:i});return r.error=(...t)=>{for(let i of t)if(i instanceof Error)return void e(i,...t);e(void 0,...t)},r}},dd={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},dh=(0,lY.BX)({providers:{...dd},providerIds:{...dd}}),du={state:dh,subscribeKey:(e,t)=>(0,lQ.u$)(dh,e,t),subscribe:e=>(0,lY.B1)(dh,()=>{e(dh)}),subscribeProviders:e=>(0,lY.B1)(dh.providers,()=>e(dh.providers)),setProvider(e,t){t&&(dh.providers[e]=(0,lY.KR)(t))},getProvider:e=>dh.providers[e],setProviderId(e,t){t&&(dh.providerIds[e]=t)},getProviderId(e){if(e)return dh.providerIds[e]},reset(){dh.providers={...dd},dh.providerIds={...dd}},resetChain(e){dh.providers[e]=void 0,dh.providerIds[e]=void 0}};var dp=i(89745),df=i(7672),dg=i(51605),dy=i(13015);let dm={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};function db(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}let dw=db({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),dv=db({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}),dI=db({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});db({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),db({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});let dE={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},d_={getMethodsByChainNamespace:e=>dE[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let i={...e},r=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>r.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>r.add(e)),t.events&&Object.keys(t.events).forEach(e=>r.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{let[t]=e.split(":");t&&r.add(t)}),r.forEach(e=>{i[e]||(i[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{i[e]&&(i[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{i[e]&&(i[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{i[e]&&(i[e].events=t)}),t.rpcMap){let e=new Set;Object.entries(t.rpcMap).forEach(([t,r])=>{let[s,n]=t.split(":");s&&n&&i[s]&&(i[s].rpcMap||(i[s].rpcMap={}),e.has(s)||(i[s].rpcMap={},e.add(s)),i[s].rpcMap[n]=r)})}return i},createNamespaces(e,t){let i=e.reduce((e,t)=>{let{id:i,chainNamespace:r,rpcUrls:s}=t,n=s.default.http[0];e[r]||(e[r]=this.createDefaultNamespace(r));let a=`${r}:${i}`,o=e[r];switch(o.chains.push(a),a){case dw.caipNetworkId:o.chains.push(dw.deprecatedCaipNetworkId);break;case dv.caipNetworkId:o.chains.push(dv.deprecatedCaipNetworkId)}return o?.rpcMap&&n&&(o.rpcMap[i]=n),e},{});return this.applyNamespaceOverrides(i,t)},resolveReownName:async e=>{let t=await l1.resolveName(e),i=Object.values(t?.addresses)||[];return i[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let[t,i]=e.split(":");return`${t}:${i}`})]))),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event};class dC{constructor({provider:e,caipNetworks:t,namespace:i}){this.id=lB.o.CONNECTOR_ID.WALLET_CONNECT,this.name=ds.ConnectorNamesMap[lB.o.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=ds.ConnectorImageIds[lB.o.CONNECTOR_ID.WALLET_CONNECT],this.caipNetworks=t,this.provider=e,this.chain=i}get chains(){return this.caipNetworks}async connectWalletConnect(){if(!await this.authenticate()){let e=l$.H.state.universalProviderConfigOverride,t=d_.createNamespaces(this.caipNetworks,e);await this.provider.connect({optionalNamespaces:t})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let e=this.chains.map(e=>e.caipNetworkId);return dy.U.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:dA})}}let dA=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class dS{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,e&&this.construct(e)}construct(e){this.caipNetworks=e.networks,this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.caipNetworks||[]}setAuthProvider(e){this.addConnector({id:lB.o.CONNECTOR_ID.AUTH,type:"AUTH",name:lB.o.CONNECTOR_NAMES.AUTH,provider:e,imageId:ds.ConnectorImageIds[lB.o.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){let t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){lK.U.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){let i=this.eventListeners.get(e);i&&i.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){let i=this.eventListeners.get(e);i&&i.forEach(e=>e(t))}async connectWalletConnect(e){let t=this.getWalletConnectConnector();return{clientId:(await t.connectWalletConnect()).clientId}}async switchNetwork(e){let{caipNetwork:t,providerType:i}=e;if(!e.provider)return;let r="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"===i)return void r.setDefaultChain(t.caipNetworkId);if(r&&"AUTH"===i){await r.switchNetwork(t.caipNetworkId);let e=await r.getUser({chainId:t.caipNetworkId,preferredAccountType:l$.H.state.defaultAccountTypes[t.chainNamespace]});this.emit("switchNetwork",e)}}getWalletConnectConnector(){let e=this.connectors.find(e=>e instanceof dC);if(!e)throw Error("WalletConnectConnector not found");return e}}class dN extends dS{setUniversalProvider(e){this.addConnector(new dC({provider:e,caipNetworks:this.caipNetworks||[],namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{let e=this.getWalletConnectConnector();await e.disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){let t=this.provider;return Promise.resolve({accounts:(t?.session?.namespaces?.[e]?.accounts?.map(e=>{let[,,t]=e.split(":");return t}).filter((e,t,i)=>i.indexOf(e)===t)||[]).map(t=>lj.w.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&dg.oU.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(lK.U.state.balanceLoading&&e.chainId===lF.W.state.activeCaipNetwork?.id)return{balance:lK.U.state.balance||"0.00",symbol:lK.U.state.balanceSymbol||""};let t=(await lK.U.fetchTokenBalance()).find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:t?.quantity.numeric||"0.00",symbol:t?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:i,address:r}=e;if(!t)throw Error("UniversalAdapter:signMessage - provider is undefined");let s="";return{signature:lF.W.state.activeCaipNetwork?.chainNamespace===lB.o.CHAIN.SOLANA?(await t.request({method:"solana_signMessage",params:{message:dp.A.encode(new TextEncoder().encode(i)),pubkey:r}},lF.W.state.activeCaipNetwork?.caipNetworkId)).signature:await t.request({method:"personal_sign",params:[i,r]},lF.W.state.activeCaipNetwork?.caipNetworkId)}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async getProfile(){return Promise.resolve({profileImage:"",profileName:""})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}async getEnsAddress(){return Promise.resolve({address:!1})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,i=this.getWalletConnectConnector();if(t.chainNamespace===lB.o.CHAIN.EVM)try{await i.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:(0,df.nj)(t.id)}]})}catch(e){if(e.code===dm.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||e.code===dm.ERROR_INVALID_CHAIN_ID||e.code===dm.ERROR_CODE_DEFAULT||e?.data?.originalError?.code===dm.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await i.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:(0,df.nj)(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch(e){throw Error("Chain is not supported")}}i.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){let e=this.connectors.find(e=>"WALLET_CONNECT"===e.type);return e?.provider}}class dT{constructor(e){this.hasSwitchedToPreferredAccountTypeOnConnect=!1,this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=e=>{if(e){let t=lF.W.getNetworkData(e)?.caipNetwork;return t||lF.W.getRequestedCaipNetworks(e).filter(t=>t.chainNamespace===e)?.[0]}return lF.W.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{let e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>lF.W.getRequestedCaipNetworks(e),this.getActiveChainNamespace=()=>lF.W.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{lF.W.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>lF.W.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>lF.W.state.activeChain!==e&&e?lF.W.getAccountProp("caipAddress",e):lF.W.state.activeCaipAddress,this.setClientId=e=>{lV.T.setClientId(e)},this.getProvider=e=>du.getProvider(e),this.getProviderType=e=>du.getProviderId(e),this.getPreferredAccountType=()=>lK.U.state.preferredAccountType,this.setCaipAddress=(e,t)=>{lK.U.setCaipAddress(e,t)},this.setBalance=(e,t,i)=>{lK.U.setBalance(e,t,i)},this.setProfileName=(e,t)=>{lK.U.setProfileName(e,t)},this.setProfileImage=(e,t)=>{lK.U.setProfileImage(e,t)},this.setUser=(e,t)=>{lK.U.setUser(e,t),l$.H.state.enableEmbedded&&lG.W.close()},this.resetAccount=e=>{lK.U.resetAccount(e)},this.setCaipNetwork=e=>{lF.W.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{lF.W.setChainNetworkData(t,{caipNetwork:e})},this.setAllAccounts=(e,t)=>{lK.U.setAllAccounts(e,t),l$.H.setHasMultipleAddresses(e?.length>1)},this.setStatus=(e,t)=>{lK.U.setStatus(e,t),lL.a.isConnected()?lJ.i.setConnectionStatus("connected"):lJ.i.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>lF.W.getAccountProp("address",e),this.setConnectors=e=>{let t=[...lL.a.getConnectors(),...e];lL.a.setConnectors(t)},this.fetchIdentity=e=>lV.T.fetchIdentity(e),this.getReownName=e=>l1.getNamesForAddress(e),this.getConnectors=()=>lL.a.getConnectors(),this.getConnectorImage=e=>l2.$.getConnectorImage(e),this.setConnectedWalletInfo=(e,t)=>{let i=du.getProviderId(t),r=e?{...e,type:i}:void 0;lK.U.setConnectedWalletInfo(r,t)},this.getIsConnectedState=()=>!!lF.W.state.activeCaipAddress,this.addAddressLabel=(e,t,i)=>{lK.U.addAddressLabel(e,t,i)},this.removeAddressLabel=(e,t)=>{lK.U.removeAddressLabel(e,t)},this.getAddress=e=>lF.W.state.activeChain!==e&&e?lF.W.getAccountProp("address",e):lK.U.state.address,this.setApprovedCaipNetworksData=e=>lF.W.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{lF.W.resetNetwork(e)},this.addConnector=e=>{lL.a.addConnector(e)},this.resetWcConnection=()=>{lq.x.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{lK.U.setAddressExplorerUrl(e,t)},this.setSmartAccountDeployed=(e,t)=>{lK.U.setSmartAccountDeployed(e,t)},this.setSmartAccountEnabledNetworks=(e,t)=>{lF.W.setSmartAccountEnabledNetworks(e,t)},this.setPreferredAccountType=(e,t)=>{lK.U.setPreferredAccountType(e,t)},this.setEIP6963Enabled=e=>{l$.H.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{this.isOpen()?this.isTransactionStackEmpty()||this.redirect("ApproveTransaction"):this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=[...new Set(this.caipNetworks?.map(e=>e.chainNamespace))],this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e),this.sendInitializeEvent(e)}async initialize(e){this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),await this.syncExistingConnection(),l5.z.set({initialized:!0})}sendInitializeEvent(e){let{...t}=e;delete t.adapters,l3.E.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&l6.W.setThemeMode(e.themeMode),e.themeVariables&&l6.W.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw Error("ConnectionControllerClient and NetworkControllerClient must be set");lF.W.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});let t=this.getDefaultNetwork();t&&lF.W.setActiveCaipNetwork(t)}initializeConnectionController(e){lq.x.setWcBasic(e.basic??!1)}initializeConnectorController(){lL.a.initialize(this.chainNamespaces)}initializeOptionsController(e){l$.H.setDebug(!1!==e.debug),l$.H.setEnableWalletConnect(!1!==e.enableWalletConnect),l$.H.setEnableWalletGuide(!1!==e.enableWalletGuide),l$.H.setEnableWallets(!1!==e.enableWallets),l$.H.setEIP6963Enabled(!1!==e.enableEIP6963),l$.H.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),l$.H.setEnableAuthLogger(!1!==e.enableAuthLogger),l$.H.setCustomRpcUrls(e.customRpcUrls),l$.H.setSdkVersion(e.sdkVersion),l$.H.setProjectId(e.projectId),l$.H.setEnableEmbedded(e.enableEmbedded),l$.H.setAllWallets(e.allWallets),l$.H.setIncludeWalletIds(e.includeWalletIds),l$.H.setExcludeWalletIds(e.excludeWalletIds),l$.H.setFeaturedWalletIds(e.featuredWalletIds),l$.H.setTokens(e.tokens),l$.H.setTermsConditionsUrl(e.termsConditionsUrl),l$.H.setPrivacyPolicyUrl(e.privacyPolicyUrl),l$.H.setCustomWallets(e.customWallets),l$.H.setFeatures(e.features),l$.H.setAllowUnsupportedChain(e.allowUnsupportedChain),l$.H.setDefaultAccountTypes(e.defaultAccountTypes),l$.H.setUniversalProviderConfigOverride(e.universalProviderConfigOverride);let t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),l$.H.setMetadata(e.metadata),l$.H.setDisableAppend(e.disableAppend),l$.H.setEnableEmbedded(e.enableEmbedded),l$.H.setSIWX(e.siwx),!e.projectId)return void l4.h.open(de.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");if(e.adapters?.find(e=>e.namespace===lB.o.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw Error("Cannot set both `siweConfig` and `siwx` options");l$.H.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return"undefined"!=typeof window&&"undefined"!=typeof document?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let i=da.getUnsupportedNetwork(`${t}:${e}`);lF.W.setActiveCaipNetwork(i)}}getDefaultNetwork(){return da.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return da.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return da.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){let t=e.networks.find(t=>t.id===e.defaultNetwork?.id);return t?da.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=lF.W.state.activeChain,t=this.getAdapter(e),i=this.getCaipNetwork(e)?.id;if(!t)throw Error("Adapter not found");let r=await t.connectWalletConnect(i);this.close(),this.setClientId(r?.clientId||null),lJ.i.setConnectedNamespaces([...lF.W.state.chains.keys()]),this.chainNamespaces.forEach(e=>{lL.a.setConnectorId(dr.o.CONNECTOR_TYPE_WALLET_CONNECT,e)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:i,provider:r,chain:s,caipNetwork:n})=>{let a=lF.W.state.activeChain,o=s||a,c=this.getAdapter(o);if(s&&s!==a&&!n){let e=this.caipNetworks?.find(e=>e.chainNamespace===s);e&&this.setCaipNetwork(e)}if(!c)throw Error("Adapter not found");let l=this.getCaipNetwork(o),d=await c.connect({id:e,info:t,type:i,provider:r,chainId:n?.id||l?.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]||l?.rpcUrls?.default?.http?.[0]});if(!d)return;lJ.i.addConnectedNamespace(o),this.syncProvider({...d,chainNamespace:o}),await this.syncAccount({...d,chainNamespace:o});let{accounts:h}=await c.getAccounts({namespace:o,id:e});this.setAllAccounts(h,o)},reconnectExternal:async({id:e,info:t,type:i,provider:r})=>{let s=lF.W.state.activeChain,n=this.getAdapter(s);n?.reconnect&&(await n?.reconnect({id:e,info:t,type:i,provider:r,chainId:this.getCaipNetwork()?.id}),lJ.i.addConnectedNamespace(s))},disconnect:async e=>{let t=e||lF.W.state.activeChain,i=this.getAdapter(t),r=du.getProvider(t),s=du.getProviderId(t);await i?.disconnect({provider:r,providerType:s}),lJ.i.removeConnectedNamespace(t),du.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.hasSwitchedToPreferredAccountTypeOnConnect=!1},checkInstalled:e=>e?e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum,signMessage:async e=>{let t=this.getAdapter(lF.W.state.activeChain),i=await t?.signMessage({message:e,address:lK.U.state.address,provider:du.getProvider(lF.W.state.activeChain)});return i?.signature||""},sendTransaction:async e=>{if(e.chainNamespace===lB.o.CHAIN.EVM){let t=this.getAdapter(lF.W.state.activeChain),i=du.getProvider(lF.W.state.activeChain),r=await t?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:i});return r?.hash||""}return""},estimateGas:async e=>{if(e.chainNamespace===lB.o.CHAIN.EVM){let t=this.getAdapter(lF.W.state.activeChain),i=du.getProvider(lF.W.state.activeChain),r=this.getCaipNetwork();if(!r)throw Error("CaipNetwork is undefined");let s=await t?.estimateGas({...e,provider:i,caipNetwork:r});return s?.gas||0n}return 0n},getEnsAvatar:async()=>{let e=this.getAdapter(lF.W.state.activeChain),t=await e?.getProfile({address:lK.U.state.address,chainId:Number(this.getCaipNetwork()?.id)});return t?.profileImage||!1},getEnsAddress:async e=>{let t=this.getAdapter(lF.W.state.activeChain),i=this.getCaipNetwork();if(!i)return!1;let r=await t?.getEnsAddress({name:e,caipNetwork:i});return r?.address||!1},writeContract:async e=>{let t=this.getAdapter(lF.W.state.activeChain),i=this.getCaipNetwork(),r=this.getCaipAddress(),s=du.getProvider(lF.W.state.activeChain);if(!i||!r)throw Error("CaipNetwork or CaipAddress is undefined");let n=await t?.writeContract({...e,caipNetwork:i,provider:s,caipAddress:r});return n?.hash},parseUnits:(e,t)=>{let i=this.getAdapter(lF.W.state.activeChain);return i?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let i=this.getAdapter(lF.W.state.activeChain);return i?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(lF.W.state.activeChain);return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(lF.W.state.activeChain);return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(lF.W.state.activeChain);return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(lF.W.state.activeChain);return await t?.walletGetAssets(e)??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},lq.x.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(du.getProviderId(lF.W.state.activeChain)===dr.o.CONNECTOR_TYPE_WALLET_CONNECT){let e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;let t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){let i=du.getProvider(t),r=du.getProviderId(t);if(e.chainNamespace===lF.W.state.activeChain){let s=this.getAdapter(t);await s?.switchNetwork({caipNetwork:e,provider:i,providerType:r})}else if(this.setCaipNetwork(e),r===dr.o.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let i=this.getAddressByChainNamespace(t);i&&this.syncAccount({address:i,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let{chainId:t,chainNamespace:i}=lH.parseCaipAddress(e);return`${i}:${t}`})])))}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,i)=>{let r=e?.find(e=>e.namespace===i);return r?(t[i]=r,t[i].namespace=i,t[i].construct({namespace:i,projectId:this.options?.projectId,networks:this.caipNetworks})):t[i]=new dN({namespace:i,networks:this.caipNetworks}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){let t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let t=this.getAdapter(e);if(!t)return;let i=lJ.i.getConnectionStatus();"connected"===i?this.setStatus("connecting",e):("disconnected"===i&&lJ.i.clearAddressCache(),this.setStatus(i,e)),t.on("switchNetwork",({address:t,chainId:i})=>{let r=this.caipNetworks?.find(e=>e.id===i||e.caipNetworkId===i),s=lF.W.state.activeChain===e,n=lF.W.getAccountProp("address",e);if(r){let r=s&&t?t:n;r&&this.syncAccount({address:r,chainId:i,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",()=>{let e=lK.U.state.address,t=lF.W.state.activeCaipNetwork;e&&t?.id&&this.updateNativeBalance(e,t.id,t.chainNamespace)}),t.on("accountChanged",({address:t,chainId:i})=>{let r=lF.W.state.activeChain===e;r&&i?this.syncAccount({address:t,chainId:i,chainNamespace:e}):r&&lF.W.state.activeCaipNetwork?.id?this.syncAccount({address:t,chainId:lF.W.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(t,i,e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{let t=lL.a.getConnectorId(e);switch(this.setStatus("connecting",e),t){case lB.o.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case lB.o.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){let t=this.getAdapter(e),i=lL.a.getConnectorId(e),r=this.getCaipNetwork(e),s=lL.a.getConnectors(e).find(e=>e.id===i);try{if(!t||!s)throw Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw Error("CaipNetwork not found");let i=await t?.syncConnection({namespace:e,id:s.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});if(i){let r=await t?.getAccounts({namespace:e,id:s.id});r&&r.accounts.length>0?this.setAllAccounts(r.accounts,e):this.setAllAccounts([lj.w.createAccount(e,i.address,"eoa")],e),this.syncProvider({...i,chainNamespace:e}),await this.syncAccount({...i,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch(t){this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){let e=this.chainNamespaces.map(async e=>{let t=this.getAdapter(e),i=this.universalProvider?.session?.namespaces?.[e]?.accounts||[],r=lF.W.state.activeCaipNetwork?.id,s=i.find(e=>{let{chainId:t}=lH.parseCaipAddress(e);return t===r?.toString()})||i[0];if(s){let i=lH.validateCaipAddress(s),{chainId:r,address:n}=lH.parseCaipAddress(i);if(du.setProviderId(e,dr.o.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&lF.W.state.activeCaipNetwork&&t?.namespace!==lB.o.CHAIN.EVM){let i=t?.getWalletConnectProvider({caipNetworks:this.caipNetworks,provider:this.universalProvider,activeCaipNetwork:lF.W.state.activeCaipNetwork});du.setProvider(e,i)}else du.setProvider(e,this.universalProvider);lL.a.setConnectorId(lB.o.CONNECTOR_ID.WALLET_CONNECT,e),lJ.i.addConnectedNamespace(e),this.syncWalletConnectAccounts(e),await this.syncAccount({address:n,chainId:r,chainNamespace:e})}else this.setStatus("disconnected",e);await lF.W.setApprovedCaipNetworksData(e)});await Promise.all(e)}syncWalletConnectAccounts(e){let t=this.universalProvider?.session?.namespaces?.[e]?.accounts?.map(e=>{let{address:t}=lH.parseCaipAddress(e);return t}).filter((e,t,i)=>i.indexOf(e)===t);t&&this.setAllAccounts(t.map(t=>lj.w.createAccount(e,t,"bip122"===e?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:i,chainNamespace:r}){du.setProviderId(r,e),du.setProvider(r,t),lL.a.setConnectorId(i,r)}async syncAccount(e){let t=e.chainNamespace===lF.W.state.activeChain,i=lF.W.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:r,chainId:s,chainNamespace:n}=e,{chainId:a}=lJ.i.getActiveNetworkProps(),o=s||a,c=lF.W.state.activeCaipNetwork?.name===lB.o.UNSUPPORTED_NETWORK_NAME,l=lF.W.getNetworkProp("supportsAllNetworks",n);if(this.setStatus("connected",n),(!c||l)&&o){let e=this.caipNetworks?.find(e=>e.id.toString()===o.toString()),s=this.caipNetworks?.find(e=>e.chainNamespace===n);if(!l&&!e&&!s){let t=this.getApprovedCaipNetworkIds()||[],i=t.find(e=>lH.parseCaipNetworkId(e)?.chainId===o.toString()),r=t.find(e=>lH.parseCaipNetworkId(e)?.chainNamespace===n);e=this.caipNetworks?.find(e=>e.caipNetworkId===i),s=this.caipNetworks?.find(e=>e.caipNetworkId===r||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===r)}let a=e||s;a?.chainNamespace===lF.W.state.activeChain?l$.H.state.enableNetworkSwitch&&!l$.H.state.allowUnsupportedChain&&lF.W.state.activeCaipNetwork?.name===lB.o.UNSUPPORTED_NETWORK_NAME?lF.W.showUnsupportedChainUI():this.setCaipNetwork(a):!t&&i&&this.setCaipNetworkOfNamespace(i,n),this.syncConnectedWalletInfo(n),dc.y.isLowerCaseMatch(r,lK.U.state.address)||this.syncAccountInfo(r,a?.id,n),t?await this.syncBalance({address:r,chainId:a?.id,chainNamespace:n}):await this.syncBalance({address:r,chainId:i?.id,chainNamespace:n})}}async syncAccountInfo(e,t,i){let r=this.getCaipAddress(i),s=t||r?.split(":")[1];if(!s)return;let n=`${i}:${s}:${e}`;this.setCaipAddress(n,i),await this.syncIdentity({address:e,chainId:s,chainNamespace:i})}async syncReownName(e,t){try{let i=await this.getReownName(e);if(i[0]){let e=i[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=lL.a.getConnectorId(e),i=du.getProviderId(e);if(i===dr.o.CONNECTOR_TYPE_ANNOUNCED||i===dr.o.CONNECTOR_TYPE_INJECTED){if(t){let i=this.getConnectors().find(e=>e.id===t);if(i){let{info:t,name:r,imageUrl:s}=i,n=s||this.getConnectorImage(i);this.setConnectedWalletInfo({name:r,icon:n,...t},e)}}}else if(i===dr.o.CONNECTOR_TYPE_WALLET_CONNECT){let t=du.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t)if(t===lB.o.CONNECTOR_ID.COINBASE){let t=this.getConnectors().find(e=>e.id===lB.o.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(t)},e)}else this.setConnectedWalletInfo({name:t},e)}async syncBalance(e){lW.L.getNetworksByNamespace(this.caipNetworks,e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString())&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,i){let r=this.getAdapter(i);if(r){let s=await r.getBalance({address:e,chainId:t,caipNetwork:this.getCaipNetwork(i),tokens:this.options.tokens});this.setBalance(s.balance,s.symbol,i)}}async initializeUniversalAdapter(){let e=dl.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};l$.H.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await lz.A.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{lq.x.setUri(e)}),this.universalProvider.on("connect",lq.x.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),lq.x.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{let t=this.caipNetworks?.find(t=>t.id==e),i=this.getCaipNetwork();if(!t)return void this.setUnsupportedNetwork(e);i?.id!==t?.id&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(d_.isSessionEventData(e)){let{name:t,data:i}=e.params.event;"accountsChanged"===t&&Array.isArray(i)&&lj.w.isCaipAddress(i[0])&&this.syncAccount(lH.parseCaipAddress(i[0]))}}))}createUniversalProvider(){return!this.universalProviderInitPromise&&lj.w.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){l3.E.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){let[t,i]=Object.entries(de.UniversalProviderErrors).find(([,{message:t}])=>e.message.includes(t))??[],{message:r,alertErrorKey:s}=i??{};if(t&&r&&!this.reportedAlertErrors[t]){let e=de.ALERT_ERRORS[s];e&&(l4.h.open(e,"error"),this.reportedAlertErrors[t]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;t&&(this.createClients(),e.namespace=t,e.construct({namespace:t,projectId:this.options?.projectId,networks:this.caipNetworks}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=e))}async open(e){await this.injectModalUi(),e?.uri&&lq.x.setUri(e.uri),await lG.W.open(e)}async close(){await this.injectModalUi(),lG.W.close()}setLoading(e,t){lG.W.setLoading(e,t)}async disconnect(e){await lq.x.disconnect(e)}getError(){return""}getChainId(){return lF.W.state.activeCaipNetwork?.id}async switchNetwork(e){let t=this.caipNetworks?.find(t=>t.id===e.id);if(!t)return void l4.h.open(de.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");await lF.W.switchActiveNetwork(t)}getWalletProvider(){return lF.W.state.activeChain?du.state.providers[lF.W.state.activeChain]:null}getWalletProviderType(){return du.getProviderId(lF.W.state.activeChain)}subscribeProviders(e){return du.subscribeProviders(e)}getThemeMode(){return l6.W.state.themeMode}getThemeVariables(){return l6.W.state.themeVariables}setThemeMode(e){l6.W.setThemeMode(e),(0,l7.JX)(l6.W.state.themeMode)}setTermsConditionsUrl(e){l$.H.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){l$.H.setPrivacyPolicyUrl(e)}setThemeVariables(e){l6.W.setThemeVariables(e),(0,l7.ds)(l6.W.state.themeVariables)}subscribeTheme(e){return l6.W.subscribe(e)}getWalletInfo(){return lK.U.state.connectedWalletInfo}getAccount(e){let t=lL.a.getAuthConnector(e),i=lF.W.getAccountData(e);if(i)return{allAccounts:i.allAccounts,caipAddress:i.caipAddress,address:lj.w.getPlainAddress(i.caipAddress),isConnected:!!i.caipAddress,status:i.status,embeddedWalletInfo:t?{user:i.user,authProvider:i.socialProvider||"email",accountType:i.preferredAccountType,isSmartAccountDeployed:!!i.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let i=()=>{let i=this.getAccount(t);i&&e(i)};t?lF.W.subscribeChainProp("accountState",i,t):lF.W.subscribe(i),lL.a.subscribe(i)}subscribeNetwork(e){return lF.W.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e){return lK.U.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){lK.U.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){lF.W.subscribeKey("activeCaipNetwork",e)}getState(){return l5.z.state}subscribeState(e){return l5.z.subscribe(e)}showErrorMessage(e){l8.P.showError(e)}showSuccessMessage(e){l8.P.showSuccess(e)}getEvent(){return{...l3.E.state}}subscribeEvents(e){return l3.E.subscribe(e)}replace(e){lZ.I.replace(e)}redirect(e){lZ.I.push(e)}popTransactionStack(e){lZ.I.popTransactionStack(e)}isOpen(){return lG.W.state.open}isTransactionStackEmpty(){return 0===lZ.I.state.transactionStack.length}isTransactionShouldReplaceView(){return lZ.I.state.transactionStack[lZ.I.state.transactionStack.length-1]?.replace}static getInstance(){return this.instance}updateFeatures(e){l$.H.setFeatures(e)}updateOptions(e){let t={...l$.H.state||{},...e};l$.H.setOptions(t)}setConnectMethodsOrder(e){l$.H.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){l$.H.setWalletFeaturesOrder(e)}setCollapseWallets(e){l$.H.setCollapseWallets(e)}setSocialsOrder(e){l$.H.setSocialsOrder(e)}getConnectMethodsOrder(){return l9.A.getConnectOrderMethod(l$.H.state.features,lL.a.getConnectors())}removeAdapter(e){let t=this.getIsConnectedState(),i=this.getAdapter(e);if(!i||!this.chainAdapters||t)return;let r=this.caipNetworks?.filter(t=>t.chainNamespace!==e);lF.W.removeAdapter(e),lL.a.removeAdapter(e),this.chainNamespaces=this.chainNamespaces.filter(t=>t!==e),this.caipNetworks=r,i.removeAllEventListeners(),Reflect.deleteProperty(this.chainAdapters,e)}addAdapter(e,t){let i=e.namespace;if(!this.connectionControllerClient||!this.networkControllerClient||!this.chainAdapters||!i)return;let r=this.extendCaipNetworks({...this.options,networks:t});this.caipNetworks=[...this.caipNetworks||[],...r],this.createAdapter(e),this.initChainAdapter(i),lF.W.addAdapter(e,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient},r)}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let i=this.extendCaipNetwork(t,this.options);lF.W.addNetwork(i),this.caipNetworks&&!this.caipNetworks?.find(e=>e.id===i.id)&&this.caipNetworks.push(i)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);if(!this.caipNetworks?.find(e=>e.id===t))throw Error(`Network with ID ${t} not found`);if(!this.caipNetworks)return;let i=this.caipNetworks.filter(i=>i.chainNamespace===e&&i.id!==t);if(!i?.length)throw Error("Cannot remove last network for a namespace");lF.W.removeNetwork(e,t),this.caipNetworks=[...i]}}let dx=!1;class dP extends dT{async open(e){lL.a.isConnected()||await super.open(e)}async close(){await super.close(),this.options.manualWCControl&&lq.x.finalizeWcConnection()}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!dx&&lj.w.isClient()){if(await Promise.all([i.e(6837),i.e(5792),i.e(5117)]).then(i.bind(i,65117)),await Promise.all([i.e(5792),i.e(2457)]).then(i.bind(i,69444)),!document.querySelector("w3m-modal")){let e=document.createElement("w3m-modal");l$.H.state.disableAppend||l$.H.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}dx=!0}}}class dO extends Error{constructor(){super(),Object.setPrototypeOf(this,dO.prototype)}}class dM extends Error{constructor(e){super(`WalletConnect Adapter - Method ${e} is not supported by the wallet`),this.name="WalletConnectFeatureNotSupportedError"}}let dR={mainnet:`You are using a deprecated chain ID for Solana Mainnet, please use ${h.Mainnet} instead.`,devnet:`You are using a deprecated chain ID for Solana Devnet, please use ${h.Devnet} instead.`,wallet:"The connected wallet is using a deprecated chain ID for Solana. Please, contact them to upgrade. You can learn more at https://github.com/ChainAgnostic/namespaces/blob/main/solana/caip10.md#chain-ids"};function dk(e,t){let i=e.namespaces.solana?.accounts.map(e=>`solana:${e.split(":")[1]}`);if(t===h.Mainnet)return i?.find(e=>e===h.Mainnet)?h.Mainnet:(console.warn(dR.wallet),h.Deprecated_Mainnet);if(t===h.Devnet)return i?.find(e=>e===h.Devnet)?h.Devnet:(console.warn(dR.wallet),h.Deprecated_Devnet);throw Error("WalletConnect Solana Adapter: Unable to get a default chain from the session.")}class dD extends Error{constructor(){super("QR Code Modal was closed by user"),Object.setPrototypeOf(this,dD.prototype),this.name="QRCodeModalError"}}var dU=i(29155).Buffer;class dL{_UniversalProvider;_session;_modal;_projectId;_network;_ConnectQueueResolver;constructor(e){if(this.initClient(e.options),this._network=e.network,!e.options.projectId)throw Error("WalletConnect Adapter: Project ID is undefined");this._projectId=e.options.projectId}async connect(){var e;let t;if(this._UniversalProvider||await new Promise(e=>{this._ConnectQueueResolver=e}),!this._UniversalProvider)throw Error("WalletConnect Adapter - Universal Provider was undefined while calling 'connect()'");if(this._UniversalProvider.session){this._session=this._UniversalProvider.session;let e=dk(this._session,this._network);return this._network=e,this._UniversalProvider.setDefaultChain(e),{publicKey:this.publicKey}}await this.initModal();let i={optionalNamespaces:{solana:{chains:(t=[e=this._network],e===h.Mainnet||e===h.Deprecated_Mainnet?(t=[h.Mainnet,h.Deprecated_Mainnet],e===h.Deprecated_Mainnet&&console.warn(dR.mainnet)):(e===h.Deprecated_Devnet||e===h.Devnet)&&(t=[h.Devnet,h.Deprecated_Devnet],h.Deprecated_Devnet&&console.warn(dR.devnet)),t),methods:[a.signTransaction,a.signMessage],events:[]}}};this._modal?.open();let r=new AbortController,s=r.signal;this._modal?.subscribeState(e=>{e.open||r.abort(new dD)});try{let e=await Promise.race([this._UniversalProvider?.connect(i),new Promise((e,t)=>{s.addEventListener("abort",()=>{t(s.reason)})})]);if(this._modal?.close(),this._session=e,!e)throw new l.Y6;let t=dk(e,this._network);return this._network=t,this._UniversalProvider?.setDefaultChain(t),{publicKey:this.publicKey}}catch(e){throw this._modal?.close(),e}}async disconnect(){if(this._UniversalProvider?.session){if(await this.initModal(),!this._modal)throw Error("WalletConnect Adapter -Modal is undefined: unable to disconnect");await this.client.disconnect(),this._session=void 0}else throw new dO}get client(){if(this._UniversalProvider)return this._UniversalProvider;throw new dO}get session(){if(!this._session)throw new dO;return this._session}get publicKey(){if(this._UniversalProvider?.session&&this._session){let{address:e}=ei(this._session?.namespaces.solana?.accounts[0]??"");return new p.J3(e)}throw new dO}async signTransaction(e){this.checkIfWalletSupportsMethod(a.signTransaction);let t=(0,u.Y)(e),i=t?{}:e,{signature:r,transaction:s}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:a.signTransaction,params:{...i,transaction:this.serialize(e)}}});return s?this.deserialize(s,t):(e.addSignature(this.publicKey,dU.from(dp.A.decode(r))),e)}async signMessage(e){this.checkIfWalletSupportsMethod(a.signMessage);let{signature:t}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:a.signMessage,params:{pubkey:this.publicKey.toString(),message:dp.A.encode(e)}}});return dp.A.decode(t)}async signAndSendTransaction(e){this.checkIfWalletSupportsMethod(a.signAndSendTransaction);let{signature:t}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:a.signAndSendTransaction,params:{transaction:this.serialize(e)}}});return t}async signAllTransactions(e){try{this.checkIfWalletSupportsMethod(a.signAllTransactions);let t=e.map(e=>this.serialize(e)),{transactions:i}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:a.signAllTransactions,params:{transactions:t}}});return e.map((e,t)=>(0,u.Y)(e)?this.deserialize(i[t]??"",!0):this.deserialize(i[t]??""))}catch(t){if(t instanceof dM){let t=e.map(e=>this.signTransaction(e));return await Promise.all(t)}throw t}}async initClient(e){let t=await lU.init(e);this._UniversalProvider=t,this._ConnectQueueResolver&&this._ConnectQueueResolver(!0)}async initModal(){if(!this._modal){if(!this._UniversalProvider)throw Error("WalletConnect Adapter - cannot init modal when Universal Provider is undefined");this._modal=new dP({...{projectId:this._projectId,universalProvider:this._UniversalProvider,networks:[dw,dv,dI],manualWCControl:!0},basic:!0,sdkVersion:"html-core-1.7.2"})}}serialize(e){return dU.from(e.serialize({verifySignatures:!1})).toString("base64")}deserialize(e,t=!1){return t?p.Kt.deserialize(dU.from(e,"base64")):p.ZX.from(dU.from(e,"base64"))}checkIfWalletSupportsMethod(e){if(!this.session.namespaces.solana?.methods.includes(e))throw new dM(e)}}class dq extends o.Kl{name="WalletConnect";url="https://walletconnect.org";icon="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+";supportedTransactionVersions=new Set(["legacy",0]);_publicKey;_connecting;_wallet;_config;_readyState;_onDisconnect;constructor(e){super(),this._publicKey=null,this._connecting=!1,this._config=e,this._wallet=null,this._readyState="undefined"==typeof window?c.Ok.Unsupported:c.Ok.Loadable,this._onDisconnect=this.disconnect.bind(this)}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==c.Ok.Loadable)throw new l.AE;this._connecting=!0,this._wallet=new dL({network:this._config.network===d.B.Mainnet?n.Mainnet:n.Devnet,options:this._config.options});let{publicKey:e}=await this._wallet.connect();this._publicKey=e,this.emit("connect",e),this._wallet.client.on("session_delete",this._onDisconnect)}catch(e){if("QRCodeModalError"===e.constructor.name||e instanceof Error&&"QRCodeModalError"===e.name)throw new l.KL;throw this._connecting=!1,e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){e.client.off("session_delete",this._onDisconnect),this._publicKey=null;try{e.client.session&&await e.disconnect()}catch(e){console.error("WalletConnectWalletAdapter: disconnect error",e),this.emit("error",new l.Y8(e?.message,e))}}this.emit("disconnect")}async signTransaction(e){try{let t=this._wallet;if(!t)throw new l.kW;try{return await t.signTransaction(e)}catch(e){throw new l.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new l.kW;try{return await t.signMessage(e)}catch(e){throw new l.K3(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAndSendTransaction(e){try{let t=this._wallet;if(!t)throw new l.kW;try{return await t.signAndSendTransaction(e)}catch(e){throw new l.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new l.kW;try{return await t.signAllTransactions(e)}catch(e){throw new l.z4(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},51605:(e,t,i)=>{"use strict";i.d(t,{oU:()=>n});var r=i(55036);let s=(void 0!==r&&void 0!==r.env?r.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",n={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:s,SECURE_SITE_DASHBOARD:`${s}/dashboard`,SECURE_SITE_FAVICON:`${s}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155","solana"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in a new browser tab"},DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}}},52749:(e,t,i)=>{"use strict";i.d(t,{y:()=>s});var r=i(65121);let s={getCaipTokens(e){if(!e)return;let t={};return Object.entries(e).forEach(([e,i])=>{t[`${r.o.EIP155}:${e}`]=i}),t},isLowerCaseMatch:(e,t)=>e?.toLowerCase()===t?.toLowerCase()}},55775:(e,t,i)=>{t.utils=i(56825),t.common=i(4645),t.sha=i(40274),t.ripemd=i(85147),t.hmac=i(73359),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160},56825:(e,t,i)=>{"use strict";var r=i(66560);function s(e){return(e>>>24|e>>>8&65280|e<<8&0xff0000|(255&e)<<24)>>>0}function n(e){return 1===e.length?"0"+e:e}function a(e){if(7===e.length)return"0"+e;if(6===e.length)return"00"+e;if(5===e.length)return"000"+e;if(4===e.length)return"0000"+e;if(3===e.length)return"00000"+e;else if(2===e.length)return"000000"+e;else if(1===e.length)return"0000000"+e;else return e}t.inherits=i(93973),t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e),s=0;s<e.length;s+=2)i.push(parseInt(e[s]+e[s+1],16))}else for(var r=0,s=0;s<e.length;s++){var n,a,o=e.charCodeAt(s);o<128?i[r++]=o:(o<2048?i[r++]=o>>6|192:((n=e,a=s,(64512&n.charCodeAt(a))!=55296||a<0||a+1>=n.length?1:(64512&n.charCodeAt(a+1))!=56320)?i[r++]=o>>12|224:(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++s)),i[r++]=o>>18|240,i[r++]=o>>12&63|128),i[r++]=o>>6&63|128),i[r++]=63&o|128)}else for(s=0;s<e.length;s++)i[s]=0|e[s];return i},t.toHex=function(e){for(var t="",i=0;i<e.length;i++)t+=n(e[i].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var i="",r=0;r<e.length;r++){var n=e[r];"little"===t&&(n=s(n)),i+=a(n.toString(16))}return i},t.zero2=n,t.zero8=a,t.join32=function(e,t,i,s){var n,a=i-t;r(a%4==0);for(var o=Array(a/4),c=0,l=t;c<o.length;c++,l+=4)n="big"===s?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],o[c]=n>>>0;return o},t.split32=function(e,t){for(var i=Array(4*e.length),r=0,s=0;r<e.length;r++,s+=4){var n=e[r];"big"===t?(i[s]=n>>>24,i[s+1]=n>>>16&255,i[s+2]=n>>>8&255,i[s+3]=255&n):(i[s+3]=n>>>24,i[s+2]=n>>>16&255,i[s+1]=n>>>8&255,i[s]=255&n)}return i},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,i){return e+t+i>>>0},t.sum32_4=function(e,t,i,r){return e+t+i+r>>>0},t.sum32_5=function(e,t,i,r,s){return e+t+i+r+s>>>0},t.sum64=function(e,t,i,r){var s=e[t],n=r+e[t+1]>>>0;e[t]=+(n<r)+i+s>>>0,e[t+1]=n},t.sum64_hi=function(e,t,i,r){return+(t+r>>>0<t)+e+i>>>0},t.sum64_lo=function(e,t,i,r){return t+r>>>0},t.sum64_4_hi=function(e,t,i,r,s,n,a,o){var c,l=t;return e+i+s+a+(c=0+ +((l=l+r>>>0)<t)+ +((l=l+n>>>0)<n)+ +((l=l+o>>>0)<o))>>>0},t.sum64_4_lo=function(e,t,i,r,s,n,a,o){return t+r+n+o>>>0},t.sum64_5_hi=function(e,t,i,r,s,n,a,o,c,l){var d,h=t;return e+i+s+a+c+(d=0+ +((h=h+r>>>0)<t)+ +((h=h+n>>>0)<n)+ +((h=h+o>>>0)<o)+ +((h=h+l>>>0)<l))>>>0},t.sum64_5_lo=function(e,t,i,r,s,n,a,o,c,l){return t+r+n+o+l>>>0},t.rotr64_hi=function(e,t,i){return(t<<32-i|e>>>i)>>>0},t.rotr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0},t.shr64_hi=function(e,t,i){return e>>>i},t.shr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0}},58267:(e,t,i)=>{"use strict";i.d(t,{Vl:()=>s});var r=i(55036);void 0!==r&&void 0!==r.env&&r.env.NEXT_PUBLIC_SECURE_SITE_SDK_URL,void 0!==r&&void 0!==r.env&&r.env.NEXT_PUBLIC_DEFAULT_LOG_LEVEL,void 0!==r&&void 0!==r.env&&r.env.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION;let s={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}}},59176:(e,t,i)=>{"use strict";var r=i(56825),s=i(4645),n=i(10974),a=i(66560),o=r.sum32,c=r.sum32_4,l=r.sum32_5,d=n.ch32,h=n.maj32,u=n.s0_256,p=n.s1_256,f=n.g0_256,g=n.g1_256,y=s.BlockHash,m=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2];function b(){if(!(this instanceof b))return new b;y.call(this),this.h=[0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19],this.k=m,this.W=Array(64)}r.inherits(b,y),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var i=this.W,r=0;r<16;r++)i[r]=e[t+r];for(;r<i.length;r++)i[r]=c(g(i[r-2]),i[r-7],f(i[r-15]),i[r-16]);var s=this.h[0],n=this.h[1],y=this.h[2],m=this.h[3],b=this.h[4],w=this.h[5],v=this.h[6],I=this.h[7];for(a(this.k.length===i.length),r=0;r<i.length;r++){var E=l(I,p(b),d(b,w,v),this.k[r],i[r]),_=o(u(s),h(s,n,y));I=v,v=w,w=b,b=o(m,E),m=y,y=n,n=s,s=o(E,_)}this.h[0]=o(this.h[0],s),this.h[1]=o(this.h[1],n),this.h[2]=o(this.h[2],y),this.h[3]=o(this.h[3],m),this.h[4]=o(this.h[4],b),this.h[5]=o(this.h[5],w),this.h[6]=o(this.h[6],v),this.h[7]=o(this.h[7],I)},b.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},60564:(e,t,i)=>{"use strict";var r=i(18835),s=i(2289).assert;function n(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=n,n.fromPublic=function(e,t,i){return t instanceof n?t:new n(e,{pub:t,pubEnc:i})},n.fromPrivate=function(e,t,i){return t instanceof n?t:new n(e,{priv:t,privEnc:i})},n.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},n.prototype.getPublic=function(e,t){return("string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t)?this.pub.encode(t,e):this.pub},n.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},n.prototype._importPrivate=function(e,t){this.priv=new r(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},n.prototype._importPublic=function(e,t){if(e.x||e.y){"mont"===this.ec.curve.type?s(e.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&s(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)},n.prototype.derive=function(e){return e.validate()||s(e.validate(),"public point not validated"),e.mul(this.priv).getX()},n.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)},n.prototype.verify=function(e,t,i){return this.ec.verify(e,t,this,void 0,i)},n.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},64112:e=>{"use strict";e.exports={rE:"6.6.1"}},64606:(e,t,i)=>{"use strict";i.d(t,{g:()=>p});var r=i(3046),s=i(75808),n=i(5001),a=i(14572),o=i(91019),c=i(95954),l=i(63),d=i(1221),h=i(52749),u=i(2010);let p={getConnectorsByType(e,t,i){let{customWallets:r}=s.H.state,a=n.i.getRecentWallets(),o=u.A.filterOutDuplicateWallets(t),c=u.A.filterOutDuplicateWallets(i),l=e.filter(e=>"MULTI_CHAIN"===e.type),d=e.filter(e=>"ANNOUNCED"===e.type),h=e.filter(e=>"INJECTED"===e.type);return{custom:r,recent:a,external:e.filter(e=>"EXTERNAL"===e.type),multiChain:l,announced:d,injected:h,recommended:o,featured:c}},showConnector(e){let t=e.info?.rdns,i=!!t&&a.N.state.excludedWallets.some(e=>e.rdns===t),r=!!e.name&&a.N.state.excludedWallets.some(t=>h.y.isLowerCaseMatch(t.name,e.name));return("INJECTED"!==e.type||(!!o.w.isMobile()||"Browser Wallet"!==e.name)&&(!!t||!!c.x.checkInstalled())&&!i&&!r)&&("ANNOUNCED"!==e.type||!i&&!r)},getIsConnectedWithWC:()=>Array.from(l.W.state.chains.values()).some(e=>d.a.getConnectorId(e.namespace)===r.o.CONNECTOR_ID.WALLET_CONNECT),getConnectorTypeOrder({recommended:e,featured:t,custom:i,recent:r,announced:n,injected:a,multiChain:o,external:c,overriddenConnectors:l=s.H.state.features?.connectorTypeOrder??[]}){let d=p.getIsConnectedWithWC(),h=[{type:"walletConnect",isEnabled:s.H.state.enableWalletConnect&&!d},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...a,...n,...o].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:i&&i.length>0},{type:"external",isEnabled:c.length>0},{type:"recommended",isEnabled:e.length>0}].filter(e=>e.isEnabled),u=new Set(h.map(e=>e.type)),f=l.filter(e=>u.has(e)).map(e=>({type:e,isEnabled:!0})),g=h.filter(({type:e})=>!f.some(({type:t})=>t===e));return Array.from(new Set([...f,...g].map(({type:e})=>e)))}}},65121:(e,t,i)=>{"use strict";i.d(t,{o:()=>r});let r={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"}},66038:(e,t,i)=>{"use strict";function r(e,t){return"light"===t?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}i.d(t,{o:()=>r})},66560:e=>{function t(e,t){if(!e)throw Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,i){if(e!=t)throw Error(i||"Assertion failed: "+e+" != "+t)}},68374:(e,t,i)=>{"use strict";var r=i(56825),s=i(4645),n=i(10974),a=r.rotl32,o=r.sum32,c=r.sum32_5,l=n.ft_1,d=s.BlockHash,h=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6];function u(){if(!(this instanceof u))return new u;d.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.W=Array(80)}r.inherits(u,d),e.exports=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(e,t){for(var i=this.W,r=0;r<16;r++)i[r]=e[t+r];for(;r<i.length;r++)i[r]=a(i[r-3]^i[r-8]^i[r-14]^i[r-16],1);var s=this.h[0],n=this.h[1],d=this.h[2],u=this.h[3],p=this.h[4];for(r=0;r<i.length;r++){var f=~~(r/20),g=c(a(s,5),l(f,n,d,u),p,i[r],h[f]);p=u,u=d,d=a(n,30),n=s,s=g}this.h[0]=o(this.h[0],s),this.h[1]=o(this.h[1],n),this.h[2]=o(this.h[2],d),this.h[3]=o(this.h[3],u),this.h[4]=o(this.h[4],p)},u.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},69386:(e,t,i)=>{"use strict";i.d(t,{h:()=>o});var r=i(41179),s=i(74801),n=i(75808);let a=(0,r.BX)({message:"",variant:"info",open:!1}),o={state:a,subscribeKey:(e,t)=>(0,s.u$)(a,e,t),open(e,t){let{debug:i}=n.H.state,{shortMessage:r,longMessage:s}=e;i&&(a.message=r,a.variant=t,a.open=!0),s&&console.error("function"==typeof s?s():s)},close(){a.open=!1,a.message="",a.variant="info"}}},72597:(e,t,i)=>{"use strict";var r=i(56825),s=i(4645),n=i(66560),a=r.rotr64_hi,o=r.rotr64_lo,c=r.shr64_hi,l=r.shr64_lo,d=r.sum64,h=r.sum64_hi,u=r.sum64_lo,p=r.sum64_4_hi,f=r.sum64_4_lo,g=r.sum64_5_hi,y=r.sum64_5_lo,m=s.BlockHash,b=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function w(){if(!(this instanceof w))return new w;m.call(this),this.h=[0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179],this.k=b,this.W=Array(160)}r.inherits(w,m),e.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var i=this.W,r=0;r<32;r++)i[r]=e[t+r];for(;r<i.length;r+=2){var s=function(e,t){var i=a(e,t,19)^a(t,e,29)^c(e,t,6);return i<0&&(i+=0x100000000),i}(i[r-4],i[r-3]),n=function(e,t){var i=o(e,t,19)^o(t,e,29)^l(e,t,6);return i<0&&(i+=0x100000000),i}(i[r-4],i[r-3]),d=i[r-14],h=i[r-13],u=function(e,t){var i=a(e,t,1)^a(e,t,8)^c(e,t,7);return i<0&&(i+=0x100000000),i}(i[r-30],i[r-29]),g=function(e,t){var i=o(e,t,1)^o(e,t,8)^l(e,t,7);return i<0&&(i+=0x100000000),i}(i[r-30],i[r-29]),y=i[r-32],m=i[r-31];i[r]=p(s,n,d,h,u,g,y,m),i[r+1]=f(s,n,d,h,u,g,y,m)}},w.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,r=this.h[0],s=this.h[1],c=this.h[2],l=this.h[3],p=this.h[4],f=this.h[5],m=this.h[6],b=this.h[7],w=this.h[8],v=this.h[9],I=this.h[10],E=this.h[11],_=this.h[12],C=this.h[13],A=this.h[14],S=this.h[15];n(this.k.length===i.length);for(var N=0;N<i.length;N+=2){var T=A,x=S,P=function(e,t){var i=a(e,t,14)^a(e,t,18)^a(t,e,9);return i<0&&(i+=0x100000000),i}(w,v),O=function(e,t){var i=o(e,t,14)^o(e,t,18)^o(t,e,9);return i<0&&(i+=0x100000000),i}(w,v),M=function(e,t,i,r,s){var n=e&i^~e&s;return n<0&&(n+=0x100000000),n}(w,0,I,0,_,C),R=function(e,t,i,r,s,n){var a=t&r^~t&n;return a<0&&(a+=0x100000000),a}(0,v,0,E,0,C),k=this.k[N],D=this.k[N+1],U=i[N],L=i[N+1],q=g(T,x,P,O,M,R,k,D,U,L),j=y(T,x,P,O,M,R,k,D,U,L);T=function(e,t){var i=a(e,t,28)^a(t,e,2)^a(t,e,7);return i<0&&(i+=0x100000000),i}(r,s),x=function(e,t){var i=o(e,t,28)^o(t,e,2)^o(t,e,7);return i<0&&(i+=0x100000000),i}(r,s);var $=h(T,x,P=function(e,t,i,r,s){var n=e&i^e&s^i&s;return n<0&&(n+=0x100000000),n}(r,0,c,0,p,f),O=function(e,t,i,r,s,n){var a=t&r^t&n^r&n;return a<0&&(a+=0x100000000),a}(0,s,0,l,0,f)),z=u(T,x,P,O);A=_,S=C,_=I,C=E,I=w,E=v,w=h(m,b,q,j),v=u(b,b,q,j),m=p,b=f,p=c,f=l,c=r,l=s,r=h(q,j,$,z),s=u(q,j,$,z)}d(this.h,0,r,s),d(this.h,2,c,l),d(this.h,4,p,f),d(this.h,6,m,b),d(this.h,8,w,v),d(this.h,10,I,E),d(this.h,12,_,C),d(this.h,14,A,S)},w.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},73359:(e,t,i)=>{"use strict";var r=i(56825),s=i(66560);function n(e,t,i){if(!(this instanceof n))return new n(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,i))}e.exports=n,n.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),s(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(t=0,this.inner=new this.Hash().update(e);t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},n.prototype.update=function(e,t){return this.inner.update(e,t),this},n.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},75808:(e,t,i)=>{"use strict";i.d(t,{H:()=>l});var r=i(41179),s=i(74801),n=i(51605),a=i(91019);let o={getFeatureValue(e,t){let i=t?.[e];return void 0===i?n.oU.DEFAULT_FEATURES[e]:i},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(a.w.isTelegram()){if(a.w.isIos())return e.filter(e=>"google"!==e);if(a.w.isMac())return e.filter(e=>"x"!==e);if(a.w.isAndroid())return e.filter(e=>!["facebook","x"].includes(e))}return e}},c=(0,r.BX)({features:n.oU.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:n.oU.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0}),l={state:c,subscribeKey:(e,t)=>(0,s.u$)(c,e,t),setOptions(e){Object.assign(c,e)},setFeatures(e){if(!e)return;c.features||(c.features=n.oU.DEFAULT_FEATURES);let t={...c.features,...e};c.features=t,c.features.socials&&(c.features.socials=o.filterSocialsByPlatform(c.features.socials))},setProjectId(e){c.projectId=e},setCustomRpcUrls(e){c.customRpcUrls=e},setAllWallets(e){c.allWallets=e},setIncludeWalletIds(e){c.includeWalletIds=e},setExcludeWalletIds(e){c.excludeWalletIds=e},setFeaturedWalletIds(e){c.featuredWalletIds=e},setTokens(e){c.tokens=e},setTermsConditionsUrl(e){c.termsConditionsUrl=e},setPrivacyPolicyUrl(e){c.privacyPolicyUrl=e},setCustomWallets(e){c.customWallets=e},setIsSiweEnabled(e){c.isSiweEnabled=e},setIsUniversalProvider(e){c.isUniversalProvider=e},setSdkVersion(e){c.sdkVersion=e},setMetadata(e){c.metadata=e},setDisableAppend(e){c.disableAppend=e},setEIP6963Enabled(e){c.enableEIP6963=e},setDebug(e){c.debug=e},setEnableWalletConnect(e){c.enableWalletConnect=e},setEnableWalletGuide(e){c.enableWalletGuide=e},setEnableAuthLogger(e){c.enableAuthLogger=e},setEnableWallets(e){c.enableWallets=e},setHasMultipleAddresses(e){c.hasMultipleAddresses=e},setSIWX(e){c.siwx=e},setConnectMethodsOrder(e){c.features={...c.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){c.features={...c.features,walletFeaturesOrder:e}},setSocialsOrder(e){c.features={...c.features,socials:e}},setCollapseWallets(e){c.features={...c.features,collapseWallets:e}},setEnableEmbedded(e){c.enableEmbedded=e},setAllowUnsupportedChain(e){c.allowUnsupportedChain=e},setManualWCControl(e){c.manualWCControl=e},setEnableNetworkSwitch(e){c.enableNetworkSwitch=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([e,t])=>{t&&(c.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(e){c.universalProviderConfigOverride=e},getUniversalProviderConfigOverride:()=>c.universalProviderConfigOverride,getSnapshot:()=>(0,r.P9)(c)}},76626:(e,t,i)=>{"use strict";var r=i(18835),s=i(93973),n=i(33589),a=i(2289);function o(e){n.call(this,"mont",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,i){n.BasePoint.call(this,e,"projective"),null===t&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(t,16),this.z=new r(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(o,n),e.exports=o,o.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),r=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},s(c,n.BasePoint),o.prototype.decodePoint=function(e,t){return this.point(a.toArray(e,t),1)},o.prototype.point=function(e,t){return new c(this,e,t)},o.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),i=e.redSub(t),r=e.redMul(t),s=i.redMul(t.redAdd(this.curve.a24.redMul(i)));return this.curve.point(r,s)},c.prototype.add=function(){throw Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),r=this.x.redSub(this.z),s=e.x.redAdd(e.z),n=e.x.redSub(e.z).redMul(i),a=s.redMul(r),o=t.z.redMul(n.redAdd(a).redSqr()),c=t.x.redMul(n.redISub(a).redSqr());return this.curve.point(o,c)},c.prototype.mul=function(e){for(var t=e.clone(),i=this,r=this.curve.point(null,null),s=[];0!==t.cmpn(0);t.iushrn(1))s.push(t.andln(1));for(var n=s.length-1;n>=0;n--)0===s[n]?(i=i.diffAdd(r,this),r=r.dbl()):(r=i.diffAdd(r,this),i=i.dbl());return r},c.prototype.mulAdd=function(){throw Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},77367:(e,t,i)=>{e=i.nmd(e);var r,s,n="__lodash_hash_undefined__",a="[object Arguments]",o="[object Array]",c="[object Boolean]",l="[object Date]",d="[object Error]",h="[object Function]",u="[object Map]",p="[object Number]",f="[object Object]",g="[object Promise]",y="[object RegExp]",m="[object Set]",b="[object String]",w="[object WeakMap]",v="[object ArrayBuffer]",I="[object DataView]",E=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,C={};C["[object Float32Array]"]=C["[object Float64Array]"]=C["[object Int8Array]"]=C["[object Int16Array]"]=C["[object Int32Array]"]=C["[object Uint8Array]"]=C["[object Uint8ClampedArray]"]=C["[object Uint16Array]"]=C["[object Uint32Array]"]=!0,C[a]=C[o]=C[v]=C[c]=C[I]=C[l]=C[d]=C[h]=C[u]=C[p]=C[f]=C[y]=C[m]=C[b]=C[w]=!1;var A="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,S="object"==typeof self&&self&&self.Object===Object&&self,N=A||S||Function("return this")(),T=t&&!t.nodeType&&t,x=T&&e&&!e.nodeType&&e,P=x&&x.exports===T,O=P&&A.process,M=function(){try{return O&&O.binding&&O.binding("util")}catch(e){}}(),R=M&&M.isTypedArray;function k(e){var t=-1,i=Array(e.size);return e.forEach(function(e,r){i[++t]=[r,e]}),i}function D(e){var t=-1,i=Array(e.size);return e.forEach(function(e){i[++t]=e}),i}var U=Array.prototype,L=Function.prototype,q=Object.prototype,j=N["__core-js_shared__"],$=L.toString,z=q.hasOwnProperty,B=function(){var e=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),H=q.toString,W=RegExp("^"+$.call(z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),F=P?N.Buffer:void 0,V=N.Symbol,K=N.Uint8Array,G=q.propertyIsEnumerable,J=U.splice,Y=V?V.toStringTag:void 0,Q=Object.getOwnPropertySymbols,X=F?F.isBuffer:void 0,Z=(r=Object.keys,s=Object,function(e){return r(s(e))}),ee=eC(N,"DataView"),et=eC(N,"Map"),ei=eC(N,"Promise"),er=eC(N,"Set"),es=eC(N,"WeakMap"),en=eC(Object,"create"),ea=eN(ee),eo=eN(et),ec=eN(ei),el=eN(er),ed=eN(es),eh=V?V.prototype:void 0,eu=eh?eh.valueOf:void 0;function ep(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function ef(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function eg(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var r=e[t];this.set(r[0],r[1])}}function ey(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new eg;++t<i;)this.add(e[t])}function em(e){var t=this.__data__=new ef(e);this.size=t.size}function eb(e,t){for(var i=e.length;i--;)if(eT(e[i][0],t))return i;return -1}function ew(e){var t;return null==e?void 0===e?"[object Undefined]":"[object Null]":Y&&Y in Object(e)?function(e){var t=z.call(e,Y),i=e[Y];try{e[Y]=void 0;var r=!0}catch(e){}var s=H.call(e);return r&&(t?e[Y]=i:delete e[Y]),s}(e):(t=e,H.call(t))}function ev(e){return eD(e)&&ew(e)==a}function eI(e,t,i,r,s,n){var a=1&i,o=e.length,c=t.length;if(o!=c&&!(a&&c>o))return!1;var l=n.get(e);if(l&&n.get(t))return l==t;var d=-1,h=!0,u=2&i?new ey:void 0;for(n.set(e,t),n.set(t,e);++d<o;){var p=e[d],f=t[d];if(r)var g=a?r(f,p,d,t,e,n):r(p,f,d,e,t,n);if(void 0!==g){if(g)continue;h=!1;break}if(u){if(!function(e,t){for(var i=-1,r=null==e?0:e.length;++i<r;)if(t(e[i],i,e))return!0;return!1}(t,function(e,t){if(!u.has(t)&&(p===e||s(p,e,i,r,n)))return u.push(t)})){h=!1;break}}else if(!(p===f||s(p,f,i,r,n))){h=!1;break}}return n.delete(e),n.delete(t),h}function eE(e){var t;return t=eL(e),eP(e)?t:function(e,t){for(var i=-1,r=t.length,s=e.length;++i<r;)e[s+i]=t[i];return e}(t,eA(e))}function e_(e,t){var i,r,s=e.__data__;return("string"==(r=typeof(i=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?s["string"==typeof t?"string":"hash"]:s.map}function eC(e,t){var i,r=null==e?void 0:e[t];return!(!ek(r)||(i=r,B&&B in i))&&(eM(r)?W:E).test(eN(r))?r:void 0}ep.prototype.clear=function(){this.__data__=en?en(null):{},this.size=0},ep.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},ep.prototype.get=function(e){var t=this.__data__;if(en){var i=t[e];return i===n?void 0:i}return z.call(t,e)?t[e]:void 0},ep.prototype.has=function(e){var t=this.__data__;return en?void 0!==t[e]:z.call(t,e)},ep.prototype.set=function(e,t){var i=this.__data__;return this.size+=+!this.has(e),i[e]=en&&void 0===t?n:t,this},ef.prototype.clear=function(){this.__data__=[],this.size=0},ef.prototype.delete=function(e){var t=this.__data__,i=eb(t,e);return!(i<0)&&(i==t.length-1?t.pop():J.call(t,i,1),--this.size,!0)},ef.prototype.get=function(e){var t=this.__data__,i=eb(t,e);return i<0?void 0:t[i][1]},ef.prototype.has=function(e){return eb(this.__data__,e)>-1},ef.prototype.set=function(e,t){var i=this.__data__,r=eb(i,e);return r<0?(++this.size,i.push([e,t])):i[r][1]=t,this},eg.prototype.clear=function(){this.size=0,this.__data__={hash:new ep,map:new(et||ef),string:new ep}},eg.prototype.delete=function(e){var t=e_(this,e).delete(e);return this.size-=!!t,t},eg.prototype.get=function(e){return e_(this,e).get(e)},eg.prototype.has=function(e){return e_(this,e).has(e)},eg.prototype.set=function(e,t){var i=e_(this,e),r=i.size;return i.set(e,t),this.size+=+(i.size!=r),this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,n),this},ey.prototype.has=function(e){return this.__data__.has(e)},em.prototype.clear=function(){this.__data__=new ef,this.size=0},em.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},em.prototype.get=function(e){return this.__data__.get(e)},em.prototype.has=function(e){return this.__data__.has(e)},em.prototype.set=function(e,t){var i=this.__data__;if(i instanceof ef){var r=i.__data__;if(!et||r.length<199)return r.push([e,t]),this.size=++i.size,this;i=this.__data__=new eg(r)}return i.set(e,t),this.size=i.size,this};var eA=Q?function(e){return null==e?[]:function(e,t){for(var i=-1,r=null==e?0:e.length,s=0,n=[];++i<r;){var a=e[i];t(a,i,e)&&(n[s++]=a)}return n}(Q(e=Object(e)),function(t){return G.call(e,t)})}:function(){return[]},eS=ew;function eN(e){if(null!=e){try{return $.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eT(e,t){return e===t||e!=e&&t!=t}(ee&&eS(new ee(new ArrayBuffer(1)))!=I||et&&eS(new et)!=u||ei&&eS(ei.resolve())!=g||er&&eS(new er)!=m||es&&eS(new es)!=w)&&(eS=function(e){var t=ew(e),i=t==f?e.constructor:void 0,r=i?eN(i):"";if(r)switch(r){case ea:return I;case eo:return u;case ec:return g;case el:return m;case ed:return w}return t});var ex=ev(function(){return arguments}())?ev:function(e){return eD(e)&&z.call(e,"callee")&&!G.call(e,"callee")},eP=Array.isArray,eO=X||function(){return!1};function eM(e){if(!ek(e))return!1;var t=ew(e);return t==h||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eR(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function ek(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eD(e){return null!=e&&"object"==typeof e}var eU=R?function(e){return R(e)}:function(e){return eD(e)&&eR(e.length)&&!!C[ew(e)]};function eL(e){return null!=e&&eR(e.length)&&!eM(e)?function(e,t){var i,r,s=eP(e),n=!s&&ex(e),a=!s&&!n&&eO(e),o=!s&&!n&&!a&&eU(e),c=s||n||a||o,l=c?function(e,t){for(var i=-1,r=Array(e);++i<e;)r[i]=t(i);return r}(e.length,String):[],d=l.length;for(var h in e){z.call(e,h)&&!(c&&("length"==h||a&&("offset"==h||"parent"==h)||o&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||(i=h,(r=null==(r=d)?0x1fffffffffffff:r)&&("number"==typeof i||_.test(i))&&i>-1&&i%1==0&&i<r)))&&l.push(h)}return l}(e):function(e){if(i=(t=e)&&t.constructor,t!==("function"==typeof i&&i.prototype||q))return Z(e);var t,i,r=[];for(var s in Object(e))z.call(e,s)&&"constructor"!=s&&r.push(s);return r}(e)}e.exports=function(e,t){return function e(t,i,r,s,n){return t===i||(null!=t&&null!=i&&(eD(t)||eD(i))?function(e,t,i,r,s,n){var h=eP(e),g=eP(t),w=h?o:eS(e),E=g?o:eS(t);w=w==a?f:w,E=E==a?f:E;var _=w==f,C=E==f,A=w==E;if(A&&eO(e)){if(!eO(t))return!1;h=!0,_=!1}if(A&&!_)return n||(n=new em),h||eU(e)?eI(e,t,i,r,s,n):function(e,t,i,r,s,n,a){switch(i){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case v:if(e.byteLength!=t.byteLength||!n(new K(e),new K(t)))break;return!0;case c:case l:case p:return eT(+e,+t);case d:return e.name==t.name&&e.message==t.message;case y:case b:return e==t+"";case u:var o=k;case m:var h=1&r;if(o||(o=D),e.size!=t.size&&!h)break;var f=a.get(e);if(f)return f==t;r|=2,a.set(e,t);var g=eI(o(e),o(t),r,s,n,a);return a.delete(e),g;case"[object Symbol]":if(eu)return eu.call(e)==eu.call(t)}return!1}(e,t,w,i,r,s,n);if(!(1&i)){var S=_&&z.call(e,"__wrapped__"),N=C&&z.call(t,"__wrapped__");if(S||N){var T=S?e.value():e,x=N?t.value():t;return n||(n=new em),s(T,x,i,r,n)}}return!!A&&(n||(n=new em),function(e,t,i,r,s,n){var a=1&i,o=eE(e),c=o.length;if(c!=eE(t).length&&!a)return!1;for(var l=c;l--;){var d=o[l];if(!(a?d in t:z.call(t,d)))return!1}var h=n.get(e);if(h&&n.get(t))return h==t;var u=!0;n.set(e,t),n.set(t,e);for(var p=a;++l<c;){var f=e[d=o[l]],g=t[d];if(r)var y=a?r(g,f,d,t,e,n):r(f,g,d,e,t,n);if(!(void 0===y?f===g||s(f,g,i,r,n):y)){u=!1;break}p||(p="constructor"==d)}if(u&&!p){var m=e.constructor,b=t.constructor;m!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b)&&(u=!1)}return n.delete(e),n.delete(t),u}(e,t,i,r,s,n))}(t,i,r,s,e,n):t!=t&&i!=i)}(e,t)}},77575:(e,t,i)=>{"use strict";i.d(t,{o:()=>s});var r=i(55036);let s={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(void 0!==r&&void 0!==r.env?r.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}}},79033:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},79237:(e,t,i)=>{"use strict";var r=i(56825),s=i(59176);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]}r.inherits(n,s),e.exports=n,n.blockSize=512,n.outSize=224,n.hmacStrength=192,n.padLength=64,n.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},85147:(e,t,i)=>{"use strict";var r=i(56825),s=i(4645),n=r.rotl32,a=r.sum32,o=r.sum32_3,c=r.sum32_4,l=s.BlockHash;function d(){if(!(this instanceof d))return new d;l.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.endian="little"}function h(e,t,i,r){return e<=15?t^i^r:e<=31?t&i|~t&r:e<=47?(t|~i)^r:e<=63?t&r|i&~r:t^(i|~r)}r.inherits(d,l),t.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(e,t){for(var i=this.h[0],r=this.h[1],s=this.h[2],l=this.h[3],d=this.h[4],y=i,m=r,b=s,w=l,v=d,I=0;I<80;I++){var E,_,C=a(n(c(i,h(I,r,s,l),e[u[I]+t],(E=I)<=15?0:E<=31?0x5a827999:E<=47?0x6ed9eba1:E<=63?0x8f1bbcdc:0xa953fd4e),f[I]),d);i=d,d=l,l=n(s,10),s=r,r=C,C=a(n(c(y,h(79-I,m,b,w),e[p[I]+t],(_=I)<=15?0x50a28be6:_<=31?0x5c4dd124:_<=47?0x6d703ef3:0x7a6d76e9*!!(_<=63)),g[I]),v),y=v,v=w,w=n(b,10),b=m,m=C}C=o(this.h[1],s,w),this.h[1]=o(this.h[2],l,v),this.h[2]=o(this.h[3],d,y),this.h[3]=o(this.h[4],i,m),this.h[4]=o(this.h[0],r,b),this.h[0]=C},d.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"little"):r.split32(this.h,"little")};var u=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},88055:(e,t,i)=>{"use strict";var r=i(2289),s=r.assert,n=r.parseBytes,a=r.cachedProperty;function o(e,t){this.eddsa=e,this._secret=n(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=n(t.pub)}o.fromPublic=function(e,t){return t instanceof o?t:new o(e,{pub:t})},o.fromSecret=function(e,t){return t instanceof o?t:new o(e,{secret:t})},o.prototype.secret=function(){return this._secret},a(o,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),a(o,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),a(o,"privBytes",function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[i]&=127,r[i]|=64,r}),a(o,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),a(o,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),a(o,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),o.prototype.sign=function(e){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},o.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},o.prototype.getSecret=function(e){return s(this._secret,"KeyPair is public only"),r.encode(this.secret(),e)},o.prototype.getPublic=function(e){return r.encode(this.pubBytes(),e)},e.exports=o},88253:(e,t,i)=>{"use strict";var r=i(18835),s=i(2289),n=s.assert;function a(e,t){if(e instanceof a)return e;this._importDER(e,t)||(n(e.r&&e.s,"Signature without r or s"),this.r=new r(e.r,16),this.s=new r(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function o(){this.place=0}function c(e,t){var i=e[t.place++];if(!(128&i))return i;var r=15&i;if(0===r||r>4||0===e[t.place])return!1;for(var s=0,n=0,a=t.place;n<r;n++,a++)s<<=8,s|=e[a],s>>>=0;return!(s<=127)&&(t.place=a,s)}function l(e){for(var t=0,i=e.length-1;!e[t]&&!(128&e[t+1])&&t<i;)t++;return 0===t?e:e.slice(t)}function d(e,t){if(t<128)return void e.push(t);var i=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|i);--i;)e.push(t>>>(i<<3)&255);e.push(t)}e.exports=a,a.prototype._importDER=function(e,t){e=s.toArray(e,t);var i=new o;if(48!==e[i.place++])return!1;var n=c(e,i);if(!1===n||n+i.place!==e.length||2!==e[i.place++])return!1;var a=c(e,i);if(!1===a||(128&e[i.place])!=0)return!1;var l=e.slice(i.place,a+i.place);if(i.place+=a,2!==e[i.place++])return!1;var d=c(e,i);if(!1===d||e.length!==d+i.place||(128&e[i.place])!=0)return!1;var h=e.slice(i.place,d+i.place);if(0===l[0])if(!(128&l[1]))return!1;else l=l.slice(1);if(0===h[0])if(!(128&h[1]))return!1;else h=h.slice(1);return this.r=new r(l),this.s=new r(h),this.recoveryParam=null,!0},a.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&i[0]&&(i=[0].concat(i)),t=l(t),i=l(i);!i[0]&&!(128&i[1]);)i=i.slice(1);var r=[2];d(r,t.length),(r=r.concat(t)).push(2),d(r,i.length);var n=r.concat(i),a=[48];return d(a,n.length),a=a.concat(n),s.encode(a,e)}},91019:(e,t,i)=>{"use strict";i.d(t,{w:()=>a});var r=i(3046),s=i(51605),n=i(5001);let a={isMobile(){return!!this.isClient()&&!!(window?.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},checkCaipNetwork:(e,t="")=>e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase()),isAndroid(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return a.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){return!!this.isClient()&&(window?.navigator.userAgent.toLowerCase()).includes("safari")},isClient:()=>"undefined"!=typeof window,isPairingExpired:e=>!e||e-Date.now()<=s.oU.TEN_SEC_MS,isAllowedRetry:(e,t=s.oU.ONE_SEC_MS)=>Date.now()-e>=t,copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch(e){return!1}},getPairingExpiry:()=>Date.now()+s.oU.FOUR_MINUTES_MS,getNetworkId:e=>e?.split(":")[1],getPlainAddress:e=>e?.split(":")[2],wait:async e=>new Promise(t=>{setTimeout(t,e)}),debounce(e,t=500){let i;return(...r)=>{i&&clearTimeout(i),i=setTimeout(function(){e(...r)},t)}},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),formatNativeUrl(e,t){if(a.isHttpUrl(e))return this.formatUniversalUrl(e,t);let i=e;i.includes("://")||(i=e.replaceAll("/","").replaceAll(":",""),i=`${i}://`),i.endsWith("/")||(i=`${i}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));let r=encodeURIComponent(t);return{redirect:`${i}wc?uri=${r}`,href:i}},formatUniversalUrl(e,t){if(!a.isHttpUrl(e))return this.formatNativeUrl(e,t);let i=e;i.endsWith("/")||(i=`${i}/`);let r=encodeURIComponent(t);return{redirect:`${i}wc?uri=${r}`,href:i}},getOpenTargetForPlatform(e){return"popupWindow"===e?e:this.isTelegram()?n.i.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,i){window?.open(e,this.getOpenTargetForPlatform(t),i||"noreferrer noopener")},returnOpenHref(e,t,i){return window?.open(e,this.getOpenTargetForPlatform(t),i||"noreferrer noopener")},isTelegram:()=>"undefined"!=typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto),preloadImage:async e=>Promise.race([new Promise((t,i)=>{let r=new Image;r.onload=t,r.onerror=i,r.crossOrigin="anonymous",r.src=e}),a.wait(2e3)]),formatBalance(e,t){let i="0.000";if("string"==typeof e){let t=Number(e);if(t){let e=Math.floor(1e3*t)/1e3;e&&(i=e.toString())}}return`${i}${t?` ${t}`:""}`},formatBalance2(e,t){let i;if("0"===e)i="0";else if("string"==typeof e){let t=Number(e);t&&(i=t.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:i??"0",rest:"0"===i?"000":"",symbol:t}},getApiUrl:()=>r.o.W3M_API_URL,getBlockchainApiUrl:()=>r.o.BLOCKCHAIN_API_RPC_URL,getAnalyticsUrl:()=>r.o.PULSE_API_URL,getUUID:()=>crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),parseError:e=>"string"==typeof e?e:"string"==typeof e?.issues?.[0]?.message?e.issues[0].message:e instanceof Error?e.message:"Unknown error",sortRequestedNetworks(e,t=[]){let i={};return t&&e&&(e.forEach((e,t)=>{i[e]=t}),t.sort((e,t)=>{let r=i[e.id],s=i[t.id];return void 0!==r&&void 0!==s?r-s:void 0!==r?-1:1*(void 0!==s)})),t},calculateBalance(e){let t=0;for(let i of e)t+=i.value??0;return t},formatTokenBalance(e){let[t,i]=e.toFixed(2).split(".");return{dollars:t,pennies:i}},isAddress(e,t="eip155"){switch(t){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||/^(?:0x)?[0-9A-F]{40}$/iu.test(e)))return!0;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){let i=new Set;return e.filter(e=>{let r=e[t];return!i.has(r)&&(i.add(r),!0)})},generateSdkVersion(e,t,i){let r=0===e.length?s.oU.ADAPTER_TYPES.UNIVERSAL:e.map(e=>e.adapterType).join(",");return`${t}-${r}-${i}`},createAccount:(e,t,i,r,s)=>({namespace:e,address:t,type:i,publicKey:r,path:s}),isCaipAddress(e){if("string"!=typeof e)return!1;let t=e.split(":"),i=t[0];return 3===t.filter(Boolean).length&&i in r.o.CHAIN_NAME_MAP},isMac(){let e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){let t=`--${encodeURIComponent(window?.location.href)}`,i="state=";if("auth.magic.link"===new URL(e).host){let r="provider_authorization_url=",s=e.substring(e.indexOf(r)+r.length),n=this.injectIntoUrl(decodeURIComponent(s),i,t);return e.replace(s,encodeURIComponent(n))}return this.injectIntoUrl(e,i,t)},injectIntoUrl(e,t,i){let r=e.indexOf(t);if(-1===r)throw Error(`${t} parameter not found in the URL: ${e}`);let s=e.indexOf("&",r),n=t.length,a=-1!==s?s:e.length,o=e.substring(0,r+n),c=e.substring(r+n,a);return o+(c+i)+e.substring(s)}}},93730:(e,t,i)=>{"use strict";var r=i(2289),s=i(18835),n=i(93973),a=i(33589),o=r.assert;function c(e){a.call(this,"short",e),this.a=new s(e.a,16).toRed(this.red),this.b=new s(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}function l(e,t,i,r){a.BasePoint.call(this,e,"affine"),null===t&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(t,16),this.y=new s(i,16),r&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function d(e,t,i,r){a.BasePoint.call(this,e,"jacobian"),null===t&&null===i&&null===r?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(t,16),this.y=new s(i,16),this.z=new s(r,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}n(c,a),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){if(e.beta)t=new s(e.beta,16).toRed(this.red);else{var t,i,r,n=this._getEndoRoots(this.p);t=(t=0>n[0].cmp(n[1])?n[0]:n[1]).toRed(this.red)}if(e.lambda)i=new s(e.lambda,16);else{var a=this._getEndoRoots(this.n);0===this.g.mul(a[0]).x.cmp(this.g.x.redMul(t))?i=a[0]:(i=a[1],o(0===this.g.mul(i).x.cmp(this.g.x.redMul(t))))}return r=e.basis?e.basis.map(function(e){return{a:new s(e.a,16),b:new s(e.b,16)}}):this._getEndoBasis(i),{beta:t,lambda:i,basis:r}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:s.mont(e),i=new s(2).toRed(t).redInvm(),r=i.redNeg(),n=new s(3).toRed(t).redNeg().redSqrt().redMul(i);return[r.redAdd(n).fromRed(),r.redSub(n).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,i,r,n,a,o,c,l,d,h=this.n.ushrn(Math.floor(this.n.bitLength()/2)),u=e,p=this.n.clone(),f=new s(1),g=new s(0),y=new s(0),m=new s(1),b=0;0!==u.cmpn(0);){var w=p.div(u);l=p.sub(w.mul(u)),d=y.sub(w.mul(f));var v=m.sub(w.mul(g));if(!r&&0>l.cmp(h))t=c.neg(),i=f,r=l.neg(),n=d;else if(r&&2==++b)break;c=l,p=u,u=l,y=f,f=d,m=g,g=v}a=l.neg(),o=d;var I=r.sqr().add(n.sqr());return a.sqr().add(o.sqr()).cmp(I)>=0&&(a=t,o=i),r.negative&&(r=r.neg(),n=n.neg()),a.negative&&(a=a.neg(),o=o.neg()),[{a:r,b:n},{a:a,b:o}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],r=t[1],s=r.b.mul(e).divRound(this.n),n=i.b.neg().mul(e).divRound(this.n),a=s.mul(i.a),o=n.mul(r.a),c=s.mul(i.b),l=n.mul(r.b);return{k1:e.sub(a).sub(o),k2:c.add(l).neg()}},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),r=i.redSqrt();if(0!==r.redSqr().redSub(i).cmp(this.zero))throw Error("invalid point");var n=r.fromRed().isOdd();return(t&&!n||!t&&n)&&(r=r.redNeg()),this.point(e,r)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,r=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===i.redSqr().redISub(s).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,i){for(var r=this._endoWnafT1,s=this._endoWnafT2,n=0;n<e.length;n++){var a=this._endoSplit(t[n]),o=e[n],c=o._getBeta();a.k1.negative&&(a.k1.ineg(),o=o.neg(!0)),a.k2.negative&&(a.k2.ineg(),c=c.neg(!0)),r[2*n]=o,r[2*n+1]=c,s[2*n]=a.k1,s[2*n+1]=a.k2}for(var l=this._wnafMulAdd(1,r,s,2*n,i),d=0;d<2*n;d++)r[d]=null,s[d]=null;return l},n(l,a.BasePoint),c.prototype.point=function(e,t,i){return new l(this,e,t,i)},c.prototype.pointFromJSON=function(e,t){return l.fromJSON(this,e,t)},l.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,r=function(e){return i.point(e.x.redMul(i.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},l.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},l.fromJSON=function(e,t,i){"string"==typeof t&&(t=JSON.parse(t));var r=e.point(t[0],t[1],i);if(!t[2])return r;function s(t){return e.point(t[0],t[1],i)}var n=t[2];return r.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[r].concat(n.doubles.points.map(s))},naf:n.naf&&{wnd:n.naf.wnd,points:[r].concat(n.naf.points.map(s))}},r},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return this.inf},l.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e)||0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,r)},l.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),r=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(r),n=s.redSqr().redISub(this.x.redAdd(this.x)),a=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,a)},l.prototype.getX=function(){return this.x.fromRed()},l.prototype.getY=function(){return this.y.fromRed()},l.prototype.mul=function(e){return(e=new s(e,16),this.isInfinity())?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,i){var r=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,s):this.curve._wnafMulAdd(1,r,s,2)},l.prototype.jmulAdd=function(e,t,i){var r=[this,t],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(r,s,!0):this.curve._wnafMulAdd(1,r,s,2,!0)},l.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},l.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(r)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(r)}}}return t},l.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},n(d,a.BasePoint),c.prototype.jpoint=function(e,t,i){return new d(this,e,t,i)},d.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(i,r)},d.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},d.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),r=this.x.redMul(t),s=e.x.redMul(i),n=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(i.redMul(this.z)),o=r.redSub(s),c=n.redSub(a);if(0===o.cmpn(0))if(0!==c.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var l=o.redSqr(),d=l.redMul(o),h=r.redMul(l),u=c.redSqr().redIAdd(d).redISub(h).redISub(h),p=c.redMul(h.redISub(u)).redISub(n.redMul(d)),f=this.z.redMul(e.z).redMul(o);return this.curve.jpoint(u,p,f)},d.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,r=e.x.redMul(t),s=this.y,n=e.y.redMul(t).redMul(this.z),a=i.redSub(r),o=s.redSub(n);if(0===a.cmpn(0))if(0!==o.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var c=a.redSqr(),l=c.redMul(a),d=i.redMul(c),h=o.redSqr().redIAdd(l).redISub(d).redISub(d),u=o.redMul(d.redISub(h)).redISub(s.redMul(l)),p=this.z.redMul(a);return this.curve.jpoint(h,u,p)},d.prototype.dblp=function(e){if(0===e||this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t,i=this;for(t=0;t<e;t++)i=i.dbl();return i}var r=this.curve.a,s=this.curve.tinv,n=this.x,a=this.y,o=this.z,c=o.redSqr().redSqr(),l=a.redAdd(a);for(t=0;t<e;t++){var d=n.redSqr(),h=l.redSqr(),u=h.redSqr(),p=d.redAdd(d).redIAdd(d).redIAdd(r.redMul(c)),f=n.redMul(h),g=p.redSqr().redISub(f.redAdd(f)),y=f.redISub(g),m=p.redMul(y);m=m.redIAdd(m).redISub(u);var b=l.redMul(o);t+1<e&&(c=c.redMul(u)),n=g,o=b,l=m}return this.curve.jpoint(n,l.redMul(s),o)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},d.prototype._zeroDbl=function(){if(this.zOne){var e,t,i,r=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(r).redISub(n);a=a.redIAdd(a);var o=r.redAdd(r).redIAdd(r),c=o.redSqr().redISub(a).redISub(a),l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),e=c,t=o.redMul(a.redISub(c)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),h=this.y.redSqr(),u=h.redSqr(),p=this.x.redAdd(h).redSqr().redISub(d).redISub(u);p=p.redIAdd(p);var f=d.redAdd(d).redIAdd(d),g=f.redSqr(),y=u.redIAdd(u);y=(y=y.redIAdd(y)).redIAdd(y),e=g.redISub(p).redISub(p),t=f.redMul(p.redISub(e)).redISub(y),i=(i=this.y.redMul(this.z)).redIAdd(i)}return this.curve.jpoint(e,t,i)},d.prototype._threeDbl=function(){if(this.zOne){var e,t,i,r=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),a=this.x.redAdd(s).redSqr().redISub(r).redISub(n);a=a.redIAdd(a);var o=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),c=o.redSqr().redISub(a).redISub(a);e=c;var l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),t=o.redMul(a.redISub(c)).redISub(l),i=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),h=this.y.redSqr(),u=this.x.redMul(h),p=this.x.redSub(d).redMul(this.x.redAdd(d));p=p.redAdd(p).redIAdd(p);var f=u.redIAdd(u),g=(f=f.redIAdd(f)).redAdd(f);e=p.redSqr().redISub(g),i=this.y.redAdd(this.z).redSqr().redISub(h).redISub(d);var y=h.redSqr();y=(y=(y=y.redIAdd(y)).redIAdd(y)).redIAdd(y),t=p.redMul(f.redISub(e)).redISub(y)}return this.curve.jpoint(e,t,i)},d.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,r=this.z,s=r.redSqr().redSqr(),n=t.redSqr(),a=i.redSqr(),o=n.redAdd(n).redIAdd(n).redIAdd(e.redMul(s)),c=t.redAdd(t),l=(c=c.redIAdd(c)).redMul(a),d=o.redSqr().redISub(l.redAdd(l)),h=l.redISub(d),u=a.redSqr();u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var p=o.redMul(h).redISub(u),f=i.redAdd(i).redMul(r);return this.curve.jpoint(d,p,f)},d.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),r=t.redSqr(),s=e.redAdd(e).redIAdd(e),n=s.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(r),o=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(n)).redSqr(),c=r.redIAdd(r);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var l=s.redIAdd(a).redSqr().redISub(n).redISub(o).redISub(c),d=t.redMul(l);d=(d=d.redIAdd(d)).redIAdd(d);var h=this.x.redMul(o).redISub(d);h=(h=h.redIAdd(h)).redIAdd(h);var u=this.y.redMul(l.redMul(c.redISub(l)).redISub(a.redMul(o)));u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var p=this.z.redAdd(a).redSqr().redISub(i).redISub(o);return this.curve.jpoint(h,u,p)},d.prototype.mul=function(e,t){return e=new s(e,t),this.curve._wnafMul(this,e)},d.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(0!==this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),s=i.redMul(e.z);return 0===this.y.redMul(s).redISub(e.y.redMul(r)).cmpn(0)},d.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(i))return!0;for(var r=e.clone(),s=this.curve.redN.redMul(t);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),0===this.x.cmp(i))return!0}},d.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},d.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},93973:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},95954:(e,t,i)=>{"use strict";let r;i.d(t,{x:()=>E});var s=i(41179),n=i(74801),a=i(91019),o=i(13015),c=i(5001),l=i(63),d=i(1221),h=i(14109),u=i(50209),p=i(20641),f=i(58267),g=i(1711),y=i(42270),m=i(75808),b=i(97490);let w=(0,s.BX)({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),v={state:w,subscribe:e=>(0,s.B1)(w,()=>e(w)),setLastNetworkInView(e){w.lastNetworkInView=e},async fetchTransactions(e,t){if(!e)throw Error("Transactions can't be fetched without an accountAddress");w.loading=!0;try{let i=await y.T.fetchTransactions({account:e,cursor:w.next,onramp:t,cache:"coinbase"===t?"no-cache":void 0,chainId:l.W.state.activeCaipNetwork?.caipNetworkId}),r=this.filterSpamTransactions(i.data),s=this.filterByConnectedChain(r),n=[...w.transactions,...s];w.loading=!1,"coinbase"===t?w.coinbaseTransactions=this.groupTransactionsByYearAndMonth(w.coinbaseTransactions,i.data):(w.transactions=n,w.transactionsByYear=this.groupTransactionsByYearAndMonth(w.transactionsByYear,s)),w.empty=0===n.length,w.next=i.next?i.next:void 0}catch(t){h.E.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:m.H.state.projectId,cursor:w.next,isSmartAccount:g.U.state.preferredAccountType===f.Vl.ACCOUNT_TYPES.SMART_ACCOUNT}}),b.P.showError("Failed to fetch transactions"),w.loading=!1,w.empty=!0,w.next=void 0}},groupTransactionsByYearAndMonth:(e={},t=[])=>(t.forEach(t=>{let i=new Date(t.metadata.minedAt).getFullYear(),r=new Date(t.metadata.minedAt).getMonth(),s=e[i]??{},n=(s[r]??[]).filter(e=>e.id!==t.id);e[i]={...s,[r]:[...n,t].sort((e,t)=>new Date(t.metadata.minedAt).getTime()-new Date(e.metadata.minedAt).getTime())}}),e),filterSpamTransactions:e=>e.filter(e=>!e.transfers.every(e=>e.nft_info?.flags.is_spam===!0)),filterByConnectedChain(e){let t=l.W.state.activeCaipNetwork?.caipNetworkId;return e.filter(e=>e.metadata.chain===t)},clearCursor(){w.next=void 0},resetTransactions(){w.transactions=[],w.transactionsByYear={},w.lastNetworkInView=void 0,w.loading=!1,w.empty=!1,w.next=void 0}},I=(0,s.BX)({wcError:!1,buffering:!1,status:"disconnected"}),E={state:I,subscribeKey:(e,t)=>(0,n.u$)(I,e,t),_getClient:()=>I._client,setClient(e){I._client=(0,s.KR)(e)},async connectWalletConnect(){if(a.w.isTelegram()||a.w.isSafari()&&a.w.isIos()){if(r){await r,r=void 0;return}if(!a.w.isPairingExpired(I?.wcPairingExpiry)){let e=I.wcUri;I.wcUri=e;return}r=this._getClient()?.connectWalletConnect?.().catch(()=>void 0),this.state.status="connecting",await r,r=void 0,I.wcPairingExpiry=void 0,this.state.status="connected"}else await this._getClient()?.connectWalletConnect?.()},async connectExternal(e,t,i=!0){await this._getClient()?.connectExternal?.(e),i&&l.W.setActiveNamespace(t)},async reconnectExternal(e){await this._getClient()?.reconnectExternal?.(e);let t=e.chain||l.W.state.activeChain;t&&d.a.setConnectorId(e.id,t)},async setPreferredAccountType(e){u.W.setLoading(!0,l.W.state.activeChain);let t=d.a.getAuthConnector();t&&(await t?.provider.setPreferredAccount(e),await this.reconnectExternal(t),u.W.setLoading(!1,l.W.state.activeChain),h.E.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:l.W.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(e){return this._getClient()?.signMessage(e)},parseUnits(e,t){return this._getClient()?.parseUnits(e,t)},formatUnits(e,t){return this._getClient()?.formatUnits(e,t)},async sendTransaction(e){return this._getClient()?.sendTransaction(e)},async getCapabilities(e){return this._getClient()?.getCapabilities(e)},async grantPermissions(e){return this._getClient()?.grantPermissions(e)},async walletGetAssets(e){return this._getClient()?.walletGetAssets(e)??{}},async estimateGas(e){return this._getClient()?.estimateGas(e)},async writeContract(e){return this._getClient()?.writeContract(e)},async getEnsAddress(e){return this._getClient()?.getEnsAddress(e)},async getEnsAvatar(e){return this._getClient()?.getEnsAvatar(e)},checkInstalled(e){return this._getClient()?.checkInstalled?.(e)||!1},resetWcConnection(){I.wcUri=void 0,I.wcPairingExpiry=void 0,I.wcLinking=void 0,I.recentWallet=void 0,I.status="disconnected",v.resetTransactions(),c.i.deleteWalletConnectDeepLink()},resetUri(){I.wcUri=void 0,I.wcPairingExpiry=void 0},finalizeWcConnection(){let{wcLinking:e,recentWallet:t}=E.state;e&&c.i.setWalletConnectDeepLink(e),t&&c.i.setAppKitRecent(t),h.E.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:p.I.state.data?.wallet?.name||"Unknown"}})},setWcBasic(e){I.wcBasic=e},setUri(e){I.wcUri=e,I.wcPairingExpiry=a.w.getPairingExpiry()},setWcLinking(e){I.wcLinking=e},setWcError(e){I.wcError=e,I.buffering=!1},setRecentWallet(e){I.recentWallet=e},setBuffering(e){I.buffering=e},setStatus(e){I.status=e},async disconnect(e){try{u.W.setLoading(!0,e),await o.U.clearSessions(),await l.W.disconnect(e),u.W.setLoading(!1,e),d.a.setFilterByNamespace(void 0)}catch(e){throw Error("Failed to disconnect")}}}},97348:(e,t,i)=>{"use strict";var r=i(56825),s=i(72597);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]}r.inherits(n,s),e.exports=n,n.blockSize=1024,n.outSize=384,n.hmacStrength=192,n.padLength=128,n.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},97490:(e,t,i)=>{"use strict";i.d(t,{P:()=>c});var r=i(41179),s=i(74801),n=i(91019);let a=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),o=(0,r.BX)({...a}),c={state:o,subscribeKey:(e,t)=>(0,s.u$)(o,e,t),showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){let t=n.w.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){o.message=a.message,o.variant=a.variant,o.svg=a.svg,o.open=a.open,o.autoClose=a.autoClose},_showMessage({message:e,svg:t,variant:i="success",autoClose:r=a.autoClose}){o.open?(o.open=!1,setTimeout(()=>{o.message=e,o.variant=i,o.svg=t,o.open=!0,o.autoClose=r},150)):(o.message=e,o.variant=i,o.svg=t,o.open=!0,o.autoClose=r)}}}}]);